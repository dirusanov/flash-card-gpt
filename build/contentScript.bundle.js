(()=>{"use strict";var e={146:(e,t,n)=>{var r=n(363),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?i:s[e.$$typeof]||o}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=i;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(g){var o=f(n);o&&o!==g&&e(t,o,r)}var i=u(n);d&&(i=i.concat(d(n)));for(var s=l(t),h=l(n),m=0;m<i.length;++m){var y=i[m];if(!(a[y]||r&&r[y]||h&&h[y]||s&&s[y])){var x=p(n,y);try{c(t,y,x)}catch(e){}}}}return t}},551:(e,t,n)=>{
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=n(982);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function h(e,t,n,r,o,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new h(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new h(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new h(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new h(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new h(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new h(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new h(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new h(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new h(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function v(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(g,e)||!d.call(f,e)&&(p.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new h(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new h("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new h(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),A=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var B=Symbol.iterator;function O(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=B&&e[B]||e["@@iterator"])?e:null}var z,L=Object.assign;function N(e){if(void 0===z)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||""}return"\n"+z+e}var D=!1;function M(e,t){if(!e||D)return"";D=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),a=r.stack.split("\n"),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(1!==i||1!==s)do{if(i--,0>--s||o[i]!==a[s]){var l="\n"+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=s);break}}}finally{D=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function U(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=M(e.type,!1);case 11:return e=M(e.type.render,!1);case 1:return e=M(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case C:return"Fragment";case S:return"Portal";case E:return"Profiler";case k:return"StrictMode";case j:return"Suspense";case F:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return q(e(t))}catch(e){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=$(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Y(e,t){X(e,t);var n=$(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:$(n)}}function ae(e,t){var n=$(t.value),r=$(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function he(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=he(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(fe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ce=null,ke=null;function Ee(e){if(e=bo(e)){if("function"!=typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=So(t),Se(e.stateNode,e.type,t))}}function Ie(e){Ce?ke?ke.push(e):ke=[e]:Ce=e}function Ae(){if(Ce){var e=Ce,t=ke;if(ke=Ce=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function _e(e,t){return e(t)}function je(){}var Fe=!1;function Te(e,t,n){if(Fe)return e(t,n);Fe=!0;try{return _e(e,t,n)}finally{Fe=!1,(null!==Ce||null!==ke)&&(je(),Ae())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=So(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Re=!1;if(u)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch(ue){Re=!1}function Oe(e,t,n,r,o,a,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var ze=!1,Le=null,Ne=!1,De=null,Me={onError:function(e){ze=!0,Le=e}};function Ue(e,t,n,r,o,a,i,s,l){ze=!1,Le=null,Oe.apply(Me,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(qe(e)!==e)throw Error(a(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return $e(o),e;if(i===r)return $e(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var He=o.unstable_scheduleCallback,Ke=o.unstable_cancelCallback,Qe=o.unstable_shouldYield,Je=o.unstable_requestPaint,Xe=o.unstable_now,Ye=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~o;0!==s?r=dt(s):0!==(a&=i)&&(r=dt(a))}else 0!==(i=n&~o)?r=dt(i):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&!(t&o)&&((o=r&-r)>=(a=t&-t)||16===o&&4194240&a))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-it(t)),r|=e[n],t&=~o;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ht(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function xt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,St,Ct,kt,Et,It=!1,At=[],_t=null,jt=null,Ft=null,Tt=new Map,Pt=new Map,Rt=[],Bt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":_t=null;break;case"dragenter":case"dragleave":jt=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function zt(e,t,n,r,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=bo(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=vo(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Et(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bo(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Dt(e,t,n){Nt(e)&&n.delete(t)}function Mt(){It=!1,null!==_t&&Nt(_t)&&(_t=null),null!==jt&&Nt(jt)&&(jt=null),null!==Ft&&Nt(Ft)&&(Ft=null),Tt.forEach(Dt),Pt.forEach(Dt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Mt)))}function qt(e){function t(t){return Ut(t,e)}if(0<At.length){Ut(At[0],e);for(var n=1;n<At.length;n++){var r=At[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==_t&&Ut(_t,e),null!==jt&&Ut(jt,e),null!==Ft&&Ut(Ft,e),Tt.forEach(t),Pt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Rt.shift()}var Wt=b.ReactCurrentBatchConfig,$t=!0;function Gt(e,t,n,r){var o=vt,a=Wt.transition;Wt.transition=null;try{vt=1,Ht(e,t,n,r)}finally{vt=o,Wt.transition=a}}function Vt(e,t,n,r){var o=vt,a=Wt.transition;Wt.transition=null;try{vt=4,Ht(e,t,n,r)}finally{vt=o,Wt.transition=a}}function Ht(e,t,n,r){if($t){var o=Qt(e,t,n,r);if(null===o)$r(e,t,r,Kt,n),Ot(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return _t=zt(_t,e,t,n,r,o),!0;case"dragenter":return jt=zt(jt,e,t,n,r,o),!0;case"mouseover":return Ft=zt(Ft,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return Tt.set(a,zt(Tt.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Pt.set(a,zt(Pt.get(a)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Bt.indexOf(e)){for(;null!==o;){var a=bo(o);if(null!==a&&wt(a),null===(a=Qt(e,t,n,r))&&$r(e,t,r,Kt,n),a===o)break;o=a}null!==o&&r.stopPropagation()}else $r(e,t,r,null,n)}}var Kt=null;function Qt(e,t,n,r){if(Kt=null,null!==(e=vo(e=we(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Yt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Yt,r=n.length,o="value"in Xt?Xt.value:Xt.textContent,a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=L({},cn,{view:0,detail:0}),pn=on(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),gn=on(fn),hn=on(L({},fn,{dataTransfer:0})),mn=on(L({},dn,{relatedTarget:0})),yn=on(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=on(xn),bn=on(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function En(){return kn}var In=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=on(In),_n=on(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),jn=on(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Fn=on(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Tn),Rn=[9,13,27,32],Bn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var zn=u&&"TextEvent"in window&&!On,Ln=u&&(!Bn||On&&8<On&&11>=On),Nn=String.fromCharCode(32),Dn=!1;function Mn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ie(r),0<(t=Vr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Hn=null;function Kn(e){Nr(e,0)}function Qn(e){if(H(wo(e)))return e}function Jn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Yn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"==typeof er.oninput}Yn=Zn}else Yn=!1;Xn=Yn&&(!document.documentMode||9<document.documentMode)}function tr(){Vn&&(Vn.detachEvent("onpropertychange",nr),Hn=Vn=null)}function nr(e){if("value"===e.propertyName&&Qn(Hn)){var t=[];Gn(t,Hn,e,we(e)),Te(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Hn=n,(Vn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Hn)}function ar(e,t){if("click"===e)return Qn(t)}function ir(e,t){if("input"===e||"change"===e)return Qn(t)}var sr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(sr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=void 0===r.end?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=ur(n,a);var i=ur(n,r);o&&i&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,xr=null,vr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&lr(xr,r)||(xr=r,0<(r=Vr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Cr={},kr={};function Er(e){if(Cr[e])return Cr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Cr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Ir=Er("animationend"),Ar=Er("animationiteration"),_r=Er("animationstart"),jr=Er("transitionend"),Fr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Fr.set(e,t),l(t,[e])}for(var Rr=0;Rr<Tr.length;Rr++){var Br=Tr[Rr];Pr(Br.toLowerCase(),"on"+(Br[0].toUpperCase()+Br.slice(1)))}Pr(Ir,"onAnimationEnd"),Pr(Ar,"onAnimationIteration"),Pr(_r,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(jr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,l,c){if(Ue.apply(this,arguments),ze){if(!ze)throw Error(a(198));var u=Le;ze=!1,Le=null,Ne||(Ne=!0,De=u)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;Lr(o,s,c),a=l}else for(i=0;i<r.length;i++){if(l=(s=r[i]).instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;Lr(o,s,c),a=l}}}if(Ne)throw e=De,Ne=!1,De=null,e}function Dr(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Mr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Ur]){e[Ur]=!0,i.forEach((function(t){"selectionchange"!==t&&(zr.has(t)||Mr(t,!1,e),Mr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Mr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Jt(t)){case 1:var o=Gt;break;case 4:o=Vt;break;default:o=Ht}n=o.bind(null,t,n,e),o=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function $r(e,t,n,r,o){var a=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;i=i.return}for(;null!==s;){if(null===(i=vo(s)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}s=s.parentNode}}r=r.return}Te((function(){var r=a,o=we(n),i=[];e:{var s=Fr.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=hn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=jn;break;case Ir:case Ar:case _r:l=yn;break;case jr:l=Fn;break;case"scroll":l=pn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_n}var u=!!(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var f,g=r;null!==g;){var h=(f=g).stateNode;if(5===f.tag&&null!==h&&(f=h,null!==p&&(null!=(h=Pe(g,p))&&u.push(Gr(g,h,f)))),d)break;g=g.return}0<u.length&&(s=new l(s,c,null,n,o),i.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!vo(c)&&!c[ho])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vo(c):null)&&(c!==(d=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=gn,h="onMouseLeave",p="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=_n,h="onPointerLeave",p="onPointerEnter",g="pointer"),d=null==l?s:wo(l),f=null==c?s:wo(c),(s=new u(h,g+"leave",l,n,o)).target=d,s.relatedTarget=f,h=null,vo(o)===r&&((u=new u(p,g+"enter",c,n,o)).target=f,u.relatedTarget=d,h=u),d=h,l&&c)e:{for(p=c,g=0,f=u=l;f;f=Hr(f))g++;for(f=0,h=p;h;h=Hr(h))f++;for(;0<g-f;)u=Hr(u),g--;for(;0<f-g;)p=Hr(p),f--;for(;g--;){if(u===p||null!==p&&u===p.alternate)break e;u=Hr(u),p=Hr(p)}u=null}else u=null;null!==l&&Kr(i,s,l,u,!1),null!==c&&null!==d&&Kr(i,d,c,u,!0)}if("select"===(l=(s=r?wo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Jn;else if($n(s))if(Xn)m=ir;else{m=or;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ar);switch(m&&(m=m(e,r))?Gn(i,m,n,o):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?wo(r):window,e){case"focusin":($n(y)||"true"===y.contentEditable)&&(mr=y,yr=r,xr=null);break;case"focusout":xr=yr=mr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,br(i,n,o);break;case"selectionchange":if(hr)break;case"keydown":case"keyup":br(i,n,o)}var x;if(Bn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else qn?Mn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Ln&&"ko"!==n.locale&&(qn||"onCompositionStart"!==v?"onCompositionEnd"===v&&qn&&(x=en()):(Yt="value"in(Xt=o)?Xt.value:Xt.textContent,qn=!0)),0<(y=Vr(r,v)).length&&(v=new bn(v,e,null,n,o),i.push({event:v,listeners:y}),x?v.data=x:null!==(x=Un(n))&&(v.data=x))),(x=zn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Dn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Dn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Bn&&Mn(e,t)?(e=en(),Zt=Yt=Xt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(o=new bn("onBeforeInput","beforeinput",null,n,o),i.push({event:o,listeners:r}),o.data=x))}Nr(i,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=Pe(e,n))&&r.unshift(Gr(e,a,o)),null!=(a=Pe(e,t))&&r.push(Gr(e,a,o))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,o){for(var a=t._reactName,i=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Pe(n,a))&&i.unshift(Gr(n,l,s)):o||null!=(l=Pe(n,a))&&i.push(Gr(n,l,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Qr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Xr(e){return("string"==typeof e?e:""+e).replace(Qr,"\n").replace(Jr,"")}function Yr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(a(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"==typeof setTimeout?setTimeout:void 0,oo="function"==typeof clearTimeout?clearTimeout:void 0,ao="function"==typeof Promise?Promise:void 0,io="function"==typeof queueMicrotask?queueMicrotask:void 0!==ao?function(e){return ao.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout((function(){throw e}))}function lo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);qt(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),fo="__reactFiber$"+po,go="__reactProps$"+po,ho="__reactContainer$"+po,mo="__reactEvents$"+po,yo="__reactListeners$"+po,xo="__reactHandles$"+po;function vo(e){var t=e[fo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ho]||n[fo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[fo])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function bo(e){return!(e=e[fo]||e[ho])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function So(e){return e[go]||null}var Co=[],ko=-1;function Eo(e){return{current:e}}function Io(e){0>ko||(e.current=Co[ko],Co[ko]=null,ko--)}function Ao(e,t){ko++,Co[ko]=e.current,e.current=t}var _o={},jo=Eo(_o),Fo=Eo(!1),To=_o;function Po(e,t){var n=e.type.contextTypes;if(!n)return _o;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ro(e){return null!=(e=e.childContextTypes)}function Bo(){Io(Fo),Io(jo)}function Oo(e,t,n){if(jo.current!==_o)throw Error(a(168));Ao(jo,t),Ao(Fo,n)}function zo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,W(e)||"Unknown",o));return L({},n,r)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_o,To=jo.current,Ao(jo,e),Ao(Fo,Fo.current),!0}function No(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=zo(e,t,To),r.__reactInternalMemoizedMergedChildContext=e,Io(Fo),Io(jo),Ao(jo,e)):Io(Fo),Ao(Fo,n)}var Do=null,Mo=!1,Uo=!1;function qo(e){null===Do?Do=[e]:Do.push(e)}function Wo(){if(!Uo&&null!==Do){Uo=!0;var e=0,t=vt;try{var n=Do;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Do=null,Mo=!1}catch(t){throw null!==Do&&(Do=Do.slice(e+1)),He(Ze,Wo),t}finally{vt=t,Uo=!1}}return null}var $o=[],Go=0,Vo=null,Ho=0,Ko=[],Qo=0,Jo=null,Xo=1,Yo="";function Zo(e,t){$o[Go++]=Ho,$o[Go++]=Vo,Vo=e,Ho=t}function ea(e,t,n){Ko[Qo++]=Xo,Ko[Qo++]=Yo,Ko[Qo++]=Jo,Jo=e;var r=Xo;e=Yo;var o=32-it(r)-1;r&=~(1<<o),n+=1;var a=32-it(t)+o;if(30<a){var i=o-o%5;a=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Xo=1<<32-it(t)+o|n<<o|r,Yo=a+e}else Xo=1<<a|n<<o|r,Yo=e}function ta(e){null!==e.return&&(Zo(e,1),ea(e,1,0))}function na(e){for(;e===Vo;)Vo=$o[--Go],$o[Go]=null,Ho=$o[--Go],$o[Go]=null;for(;e===Jo;)Jo=Ko[--Qo],Ko[Qo]=null,Yo=Ko[--Qo],Ko[Qo]=null,Xo=Ko[--Qo],Ko[Qo]=null}var ra=null,oa=null,aa=!1,ia=null;function sa(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function la(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,oa=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Jo?{id:Xo,overflow:Yo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ra=e,oa=null,!0);default:return!1}}function ca(e){return!(!(1&e.mode)||128&e.flags)}function ua(e){if(aa){var t=oa;if(t){var n=t;if(!la(e,t)){if(ca(e))throw Error(a(418));t=co(n.nextSibling);var r=ra;t&&la(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,aa=!1,ra=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,ra=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function pa(e){if(e!==ra)return!1;if(!aa)return da(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oa)){if(ca(e))throw fa(),Error(a(418));for(;t;)sa(e,t),t=co(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oa=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oa=null}}else oa=ra?co(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=oa;e;)e=co(e.nextSibling)}function ga(){oa=ra=null,aa=!1}function ha(e){null===ia?ia=[e]:ia.push(e)}var ma=b.ReactCurrentBatchConfig;function ya(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var xa=Eo(null),va=null,ba=null,wa=null;function Sa(){wa=ba=va=null}function Ca(e){var t=xa.current;Io(xa),e._currentValue=t}function ka(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ea(e,t){va=e,wa=ba=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ia(e){var t=e._currentValue;if(wa!==e)if(e={context:e,memoizedValue:t,next:null},null===ba){if(null===va)throw Error(a(308));ba=e,va.dependencies={lanes:0,firstContext:e}}else ba=ba.next=e;return t}var Aa=null;function _a(e){null===Aa?Aa=[e]:Aa.push(e)}function ja(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,_a(t)):(n.next=o.next,o.next=n),t.interleaved=n,Fa(e,r)}function Fa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ta=!1;function Pa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&jl){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Fa(e,n)}return null===(o=r.interleaved)?(t.next=t,_a(r)):(t.next=o.next,o.next=t),r.interleaved=t,Fa(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}function La(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Na(e,t,n,r){var o=e.updateQueue;Ta=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==a){var d=o.baseState;for(i=0,u=c=l=null,s=a;;){var p=s.lane,f=s.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,h=s;switch(p=t,f=n,h.tag){case 1:if("function"==typeof(g=h.payload)){d=g.call(f,d,p);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(p="function"==typeof(g=h.payload)?g.call(f,d,p):g))break e;d=L({},d,p);break e;case 2:Ta=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,i|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{i|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Ll|=i,e.lanes=i,e.memoizedState=d}}function Da(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(a(191,o));o.call(r)}}}var Ma=(new r.Component).refs;function Ua(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var qa={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),o=nc(e),a=Ba(r,o);a.payload=t,null!=n&&(a.callback=n),null!==(t=Oa(e,a,o))&&(rc(t,e,o,r),za(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),o=nc(e),a=Ba(r,o);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=Oa(e,a,o))&&(rc(t,e,o,r),za(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),o=Ba(n,r);o.tag=2,null!=t&&(o.callback=t),null!==(t=Oa(e,o,r))&&(rc(t,e,r,n),za(t,e,r))}};function Wa(e,t,n,r,o,a,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(o,a))}function $a(e,t,n){var r=!1,o=_o,a=t.contextType;return"object"==typeof a&&null!==a?a=Ia(a):(o=Ro(t)?To:jo.current,a=(r=null!=(r=t.contextTypes))?Po(e,o):_o),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ga(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qa.enqueueReplaceState(t,t.state,null)}function Va(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=Ma,Pa(e);var a=t.contextType;"object"==typeof a&&null!==a?o.context=Ia(a):(a=Ro(t)?To:jo.current,o.context=Po(e,a)),o.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&qa.enqueueReplaceState(o,o.state,null),Na(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function Ha(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;t===Ma&&(t=o.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qa(e){return(0,e._init)(e._payload)}function Ja(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Bc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Nc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===C?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===P&&Qa(a)===t.type)?((r=o(t,n.props)).ref=Ha(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=Ha(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=zc(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Nc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=Ha(e,null,t),n.return=e,n;case S:return(t=Dc(t,e.mode,n)).return=e,t;case P:return p(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=zc(t,e.mode,n,null)).return=e,t;Ka(e,t)}return null}function f(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===o?c(e,t,n,r):null;case S:return n.key===o?u(e,t,n,r):null;case P:return f(e,t,(o=n._init)(n._payload),r)}if(te(n)||O(n))return null!==o?null:d(e,t,n,r,null);Ka(e,n)}return null}function g(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case P:return g(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,o,null);Ka(t,r)}return null}function h(o,a,s,l){for(var c=null,u=null,d=a,h=a=0,m=null;null!==d&&h<s.length;h++){d.index>h?(m=d,d=null):m=d.sibling;var y=f(o,d,s[h],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(o,d),a=i(y,a,h),null===u?c=y:u.sibling=y,u=y,d=m}if(h===s.length)return n(o,d),aa&&Zo(o,h),c;if(null===d){for(;h<s.length;h++)null!==(d=p(o,s[h],l))&&(a=i(d,a,h),null===u?c=d:u.sibling=d,u=d);return aa&&Zo(o,h),c}for(d=r(o,d);h<s.length;h++)null!==(m=g(d,o,h,s[h],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?h:m.key),a=i(m,a,h),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),aa&&Zo(o,h),c}function m(o,s,l,c){var u=O(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,h=s,m=s=0,y=null,x=l.next();null!==h&&!x.done;m++,x=l.next()){h.index>m?(y=h,h=null):y=h.sibling;var v=f(o,h,x.value,c);if(null===v){null===h&&(h=y);break}e&&h&&null===v.alternate&&t(o,h),s=i(v,s,m),null===d?u=v:d.sibling=v,d=v,h=y}if(x.done)return n(o,h),aa&&Zo(o,m),u;if(null===h){for(;!x.done;m++,x=l.next())null!==(x=p(o,x.value,c))&&(s=i(x,s,m),null===d?u=x:d.sibling=x,d=x);return aa&&Zo(o,m),u}for(h=r(o,h);!x.done;m++,x=l.next())null!==(x=g(h,o,m,x.value,c))&&(e&&null!==x.alternate&&h.delete(null===x.key?m:x.key),s=i(x,s,m),null===d?u=x:d.sibling=x,d=x);return e&&h.forEach((function(e){return t(o,e)})),aa&&Zo(o,m),u}return function e(r,a,i,l){if("object"==typeof i&&null!==i&&i.type===C&&null===i.key&&(i=i.props.children),"object"==typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=a;null!==u;){if(u.key===c){if((c=i.type)===C){if(7===u.tag){n(r,u.sibling),(a=o(u,i.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===P&&Qa(c)===u.type){n(r,u.sibling),(a=o(u,i.props)).ref=Ha(r,u,i),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===C?((a=zc(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=Oc(i.type,i.key,i.props,null,r.mode,l)).ref=Ha(r,a,i),l.return=r,r=l)}return s(r);case S:e:{for(u=i.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=o(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Dc(i,r.mode,l)).return=r,r=a}return s(r);case P:return e(r,a,(u=i._init)(i._payload),l)}if(te(i))return h(r,a,i,l);if(O(i))return m(r,a,i,l);Ka(r,i)}return"string"==typeof i&&""!==i||"number"==typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=o(a,i)).return=r,r=a):(n(r,a),(a=Nc(i,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var Xa=Ja(!0),Ya=Ja(!1),Za={},ei=Eo(Za),ti=Eo(Za),ni=Eo(Za);function ri(e){if(e===Za)throw Error(a(174));return e}function oi(e,t){switch(Ao(ni,t),Ao(ti,e),Ao(ei,Za),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Io(ei),Ao(ei,t)}function ai(){Io(ei),Io(ti),Io(ni)}function ii(e){ri(ni.current);var t=ri(ei.current),n=le(t,e.type);t!==n&&(Ao(ti,e),Ao(ei,n))}function si(e){ti.current===e&&(Io(ei),Io(ti))}var li=Eo(0);function ci(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ui=[];function di(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var pi=b.ReactCurrentDispatcher,fi=b.ReactCurrentBatchConfig,gi=0,hi=null,mi=null,yi=null,xi=!1,vi=!1,bi=0,wi=0;function Si(){throw Error(a(321))}function Ci(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ki(e,t,n,r,o,i){if(gi=i,hi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pi.current=null===e||null===e.memoizedState?ss:ls,e=n(r,o),vi){i=0;do{if(vi=!1,bi=0,25<=i)throw Error(a(301));i+=1,yi=mi=null,t.updateQueue=null,pi.current=cs,e=n(r,o)}while(vi)}if(pi.current=is,t=null!==mi&&null!==mi.next,gi=0,yi=mi=hi=null,xi=!1,t)throw Error(a(300));return e}function Ei(){var e=0!==bi;return bi=0,e}function Ii(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yi?hi.memoizedState=yi=e:yi=yi.next=e,yi}function Ai(){if(null===mi){var e=hi.alternate;e=null!==e?e.memoizedState:null}else e=mi.next;var t=null===yi?hi.memoizedState:yi.next;if(null!==t)yi=t,mi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(mi=e).memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},null===yi?hi.memoizedState=yi=e:yi=yi.next=e}return yi}function _i(e,t){return"function"==typeof t?t(e):t}function ji(e){var t=Ai(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=mi,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var l=s=null,c=null,u=i;do{var d=u.lane;if((gi&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=p,s=r):c=c.next=p,hi.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==i);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,hi.lanes|=i,Ll|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Fi(e){var t=Ai(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);sr(i,t.memoizedState)||(bs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ti(){}function Pi(e,t){var n=hi,r=Ai(),o=t(),i=!sr(r.memoizedState,o);if(i&&(r.memoizedState=o,bs=!0),r=r.queue,$i(Oi.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==yi&&1&yi.memoizedState.tag){if(n.flags|=2048,Di(9,Bi.bind(null,n,r,o,t),void 0,null),null===Fl)throw Error(a(349));30&gi||Ri(n,t,o)}return o}function Ri(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=hi.updateQueue)?(t={lastEffect:null,stores:null},hi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Bi(e,t,n,r){t.value=n,t.getSnapshot=r,zi(t)&&Li(e)}function Oi(e,t,n){return n((function(){zi(t)&&Li(e)}))}function zi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(e){return!0}}function Li(e){var t=Fa(e,1);null!==t&&rc(t,e,1,-1)}function Ni(e){var t=Ii();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,hi,e),[t.memoizedState,e]}function Di(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=hi.updateQueue)?(t={lastEffect:null,stores:null},hi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Mi(){return Ai().memoizedState}function Ui(e,t,n,r){var o=Ii();hi.flags|=e,o.memoizedState=Di(1|t,n,void 0,void 0===r?null:r)}function qi(e,t,n,r){var o=Ai();r=void 0===r?null:r;var a=void 0;if(null!==mi){var i=mi.memoizedState;if(a=i.destroy,null!==r&&Ci(r,i.deps))return void(o.memoizedState=Di(t,n,a,r))}hi.flags|=e,o.memoizedState=Di(1|t,n,a,r)}function Wi(e,t){return Ui(8390656,8,e,t)}function $i(e,t){return qi(2048,8,e,t)}function Gi(e,t){return qi(4,2,e,t)}function Vi(e,t){return qi(4,4,e,t)}function Hi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ki(e,t,n){return n=null!=n?n.concat([e]):null,qi(4,4,Hi.bind(null,t,e),n)}function Qi(){}function Ji(e,t){var n=Ai();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ci(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xi(e,t){var n=Ai();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ci(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Yi(e,t,n){return 21&gi?(sr(n,t)||(n=ht(),hi.lanes|=n,Ll|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n)}function Zi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=fi.transition;fi.transition={};try{e(!1),t()}finally{vt=n,fi.transition=r}}function es(){return Ai().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))os(t,n);else if(null!==(n=ja(e,t,n,r))){rc(n,e,r,tc()),as(n,t,r)}}function ns(e,t,n){var r=nc(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))os(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=a(i,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,i)){var l=t.interleaved;return null===l?(o.next=o,_a(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=ja(e,t,o,r))&&(rc(n,e,r,o=tc()),as(n,t,r))}}function rs(e){var t=e.alternate;return e===hi||null!==t&&t===hi}function os(e,t){vi=xi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function as(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}var is={readContext:Ia,useCallback:Si,useContext:Si,useEffect:Si,useImperativeHandle:Si,useInsertionEffect:Si,useLayoutEffect:Si,useMemo:Si,useReducer:Si,useRef:Si,useState:Si,useDebugValue:Si,useDeferredValue:Si,useTransition:Si,useMutableSource:Si,useSyncExternalStore:Si,useId:Si,unstable_isNewReconciler:!1},ss={readContext:Ia,useCallback:function(e,t){return Ii().memoizedState=[e,void 0===t?null:t],e},useContext:Ia,useEffect:Wi,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Ui(4194308,4,Hi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ui(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ui(4,2,e,t)},useMemo:function(e,t){var n=Ii();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ii();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,hi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ii().memoizedState=e},useState:Ni,useDebugValue:Qi,useDeferredValue:function(e){return Ii().memoizedState=e},useTransition:function(){var e=Ni(!1),t=e[0];return e=Zi.bind(null,e[1]),Ii().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=hi,o=Ii();if(aa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Fl)throw Error(a(349));30&gi||Ri(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Wi(Oi.bind(null,r,i,e),[e]),r.flags|=2048,Di(9,Bi.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Ii(),t=Fl.identifierPrefix;if(aa){var n=Yo;t=":"+t+"R"+(n=(Xo&~(1<<32-it(Xo)-1)).toString(32)+n),0<(n=bi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:Ia,useCallback:Ji,useContext:Ia,useEffect:$i,useImperativeHandle:Ki,useInsertionEffect:Gi,useLayoutEffect:Vi,useMemo:Xi,useReducer:ji,useRef:Mi,useState:function(){return ji(_i)},useDebugValue:Qi,useDeferredValue:function(e){return Yi(Ai(),mi.memoizedState,e)},useTransition:function(){return[ji(_i)[0],Ai().memoizedState]},useMutableSource:Ti,useSyncExternalStore:Pi,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ia,useCallback:Ji,useContext:Ia,useEffect:$i,useImperativeHandle:Ki,useInsertionEffect:Gi,useLayoutEffect:Vi,useMemo:Xi,useReducer:Fi,useRef:Mi,useState:function(){return Fi(_i)},useDebugValue:Qi,useDeferredValue:function(e){var t=Ai();return null===mi?t.memoizedState=e:Yi(t,mi.memoizedState,e)},useTransition:function(){return[Fi(_i)[0],Ai().memoizedState]},useMutableSource:Ti,useSyncExternalStore:Pi,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var fs="function"==typeof WeakMap?WeakMap:Map;function gs(e,t,n){(n=Ba(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gl||(Gl=!0,Vl=r),ps(0,t)},n}function hs(e,t,n){(n=Ba(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ps(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){ps(0,t),"function"!=typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fs;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Ic.bind(null,e,t,n),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xs(e,t,n,r,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ba(-1,1)).tag=2,Oa(n,t,1))),n.lanes|=1),e)}var vs=b.ReactCurrentOwner,bs=!1;function ws(e,t,n,r){t.child=null===e?Ya(t,null,n,r):Xa(t,e.child,n,r)}function Ss(e,t,n,r,o){n=n.render;var a=t.ref;return Ea(t,o),r=ki(e,t,n,r,a,o),n=Ei(),null===e||bs?(aa&&n&&ta(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Cs(e,t,n,r,o){if(null===e){var a=n.type;return"function"!=typeof a||Rc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ks(e,t,a,r,o))}if(a=e.child,!(e.lanes&o)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return Gs(e,t,o)}return t.flags|=1,(e=Bc(a,r)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,n,r,o){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=a,!(e.lanes&o))return t.lanes=e.lanes,Gs(e,t,o);131072&e.flags&&(bs=!0)}}return As(e,t,n,r,o)}function Es(e,t,n){var r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ao(Bl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ao(Bl,Rl),Rl|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ao(Bl,Rl),Rl|=n;else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ao(Bl,Rl),Rl|=r;return ws(e,t,o,n),t.child}function Is(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,n,r,o){var a=Ro(n)?To:jo.current;return a=Po(t,a),Ea(t,o),n=ki(e,t,n,r,a,o),r=Ei(),null===e||bs?(aa&&r&&ta(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function _s(e,t,n,r,o){if(Ro(n)){var a=!0;Lo(t)}else a=!1;if(Ea(t,o),null===t.stateNode)$s(e,t),$a(t,n,r),Va(t,n,r,o),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=n.contextType;"object"==typeof c&&null!==c?c=Ia(c):c=Po(t,c=Ro(n)?To:jo.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate;d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==r||l!==c)&&Ga(t,i,r,c),Ta=!1;var p=t.memoizedState;i.state=p,Na(t,r,i,o),l=t.memoizedState,s!==r||p!==l||Fo.current||Ta?("function"==typeof u&&(Ua(t,n,u,r),l=t.memoizedState),(s=Ta||Wa(t,n,s,r,p,l,c))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=s):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Ra(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ya(t.type,s),i.props=c,d=t.pendingProps,p=i.context,"object"==typeof(l=n.contextType)&&null!==l?l=Ia(l):l=Po(t,l=Ro(n)?To:jo.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==d||p!==l)&&Ga(t,i,r,l),Ta=!1,p=t.memoizedState,i.state=p,Na(t,r,i,o);var g=t.memoizedState;s!==d||p!==g||Fo.current||Ta?("function"==typeof f&&(Ua(t,n,f,r),g=t.memoizedState),(c=Ta||Wa(t,n,c,r,p,g,l)||!1)?(u||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,g,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,g,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),i.props=r,i.state=g,i.context=l,r=c):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return js(e,t,n,r,a,o)}function js(e,t,n,r,o,a){Is(e,t);var i=!!(128&t.flags);if(!r&&!i)return o&&No(t,n,!1),Gs(e,t,a);r=t.stateNode,vs.current=t;var s=i&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=Xa(t,e.child,null,a),t.child=Xa(t,null,s,a)):ws(e,t,s,a),t.memoizedState=r.state,o&&No(t,n,!0),t.child}function Fs(e){var t=e.stateNode;t.pendingContext?Oo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oo(0,t.context,!1),oi(e,t.containerInfo)}function Ts(e,t,n,r,o){return ga(),ha(o),t.flags|=256,ws(e,t,n,r),t.child}var Ps,Rs,Bs,Os,zs={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ns(e,t,n){var r,o=t.pendingProps,i=li.current,s=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ao(li,1&i),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},1&o||null===s?s=Lc(l,o,0,null):(s.childLanes=0,s.pendingProps=l),e=zc(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=zs,e):Ds(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,s){if(n)return 256&t.flags?(t.flags&=-257,Ms(e,t,s,r=ds(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Lc({mode:"visible",children:r.children},o,0,null),(i=zc(i,o,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,1&t.mode&&Xa(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=zs,i);if(!(1&t.mode))return Ms(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,Ms(e,t,s,r=ds(i=Error(a(419)),r,void 0))}if(l=!!(s&e.childLanes),bs||l){if(null!==(r=Fl)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=o&(r.suspendedLanes|s)?0:o)&&o!==i.retryLane&&(i.retryLane=o,Fa(e,o),rc(r,e,o,-1))}return mc(),Ms(e,t,s,r=ds(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,oa=co(o.nextSibling),ra=t,aa=!0,ia=null,null!==e&&(Ko[Qo++]=Xo,Ko[Qo++]=Yo,Ko[Qo++]=Jo,Xo=e.id,Yo=e.overflow,Jo=t),t=Ds(t,r.children),t.flags|=4096,t)}(e,t,l,o,r,i,n);if(s){s=o.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:o.children};return 1&l||t.child===i?(o=Bc(i,c)).subtreeFlags=14680064&i.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null),null!==r?s=Bc(r,s):(s=zc(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?Ls(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=zs,o}return e=(s=e.child).sibling,o=Bc(s,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Ds(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ms(e,t,n,r){return null!==r&&ha(r),Xa(t,e.child,null,n),(e=Ds(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ka(e.return,t,n)}function qs(e,t,n,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function Ws(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(ws(e,t,r.children,n),2&(r=li.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ao(li,r),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ci(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),qs(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ci(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}qs(t,!0,n,null,a);break;case"together":qs(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function $s(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Bc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vs(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Ro(t.type)&&Bo(),Hs(t),null;case 3:return r=t.stateNode,ai(),Io(Fo),Io(jo),di(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(pa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ia&&(sc(ia),ia=null))),Rs(e,t),Hs(t),null;case 5:si(t);var o=ri(ni.current);if(n=t.type,null!==e&&null!=t.stateNode)Bs(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Hs(t),null}if(e=ri(ei.current),pa(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[fo]=t,r[go]=i,e=!!(1&t.mode),n){case"dialog":Dr("cancel",r),Dr("close",r);break;case"iframe":case"object":case"embed":Dr("load",r);break;case"video":case"audio":for(o=0;o<Or.length;o++)Dr(Or[o],r);break;case"source":Dr("error",r);break;case"img":case"image":case"link":Dr("error",r),Dr("load",r);break;case"details":Dr("toggle",r);break;case"input":J(r,i),Dr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Dr("invalid",r);break;case"textarea":oe(r,i),Dr("invalid",r)}for(var l in xe(n,i),o=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Yr(r.textContent,c,e),o=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Yr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Dr("scroll",r)}switch(n){case"input":V(r),Z(r,i,!0);break;case"textarea":V(r),ie(r);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[fo]=t,e[go]=r,Ps(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":Dr("cancel",e),Dr("close",e),o=r;break;case"iframe":case"object":case"embed":Dr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Or.length;o++)Dr(Or[o],e);o=r;break;case"source":Dr("error",e),o=r;break;case"img":case"image":case"link":Dr("error",e),Dr("load",e),o=r;break;case"details":Dr("toggle",e),o=r;break;case"input":J(e,r),o=Q(e,r),Dr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=L({},r,{value:void 0}),Dr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Dr("invalid",e)}for(i in xe(n,o),c=o)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?me(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&pe(e,u):"number"==typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Dr("scroll",e):null!=u&&v(e,i,u,l))}switch(n){case"input":V(e),Z(e,r,!1);break;case"textarea":V(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+$(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Os(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(n=ri(ni.current),ri(ei.current),pa(t)){if(r=t.stateNode,n=t.memoizedProps,r[fo]=t,(i=r.nodeValue!==n)&&null!==(e=ra))switch(e.tag){case 3:Yr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yr(r.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fo]=t,t.stateNode=r}return Hs(t),null;case 13:if(Io(li),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&1&t.mode&&!(128&t.flags))fa(),ga(),t.flags|=98560,i=!1;else if(i=pa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[fo]=t}else ga(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),i=!1}else null!==ia&&(sc(ia),ia=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&li.current?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return ai(),Rs(e,t),null===e&&qr(t.stateNode.containerInfo),Hs(t),null;case 10:return Ca(t.type._context),Hs(t),null;case 19:if(Io(li),null===(i=t.memoizedState))return Hs(t),null;if(r=!!(128&t.flags),null===(l=i.rendering))if(r)Vs(i,!1);else{if(0!==Ol||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ci(e))){for(t.flags|=128,Vs(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ao(li,1&li.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>Wl&&(t.flags|=128,r=!0,Vs(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ci(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vs(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!aa)return Hs(t),null}else 2*Xe()-i.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Vs(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,n=li.current,Ao(li,r?1&n|2:1&n),t):(Hs(t),null);case 22:case 23:return pc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Rl)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qs(e,t){switch(na(t),t.tag){case 1:return Ro(t.type)&&Bo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ai(),Io(Fo),Io(jo),di(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return si(t),null;case 13:if(Io(li),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ga()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Io(li),null;case 4:return ai(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return pc(),null;default:return null}}Ps=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Rs=function(){},Bs=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,ri(ei.current);var a,i=null;switch(n){case"input":o=Q(e,o),r=Q(e,r),i=[];break;case"select":o=L({},o,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":o=re(e,o),r=re(e,r),i=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=Zr)}for(u in xe(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Dr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Js=!1,Xs=!1,Ys="function"==typeof WeakSet?WeakSet:Set,Zs=null;function el(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Ec(e,t,n)}else n.current=null}function tl(e,t,n){try{n()}catch(n){Ec(e,t,n)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&tl(t,n,a)}o=o.next}while(o!==r)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[go],delete t[mo],delete t[yo],delete t[xo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,pl=!1;function fl(e,t,n){for(n=n.child;null!==n;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,n)}catch(e){}switch(n.tag){case 5:Xs||el(n,t);case 6:var r=dl,o=pl;dl=null,fl(e,t,n),pl=o,null!==(dl=r)&&(pl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(pl?(e=dl,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),qt(e)):lo(dl,n.stateNode));break;case 4:r=dl,o=pl,dl=n.stateNode.containerInfo,pl=!0,fl(e,t,n),dl=r,pl=o;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var a=o,i=a.destroy;a=a.tag,void 0!==i&&(2&a||4&a)&&tl(n,t,i),o=o.next}while(o!==r)}fl(e,t,n);break;case 1:if(!Xs&&(el(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Ec(n,t,e)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,fl(e,t,n),Xs=r):fl(e,t,n);break;default:fl(e,t,n)}}function hl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var r=jc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,pl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,pl=!0;break e}l=l.return}if(null===dl)throw Error(a(160));gl(i,s,o),dl=null,pl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(e){Ec(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),xl(e),4&r){try{rl(3,e,e.return),ol(3,e)}catch(t){Ec(e,e.return,t)}try{rl(5,e,e.return)}catch(t){Ec(e,e.return,t)}}break;case 1:ml(t,e),xl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),xl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var o=e.stateNode;try{pe(o,"")}catch(t){Ec(e,e.return,t)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&X(o,i),ve(l,s);var u=ve(l,i);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?me(o,p):"dangerouslySetInnerHTML"===d?de(o,p):"children"===d?pe(o,p):v(o,d,p,u)}switch(l){case"input":Y(o,i);break;case"textarea":ae(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var g=i.value;null!=g?ne(o,!!i.multiple,g,!1):f!==!!i.multiple&&(null!=i.defaultValue?ne(o,!!i.multiple,i.defaultValue,!0):ne(o,!!i.multiple,i.multiple?[]:"",!1))}o[go]=i}catch(t){Ec(e,e.return,t)}}break;case 6:if(ml(t,e),xl(e),4&r){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(t){Ec(e,e.return,t)}}break;case 3:if(ml(t,e),xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(t){Ec(e,e.return,t)}break;case 4:default:ml(t,e),xl(e);break;case 13:ml(t,e),xl(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(ql=Xe())),4&r&&hl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(u=Xs)||d,ml(t,e),Xs=u):ml(t,e),xl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Zs=e,d=e.child;null!==d;){for(p=Zs=d;null!==Zs;){switch(g=(f=Zs).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var h=f.stateNode;if("function"==typeof h.componentWillUnmount){r=f,n=f.return;try{t=r,h.props=t.memoizedProps,h.state=t.memoizedState,h.componentWillUnmount()}catch(e){Ec(r,n,e)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(p);continue}}null!==g?(g.return=f,Zs=g):Sl(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"==typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=p.stateNode,s=null!=(c=p.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=he("display",s))}catch(t){Ec(e,e.return,t)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(t){Ec(e,e.return,t)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ml(t,e),xl(e),4&r&&hl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(pe(o,""),r.flags&=-33),ul(e,ll(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;cl(e,ll(e),i);break;default:throw Error(a(161))}}catch(t){Ec(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Zs=e,bl(e,t,n)}function bl(e,t,n){for(var r=!!(1&e.mode);null!==Zs;){var o=Zs,a=o.child;if(22===o.tag&&r){var i=null!==o.memoizedState||Js;if(!i){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Js;var c=Xs;if(Js=i,(Xs=l)&&!c)for(Zs=o;null!==Zs;)l=(i=Zs).child,22===i.tag&&null!==i.memoizedState?Cl(o):null!==l?(l.return=i,Zs=l):Cl(o);for(;null!==a;)Zs=a,bl(a,t,n),a=a.sibling;Zs=o,Js=s,Xs=c}wl(e)}else 8772&o.subtreeFlags&&null!==a?(a.return=o,Zs=a):wl(e)}}function wl(e){for(;null!==Zs;){var t=Zs;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Xs||ol(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ya(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Da(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Da(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&qt(p)}}}break;default:throw Error(a(163))}Xs||512&t.flags&&al(t)}catch(e){Ec(t,t.return,e)}}if(t===e){Zs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zs=n;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zs=n;break}Zs=t.return}}function Cl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ol(4,t)}catch(e){Ec(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(e){Ec(t,o,e)}}var a=t.return;try{al(t)}catch(e){Ec(t,a,e)}break;case 5:var i=t.return;try{al(t)}catch(e){Ec(t,i,e)}}}catch(e){Ec(t,t.return,e)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var kl,El=Math.ceil,Il=b.ReactCurrentDispatcher,Al=b.ReactCurrentOwner,_l=b.ReactCurrentBatchConfig,jl=0,Fl=null,Tl=null,Pl=0,Rl=0,Bl=Eo(0),Ol=0,zl=null,Ll=0,Nl=0,Dl=0,Ml=null,Ul=null,ql=0,Wl=1/0,$l=null,Gl=!1,Vl=null,Hl=null,Kl=!1,Ql=null,Jl=0,Xl=0,Yl=null,Zl=-1,ec=0;function tc(){return 6&jl?Xe():-1!==Zl?Zl:Zl=Xe()}function nc(e){return 1&e.mode?2&jl&&0!==Pl?Pl&-Pl:null!==ma.transition?(0===ec&&(ec=ht()),ec):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Jt(e.type):1}function rc(e,t,n,r){if(50<Xl)throw Xl=0,Yl=null,Error(a(185));yt(e,n,r),2&jl&&e===Fl||(e===Fl&&(!(2&jl)&&(Nl|=n),4===Ol&&lc(e,Pl)),oc(e,r),1===n&&0===jl&&!(1&t.mode)&&(Wl=Xe()+500,Mo&&Wo()))}function oc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),s=1<<i,l=o[i];-1===l?s&n&&!(s&r)||(o[i]=ft(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=pt(e,e===Fl?Pl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Mo=!0,qo(e)}(cc.bind(null,e)):qo(cc.bind(null,e)),io((function(){!(6&jl)&&Wo()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Fc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Zl=-1,ec=0,6&jl)throw Error(a(327));var n=e.callbackNode;if(Cc()&&e.callbackNode!==n)return null;var r=pt(e,e===Fl?Pl:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=yc(e,r);else{t=r;var o=jl;jl|=2;var i=hc();for(Fl===e&&Pl===t||($l=null,Wl=Xe()+500,fc(e,t));;)try{vc();break}catch(t){gc(e,t)}Sa(),Il.current=i,jl=o,null!==Tl?t=0:(Fl=null,Pl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(o=gt(e))&&(r=o,t=ic(e,o))),1===t)throw n=zl,fc(e,0),lc(e,r),oc(e,Xe()),n;if(6===t)lc(e,r);else{if(o=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!sr(a(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=yc(e,r),2===t&&(i=gt(e),0!==i&&(r=i,t=ic(e,i))),1!==t)))throw n=zl,fc(e,0),lc(e,r),oc(e,Xe()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Sc(e,Ul,$l);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=ql+500-Xe())){if(0!==pt(e,0))break;if(((o=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(Sc.bind(null,e,Ul,$l),t);break}Sc(e,Ul,$l);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-it(r);i=1<<s,(s=t[s])>o&&(o=s),r&=~i}if(r=o,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ro(Sc.bind(null,e,Ul,$l),r);break}Sc(e,Ul,$l);break;default:throw Error(a(329))}}}return oc(e,Xe()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Ml;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Ul,Ul=n,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function lc(e,t){for(t&=~Dl,t&=~Nl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(6&jl)throw Error(a(327));Cc();var t=pt(e,0);if(!(1&t))return oc(e,Xe()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=zl,fc(e,0),lc(e,t),oc(e,Xe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,Ul,$l),oc(e,Xe()),null}function uc(e,t){var n=jl;jl|=1;try{return e(t)}finally{0===(jl=n)&&(Wl=Xe()+500,Mo&&Wo())}}function dc(e){null!==Ql&&0===Ql.tag&&!(6&jl)&&Cc();var t=jl;jl|=1;var n=_l.transition,r=vt;try{if(_l.transition=null,vt=1,e)return e()}finally{vt=r,_l.transition=n,!(6&(jl=t))&&Wo()}}function pc(){Rl=Bl.current,Io(Bl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(na(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Bo();break;case 3:ai(),Io(Fo),Io(jo),di();break;case 5:si(r);break;case 4:ai();break;case 13:case 19:Io(li);break;case 10:Ca(r.type._context);break;case 22:case 23:pc()}n=n.return}if(Fl=e,Tl=e=Bc(e.current,null),Pl=Rl=t,Ol=0,zl=null,Dl=Nl=Ll=0,Ul=Ml=null,null!==Aa){for(t=0;t<Aa.length;t++)if(null!==(r=(n=Aa[t]).interleaved)){n.interleaved=null;var o=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=o,r.next=i}n.pending=r}Aa=null}return e}function gc(e,t){for(;;){var n=Tl;try{if(Sa(),pi.current=is,xi){for(var r=hi.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}xi=!1}if(gi=0,yi=mi=hi=null,vi=!1,bi=0,Al.current=null,null===n||null===n.return){Ol=1,zl=t,Tl=null;break}e:{var i=e,s=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,p=d.tag;if(!(1&d.mode||0!==p&&11!==p&&15!==p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=ys(s);if(null!==g){g.flags&=-257,xs(g,s,l,0,t),1&g.mode&&ms(i,u,t),c=u;var h=(t=g).updateQueue;if(null===h){var m=new Set;m.add(c),t.updateQueue=m}else h.add(c);break e}if(!(1&t)){ms(i,u,t),mc();break e}c=Error(a(426))}else if(aa&&1&l.mode){var y=ys(s);if(null!==y){!(65536&y.flags)&&(y.flags|=256),xs(y,s,l,0,t),ha(us(c,l));break e}}i=c=us(c,l),4!==Ol&&(Ol=2),null===Ml?Ml=[i]:Ml.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,La(i,gs(0,c,t));break e;case 1:l=c;var x=i.type,v=i.stateNode;if(!(128&i.flags||"function"!=typeof x.getDerivedStateFromError&&(null===v||"function"!=typeof v.componentDidCatch||null!==Hl&&Hl.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,La(i,hs(i,l,t));break e}}i=i.return}while(null!==i)}wc(n)}catch(e){t=e,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function hc(){var e=Il.current;return Il.current=is,null===e?is:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Fl||!(268435455&Ll)&&!(268435455&Nl)||lc(Fl,Pl)}function yc(e,t){var n=jl;jl|=2;var r=hc();for(Fl===e&&Pl===t||($l=null,fc(e,t));;)try{xc();break}catch(t){gc(e,t)}if(Sa(),jl=n,Il.current=r,null!==Tl)throw Error(a(261));return Fl=null,Pl=0,Ol}function xc(){for(;null!==Tl;)bc(Tl)}function vc(){for(;null!==Tl&&!Qe();)bc(Tl)}function bc(e){var t=kl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Tl=t,Al.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Qs(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Ol=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Ks(n,t,Rl)))return void(Tl=n);if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Ol&&(Ol=5)}function Sc(e,t,n){var r=vt,o=_l.transition;try{_l.transition=null,vt=1,function(e,t,n,r){do{Cc()}while(null!==Ql);if(6&jl)throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-it(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}(e,i),e===Fl&&(Tl=Fl=null,Pl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Kl||(Kl=!0,Fc(tt,(function(){return Cc(),null}))),i=!!(15990&n.flags),!!(15990&n.subtreeFlags)||i){i=_l.transition,_l.transition=null;var s=vt;vt=1;var l=jl;jl|=4,Al.current=null,function(e,t){if(eo=$t,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,f=null;t:for(;;){for(var g;p!==n||0!==o&&3!==p.nodeType||(l=s+o),p!==i||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(g=p.firstChild);)f=p,p=g;for(;;){if(p===e)break t;if(f===n&&++u===o&&(l=s),f===i&&++d===r&&(c=s),null!==(g=p.nextSibling))break;f=(p=f).parentNode}p=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},$t=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,1028&t.subtreeFlags&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var h=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==h){var m=h.memoizedProps,y=h.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:ya(t.type,m),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(e){Ec(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}h=nl,nl=!1}(e,n),yl(n,e),gr(to),$t=!!eo,to=eo=null,e.current=n,vl(n,e,o),Je(),jl=l,vt=s,_l.transition=i}else e.current=n;if(Kl&&(Kl=!1,Ql=e,Jl=o),i=e.pendingLanes,0===i&&(Hl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),oc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Gl)throw Gl=!1,e=Vl,Vl=null,e;!!(1&Jl)&&0!==e.tag&&Cc(),i=e.pendingLanes,1&i?e===Yl?Xl++:(Xl=0,Yl=e):Xl=0,Wo()}(e,t,n,r)}finally{_l.transition=o,vt=r}return null}function Cc(){if(null!==Ql){var e=bt(Jl),t=_l.transition,n=vt;try{if(_l.transition=null,vt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Jl=0,6&jl)throw Error(a(331));var o=jl;for(jl|=4,Zs=e.current;null!==Zs;){var i=Zs,s=i.child;if(16&Zs.flags){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zs=u;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:rl(8,d,i)}var p=d.child;if(null!==p)p.return=d,Zs=p;else for(;null!==Zs;){var f=(d=Zs).sibling,g=d.return;if(il(d),d===u){Zs=null;break}if(null!==f){f.return=g,Zs=f;break}Zs=g}}}var h=i.alternate;if(null!==h){var m=h.child;if(null!==m){h.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Zs=i}}if(2064&i.subtreeFlags&&null!==s)s.return=i,Zs=s;else e:for(;null!==Zs;){if(2048&(i=Zs).flags)switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var x=i.sibling;if(null!==x){x.return=i.return,Zs=x;break e}Zs=i.return}}var v=e.current;for(Zs=v;null!==Zs;){var b=(s=Zs).child;if(2064&s.subtreeFlags&&null!==b)b.return=s,Zs=b;else e:for(s=v;null!==Zs;){if(2048&(l=Zs).flags)try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(e){Ec(l,l.return,e)}if(l===s){Zs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zs=w;break e}Zs=l.return}}if(jl=o,Wo(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(e){}r=!0}return r}finally{vt=n,_l.transition=t}}return!1}function kc(e,t,n){e=Oa(e,t=gs(0,t=us(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),oc(e,t))}function Ec(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=Oa(t,e=hs(t,e=us(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),oc(t,e));break}}t=t.return}}function Ic(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Fl===e&&(Pl&n)===n&&(4===Ol||3===Ol&&(130023424&Pl)===Pl&&500>Xe()-ql?fc(e,0):Dl|=n),oc(e,t)}function Ac(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=tc();null!==(e=Fa(e,t))&&(yt(e,t,n),oc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function jc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ac(e,n)}function Fc(e,t){return He(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Tc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,o,i){var s=2;if(r=e,"function"==typeof e)Rc(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case C:return zc(n.children,o,i,t);case k:s=8,o|=8;break;case E:return(e=Pc(12,n,t,2|o)).elementType=E,e.lanes=i,e;case j:return(e=Pc(13,n,t,o)).elementType=j,e.lanes=i,e;case F:return(e=Pc(19,n,t,o)).elementType=F,e.lanes=i,e;case R:return Lc(n,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case A:s=9;break e;case _:s=11;break e;case T:s=14;break e;case P:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Pc(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function zc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Nc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,o,a,i,s,l){return e=new Mc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Pc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pa(a),e}function qc(e){if(!e)return _o;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ro(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ro(n))return zo(e,n,t)}return t}function Wc(e,t,n,r,o,a,i,s,l){return(e=Uc(n,r,!0,e,0,a,0,s,l)).context=qc(null),n=e.current,(a=Ba(r=tc(),o=nc(n))).callback=null!=t?t:null,Oa(n,a,o),e.current.lanes=o,yt(e,o,r),oc(e,r),e}function $c(e,t,n,r){var o=t.current,a=tc(),i=nc(o);return n=qc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ba(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oa(o,t,i))&&(rc(e,o,i,a),za(e,o,i)),i}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fo.current)bs=!0;else{if(!(e.lanes&n||128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Fs(t),ga();break;case 5:ii(t);break;case 1:Ro(t.type)&&Lo(t);break;case 4:oi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ao(xa,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ao(li,1&li.current),t.flags|=128,null):n&t.child.childLanes?Ns(e,t,n):(Ao(li,1&li.current),null!==(e=Gs(e,t,n))?e.sibling:null);Ao(li,1&li.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return Ws(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ao(li,li.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return Gs(e,t,n)}(e,t,n);bs=!!(131072&e.flags)}else bs=!1,aa&&1048576&t.flags&&ea(t,Ho,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$s(e,t),e=t.pendingProps;var o=Po(t,jo.current);Ea(t,n),o=ki(null,t,r,e,o,n);var i=Ei();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ro(r)?(i=!0,Lo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Pa(t),o.updater=qa,t.stateNode=o,o._reactInternals=t,Va(t,r,e,n),t=js(null,t,r,!0,i,n)):(t.tag=0,aa&&i&&ta(t),ws(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch($s(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===_)return 11;if(e===T)return 14}return 2}(r),e=ya(r,e),o){case 0:t=As(null,t,r,e,n);break e;case 1:t=_s(null,t,r,e,n);break e;case 11:t=Ss(null,t,r,e,n);break e;case 14:t=Cs(null,t,r,ya(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,As(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 1:return r=t.type,o=t.pendingProps,_s(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 3:e:{if(Fs(t),null===e)throw Error(a(387));r=t.pendingProps,o=(i=t.memoizedState).element,Ra(e,t),Na(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ts(e,t,r,n,o=us(Error(a(423)),t));break e}if(r!==o){t=Ts(e,t,r,n,o=us(Error(a(424)),t));break e}for(oa=co(t.stateNode.containerInfo.firstChild),ra=t,aa=!0,ia=null,n=Ya(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ga(),r===o){t=Gs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return ii(t),null===e&&ua(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==i&&no(r,i)&&(t.flags|=32),Is(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return Ns(e,t,n);case 4:return oi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Xa(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ss(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,s=o.value,Ao(xa,r._currentValue),r._currentValue=s,null!==i)if(sr(i.value,s)){if(i.children===o.children&&!Fo.current){t=Gs(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Ba(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),ka(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ka(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}ws(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Ea(t,n),r=r(o=Ia(o)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return o=ya(r=t.type,t.pendingProps),Cs(e,t,r,o=ya(r.type,o),n);case 15:return ks(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ya(r,o),$s(e,t),t.tag=1,Ro(r)?(e=!0,Lo(t)):e=!1,Ea(t,n),$a(t,r,o),Va(t,r,o,n),js(null,t,r,!0,e,n);case 19:return Ws(e,t,n);case 22:return Es(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"==typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,o){var a=n._reactRootContainer;if(a){var i=a;if("function"==typeof o){var s=o;o=function(){var e=Gc(i);s.call(e)}}$c(t,i,e,o)}else i=function(e,t,n,r,o){if(o){if("function"==typeof r){var a=r;r=function(){var e=Gc(i);a.call(e)}}var i=Wc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[ho]=i.current,qr(8===e.nodeType?e.parentNode:e),dc(),i}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof r){var s=r;r=function(){var e=Gc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[ho]=l.current,qr(8===e.nodeType?e.parentNode:e),dc((function(){$c(t,l,n,r)})),l}(n,t,e,o,r);return Gc(i)}Jc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));$c(e,t,null,null)},Jc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){$c(null,e,null,null)})),t[ho]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(xt(t,1|n),oc(t,Xe()),!(6&jl)&&(Wl=Xe()+500,Wo()))}break;case 13:dc((function(){var t=Fa(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Hc(e,1)}},St=function(e){if(13===e.tag){var t=Fa(e,134217728);if(null!==t)rc(t,e,134217728,tc());Hc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=nc(e),n=Fa(e,t);if(null!==n)rc(n,e,t,tc());Hc(e,t)}},kt=function(){return vt},Et=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},Se=function(e,t,n){switch(t){case"input":if(Y(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=So(r);if(!o)throw Error(a(90));H(r),Y(r,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},_e=uc,je=dc;var tu={usingClientEntryPoint:!1,Events:[bo,wo,So,Ie,Ae,uc]},nu={findFiberByHostInstance:vo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{ot=ou.inject(ru),at=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var n=!1,r="",o=Kc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,o),e[ho]=t.current,qr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",s=Kc;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,o,0,i,s),e[ho]=t.current,qr(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Jc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[ho]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},338:(e,t,n)=>{var r=n(961);t.H=r.createRoot,r.hydrateRoot},961:(e,t,n)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(551)},799:(e,t)=>{
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.suspense_list"):60120,h=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,x=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case a:case s:case i:case f:return e;default:switch(e=e&&e.$$typeof){case c:case p:case m:case h:case l:return e;default:return t}}case o:return t}}}function S(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=a,t.Lazy=m,t.Memo=h,t.Portal=o,t.Profiler=s,t.StrictMode=i,t.Suspense=f,t.isAsyncMode=function(e){return S(e)||w(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===h},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===i},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===i||e===f||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===h||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===x||e.$$typeof===v||e.$$typeof===b||e.$$typeof===y)},t.typeOf=w},363:(e,t,n)=>{e.exports=n(799)},989:(e,t)=>{var n,r=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");
/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case a:case s:case i:case p:case f:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case h:case g:case l:return e;default:return t}}case o:return t}}}n=Symbol.for("react.module.reference")},737:(e,t,n)=>{n(989)},20:(e,t,n)=>{
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},287:(e,t)=>{
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function x(){}function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=y.prototype;var b=v.prototype=new x;b.constructor=v,h(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,C={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var o,a={},i=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)S.call(t,o)&&!k.hasOwnProperty(o)&&(a[o]=t[o]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===a[o]&&(a[o]=l[o]);return{$$typeof:n,type:e,key:i,ref:s,props:a,_owner:C.current}}function I(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function _(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function j(e,t,o,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+_(l,0):a,w(i)?(o="",null!=e&&(o=e.replace(A,"$&/")+"/"),j(i,t,o,"",(function(e){return e}))):null!=i&&(I(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(A,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+_(s=e[c],c);l+=j(s,t,o,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=j(s=s.value,t,o,u=a+_(s,c++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function F(e,t,n){if(null==e)return e;var r=[],o=0;return j(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},R={transition:null},B={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:R,ReactCurrentOwner:C};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:F,forEach:function(e,t,n){F(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return F(e,(function(){t++})),t},toArray:function(e){return F(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=o,t.Profiler=i,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,t.act=O,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=h({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=C.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!k.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},540:(e,t,n)=>{e.exports=n(287)},848:(e,t,n)=>{e.exports=n(20)},463:(e,t)=>{
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,p=null,f=3,g=!1,h=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,b(e),!h)if(null!==r(c))h=!0,R(S);else{var t=r(u);null!==t&&B(w,t.startTime-e)}}function S(e,n){h=!1,m&&(m=!1,x(I),I=-1),g=!0;var a=f;try{for(b(n),p=r(c);null!==p&&(!(p.expirationTime>n)||e&&!j());){var i=p.callback;if("function"==typeof i){p.callback=null,f=p.priorityLevel;var s=i(p.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?p.callback=s:p===r(c)&&o(c),b(n)}else o(c);p=r(c)}if(null!==p)var l=!0;else{var d=r(u);null!==d&&B(w,d.startTime-n),l=!1}return l}finally{p=null,f=a,g=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,k=!1,E=null,I=-1,A=5,_=-1;function j(){return!(t.unstable_now()-_<A)}function F(){if(null!==E){var e=t.unstable_now();_=e;var n=!0;try{n=E(!0,e)}finally{n?C():(k=!1,E=null)}}else k=!1}if("function"==typeof v)C=function(){v(F)};else if("undefined"!=typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=F,C=function(){P.postMessage(null)}}else C=function(){y(F,0)};function R(e){E=e,k||(k=!0,C())}function B(e,n){I=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){h||g||(h=!0,R(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>i?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(m?(x(I),I=-1):m=!0,B(w,a-i))):(e.sortIndex=s,n(c,e),h||g||(h=!0,R(S))),e},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},982:(e,t,n)=>{e.exports=n(463)},63:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,i=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return s((function(){o.value=n,o.getSnapshot=t,c(o)&&u({inst:o})}),[e,n,t]),i((function(){return c(o)&&u({inst:o}),e((function(){c(o)&&u({inst:o})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},940:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=n(888);var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=o.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=s(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=c((function(){function e(e){if(!l){if(l=!0,i=e,e=r(e),void 0!==o&&p.hasValue){var t=p.value;if(o(t,e))return s=t}return s=e}if(t=s,a(i,e))return t;var n=r(e);return void 0!==o&&o(t,n)?t:(i=e,s=n)}var i,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,o]);var f=i(e,d[0],d[1]);return l((function(){p.hasValue=!0,p.value=f}),[f]),u(f),f}},888:(e,t,n)=>{e.exports=n(63)},242:(e,t,n)=>{e.exports=n(940)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.p="/";var r=n(540),o=n(338),a=n(848),i=n(888),s=n(242),l=n(961);let c=function(e){e()};const u=()=>c,d=(0,r.createContext)(null);function p(){return(0,r.useContext)(d)}let f=()=>{throw new Error("uSES not initialized!")};const g=(e,t)=>e===t;function h(e=d){const t=e===d?p:()=>(0,r.useContext)(e);return function(e,n=g){const{store:o,subscription:a,getServerState:i}=t(),s=f(a.addNestedSub,o.getState,i||o.getState,e,n);return(0,r.useDebugValue)(s),s}}const m=h();n(146),n(737);const y={notify(){},get:()=>[]};function x(e,t){let n,r=y;function o(){i.onStateChange&&i.onStateChange()}function a(){n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){const e=u();let t=null,n=null;return{clear(){t=null,n=null},notify(){e((()=>{let e=t;for(;e;)e.callback(),e=e.next}))},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}())}const i={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=y)},getListeners:()=>r};return i}const v=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement)?r.useLayoutEffect:r.useEffect;let b=null;const w=function({store:e,context:t,children:n,serverState:o}){const a=(0,r.useMemo)((()=>{const t=x(e);return{store:e,subscription:t,getServerState:o?()=>o:void 0}}),[e,o]),i=(0,r.useMemo)((()=>e.getState()),[e]);v((()=>{const{subscription:t}=a;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),i!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[a,i]);const s=t||d;return r.createElement(s.Provider,{value:a},n)};function S(e=d){const t=e===d?p:()=>(0,r.useContext)(e);return function(){const{store:e}=t();return e}}const C=S();function k(e=d){const t=e===d?C:S(e);return function(){return t().dispatch}}const E=k();var I,A;I=s.useSyncExternalStoreWithSelector,f=I,(e=>{b=e})(i.useSyncExternalStore),A=l.unstable_batchedUpdates,c=A;var _,j="SET_CURRENT_TAB_ID",F="SET_TAB_CARD_FIELD",T="CLEAR_TAB_CARD_DATA",P="SAVE_TAB_CARD",R="DELETE_TAB_CARD",B="SET_TAB_STORED_CARDS",O="UPDATE_TAB_CARD_EXPORT_STATUS",z="UPDATE_TAB_STORED_CARD",L="SET_TAB_CURRENT_PAGE",N=function(e,t,n){return{type:F,payload:{tabId:e,field:t,value:n}}},D=function(e,t){return N(e,"text",t)},M=function(e,t){return N(e,"translation",t)},U=function(e,t){return N(e,"examples",t)},q=function(e,t){return N(e,"image",t)},W=function(e,t){return N(e,"imageUrl",t)},$=function(e,t){return N(e,"front",t)},G=function(e,t){return N(e,"back",t)},V=function(e,t){return N(e,"linguisticInfo",t)},H=function(e,t){return N(e,"transcription",t)},K=function(e,t){return N(e,"isGeneratingCard",t)},Q=function(e,t){return N(e,"currentCardId",t)};!function(e){e.LanguageLearning="language-learning",e.GeneralTopic="general-topic"}(_||(_={}));var J=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},X=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function Y(e){var t=e.examples.map((function(t){return function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r="0.8em");var o=e.replace(t,"<b>".concat(t,"</b>"));if(n){var a=n.split(" ").slice(1).join(" ");return"".concat(o,"<br><span style='font-size: ").concat(r,";'><i>").concat(a,"</i></span>")}return o}(t[0],e.text,t[1])})).join("<br><br>"),n="";if(e.image_base64){var r=e.image_base64;if(r.startsWith("data:")){var o="base64,",a=r.indexOf(o);if(-1!==a){var i=r.substring(a+7);n='<div><img src="data:image/jpeg;base64,'.concat(i,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else n='<div><img src="'.concat(r,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else n='<div><img src="data:image/jpeg;base64,'.concat(r,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}var s="";if(e.linguisticInfo&&e.linguisticInfo.trim()){var l=e.linguisticInfo.trim().split("\n").filter((function(e){return e.trim()})),c="";l.forEach((function(e){var t=e.trim();if(t.match(/^[-A-Z][^:]*:$/))c+='<div style="color: #2563EB; font-weight: bold; margin-top: 12px; margin-bottom: 4px;">'.concat(t,"</div>");else if(t.startsWith("")||t.startsWith("-")||t.startsWith("*")){var n=t.replace(/^[\-*]\s*/,"");c+='<div style="margin-left: 16px; margin-bottom: 2px; color: #374151;"> '.concat(n,"</div>")}else if(t.includes(":")&&!t.endsWith(":")){var r=t.split(":"),o=r[0],a=r.slice(1).join(":").trim();c+='<div style="margin-bottom: 4px;"><span style="color: #6B7280; font-weight: 500;">'.concat(o.trim(),':</span> <span style="color: #111827;">').concat(a,"</span></div>")}else t&&(c+='<div style="margin-bottom: 6px; color: #374151; line-height: 1.4;">'.concat(t,"</div>"))})),c&&(s='\n                <div style="margin-top: 20px; padding: 12px; background-color: #F8FAFC; border-left: 4px solid #2563EB; border-radius: 0 6px 6px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n                    <div style="color: #1E40AF; font-weight: bold; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center;">\n                        <span style="margin-right: 6px;"></span>\n                        Grammar & Linguistics\n                    </div>\n                    '.concat(c,"\n                </div>\n            "))}return"\n        <b>".concat(e.translation,"</b>\n        <br><br>").concat(t,"<br><br>\n        ").concat(n,"\n        ").concat(s,"\n    ")}function Z(e,t){var n=e.replace("Key points:","").trim().split("-").map((function(e){return"<li>".concat(e.trim(),"</li>")})).join(""),r="";if(t){var o=t;if(o.startsWith("data:")){var a="base64,",i=o.indexOf(a);if(-1!==i){var s=o.substring(i+7);r='<div><img src="data:image/jpeg;base64,'.concat(s,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else r='<div><img src="'.concat(o,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else r='<div><img src="data:image/jpeg;base64,'.concat(o,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}return"\n        <b>Key points:</b>\n        <ul>\n            ".concat(n,"\n        </ul>\n        ").concat(r,"\n    ")}var ee=function(e,t,n,r,o,a){return J(void 0,void 0,void 0,(function(){var i,s,l,c,u;return X(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),i=JSON.stringify({action:"createDeck",version:6,key:n,params:{deck:r}}),[4,fetch(t,{method:"POST",body:i,headers:{"Content-Type":"application/json"}})];case 1:if(!d.sent().ok)throw new Error("Failed to create deck.");return s=a.map((function(t){var n;if(e===_.LanguageLearning&&"translation"in t&&"examples"in t&&"image_base64"in t)n={Front:t.text,Back:Y(t)};else if(e===_.GeneralTopic&&"back"in t){var a=t;n={Front:a.front,Back:Z(a.back,a.image_base64)}}return{deckName:r,modelName:o,fields:n,options:{allowDuplicate:!1},tags:[]}})),l=JSON.stringify({action:"addNotes",version:6,key:n,params:{notes:s}}),[4,fetch(t,{method:"POST",body:l,headers:{"Content-Type":"application/json"}})];case 2:if(!(c=d.sent()).ok)throw new Error("Failed to add notes.");return[4,c.json()];case 3:if((u=d.sent()).error)throw new Error("Anki error: ".concat(u.error));return[2,u.result];case 4:throw d.sent();case 5:return[2]}}))}))};function te(e){return J(this,void 0,void 0,(function(){return X(this,(function(t){return[2,new Promise((function(t,n){chrome.runtime.sendMessage(e,(function(e){e.status&&void 0!==e.data?t(e.data):(console.error("Error fetching image:",e.error),n(null))}))}))]}))}))}var ne=function(e){return J(void 0,void 0,void 0,(function(){var t,n,r;return X(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch("http://localhost:8765",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deckNames",version:6,key:e})})];case 1:if(!(t=o.sent()).ok)throw new Error("HTTP error! Status: ".concat(t.status));return[4,t.json()];case 2:return(n=o.sent()).result?[2,{result:n.result.map((function(e){return{deckId:e,name:e}})),error:n.error}]:[2,n];case 3:throw r=o.sent(),console.error("Error fetching decks:",r),r;case 4:return[2]}}))}))},re=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},oe=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ae="SAVE_ANKI_CARDS",ie="SET_TEXT",se="SET_TRANSLATION",le="SET_EXAMPLES",ce="SET_IMAGE",ue="SET_IMAGE_URL",de="SET_BACK",pe="SET_FRONT",fe="SAVE_CARD_TO_STORAGE",ge="LOAD_STORED_CARDS",he="DELETE_STORED_CARD",me="SET_STORED_CARDS",ye="UPDATE_CARD_EXPORT_STATUS",xe="UPDATE_STORED_CARD",ve="SET_CURRENT_CARD_ID",be="SET_LINGUISTIC_INFO",we="SET_TRANSCRIPTION",Se="SET_IS_GENERATING_CARD",Ce=function(e,t,n,r,o,a){return void 0===n&&(n=null),function(i){return re(void 0,void 0,void 0,(function(){var s,l;return oe(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,ee(e,t,n,r,o,a)];case 1:return s=c.sent(),i({type:ae,payload:s}),[3,3];case 2:throw l=c.sent(),console.error("Error saving Anki cards:",l),l;case 3:return[2]}}))}))}},ke=function(e){var t,n,r,o;return console.log("*** ACTION: saveCardToStorage called with card data ***"),console.log("Action payload image info:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imageValue:e.image,imageUrlValue:e.imageUrl,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)}),{type:fe,payload:e}},Ee=function(){return{type:ge}},Ie=function(e){return{type:ie,payload:e}},Ae=function(e){return{type:le,payload:e}},_e=function(e){return{type:se,payload:e}},je=function(e){return{type:ce,payload:e}},Fe=function(e){return{type:ue,payload:e}},Te=function(e){return{type:de,payload:e}},Pe=function(e){return{type:pe,payload:e}},Re=function(e){var t,n,r,o;return console.log("*** ACTION: updateStoredCard called ***"),console.log("Updated card image info:",{cardId:e.id,hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imageValue:e.image,imageUrlValue:e.imageUrl,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)}),{type:xe,payload:e}},Be=function(e){return{type:ve,payload:e}},Oe=function(e){return{type:be,payload:e}},ze=function(e){return{type:we,payload:e}},Le=function(e){return{type:Se,payload:e}},Ne=function(){return Ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ne.apply(this,arguments)},De=(0,r.createContext)(null),Me=function(e){var t=e.tabId,n=e.children,o=E(),i=m((function(e){return e.tabState.tabStates[t]})),s=m((function(e){return e.cards})),l=(0,r.useMemo)((function(){var e=(null==i?void 0:i.cardData)||{text:s.text,translation:s.translation,examples:s.examples,image:s.image,imageUrl:s.imageUrl,front:s.front,back:s.back,linguisticInfo:s.linguisticInfo,transcription:s.transcription,isGeneratingCard:s.isGeneratingCard,currentCardId:s.currentCardId},n=s.storedCards,r=(null==i?void 0:i.fieldIdPrefix)||"fallback_".concat(Date.now(),"_"),a=m((function(e){return e.currentPage})),l=(null==i?void 0:i.currentPage)||a;return{text:e.text,translation:e.translation,examples:e.examples,image:e.image,imageUrl:e.imageUrl,front:e.front,back:e.back,linguisticInfo:e.linguisticInfo,transcription:e.transcription,isGeneratingCard:e.isGeneratingCard,currentCardId:e.currentCardId,storedCards:n,fieldIdPrefix:r,currentPage:l,setText:function(e){o(i?D(t,e):Ie(e))},setTranslation:function(e){o(i?M(t,e):_e(e))},setExamples:function(e){o(i?U(t,e):Ae(e))},setImage:function(e){o(i?q(t,e):je(e))},setImageUrl:function(e){o(i?W(t,e):Fe(e))},setFront:function(e){o(i?$(t,e):Pe(e))},setBack:function(e){o(i?G(t,e):Te(e))},setLinguisticInfo:function(e){o(i?V(t,e):Oe(e))},setTranscription:function(e){o(i?H(t,e):ze(e))},setIsGeneratingCard:function(e){o(i?K(t,e):Le(e))},setCurrentCardId:function(e){o(i?Q(t,e):Be(e))},saveCardToStorage:function(e){o(ke(e))},updateStoredCard:function(e){o(Re(e))},deleteStoredCard:function(e){o(function(e){return{type:he,payload:e}}(e))},updateCardExportStatus:function(e,t){o(function(e,t){return{type:ye,payload:{cardId:e,status:t}}}(e,t))},setCurrentPage:function(e){o(i?function(e,t){return{type:L,payload:{tabId:e,currentPage:t}}}(t,e):function(e){return{type:"SET_CURRENT_PAGE",currentPage:e}}(e))},updateCard:function(e){Object.keys(e).forEach((function(n){var r=e[n];if(void 0!==r)switch(n){case"text":o(i?D(t,r):Ie(r));break;case"translation":o(i?M(t,r):_e(r));break;case"examples":o(i?U(t,r):Ae(r));break;case"image":o(i?q(t,r):je(r));break;case"imageUrl":o(i?W(t,r):Fe(r));break;case"front":o(i?$(t,r):Pe(r));break;case"back":o(i?G(t,r):Te(r));break;case"linguisticInfo":o(i?V(t,r):Oe(r));break;case"transcription":o(i?H(t,r):ze(r));break;case"isGeneratingCard":o(i?K(t,r):Le(r));break;case"currentCardId":o(i?Q(t,r):Be(r))}}))}}}),[i,s,t,o]);return(0,a.jsx)(De.Provider,Ne({value:l},{children:n}))},Ue=function(){var e=(0,r.useContext)(De);if(!e)throw new Error("useTabAware must be used within a TabAwareProvider");return e},qe=function(){function e(e){this.requests=new Map,this.activeRequests=new Set,this.requestCounter=0,this.startTime=Date.now(),this.onProgressUpdate=e}return e.prototype.startRequest=function(e,t,n,r){var o="request_".concat(++this.requestCounter,"_").concat(Date.now()),a={id:o,operation:e,description:t,startTime:Date.now(),status:"pending",icon:n,color:r||this.getDefaultColor(e)};return this.requests.set(o,a),this.activeRequests.add(o),this.notifyProgressUpdate(),o},e.prototype.setInProgress=function(e){var t=this.requests.get(e);t&&(t.status="in-progress",this.notifyProgressUpdate())},e.prototype.completeRequest=function(e){var t=this.requests.get(e);t&&(t.status="completed",t.endTime=Date.now(),this.activeRequests.delete(e),this.notifyProgressUpdate())},e.prototype.errorRequest=function(e){var t=this.requests.get(e);t&&(t.status="error",t.endTime=Date.now(),this.activeRequests.delete(e),this.notifyProgressUpdate())},e.prototype.getCurrentProgress=function(){var e=this,t=Array.from(this.requests.values()),n=t.filter((function(e){return"completed"===e.status||"error"===e.status})).length,r=t.length,o=Array.from(this.activeRequests).map((function(t){return e.requests.get(t)})).find((function(e){return"in-progress"===(null==e?void 0:e.status)}));return{completed:n,total:r,currentRequest:o,progress:r>0?n/r*100:0,message:o?{title:o.operation,subtitle:o.description,icon:o.icon,color:o.color,currentStep:n+1,totalSteps:r,currentStepTitle:o.operation,currentStepSubtitle:o.description}:0===r?{title:"Ready",subtitle:"No active requests",icon:"",color:"#10B981"}:n===r&&r>0?{title:"Completed!",subtitle:"All ".concat(r," requests finished"),icon:"",color:"#10B981",currentStep:n,totalSteps:r,currentStepTitle:"Completed!",currentStepSubtitle:"All ".concat(r," requests finished")}:{title:"Processing...",subtitle:"".concat(n," of ").concat(r," requests completed"),icon:"",color:"#3B82F6",currentStep:n,totalSteps:r,currentStepTitle:"Processing...",currentStepSubtitle:"".concat(n," of ").concat(r," requests completed")}}},e.prototype.getStats=function(){var e=Array.from(this.requests.values());return{total:e.length,completed:e.filter((function(e){return"completed"===e.status})).length,pending:e.filter((function(e){return"pending"===e.status})).length,inProgress:e.filter((function(e){return"in-progress"===e.status})).length,errors:e.filter((function(e){return"error"===e.status})).length,elapsedTime:Date.now()-this.startTime}},e.prototype.reset=function(){this.requests.clear(),this.activeRequests.clear(),this.requestCounter=0,this.startTime=Date.now(),this.notifyProgressUpdate()},e.prototype.getDefaultColor=function(e){for(var t=0,n=Object.entries({translate:"#3B82F6","generate-examples":"#F59E0B","analyze-word":"#8B5CF6","create-image-description":"#EC4899","generate-image":"#6366F1","create-card":"#10B981","save-card":"#EF4444",connect:"#6366F1"});t<n.length;t++){var r=n[t],o=r[0],a=r[1];if(e.toLowerCase().includes(o))return a}return"#6B7280"},e.prototype.getDefaultIcon=function(e){for(var t=0,n=Object.entries({translate:"","generate-examples":"","analyze-word":"","create-image-description":"","generate-image":"","create-card":"","save-card":"",connect:""});t<n.length;t++){var r=n[t],o=r[0],a=r[1];if(e.toLowerCase().includes(o))return a}return""},e.prototype.notifyProgressUpdate=function(){if(this.onProgressUpdate){var e=this.getCurrentProgress();this.onProgressUpdate(e)}},e}(),We=null,$e=function(){return We||(We=new qe),We},Ge=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ve=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},He=null,Ke=function(){return!!He&&(!(Date.now()-He.timestamp>3e5)||(He=null,!1))},Qe=function(e){He={timestamp:Date.now(),message:e,notificationShown:!1}},Je=function(){He&&(He.notificationShown=!0)},Xe=function(){return null!==He&&!He.notificationShown},Ye=function(){return(null==He?void 0:He.message)||null},Ze=function(e){if(!e||!e.error)return"Unknown OpenAI API error";var t=e.error,n=t.message,r=t.type,o=t.code,a="";return a="insufficient_quota"===o?"Your OpenAI account has exceeded its quota.\n\nPlease check your billing details or use a different API key.":"invalid_request_error"===r?"Invalid request to OpenAI.\n\nPlease check your API key and settings.":"rate_limit_exceeded"===r?"OpenAI rate limit exceeded.\n\nPlease try again in a few minutes.":"OpenAI API Error: ".concat(n||"Unknown error"),a+="\n\nDetails:\n- Type: ".concat(r||"unknown","\n- Code: ").concat(o||"none")},et=function(e,t){return Ge(void 0,void 0,void 0,(function(){var n,r,o,a,i,s,l,c,u,d,p,f,g,h;return Ve(this,(function(m){switch(m.label){case 0:n=$e(),r=n.startRequest("Analyzing word type",'Determining if "'.concat(t,'" can be visualized'),"","#8B5CF6"),m.label=1;case 1:if(m.trys.push([1,6,,7]),!e)throw n.errorRequest(r),new Error("OpenAI API key is missing. Please check your settings.");if(n.setInProgress(r),Ke())throw n.errorRequest(r),new Error(He.message);return o=[{role:"system",content:"Is the word '".concat(t,"' an abstract concept or a concrete object? Answer 'abstract' or 'concrete':")}],a={model:"gpt-3.5-turbo",messages:o},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(a),signal:void 0})];case 2:return(i=m.sent()).ok?[3,4]:[4,i.json()];case 3:if((s=m.sent())&&s.error)throw l=Ze(s),"insufficient_quota"!==s.error.code&&429!==i.status||Qe(l),new Error(l);throw new Error("OpenAI API error: ".concat(i.status," ").concat(i.statusText));case 4:return[4,i.json()];case 5:return c=m.sent(),u=null!==(h=null===(g=null===(f=null===(p=c.choices[0])||void 0===p?void 0:p.message)||void 0===f?void 0:f.content)||void 0===g?void 0:g.trim().toLowerCase())&&void 0!==h?h:"",n.completeRequest(r),[2,"abstract"===u];case 6:return d=m.sent(),console.error("Error during determining abstractness:",d),n.errorRequest(r),[2,!1];case 7:return[2]}}))}))},tt=function(e,t,n,r){return void 0===n&&(n=""),Ge(void 0,void 0,void 0,(function(){var o,a,i,s,l,c,u,d,p,f,g,h,m,y,x;return Ve(this,(function(v){switch(v.label){case 0:o=$e(),a=o.startRequest("Crafting image description",'Creating detailed prompt for "'.concat(t,'" visualization'),"","#EC4899"),v.label=1;case 1:if(v.trys.push([1,6,,7]),!e)throw o.errorRequest(a),new Error("OpenAI API key is missing. Please check your settings.");if(o.setInProgress(a),Ke())throw o.errorRequest(a),new Error(He.message);return i="Provide a detailed description for an image that represents the concept of '".concat(t,"'"),s=n?"".concat(i,". ").concat(n):i,l={model:"gpt-3.5-turbo",messages:[{role:"system",content:s}]},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(l),signal:r})];case 2:return(c=v.sent()).ok?[3,4]:[4,c.json()];case 3:if((u=v.sent())&&u.error)throw d=Ze(u),"insufficient_quota"!==u.error.code&&429!==c.status||Qe(d),o.errorRequest(a),new Error(d);throw o.errorRequest(a),new Error("Could not generate image description. OpenAI API error: ".concat(c.status," ").concat(c.statusText));case 4:return[4,c.json()];case 5:if(p=v.sent(),!(f=null!==(x=null===(y=null===(m=null===(h=p.choices[0])||void 0===h?void 0:h.message)||void 0===m?void 0:m.content)||void 0===y?void 0:y.trim())&&void 0!==x?x:""))throw o.errorRequest(a),new Error("Could not generate a valid image description. Please try again.");return o.completeRequest(a),[2,f];case 6:throw g=v.sent(),console.error("Error during getting description image:",g),o.errorRequest(a),g;case 7:return[2]}}))}))},nt=function(e,t,n){return void 0===n&&(n=""),Ge(void 0,void 0,void 0,(function(){var r,o,a,i,s,l,c,u,d,p;return Ve(this,(function(f){switch(f.label){case 0:r=$e(),o=r.startRequest("Generating image","Creating beautiful illustration with AI","","#6366F1"),f.label=1;case 1:return f.trys.push([1,3,,4]),r.setInProgress(o),a=n?"".concat(t,". ").concat(n):t,[4,e.images.generate({model:"dall-e-2",prompt:a,n:1,size:"512x512",response_format:"url"})];case 2:if(!(i=f.sent()).data||!(null===(p=i.data[0])||void 0===p?void 0:p.url))throw r.errorRequest(o),new Error("OpenAI did not return an image URL. Please try again.");return r.completeRequest(o),[2,i.data[0].url];case 3:if(s=f.sent(),console.error("Error during image generation:",s),r.errorRequest(o),s instanceof Error){if((l=s.message||"").includes("quota")||l.includes("billing"))throw Qe(c="Your OpenAI account has exceeded its quota.\n\nPlease check your billing details or use a different API key."),new Error(c);if(l.includes("rate limit"))throw new Error("OpenAI rate limit exceeded.\n\nPlease try again in a few minutes.");if(l.includes("invalid API key"))throw new Error("Invalid OpenAI API key.\n\nPlease check your API key in settings.");if(l.includes("moderation")||l.includes("policy"))throw new Error("OpenAI content policy violation.\n\nThe image request was flagged for content policy violation. Please modify your request.");if(l.includes("{")&&l.includes("}"))try{if(u=l.substring(l.indexOf("{"),l.lastIndexOf("}")+1),(d=JSON.parse(u))&&d.error)return[2,Ze(d)]}catch(e){}throw s}throw new Error("Failed to generate image.\n\nPlease check your OpenAI API key and try again.");case 4:return[2]}}))}))},rt=function(e,t,n,r){return void 0===r&&(r=""),Ge(void 0,void 0,void 0,(function(){var o,a,i,s,l,c;return Ve(this,(function(u){switch(u.label){case 0:o=$e(),a=o.startRequest("Creating custom image",'Generating visual for "'.concat(n,'"'),"","#6366F1"),u.label=1;case 1:if(u.trys.push([1,8,,9]),!t)throw o.errorRequest(a),new Error("OpenAI API key is missing. Please check your settings.");if(o.setInProgress(a),Ke())throw o.errorRequest(a),new Error(He.message);return[4,et(t,n)];case 2:return u.sent()?[4,tt(t,n,r)]:[3,5];case 3:return i=u.sent(),[4,nt(e,"Create a vivid, high-quality illustration representing the concept of '".concat(i,"'"),r)];case 4:return l=u.sent(),o.completeRequest(a),[2,l];case 5:return s="Create a high-quality, photorealistic image of a ".concat(n," with a neutral expression and clear features"),[4,nt(e,s,r)];case 6:return l=u.sent(),o.completeRequest(a),[2,l];case 7:return[3,9];case 8:throw c=u.sent(),console.error("Error during getting image for word:",c),o.errorRequest(a),c;case 9:return[2]}}))}))},ot="SET_OPEN_AI_KEY",at="SET_SELECTED_MODE",it="SET_TRANSLATE_TO_LANGUAGE",st="SET_ANKI_CONNECT_URL",lt="SET_ANKI_CONNECT_API_KEY",ct="SET_USE_ANKI_CONNECT",ut="SET_VISIBLE_SIDEBAR",dt="SET_SHOULD_GENERATE_IMAGE",pt="SET_IMAGE_GENERATION_MODE",ft="SET_TRANSLATION_PROMPT",gt="SET_EXAMPLES_PROMPT",ht="SET_AI_INSTRUCTIONS",mt="SET_IMAGE_INSTRUCTIONS",yt="SET_MODEL_PROVIDER",xt="SET_GROQ_API_KEY",vt="SET_GROQ_MODEL_NAME",bt="SET_SOURCE_LANGUAGE",wt=function(e){return{type:at,payload:e}},St={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Ct=r.createContext&&r.createContext(St),kt=function(){return kt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},kt.apply(this,arguments)},Et=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function It(e){return e&&e.map((function(e,t){return r.createElement(e.tag,kt({key:t},e.attr),It(e.child))}))}function At(e){return function(t){return r.createElement(_t,kt({attr:kt({},e.attr)},t),It(e.child))}}function _t(e){var t=function(t){var n,o=e.attr,a=e.size,i=e.title,s=Et(e,["attr","size","title"]),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",kt({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,s,{className:n,style:kt(kt({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&r.createElement("title",null,i),e.children)};return void 0!==Ct?r.createElement(Ct.Consumer,null,(function(e){return t(e)})):t(St)}function jt(e){return At({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M208 0c-29.9 0-54.7 20.5-61.8 48.2-.8 0-1.4-.2-2.2-.2-35.3 0-64 28.7-64 64 0 4.8.6 9.5 1.7 14C52.5 138 32 166.6 32 200c0 12.6 3.2 24.3 8.3 34.9C16.3 248.7 0 274.3 0 304c0 33.3 20.4 61.9 49.4 73.9-.9 4.6-1.4 9.3-1.4 14.1 0 39.8 32.2 72 72 72 4.1 0 8.1-.5 12-1.2 9.6 28.5 36.2 49.2 68 49.2 39.8 0 72-32.2 72-72V64c0-35.3-28.7-64-64-64zm368 304c0-29.7-16.3-55.3-40.3-69.1 5.2-10.6 8.3-22.3 8.3-34.9 0-33.4-20.5-62-49.7-74 1-4.5 1.7-9.2 1.7-14 0-35.3-28.7-64-64-64-.8 0-1.5.2-2.2.2C422.7 20.5 397.9 0 368 0c-35.3 0-64 28.6-64 64v376c0 39.8 32.2 72 72 72 31.8 0 58.4-20.7 68-49.2 3.9.7 7.9 1.2 12 1.2 39.8 0 72-32.2 72-72 0-4.8-.5-9.5-1.4-14.1 29-12 49.4-40.6 49.4-73.9z"}}]})(e)}function Ft(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function Tt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}}]})(e)}function Pt(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"}}]})(e)}function Rt(e){return At({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}}]})(e)}function Bt(e){return At({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}}]})(e)}function Ot(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}}]})(e)}function zt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(e)}function Lt(e){return At({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"}}]})(e)}function Nt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(e)}function Dt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(e)}function Mt(e){return At({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(e)}function Ut(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z"}}]})(e)}function qt(e){return At({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"}}]})(e)}function Wt(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"}}]})(e)}function $t(e){return At({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"}}]})(e)}function Gt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"}}]})(e)}function Vt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}}]})(e)}function Ht(e){return At({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M152.1 236.2c-3.5-12.1-7.8-33.2-7.8-33.2h-.5s-4.3 21.1-7.8 33.2l-11.1 37.5H163zM616 96H336v320h280c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm-24 120c0 6.6-5.4 12-12 12h-11.4c-6.9 23.6-21.7 47.4-42.7 69.9 8.4 6.4 17.1 12.5 26.1 18 5.5 3.4 7.3 10.5 4.1 16.2l-7.9 13.9c-3.4 5.9-10.9 7.8-16.7 4.3-12.6-7.8-24.5-16.1-35.4-24.9-10.9 8.7-22.7 17.1-35.4 24.9-5.8 3.5-13.3 1.6-16.7-4.3l-7.9-13.9c-3.2-5.6-1.4-12.8 4.2-16.2 9.3-5.7 18-11.7 26.1-18-7.9-8.4-14.9-17-21-25.7-4-5.7-2.2-13.6 3.7-17.1l6.5-3.9 7.3-4.3c5.4-3.2 12.4-1.7 16 3.4 5 7 10.8 14 17.4 20.9 13.5-14.2 23.8-28.9 30-43.2H412c-6.6 0-12-5.4-12-12v-16c0-6.6 5.4-12 12-12h64v-16c0-6.6 5.4-12 12-12h16c6.6 0 12 5.4 12 12v16h64c6.6 0 12 5.4 12 12zM0 120v272c0 13.3 10.7 24 24 24h280V96H24c-13.3 0-24 10.7-24 24zm58.9 216.1L116.4 167c1.7-4.9 6.2-8.1 11.4-8.1h32.5c5.1 0 9.7 3.3 11.4 8.1l57.5 169.1c2.6 7.8-3.1 15.9-11.4 15.9h-22.9a12 12 0 0 1-11.5-8.6l-9.4-31.9h-60.2l-9.1 31.8c-1.5 5.1-6.2 8.7-11.5 8.7H70.3c-8.2 0-14-8.1-11.4-15.9z"}}]})(e)}function Kt(e){return At({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"}}]})(e)}function Qt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(e)}function Jt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"}}]})(e)}function Xt(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"}}]})(e)}function Yt(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(e)}function Zt(e){return At({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M32,224H64V416H32A31.96166,31.96166,0,0,1,0,384V256A31.96166,31.96166,0,0,1,32,224Zm512-48V448a64.06328,64.06328,0,0,1-64,64H160a64.06328,64.06328,0,0,1-64-64V176a79.974,79.974,0,0,1,80-80H288V32a32,32,0,0,1,64,0V96H464A79.974,79.974,0,0,1,544,176ZM264,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,264,256Zm-8,128H192v32h64Zm96,0H288v32h64ZM456,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,456,256Zm-8,128H384v32h64ZM640,256V384a31.96166,31.96166,0,0,1-32,32H576V224h32A31.96166,31.96166,0,0,1,640,256Z"}}]})(e)}function en(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function tn(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"}}]})(e)}function nn(e){return At({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"}}]})(e)}function rn(e){return At({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function on(e){return At({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(e)}var an=function(){return an=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},an.apply(this,arguments)};const sn=function(e){var t=e.size,n=void 0===t?"medium":t,r=e.type,o=void 0===r?"spinner":r,i=e.color,s=void 0===i?"#3B82F6":i,l=e.text,c=e.fullScreen,u=void 0!==c&&c,d=e.overlay,p=void 0!==d&&d,f=e.inline,g=void 0!==f&&f,h={small:{container:"16px",fontSize:"12px",spacing:"8px"},medium:{container:"24px",fontSize:"14px",spacing:"12px"},large:{container:"32px",fontSize:"16px",spacing:"16px"}}[n],m={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:h.spacing,zIndex:1e3};return u&&(m.position="fixed",m.top=0,m.left=0,m.right=0,m.bottom=0),p&&(m.position="absolute",m.top=0,m.left=0,m.right=0,m.bottom=0,m.backgroundColor="rgba(255, 255, 255, 0.8)"),g&&(m.display="inline-flex",m.flexDirection="row",m.marginLeft="8px",m.marginRight="8px"),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("style",{children:["\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n  ","\n    @keyframes pulse {\n      0%, 100% { opacity: 1; transform: scale(1); }\n      50% { opacity: 0.5; transform: scale(0.8); }\n    }\n  ","\n    @keyframes dots1 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n    }\n    @keyframes dots2 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n      animation-delay: 0.2s;\n    }\n    @keyframes dots3 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n      animation-delay: 0.4s;\n    }\n  "]}),(0,a.jsxs)("div",an({style:m},{children:[function(){switch(o){case"spinner":return(0,a.jsx)("div",{style:{width:h.container,height:h.container,border:"2px solid ".concat(s),borderTopColor:"transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite"}});case"pulse":return(0,a.jsx)("div",{style:{width:h.container,height:h.container,backgroundColor:s,borderRadius:"50%",animation:"pulse 1.2s ease-in-out infinite"}});case"dots":return(0,a.jsx)("div",an({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"}},{children:[1,2,3].map((function(e){return(0,a.jsx)("div",{style:{width:"calc(".concat(h.container," / 3)"),height:"calc(".concat(h.container," / 3)"),backgroundColor:s,borderRadius:"50%",animation:"dots".concat(e," 1.4s infinite ease-in-out both"),animationDelay:"".concat(.2*(e-1),"s")}},e)}))}));default:return null}}(),l&&(0,a.jsx)("div",an({style:{color:s,fontSize:h.fontSize,fontWeight:500,textAlign:"center"}},{children:l}))]}))]})};var ln=function(){return ln=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ln.apply(this,arguments)};const cn=function(e){var t=e.content,n=e.isEditable,r=void 0!==n&&n,o=e.onEditClick;return(0,a.jsxs)("div",ln({className:"grammar-card-container",style:{position:"relative"},onClick:function(e){e.stopPropagation()}},{children:[(0,a.jsx)("div",{className:"grammar-card grammar-reference",dangerouslySetInnerHTML:{__html:t||""},onClick:function(e){e.stopPropagation()}}),r&&o&&(0,a.jsxs)("button",ln({onClick:function(e){e.stopPropagation(),o()},style:{position:"absolute",top:"8px",right:"8px",background:"rgba(255, 255, 255, 0.8)",border:"1px solid #E5E7EB",color:"#3B82F6",fontSize:"12px",padding:"4px 8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:[(0,a.jsx)(Mt,{size:12}),"Edit"]}))]}))};var un=function(){return un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},un.apply(this,arguments)},dn={TRANSLATING_TEXT:{title:"Translating text...",subtitle:"Converting your text to the target language",icon:"",color:"#3B82F6",steps:[{title:"Preparing translation...",subtitle:"Setting up translation parameters"},{title:"Sending to translation AI...",subtitle:"Communicating with OpenAI servers"},{title:"Processing translation...",subtitle:"AI is analyzing and translating your text"},{title:"Finalizing translation...",subtitle:"Applying final touches to the translation"}]},TRANSLATING_EXAMPLES:{title:"Translating examples...",subtitle:"Making example sentences available in your language",icon:"",color:"#10B981",steps:[{title:"Preparing examples...",subtitle:"Organizing example sentences for translation"},{title:"Translating examples...",subtitle:"Converting examples to your target language"},{title:"Processing translations...",subtitle:"Ensuring translation quality and accuracy"}]},GENERATING_EXAMPLES:{title:"Generating examples...",subtitle:"Creating meaningful example sentences for better understanding",icon:"",color:"#F59E0B",steps:[{title:"Analyzing word context...",subtitle:"Understanding word usage and meaning"},{title:"Creating example prompts...",subtitle:"Preparing AI prompts for example generation"},{title:"Generating examples...",subtitle:"AI is crafting relevant example sentences"},{title:"Refining examples...",subtitle:"Ensuring examples are clear and educational"}]},ANALYZING_WORD_FOR_IMAGE:{title:"Analyzing word...",subtitle:"Determining if this is a concept or object for optimal visualization",icon:"",color:"#8B5CF6",steps:[{title:"Classifying word type...",subtitle:"Determining if word represents concept or object"},{title:"Evaluating visual potential...",subtitle:"Assessing how well this can be visualized"},{title:"Preparing visualization strategy...",subtitle:"Choosing optimal image generation approach"}]},CREATING_IMAGE_DESCRIPTION:{title:"Creating image description...",subtitle:"Crafting detailed prompts for AI image generation",icon:"",color:"#EC4899",steps:[{title:"Building image prompt...",subtitle:"Creating detailed description for image generation"},{title:"Optimizing prompt...",subtitle:"Refining prompt for best AI image results"},{title:"Finalizing description...",subtitle:"Preparing final prompt for image generation"}]},GENERATING_IMAGE:{title:"Generating image...",subtitle:"AI is creating a beautiful illustration just for you",icon:"",color:"#6366F1",steps:[{title:"Sending to image AI...",subtitle:"Transmitting prompt to OpenAI DALL-E"},{title:"AI generating image...",subtitle:"Neural network is creating your custom illustration"},{title:"Processing image...",subtitle:"Applying final touches and optimizations"},{title:"Preparing image for display...",subtitle:"Finalizing image for your flashcard"}]},GENERATING_CARD_CONTENT:{title:"Generating card content...",subtitle:"AI is analyzing your text and creating the perfect flashcard",icon:"",color:"#3B82F6",steps:[{title:"Analyzing input text...",subtitle:"Understanding the content and context"},{title:"Extracting key information...",subtitle:"Identifying main concepts and details"},{title:"Structuring card content...",subtitle:"Organizing information for optimal learning"},{title:"Generating front side...",subtitle:"Creating effective question or prompt"},{title:"Generating back side...",subtitle:"Developing comprehensive answer or explanation"},{title:"Finalizing card format...",subtitle:"Ensuring proper flashcard structure"}]},GENERATING_FRONT_SIDE:{title:"Creating front side...",subtitle:"Crafting an effective question or prompt",icon:"",color:"#10B981",steps:[{title:"Designing question format...",subtitle:"Choosing optimal question structure"},{title:"Crafting question text...",subtitle:"Writing clear and effective question"},{title:"Optimizing for learning...",subtitle:"Ensuring question promotes active recall"}]},GENERATING_BACK_SIDE:{title:"Creating back side...",subtitle:"Developing comprehensive answers and explanations",icon:"",color:"#F59E0B",steps:[{title:"Compiling answer content...",subtitle:"Gathering comprehensive information"},{title:"Structuring explanation...",subtitle:"Organizing answer for clarity"},{title:"Adding learning elements...",subtitle:"Including helpful context and examples"}]},SAVING_TO_ANKI:{title:"Saving to Anki...",subtitle:"Your card is being added to your Anki collection",icon:"",color:"#EF4444",steps:[{title:"Connecting to Anki...",subtitle:"Establishing connection with Anki application"},{title:"Validating card data...",subtitle:"Ensuring card format is correct"},{title:"Saving to collection...",subtitle:"Adding card to your Anki deck"},{title:"Confirming save...",subtitle:"Verifying card was saved successfully"}]},CONNECTING_TO_ANKI:{title:"Connecting to Anki...",subtitle:"Establishing connection with your Anki application",icon:"",color:"#6366F1",steps:[{title:"Locating Anki application...",subtitle:"Finding Anki on your system"},{title:"Establishing connection...",subtitle:"Setting up communication with Anki"},{title:"Verifying connection...",subtitle:"Ensuring stable connection is established"}]},DETECTING_LANGUAGE:{title:"Detecting language...",subtitle:"Analyzing text to determine the source language",icon:"",color:"#8B5CF6",steps:[{title:"Analyzing text patterns...",subtitle:"Examining linguistic characteristics"},{title:"Identifying language...",subtitle:"Determining the most likely language"},{title:"Confirming detection...",subtitle:"Validating language identification"}]},PROCESSING_REQUEST:{title:"Processing your request...",subtitle:"Please wait while we work our magic",icon:"",color:"#6B7280",steps:[{title:"Initializing request...",subtitle:"Setting up your request parameters"},{title:"Processing...",subtitle:"Working on your request"},{title:"Almost done...",subtitle:"Finalizing your request"}]},FINALIZING:{title:"Finalizing...",subtitle:"Putting everything together nicely",icon:"",color:"#10B981",steps:[{title:"Assembling results...",subtitle:"Combining all processed information"},{title:"Applying final touches...",subtitle:"Making everything look perfect"},{title:"Ready!",subtitle:"Your request has been completed successfully"}]}},pn=function(e,t){var n=dn[e],r=n.steps||[];if(!t||t<=0)return un(un({},n),{currentStep:0,totalSteps:r.length,currentStepTitle:n.title,currentStepSubtitle:n.subtitle});var o=r[Math.min(t-1,r.length-1)];return un(un({},n),{currentStep:t,totalSteps:r.length,currentStepTitle:(null==o?void 0:o.title)||n.title,currentStepSubtitle:(null==o?void 0:o.subtitle)||n.subtitle})},fn=(function(){function e(e,t){this.currentStep=0,this.startTime=Date.now(),this.operation=e,this.onProgressUpdate=t,this.startTime=Date.now()}e.prototype.nextStep=function(){this.currentStep++;var e=pn(this.operation,this.currentStep);return this.onProgressUpdate&&e&&this.onProgressUpdate(e),e},e.prototype.setStep=function(e){this.currentStep=e;var t=pn(this.operation,this.currentStep);return this.onProgressUpdate&&t&&this.onProgressUpdate(t),t},e.prototype.getCurrentProgress=function(){return pn(this.operation,this.currentStep)},e.prototype.getElapsedTime=function(){return Math.floor((Date.now()-this.startTime)/1e3)},e.prototype.isComplete=function(){var e=dn[this.operation].steps||[];return this.currentStep>=e.length},e.prototype.reset=function(){this.currentStep=0,this.startTime=Date.now()}}(),function(){return fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},fn.apply(this,arguments)}),gn=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const hn=function(e){var t=e.front,n=e.back,o=e.translation,i=e.examples,s=e.imageUrl,l=e.image,c=e.linguisticInfo,u=e.transcription,d=e.onNewImage,p=e.onNewExamples,f=e.onAccept,g=e.onViewSavedCards,h=e.onCancel,m=e.mode,y=void 0===m?_.LanguageLearning:m,x=e.loadingNewImage,v=e.loadingNewExamples,b=e.loadingAccept,w=e.loadingGetResult,S=void 0!==w&&w,C=(e.shouldGenerateImage,e.isSaved),k=void 0!==C&&C,E=(e.isEdited,e.isGeneratingCard),I=e.setTranslation,A=e.setBack,j=e.setExamples,F=e.setLinguisticInfo,T=e.hideActionButtons,P=void 0!==T&&T,R=e.createdAt,B=(0,r.useState)(!1),O=B[0],z=B[1],L=(0,r.useState)(o||""),N=L[0],D=L[1],M=(0,r.useState)(!1),U=M[0],q=M[1],W=(0,r.useState)(n||""),$=W[0],G=W[1],V=(0,r.useState)(!1),H=V[0],K=V[1],Q=(0,r.useState)(!0),J=(Q[0],Q[1],(0,r.useState)(!0)),X=J[0],Y=J[1],Z=(0,r.useState)(null),ee=Z[0],te=Z[1],ne=(0,r.useState)(null),re=ne[0],oe=ne[1],ae=(0,r.useState)(null),ie=ae[0],se=ae[1];(0,r.useEffect)((function(){D(o||"")}),[o]),(0,r.useEffect)((function(){G(n||"")}),[n]),(0,r.useEffect)((function(){te(x?pn("GENERATING_IMAGE",1):null)}),[x]),(0,r.useEffect)((function(){oe(v?pn("GENERATING_EXAMPLES",1):null)}),[v]),(0,r.useEffect)((function(){se(b?pn("SAVING_TO_ANKI",1):null)}),[b]),(0,r.useEffect)((function(){Te(c||"")}),[c]);var le,ce,ue=function(){K(!0)},de=function(){if(O&&I&&(I(N),z(!1)),U&&A&&(A($),q(!1)),null!==be&&j){var e=gn([],i,!0);e[be]=[Ce,Ee],j(e),we(null)}Ae&&F&&(F(Fe),_e(!1)),k&&f(),K(!1)},pe=function(){H&&(z(!0),D(o||""))},fe=function(){I&&I(N),z(!1)},ge=function(){H&&(q(!0),G(n||""))},he=function(){A&&A($),q(!1)},me=function(e,t,n){if(H&&j&&i){var r=gn([],i,!0);t?r[e][0]=n:r[e][1]=n||null,j(r)}},ye=(0,r.useState)(!1),xe=(ye[0],ye[1],(0,r.useState)(o||"")),ve=(xe[0],xe[1],(0,r.useState)(null)),be=ve[0],we=ve[1],Se=(0,r.useState)(""),Ce=Se[0],ke=(Se[1],(0,r.useState)("")),Ee=ke[0],Ie=(ke[1],(0,r.useState)(!1)),Ae=Ie[0],_e=Ie[1],je=(0,r.useState)(c||""),Fe=je[0],Te=je[1];return(0,a.jsxs)("div",fn({style:{padding:"16px",borderRadius:"8px",width:"100%",maxWidth:"100%",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",overflowX:"hidden",backgroundColor:H?"#FAFAFA":"#ffffff",borderLeft:H?"3px solid #3B82F6":"3px solid transparent"}},{children:[(0,a.jsxs)("div",fn({style:{fontSize:"10px",color:"#9CA3AF",marginBottom:"12px",textAlign:"right",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px",padding:"6px 8px",backgroundColor:H?"#EFF6FF":k?"#ECFDF5":"#F9FAFB",borderRadius:"4px",border:H?"1px solid #DBEAFE":k?"1px solid #D1FAE5":"1px solid #F3F4F6"}},{children:[(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",gap:"4px"}},{children:[(0,a.jsx)("span",{style:{display:"inline-block",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:H?"#3B82F6":k?"#10B981":"#6B7280"}}),(0,a.jsx)("strong",fn({style:{color:H?"#1E40AF":k?"#059669":"#4B5563"}},{children:H?"Editing":k?"Saved to Collection":"New - Not Saved Yet"}))]})),(0,a.jsxs)("div",fn({style:{fontSize:"9px",color:"#9CA3AF",fontStyle:"italic",display:"flex",alignItems:"center",gap:"3px"}},{children:[(0,a.jsx)("span",{children:""}),(R||new Date).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]}))]})),H?(0,a.jsxs)("button",fn({onClick:de,disabled:b,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",padding:"10px 12px",fontSize:"14px",fontWeight:"600",cursor:"pointer",marginBottom:"12px",width:"100%",opacity:b?.7:1},onMouseOver:function(e){return!b&&(e.currentTarget.style.backgroundColor="#2563EB")},onMouseOut:function(e){return!b&&(e.currentTarget.style.backgroundColor="#3B82F6")}},{children:[(0,a.jsx)(en,{size:14}),b?(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"}},{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),(0,a.jsx)("span",fn({style:{fontSize:"12px",fontWeight:"500"}},{children:(null==ie?void 0:ie.currentStepTitle)||(null==ie?void 0:ie.title)||"Saving"}))]})):k?"Save & Finish Editing":"Finish Editing"]})):H?null:(0,a.jsxs)("button",fn({onClick:ue,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 12px",fontSize:"14px",fontWeight:"600",cursor:"pointer",marginBottom:"12px",width:"100%"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#1F2937"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"}},{children:[(0,a.jsx)(Mt,{size:14}),"Edit Card"]})),H?(0,a.jsxs)("div",fn({style:{marginBottom:"16px",backgroundColor:"#EFF6FF",borderRadius:"6px",padding:"10px",border:"1px solid #DBEAFE",fontSize:"13px",color:"#1E40AF"}},{children:[(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",fontWeight:"600"}},{children:[(0,a.jsx)(Mt,{size:12}),"Editing Mode"]})),(0,a.jsxs)("p",fn({style:{margin:0,fontSize:"12px"}},{children:['Click on text elements to edit them. When finished, click "',k?"Save & Finish Editing":"Finish Editing",'" at the top of the card.']}))]})):null,t&&(0,a.jsx)("div",fn({style:{marginBottom:"12px"}},{children:t.includes("/")?function(){var e,n=t.split(/\s*\//),r=(null===(e=n[0])||void 0===e?void 0:e.trim())||"",o=n.length>1?"/".concat(n.slice(1).join("/").replace(/\/$/,"")):"";return(0,a.jsxs)("div",fn({style:{textAlign:"center",padding:"12px",backgroundColor:"#F3F4F6",borderRadius:"8px"}},{children:[(0,a.jsx)("h3",fn({style:{fontSize:"20px",fontWeight:"700",margin:"0 0 6px 0",color:"#111827"}},{children:r})),o&&(0,a.jsx)("div",fn({style:{fontSize:"14px",color:"#6B7280",fontStyle:"italic"}},{children:o}))]}))}():(0,a.jsx)("h3",fn({style:{fontSize:"18px",fontWeight:"600",textAlign:"center",margin:"2px 0",color:"#111827",padding:"10px",backgroundColor:"#F3F4F6",borderRadius:"8px"}},{children:t}))})),u&&(0,a.jsx)("div",fn({style:{marginBottom:"12px",textAlign:"center",padding:"8px 12px",backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"6px"}},{children:(0,a.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.6",color:"#475569"},dangerouslySetInnerHTML:{__html:u}})})),(y===_.LanguageLearning?o:n)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"10px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),(y===_.LanguageLearning?O:U)&&H?(0,a.jsxs)("div",fn({style:{marginBottom:"12px",position:"relative"}},{children:[y===_.LanguageLearning?(0,a.jsx)("input",{type:"text",value:N,onChange:function(e){return D(e.target.value)},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #3B82F6",backgroundColor:"#ffffff",color:"#111827",fontSize:"14px",outline:"none",fontWeight:"600",textAlign:"center"},autoFocus:!0,onBlur:fe,onKeyDown:function(e){"Enter"===e.key&&fe()}}):(0,a.jsx)("textarea",{value:$,onChange:function(e){return G(e.target.value)},style:{width:"100%",minHeight:"120px",padding:"12px",borderRadius:"6px",border:"1px solid #3B82F6",backgroundColor:"#ffffff",color:"#111827",fontSize:"14px",outline:"none",fontWeight:"400",lineHeight:"1.5",resize:"vertical"},autoFocus:!0,onBlur:he,onKeyDown:function(e){"Enter"===e.key&&e.ctrlKey&&he()}}),(0,a.jsx)("div",fn({style:{fontSize:"11px",color:"#6B7280",textAlign:"center",marginTop:"4px"}},{children:y===_.LanguageLearning?"Press Enter or click outside to save":"Press Ctrl+Enter or click outside to save"}))]})):(0,a.jsxs)("div",fn({style:fn({marginBottom:"12px",textAlign:y===_.LanguageLearning?"center":"left",position:"relative",paddingRight:H?"24px":"0"},H?{padding:"8px",border:"1px dashed #E5E7EB",borderRadius:"4px",transition:"all 0.2s ease",cursor:"pointer",backgroundColor:"#FAFAFA"}:{}),onClick:H?y===_.LanguageLearning?pe:ge:void 0,onMouseOver:function(e){H&&(e.currentTarget.style.borderColor="#3B82F6",e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){H&&(e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.backgroundColor="#FAFAFA")}},{children:[y===_.LanguageLearning?(0,a.jsx)("p",fn({style:{fontWeight:"600",color:"#111827",fontSize:"14px",margin:0}},{children:o})):(0,a.jsx)("div",{style:{color:"#111827",fontSize:"14px",lineHeight:"1.6",margin:0,whiteSpace:"pre-wrap",wordWrap:"break-word"},dangerouslySetInnerHTML:{__html:(le=n||"",ce=le,ce=(ce=(ce=(ce=(ce=ce.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(function(e,t,n){var r=t&&""!==t&&"Image"!==t?t:"";return'<div style="text-align: center; margin: 4px 0;">\n            <img src="'.concat(n,'" alt="').concat(r,'" style="max-width: 100%; height: auto; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: block; margin: 0 auto;" />\n            ').concat(r?'<div style="font-size: 11px; color: #6B7280; margin-top: 2px; font-style: italic;">'.concat(r,"</div>"):"","\n        </div>")}))).replace(/\$\$([^$]+)\$\$/g,(function(e,t){return'<div style="text-align: center; margin: 12px 0; padding: 8px; background: #F8FAFC; border-radius: 6px; font-family: serif;">\n            <strong>:</strong> '.concat(t,"\n        </div>")}))).replace(/```(\w*)\n([\s\S]*?)\n```/g,(function(e,t,n){return'<div style="margin: 12px 0;">\n            <div style="background: #2D2D2D; color: #F8F8F2; padding: 12px; border-radius: 6px; font-family: monospace; overflow-x: auto; white-space: pre; font-size: 13px;">\n                '.concat(t?'<div style="color: #6B7280; margin-bottom: 8px; font-size: 11px;">'.concat(t,"</div>"):"","\n                ").concat(n,"\n            </div>\n        </div>")}))).replace(/`([^`]+)`/g,'<code style="background: #F3F4F6; padding: 2px 4px; border-radius: 3px; font-family: monospace; font-size: 13px;">$1</code>')).replace(/\n/g,"<br />"))}}),H&&(0,a.jsx)("button",fn({onClick:function(e){e.stopPropagation(),y===_.LanguageLearning?pe():ge()},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#F3F4F6",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6B7280",display:"flex",padding:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},title:y===_.LanguageLearning?"Edit translation":"Edit content",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#3B82F6"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#6B7280"}},{children:(0,a.jsx)(Xt,{size:12})}))]}))]}),c&&(0,a.jsxs)("div",fn({style:{marginTop:"12px",marginBottom:"16px",borderRadius:"10px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",border:"1px solid",borderColor:X?"#BFDBFE":"#E5E7EB",backgroundColor:X?"#EFF6FF":"#F9FAFB",transition:"all 0.3s ease",overflow:"hidden"}},{children:[(0,a.jsxs)("div",fn({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:X?"1px solid #BFDBFE":"none",transition:"background-color 0.2s"}},{children:[(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",gap:"10px",fontWeight:600,fontSize:"14px",color:X?"#1D4ED8":"#4B5563",flex:1}},{children:[(0,a.jsx)($t,{size:16,color:X?"#2563EB":"#6B7280"}),(0,a.jsx)("span",{children:"Grammar & Linguistics"})]})),(0,a.jsx)("button",fn({onClick:function(e){e.stopPropagation(),Y(!X)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="rgba(0,0,0,0.05)"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"}},{children:X?(0,a.jsx)(Ot,{size:14,color:"#6B7280"}):(0,a.jsx)(Pt,{size:14,color:"#6B7280"})}))]})),X&&(0,a.jsx)("div",fn({style:{padding:"16px"}},{children:Ae?(0,a.jsxs)("div",fn({style:{width:"100%"}},{children:[(0,a.jsx)("textarea",{value:Fe,onChange:function(e){Te(e.target.value)},style:{width:"100%",minHeight:"120px",padding:"10px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",lineHeight:"1.5",resize:"vertical",marginBottom:"8px"}}),(0,a.jsxs)("div",fn({style:{display:"flex",justifyContent:"flex-end",gap:"8px"}},{children:[(0,a.jsx)("button",fn({onClick:function(){Te(c||""),_e(!1)},style:{padding:"6px 12px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"13px",cursor:"pointer"}},{children:"Cancel"})),(0,a.jsx)("button",fn({onClick:function(){F&&F(Fe),_e(!1)},style:{padding:"6px 12px",backgroundColor:"#2563EB",color:"white",border:"none",borderRadius:"6px",fontSize:"13px",cursor:"pointer"}},{children:"Save"}))]}))]})):(0,a.jsx)("div",fn({style:{position:"relative"}},{children:(0,a.jsx)(cn,{content:c||"",isEditable:H,onEditClick:function(){return _e(!0)}})}))}))]})),i.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"10px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),(0,a.jsxs)("div",fn({style:{marginBottom:"12px"}},{children:[(0,a.jsx)("div",fn({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}},{children:(0,a.jsx)("h4",fn({style:{fontSize:"14px",fontWeight:"600",color:"#374151",margin:0}},{children:"Examples"}))})),(0,a.jsx)("ul",fn({style:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"8px"}},{children:i.map((function(e,t){var n=e[0],r=e[1];return(0,a.jsxs)("li",fn({style:fn({padding:"12px",backgroundColor:"#F9FAFB",borderRadius:"6px",position:"relative",minHeight:"auto",wordWrap:"break-word",overflow:"visible"},H?{border:"1px dashed #CBD5E1",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}:{})},{children:[H&&(0,a.jsx)("div",fn({style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"8px",zIndex:5}},{children:(0,a.jsxs)("button",fn({onClick:function(){return function(e){if(H&&j&&i){var t=gn([],i,!0);t.splice(e,1),j(t)}}(t)},style:{background:"#FEE2E2",border:"none",borderRadius:"4px",cursor:"pointer",color:"#EF4444",padding:"4px 6px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"500"},title:"Delete example",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#FECACA"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#FEE2E2"}},{children:[(0,a.jsx)(on,{size:10,style:{marginRight:"4px"}}),"Delete"]}))})),H?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",fn({style:{marginBottom:"8px"}},{children:(0,a.jsx)("textarea",{value:n,onChange:function(e){return me(t,!0,e.target.value)},style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid #E5E7EB",fontSize:"13px",color:"#111827",fontWeight:"500",backgroundColor:"#ffffff",minHeight:"40px",resize:"vertical",fontFamily:"inherit",lineHeight:"1.4"},placeholder:"Example sentence"})})),(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{value:r||"",onChange:function(e){return me(t,!1,e.target.value)},style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid #E5E7EB",fontSize:"13px",color:"#6B7280",fontStyle:"italic",backgroundColor:"#ffffff",minHeight:"40px",resize:"vertical",fontFamily:"inherit",lineHeight:"1.4"},placeholder:"Translation (optional)"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",fn({style:{fontWeight:"500",color:"#111827",fontSize:"13px",marginBottom:r?"6px":0,lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:n})),r&&(0,a.jsx)("div",fn({style:{color:"#6B7280",fontSize:"13px",fontStyle:"italic",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:r}))]})]}),t)}))})),H&&(0,a.jsxs)("button",fn({onClick:function(){if(H&&j&&i){var e=gn([],i,!0);e.push(["",null]),j(e)}},style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#EFF6FF",color:"#3B82F6",fontSize:"14px",fontWeight:"500",border:"1px dashed #BFDBFE",cursor:"pointer",marginTop:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#DBEAFE",e.currentTarget.style.borderColor="#93C5FD"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#EFF6FF",e.currentTarget.style.borderColor="#BFDBFE"}},{children:[(0,a.jsx)(Yt,{size:12}),"Add Example"]}))]}))]}),(l||s)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),(0,a.jsx)("div",fn({style:{marginBottom:"16px"}},{children:(0,a.jsx)("img",{src:l||s||"",alt:"",style:{width:"100%",borderRadius:"6px",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"}})}))]}),!k&&(0,a.jsxs)("div",fn({style:{display:"flex",gap:"6px",marginBottom:"8px"}},{children:[(l||s)&&(0,a.jsx)("button",fn({onClick:d,disabled:x,style:{flex:1,padding:"8px 12px",borderRadius:"6px",backgroundColor:"#F59E0B",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:x?.7:1},onMouseOver:function(e){return!x&&(e.currentTarget.style.backgroundColor="#D97706")},onMouseOut:function(e){return!x&&(e.currentTarget.style.backgroundColor="#F59E0B")}},{children:x?(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"}},{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),(0,a.jsx)("span",fn({style:{fontSize:"12px",fontWeight:"500"}},{children:(null==ee?void 0:ee.currentStepTitle)||(null==ee?void 0:ee.title)||"Generating"}))]})):"New Image"})),i.length>0&&(0,a.jsx)("button",fn({onClick:p,disabled:v,style:{flex:1,padding:"8px 12px",borderRadius:"6px",backgroundColor:"#F59E0B",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:v?.7:1},onMouseOver:function(e){return!v&&(e.currentTarget.style.backgroundColor="#D97706")},onMouseOut:function(e){return!v&&(e.currentTarget.style.backgroundColor="#F59E0B")}},{children:v?(0,a.jsxs)("div",fn({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"}},{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),(0,a.jsx)("span",fn({style:{fontSize:"12px",fontWeight:"500"}},{children:(null==re?void 0:re.currentStepTitle)||(null==re?void 0:re.title)||"Loading"}))]})):"New Examples"}))]})),!P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",fn({style:{marginBottom:"10px"}},{children:[!H&&(!k||E||S)&&(0,a.jsxs)("div",fn({style:{display:"flex",gap:"8px",width:"100%"}},{children:[(0,a.jsxs)("button",fn({onClick:h,disabled:b,style:{flex:"1",padding:"10px",borderRadius:"6px",backgroundColor:"#F3F4F6",color:"#4B5563",fontWeight:"600",fontSize:"14px",border:"1px solid #E5E7EB",cursor:b?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:b?.7:1},onMouseOver:function(e){b||(e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){b||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563")}},{children:[(0,a.jsx)(rn,{}),E||S?"Cancel Generation":"Cancel"]})),!E&&!S&&(0,a.jsxs)("button",fn({onClick:f,disabled:b,style:{flex:"2",padding:"10px",borderRadius:"6px",backgroundColor:"#22C55E",color:"#ffffff",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:b?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(e){return!b&&(e.currentTarget.style.backgroundColor="#15803D")},onMouseOut:function(e){return!b&&(e.currentTarget.style.backgroundColor="#22C55E")}},{children:[(0,a.jsx)(Tt,{}),b?(0,a.jsx)("div",fn({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving"})})):"Save Card"]}))]})),!H&&k&&(0,a.jsxs)("div",fn({style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#ECFDF5",border:"1px solid #D1FAE5",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)("div",fn({style:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10B981",color:"white"}},{children:(0,a.jsx)(Tt,{size:12})})),(0,a.jsx)("span",fn({style:{fontWeight:"600",fontSize:"14px",color:"#059669"}},{children:"Saved to Collection"}))]})),!H&&!k&&(0,a.jsx)("p",fn({style:{fontSize:"11px",color:"#6B7280",textAlign:"center",margin:"4px 0 0 0"}},{children:"The card will be saved to your collection"}))]})),(0,a.jsxs)("button",fn({onClick:g,style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#4B5563",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#374151"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#4B5563"}},{children:[(0,a.jsx)(Qt,{size:14}),"View Saved Cards"]}))]})]}))},mn="RFC3986",yn={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},xn=(Object.prototype.hasOwnProperty,Array.isArray),vn=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();const bn=1024;function wn(e,t){if(xn(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const Sn=Object.prototype.hasOwnProperty,Cn={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},kn=Array.isArray,En=Array.prototype.push,In=function(e,t){En.apply(e,kn(t)?t:[t])},An=Date.prototype.toISOString,_n={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,o)=>{if(0===e.length)return e;let a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let i="";for(let e=0;e<a.length;e+=bn){const t=a.length>=bn?a.slice(e,e+bn):a,n=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===o&&(40===r||41===r)?n[n.length]=t.charAt(e):r<128?n[n.length]=vn[r]:r<2048?n[n.length]=vn[192|r>>6]+vn[128|63&r]:r<55296||r>=57344?n[n.length]=vn[224|r>>12]+vn[128|r>>6&63]+vn[128|63&r]:(e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),n[n.length]=vn[240|r>>18]+vn[128|r>>12&63]+vn[128|r>>6&63]+vn[128|63&r])}i+=n.join("")}return i},encodeValuesOnly:!1,format:mn,formatter:yn[mn],indices:!1,serializeDate:e=>An.call(e),skipNulls:!1,strictNullHandling:!1};const jn={};function Fn(e,t,n,r,o,a,i,s,l,c,u,d,p,f,g,h,m,y){let x=e,v=y,b=0,w=!1;for(;void 0!==(v=v.get(jn))&&!w;){const t=v.get(e);if(b+=1,void 0!==t){if(t===b)throw new RangeError("Cyclic object value");w=!0}void 0===v.get(jn)&&(b=0)}if("function"==typeof c?x=c(t,x):x instanceof Date?x=p?.(x):"comma"===n&&kn(x)&&(x=wn(x,(function(e){return e instanceof Date?p?.(e):e}))),null===x){if(a)return l&&!h?l(t,_n.encoder,m,"key",f):t;x=""}if("string"==typeof(S=x)||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S||function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}(x)){if(l){const e=h?t:l(t,_n.encoder,m,"key",f);return[g?.(e)+"="+g?.(l(x,_n.encoder,m,"value",f))]}return[g?.(t)+"="+g?.(String(x))]}var S;const C=[];if(void 0===x)return C;let k;if("comma"===n&&kn(x))h&&l&&(x=wn(x,l)),k=[{value:x.length>0?x.join(",")||null:void 0}];else if(kn(c))k=c;else{const e=Object.keys(x);k=u?e.sort(u):e}const E=s?String(t).replace(/\./g,"%2E"):String(t),I=r&&kn(x)&&1===x.length?E+"[]":E;if(o&&kn(x)&&0===x.length)return I+"[]";for(let t=0;t<k.length;++t){const v=k[t],w="object"==typeof v&&void 0!==v.value?v.value:x[v];if(i&&null===w)continue;const S=d&&s?v.replace(/\./g,"%2E"):v,E=kn(x)?"function"==typeof n?n(I,S):I:I+(d?"."+S:"["+S+"]");y.set(e,b);const A=new WeakMap;A.set(jn,y),In(C,Fn(w,E,n,r,o,a,i,s,"comma"===n&&h&&kn(x)?null:l,c,u,d,p,f,g,h,m,A))}return C}function Tn(e,t={}){let n=e;const r=function(e=_n){if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||_n.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=mn;if(void 0!==e.format){if(!Sn.call(yn,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=yn[n];let o,a=_n.filter;if(("function"==typeof e.filter||kn(e.filter))&&(a=e.filter),o=e.arrayFormat&&e.arrayFormat in Cn?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":_n.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=void 0===e.allowDots?1==!!e.encodeDotInKeys||_n.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:_n.addQueryPrefix,allowDots:i,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:_n.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:_n.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?_n.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:_n.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:_n.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:_n.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:_n.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:_n.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:_n.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:_n.strictNullHandling}}(t);let o,a;"function"==typeof r.filter?(a=r.filter,n=a("",n)):kn(r.filter)&&(a=r.filter,o=a);const i=[];if("object"!=typeof n||null===n)return"";const s=Cn[r.arrayFormat],l="comma"===s&&r.commaRoundTrip;o||(o=Object.keys(n)),r.sort&&o.sort(r.sort);const c=new WeakMap;for(let e=0;e<o.length;++e){const t=o[e];r.skipNulls&&null===n[t]||In(i,Fn(n[t],t,s,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const u=i.join(r.delimiter);let d=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Pn="4.72.0";let Rn,Bn,On,zn,Ln,Nn,Dn,Mn,Un,qn=!1,Wn=null,$n=null,Gn=null,Vn=null;class Hn{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}Rn||function(e,t={auto:!1}){if(qn)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Rn)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Rn}'\``);qn=t.auto,Rn=e.kind,Bn=e.fetch,Wn=e.Request,$n=e.Response,Gn=e.Headers,On=e.FormData,Vn=e.Blob,zn=e.File,Ln=e.ReadableStream,Nn=e.getMultipartRequestOptions,Dn=e.getDefaultAgent,Mn=e.fileFromPath,Un=e.isFsReadStream}(function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,o,a;try{n=fetch,r=Request,o=Response,a=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:o,Headers:a,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new Hn(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class Kn extends Error{}class Qn extends Kn{constructor(e,t,n,r){super(`${Qn.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"];const o=t;this.error=o,this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(e,t,n){const r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e)return new Xn({message:n,cause:Hr(t)});const o=t?.error;return 400===e?new Zn(e,o,n,r):401===e?new er(e,o,n,r):403===e?new tr(e,o,n,r):404===e?new nr(e,o,n,r):409===e?new rr(e,o,n,r):422===e?new or(e,o,n,r):429===e?new ar(e,o,n,r):e>=500?new ir(e,o,n,r):new Qn(e,o,n,r)}}class Jn extends Qn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Xn extends Qn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class Yn extends Xn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Zn extends Qn{constructor(){super(...arguments),this.status=400}}class er extends Qn{constructor(){super(...arguments),this.status=401}}class tr extends Qn{constructor(){super(...arguments),this.status=403}}class nr extends Qn{constructor(){super(...arguments),this.status=404}}class rr extends Qn{constructor(){super(...arguments),this.status=409}}class or extends Qn{constructor(){super(...arguments),this.status=422}}class ar extends Qn{constructor(){super(...arguments),this.status=429}}class ir extends Qn{}class sr extends Kn{constructor(){super("Could not parse response content as the length limit was reached")}}class lr extends Kn{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class cr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=cr.NEWLINE_CHARS.has(t[t.length-1]||"");let r=t.split(cr.NEWLINE_REGEXP);return n&&r.pop(),1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Kn(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Kn(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Kn("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}cr.NEWLINE_CHARS=new Set(["\n","\r"]),cr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ur{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new ur((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(e,t){if(!e.body)throw t.abort(),new Kn("Attempted to iterate over a response with no body");const n=new pr,r=new cr,o=fr(e.body);for await(const e of async function*(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,o=new Uint8Array(t.length+e.length);for(o.set(t),o.set(e,t.length),t=o;-1!==(r=dr(t));)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}(o))for(const t of r.decode(e)){const e=n.decode(t);e&&(yield e)}for(const e of r.flush()){const t=n.decode(e);t&&(yield t)}}(e,t))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event){let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if(e&&e.error)throw new Qn(void 0,e.error,void 0,void 0);yield e}else{let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new Qn(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}static fromReadableStream(e,t){let n=!1;return new ur((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const t of async function*(){const t=new cr,n=fr(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}())r||t&&(yield JSON.parse(t));r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new ur((()=>r(e)),this.controller),new ur((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Ln({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:o}=await t.next();if(o)return e.close();const a=n.encode(JSON.stringify(r)+"\n");e.enqueue(a)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}function dr(e){for(let t=0;t<e.length-2;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}class pr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}function fr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const gr=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,hr=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&mr(e),mr=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,yr=e=>hr(e)||gr(e)||Un(e);async function xr(e,t,n){if(e=await e,hr(e))return e;if(gr(e)){const r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=mr(r)?[await r.arrayBuffer()]:[r];return new zn(o,t,n)}const r=await async function(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(mr(e))t.push(await e.arrayBuffer());else{if(!br(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const n of e)t.push(n)}return t}(e);if(t||(t=function(e){return vr(e.name)||vr(e.filename)||vr(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!n?.type){const e=r[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new zn(r,t,n)}const vr=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,br=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],wr=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],Sr=async e=>{const t=await Cr(e.body);return Nn(t,e)},Cr=async e=>{const t=new On;return await Promise.all(Object.entries(e||{}).map((([e,n])=>kr(t,e,n)))),t},kr=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)e.append(t,String(n));else if(yr(n)){const r=await xr(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>kr(e,t+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>kr(e,`${t}[${n}]`,r))))}}};var Er,Ir=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Ar=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function _r(e){const{response:t}=e;if(e.options.stream)return Yr("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):ur.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const e=await t.json();return Yr("response",t.status,t.url,t.headers,e),jr(e,t)}const r=await t.text();return Yr("response",t.status,t.url,t.headers,r),r}function jr(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class Fr extends Promise{constructor(e,t=_r){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Fr(this.responsePromise,(async t=>jr(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Tr{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:o}){this.baseURL=e,this.maxRetries=Vr("maxRetries",t),this.timeout=Vr("timeout",n),this.httpAgent=r,this.fetch=o??Bn}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ur(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Zr()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&mr(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:n,path:r,query:o,headers:a={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"==typeof e.body?e.body:wr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(i),l=this.buildURL(r,o);"timeout"in e&&Vr("timeout",e.timeout);const c=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??Dn(l),d=c+1e3;"number"==typeof u?.options?.timeout&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:n,...i&&{body:i},headers:this.buildHeaders({options:e,headers:a,contentLength:s,retryCount:t}),...u&&{agent:u},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const o={};n&&(o["content-length"]=n);const a=this.defaultHeaders(e);return Xr(o,a),Xr(o,t),wr(e.body)&&"node"!==Rn&&delete o["content-type"],void 0===eo(a,"x-stainless-retry-count")&&void 0===eo(t,"x-stainless-retry-count")&&(o["x-stainless-retry-count"]=String(r)),this.validateHeaders(o,t),o}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return Qn.generate(e,t,n,r)}request(e,t=null){return new Fr(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);const{req:o,url:a,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(o,{url:a,options:n}),Yr("request",a,n,o.headers),n.signal?.aborted)throw new Jn;const s=new AbortController,l=await this.fetchWithTimeout(a,o,i,s).catch(Hr);if(l instanceof Error){if(n.signal?.aborted)throw new Jn;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new Yn;throw new Xn({cause:l})}const c=Br(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return Yr(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,a,c),this.retryRequest(n,t,c)}const e=await l.text().catch((e=>Hr(e).message)),r=qr(e),o=r?void 0:e;Yr(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,o);throw this.makeStatusError(l.status,r,o,c)}return{response:l,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Rr(this,n,e)}buildURL(e,t){const n=$r(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return Qr(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new Kn(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:o,...a}=t||{};o&&o.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...a}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let r;const o=n?.["retry-after-ms"];if(o){const e=parseFloat(o);Number.isNaN(e)||(r=e)}const a=n?.["retry-after"];if(a&&!r){const e=parseFloat(a);r=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await Gr(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Pn}`}}class Pr{constructor(e,t,n,r){Er.set(this,void 0),Ir(this,Er,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Kn("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await Ar(this,Er,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Er=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Rr extends Fr{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await _r(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const Br=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),Or={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},zr=e=>"object"==typeof e&&null!==e&&!Qr(e)&&Object.keys(e).every((e=>Jr(Or,e))),Lr=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pn,"X-Stainless-OS":Dr(Deno.build.os),"X-Stainless-Arch":Nr(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pn,"X-Stainless-OS":Dr(process.platform),"X-Stainless-Arch":Nr(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Pn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Nr=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",Dr=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let Mr;const Ur=()=>Mr??(Mr=Lr()),qr=e=>{try{return JSON.parse(e)}catch(e){return}},Wr=new RegExp("^(?:[a-z]+:)?//","i"),$r=e=>Wr.test(e),Gr=e=>new Promise((t=>setTimeout(t,e))),Vr=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new Kn(`${e} must be an integer`);if(t<0)throw new Kn(`${e} must be a positive integer`);return t},Hr=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Kr=e=>"undefined"!=typeof process?process.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function Qr(e){if(!e)return!0;for(const t in e)return!1;return!0}function Jr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xr(e,t){for(const n in t){if(!Jr(t,n))continue;const r=n.toLowerCase();if(!r)continue;const o=t[n];null===o?delete e[r]:void 0!==o&&(e[r]=o)}}function Yr(e,...t){"undefined"!=typeof process&&"true"===process?.env?.DEBUG&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Zr=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),eo=(e,t)=>{const n=t.toLowerCase();if((e=>"function"==typeof e?.get)(e)){const r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const o of[t,n,t.toUpperCase(),r]){const t=e.get(o);if(t)return t}}for(const[r,o]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function to(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class no{constructor(e){this._client=e}}class ro extends no{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class oo extends no{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}}class ao extends no{constructor(){super(...arguments),this.completions=new oo(this._client)}}ao.Completions=oo;class io extends no{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class so extends Pr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class lo extends Pr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class co extends no{create(e,t){return this._client.post("/files",Sr({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return zr(e)?this.list({},e):this._client.getAPIList("/files",uo,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),o=Date.now();let a=await this.retrieve(e);for(;!a.status||!r.has(a.status);)if(await Gr(t),a=await this.retrieve(e),Date.now()-o>n)throw new Yn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class uo extends lo{}co.FileObjectsPage=uo;class po extends no{createVariation(e,t){return this._client.post("/images/variations",Sr({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Sr({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class fo extends no{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class go extends no{create(e,t){return this._client.post("/audio/transcriptions",Sr({body:e,...t}))}}class ho extends no{create(e,t){return this._client.post("/audio/translations",Sr({body:e,...t}))}}class mo extends no{constructor(){super(...arguments),this.transcriptions=new go(this._client),this.translations=new ho(this._client),this.speech=new fo(this._client)}}mo.Transcriptions=go,mo.Translations=ho,mo.Speech=fo;class yo extends no{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class xo extends no{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",vo,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class vo extends so{}xo.ModelsPage=vo;class bo extends no{list(e,t={},n){return zr(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,wo,{query:t,...n})}}class wo extends lo{}bo.FineTuningJobCheckpointsPage=wo;class So extends no{constructor(){super(...arguments),this.checkpoints=new bo(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return zr(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Co,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return zr(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,ko,{query:t,...n})}}class Co extends lo{}class ko extends lo{}So.FineTuningJobsPage=Co,So.FineTuningJobEventsPage=ko,So.Checkpoints=bo,So.FineTuningJobCheckpointsPage=wo;class Eo extends no{constructor(){super(...arguments),this.jobs=new So(this._client)}}Eo.Jobs=So,Eo.FineTuningJobsPage=Co,Eo.FineTuningJobEventsPage=ko;class Io extends no{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return zr(e)?this.list({},e):this._client.getAPIList("/assistants",Ao,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Ao extends lo{}function _o(e){return"function"==typeof e.parse}Io.AssistantsPage=Ao;const jo=e=>"assistant"===e?.role,Fo=e=>"function"===e?.role,To=e=>"tool"===e?.role;var Po,Ro,Bo,Oo,zo,Lo,No,Do,Mo,Uo,qo,Wo,$o,Go=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Vo=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ho{constructor(){Po.add(this),this.controller=new AbortController,Ro.set(this,void 0),Bo.set(this,(()=>{})),Oo.set(this,(()=>{})),zo.set(this,void 0),Lo.set(this,(()=>{})),No.set(this,(()=>{})),Do.set(this,{}),Mo.set(this,!1),Uo.set(this,!1),qo.set(this,!1),Wo.set(this,!1),Go(this,Ro,new Promise(((e,t)=>{Go(this,Bo,e,"f"),Go(this,Oo,t,"f")})),"f"),Go(this,zo,new Promise(((e,t)=>{Go(this,Lo,e,"f"),Go(this,No,t,"f")})),"f"),Vo(this,Ro,"f").catch((()=>{})),Vo(this,zo,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),Vo(this,Po,"m",$o).bind(this))}),0)}_connected(){this.ended||(Vo(this,Bo,"f").call(this),this._emit("connect"))}get ended(){return Vo(this,Mo,"f")}get errored(){return Vo(this,Uo,"f")}get aborted(){return Vo(this,qo,"f")}abort(){this.controller.abort()}on(e,t){return(Vo(this,Do,"f")[e]||(Vo(this,Do,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=Vo(this,Do,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(Vo(this,Do,"f")[e]||(Vo(this,Do,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{Go(this,Wo,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){Go(this,Wo,!0,"f"),await Vo(this,zo,"f")}_emit(e,...t){if(Vo(this,Mo,"f"))return;"end"===e&&(Go(this,Mo,!0,"f"),Vo(this,Lo,"f").call(this));const n=Vo(this,Do,"f")[e];if(n&&(Vo(this,Do,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return Vo(this,Wo,"f")||n?.length||Promise.reject(e),Vo(this,Oo,"f").call(this,e),Vo(this,No,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];Vo(this,Wo,"f")||n?.length||Promise.reject(e),Vo(this,Oo,"f").call(this,e),Vo(this,No,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function Ko(e){return"auto-parseable-response-format"===e?.$brand}function Qo(e){return"auto-parseable-tool"===e?.$brand}function Jo(e,t){const n=e.choices.map((e=>{if("length"===e.finish_reason)throw new sr;if("content_filter"===e.finish_reason)throw new lr;return{...e,message:{...e.message,tool_calls:e.message.tool_calls?.map((e=>function(e,t){const n=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:Qo(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}(t,e)))??[],parsed:e.message.content&&!e.message.refusal?Xo(t,e.message.content):null}}}));return{...e,choices:n}}function Xo(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function Yo(e,t){if(!e)return!1;const n=e.tools?.find((e=>e.function?.name===t.function.name));return Qo(n)||n?.function.strict||!1}function Zo(e){return!!Ko(e.response_format)||(e.tools?.some((e=>Qo(e)||"function"===e.type&&!0===e.function.strict))??!1)}Ro=new WeakMap,Bo=new WeakMap,Oo=new WeakMap,zo=new WeakMap,Lo=new WeakMap,No=new WeakMap,Do=new WeakMap,Mo=new WeakMap,Uo=new WeakMap,qo=new WeakMap,Wo=new WeakMap,Po=new WeakSet,$o=function(e){if(Go(this,Uo,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new Jn),e instanceof Jn)return Go(this,qo,!0,"f"),this._emit("abort",e);if(e instanceof Kn)return this._emit("error",e);if(e instanceof Error){const t=new Kn(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Kn(String(e)))};var ea,ta,na,ra,oa,aa,ia,sa,la=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ca=10;class ua extends Ho{constructor(){super(...arguments),ea.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(Fo(e)||To(e))&&e.content)this._emit("functionCallResult",e.content);else if(jo(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(jo(e)&&e.tool_calls)for(const t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Kn("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),la(this,ea,"m",ta).call(this)}async finalMessage(){return await this.done(),la(this,ea,"m",na).call(this)}async finalFunctionCall(){return await this.done(),la(this,ea,"m",ra).call(this)}async finalFunctionCallResult(){return await this.done(),la(this,ea,"m",oa).call(this)}async totalUsage(){return await this.done(),la(this,ea,"m",aa).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=la(this,ea,"m",na).call(this);t&&this._emit("finalMessage",t);const n=la(this,ea,"m",ta).call(this);n&&this._emit("finalContent",n);const r=la(this,ea,"m",ra).call(this);r&&this._emit("finalFunctionCall",r);const o=la(this,ea,"m",oa).call(this);null!=o&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",la(this,ea,"m",aa).call(this))}async _createChatCompletion(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),la(this,ea,"m",ia).call(this,t);const o=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Jo(o,t))}async _runChatCompletion(e,t,n){for(const e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const r="function",{function_call:o="auto",stream:a,...i}=t,s="string"!=typeof o&&o?.name,{maxChatCompletions:l=ca}=n||{},c={};for(const e of t.functions)c[e.name||e.function.name]=e;const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...i,function_call:o,functions:u,messages:[...this.messages]},n),a=t.choices[0]?.message;if(!a)throw new Kn("missing message in ChatCompletion response");if(!a.function_call)return;const{name:l,arguments:d}=a.function_call,p=c[l];if(!p){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:l,content:e});continue}if(s&&s!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(s)} requested. Please try again`;this._addMessage({role:r,name:l,content:e});continue}let f;try{f=_o(p)?await p.parse(d):d}catch(e){this._addMessage({role:r,name:l,content:e instanceof Error?e.message:String(e)});continue}const g=await p.function(f,this),h=la(this,ea,"m",sa).call(this,g);if(this._addMessage({role:r,name:l,content:h}),s)return}}async _runTools(e,t,n){const r="tool",{tool_choice:o="auto",stream:a,...i}=t,s="string"!=typeof o&&o?.function?.name,{maxChatCompletions:l=ca}=n||{},c=t.tools.map((e=>{if(Qo(e)){if(!e.$callback)throw new Kn("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),u={};for(const e of c)"function"===e.type&&(u[e.function.name||e.function.function.name]=e.function);const d="tools"in t?c.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...i,tool_choice:o,tools:d,messages:[...this.messages]},n),a=t.choices[0]?.message;if(!a)throw new Kn("missing message in ChatCompletion response");if(!a.tool_calls?.length)return;for(const e of a.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:o}=e.function,a=u[n];if(!a){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}if(s&&s!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(s)} requested. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}let i;try{i=_o(a)?await a.parse(o):o}catch(e){const n=e instanceof Error?e.message:String(e);this._addMessage({role:r,tool_call_id:t,content:n});continue}const l=await a.function(i,this),c=la(this,ea,"m",sa).call(this,l);if(this._addMessage({role:r,tool_call_id:t,content:c}),s)return}}}}ea=new WeakSet,ta=function(){return la(this,ea,"m",na).call(this).content??null},na=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(jo(t)){const{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new Kn("stream ended without producing a ChatCompletionMessage with role=assistant")},ra=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(jo(t)&&t?.function_call)return t.function_call;if(jo(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},oa=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Fo(t)&&null!=t.content)return t.content;if(To(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},aa=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},ia=function(e){if(null!=e.n&&e.n>1)throw new Kn("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},sa=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class da extends ua{static runFunctions(e,t,n){const r=new da,o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,o))),r}static runTools(e,t,n){const r=new da,o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,o))),r}_addMessage(e,t=!0){super._addMessage(e,t),jo(e)&&e.content&&this._emit("content",e.content)}}const pa=1,fa=2,ga=4,ha=8,ma=16,ya=32,xa=64,va=128,ba=256,wa=511;class Sa extends Error{}class Ca extends Error{}const ka=(e,t)=>{const n=e.length;let r=0;const o=e=>{throw new Sa(`${e} at position ${r}`)},a=e=>{throw new Ca(`${e} at position ${r}`)},i=()=>(d(),r>=n&&o("Unexpected end of input"),'"'===e[r]?s():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||ma&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||ya&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||ya&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||va&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||ba&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||xa&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const i=r;let s=!1;for(r++;r<n&&('"'!==e[r]||s&&"\\"===e[r-1]);)s="\\"===e[r]&&!s,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(i,++r-Number(s)))}catch(e){a(String(e))}else if(pa&t)try{return JSON.parse(e.substring(i,r-Number(s))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},l=()=>{r++,d();const a={};try{for(;"}"!==e[r];){if(d(),r>=n&&ha&t)return a;const o=s();d(),r++;try{const e=i();Object.defineProperty(a,o,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(ha&t)return a;throw e}d(),","===e[r]&&r++}}catch(e){if(ha&t)return a;o("Expected '}' at end of object")}return r++,a},c=()=>{r++;const n=[];try{for(;"]"!==e[r];)n.push(i()),d(),","===e[r]&&r++}catch(e){if(ga&t)return n;o("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&fa&t&&o("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(fa&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}a(String(n))}}const i=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||fa&t||o("Unterminated number literal");try{return JSON.parse(e.substring(i,r))}catch(n){"-"===e.substring(i,r)&&fa&t&&o("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){a(String(e))}}},d=()=>{for(;r<n&&" \n\r\t".includes(e[r]);)r++};return i()},Ea=e=>function(e,t=wa){if("string"!=typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return ka(e.trim(),t)}(e,wa^fa);var Ia,Aa,_a,ja,Fa,Ta,Pa,Ra,Ba,Oa,za,La,Na=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Da=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ma extends ua{constructor(e){super(),Ia.add(this),Aa.set(this,void 0),_a.set(this,void 0),ja.set(this,void 0),Na(this,Aa,e,"f"),Na(this,_a,[],"f")}get currentChatCompletionSnapshot(){return Da(this,ja,"f")}static fromReadableStream(e){const t=new Ma(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const r=new Ma(t);return r._run((()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Da(this,Ia,"m",Fa).call(this);const o=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of o)Da(this,Ia,"m",Pa).call(this,e);if(o.controller.signal?.aborted)throw new Jn;return this._addChatCompletion(Da(this,Ia,"m",Oa).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),Da(this,Ia,"m",Fa).call(this),this._connected();const r=ur.fromReadableStream(e,this.controller);let o;for await(const e of r)o&&o!==e.id&&this._addChatCompletion(Da(this,Ia,"m",Oa).call(this)),Da(this,Ia,"m",Pa).call(this,e),o=e.id;if(r.controller.signal?.aborted)throw new Jn;return this._addChatCompletion(Da(this,Ia,"m",Oa).call(this))}[(Aa=new WeakMap,_a=new WeakMap,ja=new WeakMap,Ia=new WeakSet,Fa=function(){this.ended||Na(this,ja,void 0,"f")},Ta=function(e){let t=Da(this,_a,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Da(this,_a,"f")[e.index]=t,t)},Pa=function(e){if(this.ended)return;const t=Da(this,Ia,"m",La).call(this,e);this._emit("chunk",e,t);for(const n of e.choices){const e=t.choices[n.index];null!=n.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),null!=n.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const r=Da(this,Ia,"m",Ta).call(this,e);e.finish_reason&&(Da(this,Ia,"m",Ba).call(this,e),null!=r.current_tool_call_index&&Da(this,Ia,"m",Ra).call(this,e,r.current_tool_call_index));for(const t of n.delta.tool_calls??[])r.current_tool_call_index!==t.index&&(Da(this,Ia,"m",Ba).call(this,e),null!=r.current_tool_call_index&&Da(this,Ia,"m",Ra).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(const t of n.delta.tool_calls??[]){const n=e.message.tool_calls?.[t.index];n?.type&&("function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}))}}},Ra=function(e,t){if(Da(this,Ia,"m",Ta).call(this,e).done_tool_calls.has(t))return;const n=e.message.tool_calls?.[t];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const e=Da(this,Aa,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:t,arguments:n.function.arguments,parsed_arguments:Qo(e)?e.$parseRaw(n.function.arguments):e?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},Ba=function(e){const t=Da(this,Ia,"m",Ta).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const n=Da(this,Ia,"m",za).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},Oa=function(){if(this.ended)throw new Kn("stream has ended, this shouldn't happen");const e=Da(this,ja,"f");if(!e)throw new Kn("request ended without sending any chunks");return Na(this,ja,void 0,"f"),Na(this,_a,[],"f"),function(e,t){const{id:n,choices:r,created:o,model:a,system_fingerprint:i,...s}=e,l={...s,id:n,choices:r.map((({message:t,finish_reason:n,index:r,logprobs:o,...a})=>{if(!n)throw new Kn(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:s,tool_calls:l,...c}=t,u=t.role;if(!u)throw new Kn(`missing role for choice ${r}`);if(s){const{arguments:e,name:l}=s;if(null==e)throw new Kn(`missing function_call.arguments for choice ${r}`);if(!l)throw new Kn(`missing function_call.name for choice ${r}`);return{...a,message:{content:i,function_call:{arguments:e,name:l},role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:o}}return l?{...a,index:r,finish_reason:n,logprobs:o,message:{...c,role:u,content:i,refusal:t.refusal??null,tool_calls:l.map(((t,n)=>{const{function:o,type:a,id:i,...s}=t,{arguments:l,name:c,...u}=o||{};if(null==i)throw new Kn(`missing choices[${r}].tool_calls[${n}].id\n${Ua(e)}`);if(null==a)throw new Kn(`missing choices[${r}].tool_calls[${n}].type\n${Ua(e)}`);if(null==c)throw new Kn(`missing choices[${r}].tool_calls[${n}].function.name\n${Ua(e)}`);if(null==l)throw new Kn(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Ua(e)}`);return{...s,id:i,type:a,function:{...u,name:c,arguments:l}}}))}}:{...a,message:{...c,content:i,role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:o}})),created:o,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(e,t){return t&&Zo(t)?Jo(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,tool_calls:e.message.tool_calls??[]}})))}}(l,t)}(e,Da(this,Aa,"f"))},za=function(){const e=Da(this,Aa,"f")?.response_format;return Ko(e)?e:null},La=function(e){var t,n,r,o;let a=Da(this,ja,"f");const{choices:i,...s}=e;a?Object.assign(a,s):a=Na(this,ja,{...s,choices:[]},"f");for(const{delta:i,finish_reason:s,index:l,logprobs:c=null,...u}of e.choices){let e=a.choices[l];if(e||(e=a.choices[l]={finish_reason:s,index:l,message:{},logprobs:c,...u}),c)if(e.logprobs){const{content:r,refusal:o,...a}=c;Object.assign(e.logprobs,a),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),o&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...o))}else e.logprobs=Object.assign({},c);if(s&&(e.finish_reason=s,Da(this,Aa,"f")&&Zo(Da(this,Aa,"f")))){if("length"===s)throw new sr;if("content_filter"===s)throw new lr}if(Object.assign(e,u),!i)continue;const{content:d,refusal:p,function_call:f,role:g,tool_calls:h,...m}=i;if(Object.assign(e.message,m),p&&(e.message.refusal=(e.message.refusal||"")+p),g&&(e.message.role=g),f&&(e.message.function_call?(f.name&&(e.message.function_call.name=f.name),f.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=f.arguments)):e.message.function_call=f),d&&(e.message.content=(e.message.content||"")+d,!e.message.refusal&&Da(this,Ia,"m",za).call(this)&&(e.message.parsed=Ea(e.message.content))),h){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:n,type:r,function:a,...i}of h){const s=(o=e.message.tool_calls)[t]??(o[t]={});Object.assign(s,i),n&&(s.id=n),r&&(s.type=r),a&&(s.function??(s.function={name:a.name??"",arguments:""})),a?.name&&(s.function.name=a.name),a?.arguments&&(s.function.arguments+=a.arguments,Yo(Da(this,Aa,"f"),s)&&(s.function.parsed_arguments=Ea(s.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ur(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ua(e){return JSON.stringify(e)}class qa extends Ma{static fromReadableStream(e){const t=new qa(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const r=new qa(null),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,o))),r}static runTools(e,t,n){const r=new qa(t),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,o))),r}}class Wa extends no{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new Kn(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new Kn(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>Jo(t,e)))}runFunctions(e,t){return e.stream?qa.runFunctions(this._client,e,t):da.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?qa.runTools(this._client,e,t):da.runTools(this._client,e,t)}stream(e,t){return Ma.createChatCompletion(this._client,e,t)}}class $a extends no{constructor(){super(...arguments),this.completions=new Wa(this._client)}}!function(e){e.Completions=Wa}($a||($a={}));var Ga,Va,Ha,Ka,Qa,Ja,Xa,Ya,Za,ei,ti,ni,ri,oi,ai,ii,si,li,ci,ui,di,pi,fi=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},gi=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n};class hi extends Ho{constructor(){super(...arguments),Ga.add(this),Va.set(this,[]),Ha.set(this,{}),Ka.set(this,{}),Qa.set(this,void 0),Ja.set(this,void 0),Xa.set(this,void 0),Ya.set(this,void 0),Za.set(this,void 0),ei.set(this,void 0),ti.set(this,void 0),ni.set(this,void 0),ri.set(this,void 0)}[(Va=new WeakMap,Ha=new WeakMap,Ka=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,Za=new WeakMap,ei=new WeakMap,ti=new WeakMap,ni=new WeakMap,ri=new WeakMap,Ga=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new hi;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=ur.fromReadableStream(e,this.controller);for await(const e of r)fi(this,Ga,"m",oi).call(this,e);if(r.controller.signal?.aborted)throw new Jn;return this._addRun(fi(this,Ga,"m",ai).call(this))}toReadableStream(){return new ur(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,o){const a=new hi;return a._run((()=>a._runToolAssistantStream(e,t,n,r,{...o,headers:{...o?.headers,"X-Stainless-Helper-Method":"stream"}}))),a}async _createToolAssistantStream(e,t,n,r,o){const a=o?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(()=>this.controller.abort())));const i={...r,stream:!0},s=await e.submitToolOutputs(t,n,i,{...o,signal:this.controller.signal});this._connected();for await(const e of s)fi(this,Ga,"m",oi).call(this,e);if(s.controller.signal?.aborted)throw new Jn;return this._addRun(fi(this,Ga,"m",ai).call(this))}static createThreadAssistantStream(e,t,n){const r=new hi;return r._run((()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(e,t,n,r){const o=new hi;return o._run((()=>o._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}currentEvent(){return fi(this,ti,"f")}currentRun(){return fi(this,ni,"f")}currentMessageSnapshot(){return fi(this,Qa,"f")}currentRunStepSnapshot(){return fi(this,ri,"f")}async finalRunSteps(){return await this.done(),Object.values(fi(this,Ha,"f"))}async finalMessages(){return await this.done(),Object.values(fi(this,Ka,"f"))}async finalRun(){if(await this.done(),!fi(this,Ja,"f"))throw Error("Final run was not received.");return fi(this,Ja,"f")}async _createThreadAssistantStream(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const o={...t,stream:!0},a=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(const e of a)fi(this,Ga,"m",oi).call(this,e);if(a.controller.signal?.aborted)throw new Jn;return this._addRun(fi(this,Ga,"m",ai).call(this))}async _createAssistantStream(e,t,n,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const a={...n,stream:!0},i=await e.create(t,a,{...r,signal:this.controller.signal});this._connected();for await(const e of i)fi(this,Ga,"m",oi).call(this,e);if(i.controller.signal?.aborted)throw new Jn;return this._addRun(fi(this,Ga,"m",ai).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null!=t)if("index"!==n&&"type"!==n){if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else{if(!to(t)||!to(r)){if(Array.isArray(t)&&Array.isArray(r)){if(t.every((e=>"string"==typeof e||"number"==typeof e))){t.push(...r);continue}for(const e of r){if(!to(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const n=e.index;if(null==n)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`)}t=this.accumulateDelta(t,r)}e[n]=t}else e[n]=r;else e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,o){return await this._createToolAssistantStream(n,e,t,r,o)}}oi=function(e){if(!this.ended)switch(gi(this,ti,e,"f"),fi(this,Ga,"m",li).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":fi(this,Ga,"m",pi).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":fi(this,Ga,"m",si).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":fi(this,Ga,"m",ii).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ai=function(){if(this.ended)throw new Kn("stream has ended, this shouldn't happen");if(!fi(this,Ja,"f"))throw Error("Final run has not been received");return fi(this,Ja,"f")},ii=function(e){const[t,n]=fi(this,Ga,"m",ui).call(this,e,fi(this,Qa,"f"));gi(this,Qa,t,"f"),fi(this,Ka,"f")[t.id]=t;for(const e of n){const n=t.content[e.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,r.text)}if(n.index!=fi(this,Xa,"f")){if(fi(this,Ya,"f"))switch(fi(this,Ya,"f").type){case"text":this._emit("textDone",fi(this,Ya,"f").text,fi(this,Qa,"f"));break;case"image_file":this._emit("imageFileDone",fi(this,Ya,"f").image_file,fi(this,Qa,"f"))}gi(this,Xa,n.index,"f")}gi(this,Ya,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==fi(this,Xa,"f")){const t=e.data.content[fi(this,Xa,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,fi(this,Qa,"f"));break;case"text":this._emit("textDone",t.text,fi(this,Qa,"f"))}}fi(this,Qa,"f")&&this._emit("messageDone",e.data),gi(this,Qa,void 0,"f")}},si=function(e){const t=fi(this,Ga,"m",ci).call(this,e);switch(gi(this,ri,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==fi(this,Za,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(fi(this,ei,"f")&&this._emit("toolCallDone",fi(this,ei,"f")),gi(this,Za,e.index,"f"),gi(this,ei,t.step_details.tool_calls[e.index],"f"),fi(this,ei,"f")&&this._emit("toolCallCreated",fi(this,ei,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":gi(this,ri,void 0,"f");"tool_calls"==e.data.step_details.type&&fi(this,ei,"f")&&(this._emit("toolCallDone",fi(this,ei,"f")),gi(this,ei,void 0,"f")),this._emit("runStepDone",e.data,t)}},li=function(e){fi(this,Va,"f").push(e),this._emit("event",e)},ci=function(e){switch(e.event){case"thread.run.step.created":return fi(this,Ha,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=fi(this,Ha,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=hi.accumulateDelta(t,n.delta);fi(this,Ha,"f")[e.data.id]=r}return fi(this,Ha,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":fi(this,Ha,"f")[e.data.id]=e.data}if(fi(this,Ha,"f")[e.data.id])return fi(this,Ha,"f")[e.data.id];throw new Error("No snapshot available")},ui=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=fi(this,Ga,"m",di).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},di=function(e,t){return hi.accumulateDelta(t,e)},pi=function(e){switch(gi(this,ni,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":gi(this,Ja,e.data,"f"),fi(this,ei,"f")&&(this._emit("toolCallDone",fi(this,ei,"f")),gi(this,ei,void 0,"f"))}};class mi extends no{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return zr(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,yi,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class yi extends lo{}mi.MessagesPage=yi;class xi extends no{retrieve(e,t,n,r={},o){return zr(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...o,headers:{"OpenAI-Beta":"assistants=v2",...o?.headers}})}list(e,t,n={},r){return zr(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,vi,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class vi extends lo{}xi.RunStepsPage=vi;class bi extends no{constructor(){super(...arguments),this.steps=new xi(this._client)}create(e,t,n){const{include:r,...o}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:o,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return zr(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,wi,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return hi.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:a}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Gr(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,t,n){return hi.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const o=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,o.id,r)}submitToolOutputsStream(e,t,n,r){return hi.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class wi extends lo{}bi.RunsPage=wi,bi.Steps=xi,bi.RunStepsPage=vi;class Si extends no{constructor(){super(...arguments),this.runs=new bi(this._client),this.messages=new mi(this._client)}create(e={},t){return zr(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return hi.createThreadAssistantStream(e,this._client.beta.threads,t)}}Si.Runs=bi,Si.RunsPage=wi,Si.Messages=mi,Si.MessagesPage=yi;class Ci extends no{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},n){return zr(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,ki,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const o=await this.retrieve(e,t,{...n,headers:r}).withResponse(),a=o.data;switch(a.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Gr(e);break;case"failed":case"completed":return a}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}}class ki extends lo{}Ci.VectorStoreFilesPage=ki;class Ei extends no{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return zr(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,ki,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:a}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(o.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Gr(e);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=r?.maxConcurrency??5,a=Math.min(o,t.length),i=this._client,s=t.values(),l=[...n];const c=Array(a).fill(s).map((async function(e){for(let t of e){const e=await i.files.create({file:t,purpose:"assistants"},r);l.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)console.error(e.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const e of t)"fulfilled"===e.status&&r.push(e.value);return r})(c),await this.createAndPoll(e,{file_ids:l})}}class Ii extends no{constructor(){super(...arguments),this.files=new Ci(this._client),this.fileBatches=new Ei(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return zr(e)?this.list({},e):this._client.getAPIList("/vector_stores",Ai,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Ai extends lo{}Ii.VectorStoresPage=Ai,Ii.Files=Ci,Ii.VectorStoreFilesPage=ki,Ii.FileBatches=Ei;class _i extends no{constructor(){super(...arguments),this.vectorStores=new Ii(this._client),this.chat=new $a(this._client),this.assistants=new Io(this._client),this.threads=new Si(this._client)}}_i.VectorStores=Ii,_i.VectorStoresPage=Ai,_i.Assistants=Io,_i.AssistantsPage=Ao,_i.Threads=Si;class ji extends no{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return zr(e)?this.list({},e):this._client.getAPIList("/batches",Fi,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Fi extends lo{}ji.BatchesPage=Fi;class Ti extends no{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Sr({body:t,...n}))}}class Pi extends no{constructor(){super(...arguments),this.parts=new Ti(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}var Ri;Pi.Parts=Ti;class Bi extends Tr{constructor({baseURL:e=Kr("OPENAI_BASE_URL"),apiKey:t=Kr("OPENAI_API_KEY"),organization:n=Kr("OPENAI_ORG_ID")??null,project:r=Kr("OPENAI_PROJECT_ID")??null,...o}={}){if(void 0===t)throw new Kn("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:n,project:r,...o,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new Kn("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new ro(this),this.chat=new ao(this),this.embeddings=new io(this),this.files=new co(this),this.images=new po(this),this.audio=new mo(this),this.moderations=new yo(this),this.models=new xo(this),this.fineTuning=new Eo(this),this.beta=new _i(this),this.batches=new ji(this),this.uploads=new Pi(this),this._options=a,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Tn(e,{arrayFormat:"brackets"})}}Ri=Bi,Bi.OpenAI=Ri,Bi.DEFAULT_TIMEOUT=6e5,Bi.OpenAIError=Kn,Bi.APIError=Qn,Bi.APIConnectionError=Xn,Bi.APIConnectionTimeoutError=Yn,Bi.APIUserAbortError=Jn,Bi.NotFoundError=nr,Bi.ConflictError=rr,Bi.RateLimitError=ar,Bi.BadRequestError=Zn,Bi.AuthenticationError=er,Bi.InternalServerError=ir,Bi.PermissionDeniedError=tr,Bi.UnprocessableEntityError=or,Bi.toFile=xr,Bi.fileFromPath=Mn;Bi.Completions=ro,Bi.Chat=ao,Bi.Embeddings=io,Bi.Files=co,Bi.FileObjectsPage=uo,Bi.Images=po,Bi.Audio=mo,Bi.Moderations=yo,Bi.Models=xo,Bi.ModelsPage=vo,Bi.FineTuning=Eo,Bi.Beta=_i,Bi.Batches=ji,Bi.BatchesPage=Fi,Bi.Uploads=Pi;new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var Oi=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},zi=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function Li(e,t,n,r,o){return void 0===o&&(o=""),Oi(this,void 0,void 0,(function(){var e,a,i,s,l;return zi(this,(function(c){switch(c.label){case 0:if(console.log("getImage called with description:",r),e=null,a=null,!r)throw new Error("Cannot generate image: missing description");if(!n)throw new Error("Cannot generate image: no OpenAI API key provided. Please check your settings.");c.label=1;case 1:return c.trys.push([1,7,,8]),console.log("Using OpenAI with key:",n?n.substring(0,5)+"...":"null"),[4,rt(t,n,r,o)];case 2:if(e=c.sent(),console.log("OpenAI returned URL:",e?"success":"null"),!e)return[3,6];c.label=3;case 3:return c.trys.push([3,5,,6]),console.log("Converting image URL to base64 for permanent storage..."),[4,te(e)];case 4:return a=c.sent(),console.log("Image URL converted to base64:",a?"success":"null"),a?console.log(" Image successfully converted to base64 - keeping both URL and base64 for reliability"):console.warn(" Failed to convert image to base64 - keeping temporary URL as fallback"),[3,6];case 5:return i=c.sent(),console.error(" Error converting URL to base64:",i),console.warn(" Will use temporary URL as fallback, but it may disappear later"),[3,6];case 6:return[3,8];case 7:throw s=c.sent(),console.error("OpenAI image generation error:",s),s instanceof Error?s:new Error("Failed to generate image with OpenAI. Please check your API key and try again.");case 8:if(!e&&!a)throw new Error("Failed to generate image. Please check your API key and try again.");return l=a?null:e,console.log("Final result:",{hasBase64:!!a,hasUrl:!!l,status:a?"Base64 (permanent)":l?"URL only (temporary)":"No image"}),[2,{imageUrl:l,imageBase64:a}]}}))}))}var Ni=function(){return Ni=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ni.apply(this,arguments)};const Di=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],o=(0,r.useState)("error"),i=o[0],s=o[1],l=(0,r.useState)(!1),c=l[0],u=l[1],d=(0,r.useState)(!1),p=d[0],f=d[1],g=function(){f(!1),setTimeout((function(){u(!1),n(null)}),300)};return{showError:function(e,t){void 0===t&&(t="error"),console.log("showError called:",{message:e,errorType:t,visible:c,isAnimating:p}),e?(n(e),s(t),u(!0),setTimeout((function(){f(!0)}),50),setTimeout((function(){g()}),5e3)):g()},renderErrorNotification:function(){if(console.log("renderErrorNotification called:",{visible:c,error:t,isAnimating:p,type:i}),!c||!t)return null;var e,n=function(){switch(i){case"success":return{icon:(0,a.jsx)(Ft,{size:16}),color:"#059669",bgColor:"#ECFDF5",borderColor:"#10B981"};case"warning":return{icon:(0,a.jsx)(qt,{size:16}),color:"#D97706",bgColor:"#FFFBEB",borderColor:"#F59E0B"};case"info":return{icon:(0,a.jsx)(Vt,{size:16}),color:"#2563EB",bgColor:"#EFF6FF",borderColor:"#3B82F6"};default:return{icon:(0,a.jsx)(nn,{size:16}),color:"#DC2626",bgColor:"#FEF2F2",borderColor:"#EF4444"}}}(),r=n.icon,o=n.color,s=n.bgColor,l=n.borderColor,u=(e=t).includes("401")||e.includes("Unauthorized")||e.includes("Authentication")?"API Authentication failed: Please check your API key in Settings.":e.includes("429")||e.includes("Rate limit")?"API rate limit exceeded: Please try again in a few minutes.":e.includes("500")||e.includes("502")||e.includes("503")||e.includes("504")?"AI service is currently unavailable. Please try again later.":e.includes("key is missing")||e.includes("API key")?"API key is missing or invalid. Please check your settings.":e.includes("OpenAI")?"OpenAI API error: ".concat(e.split("OpenAI").pop()):e.includes("Groq")?"Groq API error: ".concat(e.split("Groq").pop()):e;return(0,a.jsxs)("div",Ni({style:{transform:p?"translateX(0)":"translateX(100%)",opacity:p?1:0,transition:"all 0.3s ease-out",backgroundColor:s,border:"1px solid ".concat(l),borderRadius:"12px",padding:"16px",minWidth:"280px",maxWidth:"320px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative",display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"8px"},role:"alert","aria-live":"polite"},{children:[(0,a.jsx)("div",Ni({style:{color:o,marginTop:"2px",flexShrink:0}},{children:r})),(0,a.jsx)("div",Ni({style:{flex:1,paddingRight:"8px"}},{children:(0,a.jsx)("p",Ni({style:{color:"#374151",margin:0,fontSize:"14px",lineHeight:"1.5",fontWeight:500}},{children:u}))})),(0,a.jsx)("button",Ni({onClick:g,style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",color:"#9CA3AF",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="rgba(0, 0, 0, 0.1)",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9CA3AF"},"aria-label":"Close notification"},{children:(0,a.jsx)(rn,{size:12})})),(0,a.jsx)("div",Ni({style:{position:"absolute",bottom:0,left:0,right:0,height:"3px",backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"0 0 12px 12px",overflow:"hidden"}},{children:(0,a.jsx)("div",{style:{height:"100%",backgroundColor:l,width:"100%",transition:"width 5s linear",transformOrigin:"left"}})}))]}))}}};var Mi=function(){return Mi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Mi.apply(this,arguments)},Ui=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},qi="anki_stored_cards",Wi="anki_tab_cards",$i=function(e){try{return e.startsWith("data:image/")&&e.length>1e5?(console.log("Large image detected, applying basic compression"),console.warn("Large image (".concat(Math.round(e.length/1024),"KB) detected. Consider using smaller images.")),e):e}catch(t){return console.error("Error compressing image:",t),e}},Gi=function(e){try{var t=JSON.stringify(e,(function(e,t){return t instanceof Date?t.toISOString():t})),n=new Blob([t]).size/1048576;if(console.log("Storage analysis: ".concat(e.length," cards, ").concat(n.toFixed(2),"MB")),n<4)return e;console.warn("Storage size is large, optimizing...");for(var r=Ui([],e,!0).sort((function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()})),o=[],a=0,i=0,s=r;i<s.length;i++){var l=s[i],c=JSON.stringify(l,(function(e,t){return t instanceof Date?t.toISOString():t})),u=new Blob([c]).size;if(a+u>4194304){console.warn("Stopping at ".concat(o.length," cards to stay within storage limit"));break}o.push(l),a+=u}return o}catch(t){return console.error("Error managing storage quota:",t),e}},Vi=function(){console.warn(" Storage quota exceeded! This usually happens when you have many cards with large images."),console.warn(" To fix this:"),console.warn("    Use smaller images"),console.warn("    Export older cards and delete them"),console.warn("    Consider using image URLs instead of embedded images")},Hi=function(){try{var e=localStorage.getItem(qi);if(console.log("Loading cards from localStorage. Data exists:",!!e),e)try{var t=JSON.parse(e);if(console.log("Successfully parsed cards from localStorage, total count:",t.length),t.length>0){var n=t.slice(0,Math.min(3,t.length)),r=t.length>3?t.slice(-3):[];console.log("First few cards:",n.map((function(e){var t;return{id:e.id,text:null===(t=e.text)||void 0===t?void 0:t.substring(0,20)}}))),r.length>0&&console.log("Last few cards:",r.map((function(e){var t;return{id:e.id,text:null===(t=e.text)||void 0===t?void 0:t.substring(0,20)}})))}if(!Array.isArray(t))return console.error("Stored cards is not an array!",t),[];var o=t.filter((function(e){var t=!!e.id,n=!!e.text,r=!!e.createdAt;return!!(t&&n&&r)||(console.warn("Found invalid card, removing from results:",e),!1)}));console.log("Card validation: ".concat(o.length," valid out of ").concat(t.length," total"));var a=o.map((function(e){return Mi(Mi({},e),{createdAt:new Date(e.createdAt)})})),i=a.filter((function(e){return e.image||e.imageUrl}));return console.log("Loaded cards with images:",i.length),i.forEach((function(e){var t,n,r,o;console.log("Loaded card ".concat(e.id," image data:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)})})),a}catch(e){return console.error("JSON parse error:",e),localStorage.removeItem(qi),[]}}catch(e){console.error("Error loading cards from localStorage:",e);try{localStorage.removeItem(qi)}catch(e){console.error("Could not clean up localStorage:",e)}}return[]},Ki=function(e,t,n){var r="".concat(Wi,"_").concat(e);try{var o=JSON.stringify(t,(function(e,t){return t instanceof Date?t.toISOString():t}));new Blob([o]).size}catch(e){console.error("Could not determine original size:",e)}if(n instanceof DOMException&&("QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)){console.error("localStorage quota exceeded for tab ".concat(e,". Using storage optimization.")),Vi();var a=Gi(t);try{var i=JSON.stringify(a,(function(e,t){return t instanceof Date?t.toISOString():t}));localStorage.setItem(r,i),console.warn("Smart optimization for tab ".concat(e,": Saved ").concat(a.length," of ").concat(t.length," cards"))}catch(t){console.error("Failed to save optimized cards for tab ".concat(e,":"),t)}}};const Qi=function(e){return function(t){return function(n){var r=t(n);switch(n.type){case ge:try{var o=Hi();e.dispatch({type:"SET_STORED_CARDS",payload:o})}catch(t){console.error("Error in LOAD_STORED_CARDS middleware:",t),e.dispatch({type:"SET_STORED_CARDS",payload:[]})}break;case fe:case he:case xe:case ye:try{!function(e){try{console.log("Saving cards to localStorage:",e),console.log("Total cards count:",e.length);var t=e.filter((function(e){return e.image||e.imageUrl}));console.log("Cards with images:",t.length),t.forEach((function(e){var t,n,r,o;console.log("Card ".concat(e.id," image data:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)})}));var n=Gi(e);n.length<e.length&&console.warn("Storage optimization: keeping ".concat(n.length," of ").concat(e.length," cards to preserve images"));var r=JSON.stringify(n,(function(e,t){return t instanceof Date?t.toISOString():t})),o=new Blob([r]).size;console.log("Storage size in bytes:",o,"Approximate max size: ~5MB"),o>4194304&&console.warn("Warning: localStorage size is getting large (>4MB). This might cause issues in some browsers."),localStorage.setItem(qi,r),console.log("Cards saved successfully to localStorage with image preservation")}catch(t){console.error("Error saving cards to localStorage:",t);var a=0;try{var i=JSON.stringify(e,(function(e,t){return t instanceof Date?t.toISOString():t}));a=new Blob([i]).size}catch(e){console.error("Could not determine original size:",e)}if(t instanceof DOMException&&("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&(console.error("localStorage quota exceeded. Cannot save more cards. Trying to preserve images by using other strategies."),Vi(),e.length>0)){console.warn("CRITICAL: Storage quota exceeded. Attempting to preserve images while managing storage.");try{console.warn("Storage quota exceeded. Using intelligent optimization to preserve images...");var s=Gi(e);if(s.length>0){var l=JSON.stringify(s,(function(e,t){return t instanceof Date?t.toISOString():t}));if(new Blob([l]).size<=4718592)return localStorage.setItem(qi,l),void console.warn("Smart optimization: Saved ".concat(s.length," of ").concat(e.length," cards with images preserved"))}var c=e.map((function(e){return Mi(Mi({},e),{image:e.image?$i(e.image):null,id:e.id,text:e.text,translation:e.translation,front:e.front,back:e.back,examples:e.examples,imageUrl:e.imageUrl,createdAt:e.createdAt,exportStatus:e.exportStatus,linguisticInfo:e.linguisticInfo,transcription:e.transcription})}));console.warn("Attempting to save cards with compressed images instead of removing them.");var u=JSON.stringify(c,(function(e,t){return t instanceof Date?t.toISOString():t})),d=new Blob([u]).size;if(console.log("Reduced size from ".concat(a," to ").concat(d," bytes")),d>4718592){console.warn("Still too large after size reduction, falling back to limiting card count");for(var p=Ui([],c,!0).sort((function(e,t){return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()})),f=Math.min(10,p.length),g=void 0;f<p.length;){g=p.slice(0,f);var h=JSON.stringify(g,(function(e,t){return t instanceof Date?t.toISOString():t}));if(new Blob([h]).size>4718592)break;f+=5}console.warn("Emergency preservation: keeping ".concat(f," cards out of ").concat(p.length," total (removing oldest to preserve newest with images)"));var m=p.slice(-f);localStorage.setItem(qi,JSON.stringify(m,(function(e,t){return t instanceof Date?t.toISOString():t})))}else localStorage.setItem(qi,u);return void console.log("Saved cards with image preservation strategy to fit within quota")}catch(e){console.error("Failed to save with data reduction:",e)}}}}(e.getState().cards.storedCards)}catch(e){console.error("Error in card storage middleware:",e)}break;case P:case R:case z:case O:try{var a=e.getState().tabState.tabStates,i=n.payload.tabId;if(i&&a[i])!function(e,t){try{var n="".concat(Wi,"_").concat(e);console.log("Saving ".concat(t.length," cards for tab ").concat(e));var r=Gi(t),o=JSON.stringify(r,(function(e,t){return t instanceof Date?t.toISOString():t}));localStorage.setItem(n,o),console.log("Successfully saved ".concat(r.length," cards for tab ").concat(e))}catch(n){console.error("Error saving cards for tab ".concat(e,":"),n),Ki(e,t,n)}}(i,a[i].storedCards)}catch(e){console.error("Error in tab storage middleware:",e)}break;case ve:n.payload?localStorage.setItem("current_card_id",n.payload):(localStorage.removeItem("current_card_id"),localStorage.removeItem("explicitly_saved"));break;case ie:0===e.getState().cards.storedCards.length&&e.dispatch({type:ge})}return r}}};var Ji,Xi=function(){return Xi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xi.apply(this,arguments)};!function(e){e.OpenAI="openai",e.Groq="groq"}(Ji||(Ji={}));var Yi,Zi={openAiKey:"",mode:_.LanguageLearning,translateToLanguage:"ru",ankiConnectUrl:"http://127.0.0.1:8765",ankiConnectApiKey:null,useAnkiConnect:!1,visibleSideBar:!0,groqApiKey:"",groqModelName:"llama3-8b-8192",shouldGenerateImage:!0,imageGenerationMode:"smart",translationPrompt:"",examplesPrompt:"",aiInstructions:"",imageInstructions:"",modelProvider:Ji.OpenAI,sourceLanguage:"en"},es=function(e,t,n){var r="".concat(e," - ");return r+=401===t?"Authentication error. Please check your API key.":429===t?"Rate limit exceeded. Please try again later.":500===t||503===t?"Service unavailable. The model might be overloaded or offline.":400===t?"Bad request. The input may be invalid.":"Error code ".concat(t,". ").concat(ts(n))},ts=function(e){if(!e)return"Unknown error";if(e.error){if("string"==typeof e.error)return e.error;if(e.error.message)return e.error.message;if(e.error.type)return"Error type: ".concat(e.error.type)}if(e.message)return e.message;try{return JSON.stringify(e)}catch(e){return"Unable to parse error details"}},ns=(Yi=function(e,t){return Yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Yi(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Yi(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),rs=function(){return rs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},rs.apply(this,arguments)},os=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},as=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},is=function(){function e(e,t){void 0===t&&(t=""),this.apiKey=e,this.modelName=t}return e.prototype.extractPlainText=function(e){if(!e)return null;var t=e.replace(/<\/?[^>]+(>|$)/g,"");return t=t.replace(/^#+\s+/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/```[\s\S]*?```/g,"").replace(/\[(.*?)\]\((.*?)\)/g,"$1").trim()},e.prototype.getPrompts=function(){return{translate:function(e,t){return"Translate the following text to ".concat(t,': "').concat(e,'". \nOutput ONLY the direct translation, without any additional text, explanations, quotes, examples, or formatting.\nProvide the most common and appropriate translation. Only include multiple meanings if the word has distinctly different translations that are equally common.\nIf multiple translations are needed, separate them with commas (e.g., "1, 2, 3").\nDo not include definitions, examples, notes, or part of speech information in English like (noun), (verb), (adjective), etc.\nOnly provide the clean translated word or phrase without any parenthetical information.')},examples:function(e,t){var n=t?"Give me exactly three example sentences using the word '".concat(e,"' in the language with code \"").concat(t,'".'):"Give me exactly three example sentences using the word '".concat(e,"' in its original language.");return"".concat(n,"\nEach sentence should show natural usage of '").concat(e,"' in that language.\nFormat your response as follows:\n1. [First example sentence here]\n2. [Second example sentence here] \n3. [Third example sentence here]\nDo not include definitions, explanations, or translations, ONLY the numbered example sentences as shown above.")},imageDescription:function(e){return'Create a short visual description of the word/concept "'.concat(e,'" for image generation.\nThe description should be concrete, visual, and focus on representational elements.\nKeep the description under 50 words and make sure it is purely descriptive without any formatting.')}}},e.prototype.translateText=function(e,t,n){return void 0===t&&(t="ru"),void 0===n&&(n=""),os(this,void 0,void 0,(function(){var r,o,a,i,s,l,c,u,d,p;return as(this,(function(f){switch(f.label){case 0:r=$e(),o=r.startRequest("Translating text","Converting your text to ".concat(t),"","#3B82F6"),f.label=1;case 1:return f.trys.push([1,3,,4]),r.setInProgress(o),a=this.getPrompts().translate(e,t),i=n?"".concat(a,". ").concat(n):a,[4,this.sendRequest(i)];case 2:return(s=f.sent())?(l=this.extractPlainText(s))&&(l=l.replace(/^translation[:\s-]*/i,"").replace(/^["']|["']$/g,"").replace(/^.*?:\s*/i,"").replace(/^\s*-\s*/,"").replace(/^translated\s*as\s*:?\s*/i,"").replace(/^\s*:?\s*/i,"").replace(/\s*definition:[\s\S]*$/i,"").replace(/\s*examples:[\s\S]*$/i,"").replace(/\s*example:[\s\S]*$/i,"").replace(/\s*example sentences:[\s\S]*$/i,"").replace(/\s*:[\s\S]*$/i,"").replace(/\s*:[\s\S]*$/i,"").replace(/\s*notes:[\s\S]*$/i,"").replace(/\s*:[\s\S]*$/i,"").replace(/\s*here is the response[\s\S]*$/i,"").replace(/\s*\(adjective\)[\s\S]*$/i,"").replace(/\s*\(noun\)[\s\S]*$/i,"").replace(/\s*\(verb\)[\s\S]*$/i,"").replace(/\s*\(adverb\)[\s\S]*$/i,"").replace(/\s*\(preposition\)[\s\S]*$/i,"").replace(/\s*\(pronoun\)[\s\S]*$/i,"").replace(/\s*\(conjunction\)[\s\S]*$/i,"").replace(/\s*\(interjection\)[\s\S]*$/i,"").replace(/\s*\([^)]*\)[\s\S]*$/i,"").replace(/^the word[\s\S]*translated as[\s:]*/i,"").replace(/^[\s\S]* [\s:]*/i,"").replace(/^[\s\S]* [\s:]*/i,"").replace(/^.*?[\s:]*/i,"").replace(/^.*?[\s:]*/i,"").replace(/^.*?means[\s:]*/i,"").replace(/^the translation is[\s:]*/i,"").split("\n")[0].trim(),c=l.split(/\s+/),l.includes(",")?(u=l.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).slice(0,3),l=u.join(", ")):c.length>8&&((d=e.split(/\s+/).length)<=5||c.length<=2*d||(console.log("Translation too long, trimming:",l),l=c.slice(0,8).join(" "))),!l&&s)?[2,s.split("\n")[0].trim()]:(console.log("Original translation:",s),console.log("Cleaned translation:",l),r.completeRequest(o),[2,l]):(r.errorRequest(o),[2,null]);case 3:throw p=f.sent(),console.error("Error during translation:",p),r.errorRequest(o),p;case 4:return[2]}}))}))},e.prototype.getExamples=function(e,t,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=""),os(this,void 0,void 0,(function(){var a,i,s,l,c,u,d,p,f,g,h,m,y,x,v,b,w;return as(this,(function(S){switch(S.label){case 0:a=$e(),i=a.startRequest("Creating example sentences",'Generating helpful examples for "'.concat(e,'"'),"","#F59E0B"),S.label=1;case 1:return S.trys.push([1,10,,11]),a.setInProgress(i),s=this.getPrompts().examples(e,o),l=r?"".concat(s," ").concat(r.replace(/\{word\}/g,e)):s,[4,this.sendRequest(l)];case 2:if(!(c=S.sent()))throw new Error("Failed to generate examples. Please try again with a different word.");for(console.log("Raw examples response:",c),u=this.extractPlainText(c)||"",d=u.replace(/^[\s\S]*?((?:\d+\s*\.\s*|\s*|[\-\*]\s*).+$)/m,"$1").trim(),p=/(?:^|\n)(?:\d+\s*\.\s*|\s*|[\-\*]\s*)(.+?)(?=(?:\n+(?:\d+\s*\.\s*|\s*|[\-\*]\s*)|\n*$))/g,f=[],g=void 0;null!==(g=p.exec(d));)g[1]&&f.push(g[1].trim());0===f.length&&(f=d.split(/\n+/).map((function(e){return e.replace(/^\d+\s*\.\s*|^\s*\s*|^\s*[\-\*]\s*/,"").trim()})).filter((function(t){return t.length>0&&t.toLowerCase().includes(e.toLowerCase())})).slice(0,3)),0===f.length&&(f=d.split(/\n+/).map((function(e){return e.replace(/^\d+\s*\.\s*|^\s*\s*|^\s*[\-\*]\s*/,"").trim()})).filter((function(e){return e.length>0})).slice(0,3)),f=f.map((function(e){return e.replace(/^(example|sentence||)[\s:]*/i,"").replace(/^["']|["']$/g,"")})),console.log("Processed examples:",f),h=[],m=0,y=f,S.label=3;case 3:if(!(m<y.length))return[3,9];if(!(x=y[m]).trim())return[3,8];if(v=null,!n)return[3,7];S.label=4;case 4:return S.trys.push([4,6,,7]),[4,this.translateText(x,t)];case 5:return v=S.sent(),[3,7];case 6:return b=S.sent(),console.error("Error translating example:",b),[3,7];case 7:if(h.push([x,v]),h.length>=3)return[3,9];S.label=8;case 8:return m++,[3,3];case 9:return 0===h.length?(console.warn("No examples were generated, but continuing with card creation"),a.completeRequest(i),[2,[]]):(a.completeRequest(i),[2,h]);case 10:throw w=S.sent(),console.error("Error getting examples:",w),a.errorRequest(i),w;case 11:return[2]}}))}))},e.prototype.getDescriptionImage=function(e,t){return void 0===t&&(t=""),os(this,void 0,void 0,(function(){var n,r,o,a,i,s,l;return as(this,(function(c){switch(c.label){case 0:n=$e(),r=n.startRequest("Crafting image description",'Creating detailed prompt for "'.concat(e,'" visualization'),"","#EC4899"),c.label=1;case 1:return c.trys.push([1,3,,4]),n.setInProgress(r),o=this.getPrompts().imageDescription(e),a=t?"".concat(o," ").concat(t):o,[4,this.sendRequest(a)];case 2:if(!(i=c.sent()))throw n.errorRequest(r),new Error("Failed to generate image description. Please try again.");return s=this.extractPlainText(i),n.completeRequest(r),[2,s||i];case 3:throw l=c.sent(),console.error("Error generating image description:",l),n.errorRequest(r),l;case 4:return[2]}}))}))},e.prototype.generateAnkiFront=function(e){return os(this,void 0,void 0,(function(){var t,n,r,o,a,i;return as(this,(function(s){switch(s.label){case 0:t=$e(),n=t.startRequest("Creating question","Crafting an effective question for your flashcard","","#10B981"),s.label=1;case 1:return s.trys.push([1,3,,4]),t.setInProgress(n),r='For the word or phrase "'.concat(e,'", provide ONLY the word itself without any pronunciation or additional formatting.\nJust return the clean word/phrase as it should appear on the front of an Anki card.\nFor example: if input is "hello", return "hello"\nIf input is "beautiful", return "beautiful"\nYour response should contain ONLY the word/phrase, no pronunciation, no IPA, no additional text.'),[4,this.sendRequest(r)];case 2:return(o=s.sent())?(a=(a=this.extractPlainText(o)||o).split("\n")[0].replace(/^["']|["']$/g,"").replace(/\/.*?\//g,"").replace(/\[.*?\]/g,"").replace(/\(.*?\)/g,"").replace(/^front:[\s:]*/i,"").replace(/^word:[\s:]*/i,"").trim(),console.log("Front card response:",a),t.completeRequest(n),[2,a||e]):(t.errorRequest(n),[2,e]);case 3:return i=s.sent(),console.error("Error generating Anki front:",i),t.errorRequest(n),[2,e];case 4:return[2]}}))}))},e.prototype.createTranscription=function(e,t,n){return os(this,void 0,void 0,(function(){var r,o,a,i,s,l;return as(this,(function(c){switch(c.label){case 0:r=$e(),o=r.startRequest("Creating transcription",'Generating pronunciation for "'.concat(e,'"'),"","#8B5CF6"),c.label=1;case 1:return c.trys.push([1,3,,4]),r.setInProgress(o),a=this.createTranscriptionPrompt(e,t,n),[4,this.sendRequest(a)];case 2:return(i=c.sent())?(s=this.parseTranscriptionResponse(i),r.completeRequest(o),[2,s]):(r.errorRequest(o),[2,null]);case 3:return l=c.sent(),console.error("Error creating transcription:",l),r.errorRequest(o),[2,null];case 4:return[2]}}))}))},e.prototype.createTranscriptionPrompt=function(e,t,n){return'Create transcriptions for the word/phrase "'.concat(e,'" (in ').concat(t,"):\n\n1. User language transcription: Show how to pronounce this word using ").concat(n,' phonetics/script\n2. IPA transcription: International Phonetic Alphabet notation\n\nIMPORTANT:\n- For user language: Write how "').concat(e,'" sounds using ').concat(n," pronunciation system\n- For IPA: Use proper IPA symbols [                 etc.]\n- Format exactly as shown below:\n\nUSER_LANG: [how the word sounds in ").concat(n,']\nIPA: [a.pi.e notation]\n\nExample for Russian "" with Spanish user language:\nUSER_LANG: korotkaya\nIPA: [krotkj]\n\nProvide ONLY the two lines as shown above, no additional text.')},e.prototype.parseTranscriptionResponse=function(e){var t=this.extractPlainText(e)||e,n=null,r=null,o=t.match(/USER_LANG:\s*(.+)/i);o&&(n=o[1].trim());var a=t.match(/IPA:\s*(.+)/i);return a&&(r=a[1].trim().replace(/^\[|\]$/g,"").replace(/^\/|\/$/g,""))&&!r.startsWith("[")&&(r="[".concat(r,"]")),{userLanguageTranscription:n,ipaTranscription:r}},e}(),ss=function(e){function t(t,n){void 0===n&&(n="gpt-5-nano");var r=e.call(this,t,n)||this;return r.openai=new Bi({apiKey:t,dangerouslyAllowBrowser:!0}),r}return ns(t,e),t.prototype.sendRequest=function(e,t){var n,r,o;return void 0===t&&(t={}),os(this,void 0,void 0,(function(){var a,i;return as(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.openai.chat.completions.create(rs({model:this.modelName,messages:[{role:"user",content:e}]},t))];case 1:return a=s.sent(),[2,(null===(o=null===(r=null===(n=a.choices[0])||void 0===n?void 0:n.message)||void 0===r?void 0:r.content)||void 0===o?void 0:o.trim())||null];case 2:throw i=s.sent(),console.error("Error in OpenAI request:",i),i;case 3:return[2]}}))}))},t.prototype.getImageUrl=function(e){var t,n;return os(this,void 0,void 0,(function(){var r,o,a,i,s;return as(this,(function(l){switch(l.label){case 0:r=$e(),o=r.startRequest("Generating image","Creating beautiful illustration with AI","","#6366F1"),l.label=1;case 1:return l.trys.push([1,3,,4]),r.setInProgress(o),[4,this.openai.images.generate({model:"dall-e-3",prompt:e,n:1,size:"1024x1024"})];case 2:return a=l.sent(),(i=(null===(n=null===(t=a.data)||void 0===t?void 0:t[0])||void 0===n?void 0:n.url)||null)?r.completeRequest(o):r.errorRequest(o),[2,i];case 3:throw s=l.sent(),console.error("Error generating image with OpenAI:",s),r.errorRequest(o),s;case 4:return[2]}}))}))},t.prototype.extractKeyTerms=function(e){return os(this,void 0,void 0,(function(){var t,n,r,o;return as(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t="You are a helpful language learning assistant. Extract key terms from the text that would be useful to learn as flashcards. Limit to 5 most important terms max. Return only the terms, one per line, without any additional text or formatting.",[4,this.sendRequest(t,{messages:[{role:"system",content:t},{role:"user",content:e}]})];case 1:return n=a.sent(),(r=n||"")?[2,r.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))]:[2,[]];case 2:return o=a.sent(),console.error("Error extracting key terms with OpenAI:",o),[2,[]];case 3:return[2]}}))}))},t.prototype.createChatCompletion=function(e,t){var n,r,o;return os(this,void 0,void 0,(function(){var e,a,i,s,l,c;return as(this,(function(u){switch(u.label){case 0:e=$e(),a=e.startRequest("Creating grammar reference","Generating detailed grammar and linguistic information","","#9C27B0"),u.label=1;case 1:return u.trys.push([1,3,,4]),e.setInProgress(a),i=t.map((function(e){return{role:e.role,content:e.content}})),[4,this.openai.chat.completions.create({model:this.modelName,messages:i})];case 2:return s=u.sent(),(l=(null===(o=null===(r=null===(n=s.choices[0])||void 0===n?void 0:n.message)||void 0===r?void 0:r.content)||void 0===o?void 0:o.trim())||"")?(e.completeRequest(a),[2,{content:l}]):(e.errorRequest(a),[2,null]);case 3:throw c=u.sent(),console.error("Error in OpenAI chat completion:",c),e.errorRequest(a),c;case 4:return[2]}}))}))},t}(is),ls=function(e){function t(t,n){void 0===n&&(n="llama3-8b-8192");var r=e.call(this,t,n)||this;return r.apiBaseUrl="https://api.groq.com/openai/v1",r}return ns(t,e),t.prototype.sendRequest=function(e,t){var n,r,o,a,i;return void 0===t&&(t={}),os(this,void 0,void 0,(function(){var t,s,l,c;return as(this,(function(u){switch(u.label){case 0:if(u.trys.push([0,5,,6]),!this.apiKey)throw new Error("Groq API key is missing. Please check your settings.");return[4,fetch("".concat(this.apiBaseUrl,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.apiKey)},body:JSON.stringify({model:this.modelName,messages:[{role:"user",content:e}]})})];case 1:return(t=u.sent()).ok?[3,3]:[4,t.json()];case 2:throw s=u.sent(),new Error(es("Groq API Error",t.status,s));case 3:return[4,t.json()];case 4:return l=u.sent(),[2,null!==(i=null===(a=null===(o=null===(r=null===(n=l.choices)||void 0===n?void 0:n[0])||void 0===r?void 0:r.message)||void 0===o?void 0:o.content)||void 0===a?void 0:a.trim())&&void 0!==i?i:null];case 5:throw c=u.sent(),console.error("Error in Groq API request:",c),c;case 6:return[2]}}))}))},t.prototype.getImageUrl=function(){throw new Error("Image generation is not supported by Groq.")},t.prototype.extractKeyTerms=function(e){return os(this,void 0,void 0,(function(){var t,n,r,o;return as(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t="You are a helpful language learning assistant. Extract key terms from the text that would be useful to learn as flashcards. Limit to 5 most important terms max. Return only the terms, one per line, without any additional text or formatting.",[4,this.sendRequest(t,{messages:[{role:"system",content:t},{role:"user",content:e}]})];case 1:return n=a.sent(),(r=n||"")?[2,r.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))]:[2,[]];case 2:return o=a.sent(),console.error("Error extracting key terms with Groq:",o),[2,[]];case 3:return[2]}}))}))},t.prototype.createChatCompletion=function(e,t){var n,r,o,a,i;return os(this,void 0,void 0,(function(){var e,s,l,c,u,d,p;return as(this,(function(f){switch(f.label){case 0:e=$e(),s=e.startRequest("Creating grammar reference","Generating detailed grammar and linguistic information","","#9C27B0"),f.label=1;case 1:if(f.trys.push([1,6,,7]),e.setInProgress(s),!this.apiKey)throw new Error("Groq API key is missing. Please check your settings.");return[4,fetch("".concat(this.apiBaseUrl,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.apiKey)},body:JSON.stringify({model:this.modelName,messages:t})})];case 2:return(l=f.sent()).ok?[3,4]:[4,l.json()];case 3:throw c=f.sent(),new Error(es("Groq API Error",l.status,c));case 4:return[4,l.json()];case 5:return u=f.sent(),(d=null!==(i=null===(a=null===(o=null===(r=null===(n=u.choices)||void 0===n?void 0:n[0])||void 0===r?void 0:r.message)||void 0===o?void 0:o.content)||void 0===a?void 0:a.trim())&&void 0!==i?i:"")?(e.completeRequest(s),[2,{content:d}]):(e.errorRequest(s),[2,null]);case 6:throw p=f.sent(),console.error("Error in Groq chat completion:",p),e.errorRequest(s),p;case 7:return[2]}}))}))},t}(is),cs=function(e,t,n){switch(void 0===n&&(n=""),e){case Ji.OpenAI:return new ss(t,n||"gpt-5-nano");case Ji.Groq:return new ls(t,n||"llama3-8b-8192");default:return new ss(t,n||"gpt-5-nano")}},us=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},ds=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ps=function(e){return function(e){return{translateText:function(t,n,r,o,a){return void 0===r&&(r="ru"),void 0===o&&(o=""),us(void 0,void 0,void 0,(function(){return ds(this,(function(i){if(null==a?void 0:a.aborted)throw new Error("Request cancelled");return[2,cs(e,t).translateText(n,r,o)]}))}))},getExamples:function(t,n,r,o,a,i,s){return void 0===o&&(o=!1),void 0===a&&(a=""),us(void 0,void 0,void 0,(function(){return ds(this,(function(l){if(null==s?void 0:s.aborted)throw new Error("Request cancelled");return[2,cs(e,t).getExamples(n,r,o,a,i)]}))}))},getDescriptionImage:function(t,n,r,o){return void 0===r&&(r=""),us(void 0,void 0,void 0,(function(){return ds(this,(function(a){if(null==o?void 0:o.aborted)throw new Error("Request cancelled");return[2,cs(e,t).getDescriptionImage(n,r)]}))}))},getImageUrl:function(t,n){return us(void 0,void 0,void 0,(function(){var r;return ds(this,(function(o){return[2,(r=cs(e,t)).getImageUrl?r.getImageUrl(n):null]}))}))},generateAnkiFront:function(t,n,r){return us(void 0,void 0,void 0,(function(){return ds(this,(function(o){if(null==r?void 0:r.aborted)throw new Error("Request cancelled");return[2,cs(e,t).generateAnkiFront(n)]}))}))},extractKeyTerms:function(t,n){return us(void 0,void 0,void 0,(function(){return ds(this,(function(r){return[2,cs(e,t).extractKeyTerms(n)]}))}))},createChatCompletion:function(t,n){return us(void 0,void 0,void 0,(function(){var r;return ds(this,(function(o){return(r=cs(e,t)).createChatCompletion?[2,r.createChatCompletion(t,n)]:(console.error("createChatCompletion not implemented in the provider"),[2,null])}))}))},createTranscription:function(t,n,r,o){return us(void 0,void 0,void 0,(function(){return ds(this,(function(a){return[2,cs(e,t).createTranscription(n,r,o)]}))}))}}}(e)},fs=function(e,t,n,r,o,a,i){return us(void 0,void 0,void 0,(function(){var a,s;return ds(this,(function(l){switch(l.label){case 0:if(l.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.translateText(t,n,r,o,i)];case 1:return a=l.sent(),[2,{original:n,translated:a}];case 2:throw s=l.sent(),console.error("Error in unified translation:",s),s instanceof Error?s:new Error("Failed to translate text. Please check your API key and settings.");case 3:return[2]}}))}))},gs=function(e,t,n,r,o,a,i,s){return void 0===o&&(o=!1),us(void 0,void 0,void 0,(function(){var l;return ds(this,(function(c){switch(c.label){case 0:if(c.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.getExamples(t,n,r,o,a,i,s)];case 1:return[2,c.sent().map((function(e){return{original:e[0],translated:e[1]}}))];case 2:throw l=c.sent(),console.error("Error in unified examples generation:",l),l instanceof Error?l:new Error("Failed to generate examples. Please check your API key and settings.");case 3:return[2]}}))}))},hs=function(e,t,n,r){return us(void 0,void 0,void 0,(function(){var o,a;return ds(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.generateAnkiFront(t,n,r)];case 1:if(!(o=i.sent()))throw new Error("Failed to generate flashcard content. Please try again or check your API key.");return[2,{front:o}];case 2:throw a=i.sent(),console.error("Error in unified flashcard creation:",a),a instanceof Error?a:new Error("Failed to create flashcard. Please check your API key and settings.");case 3:return[2]}}))}))},ms=function(e,t,n,r,o){return void 0===o&&(o="ru"),us(void 0,void 0,void 0,(function(){var a,i;return ds(this,(function(s){switch(s.label){case 0:if(s.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.createTranscription(t,n,r,o)];case 1:if(!(a=s.sent()))throw new Error("Failed to generate transcription. Please try again or check your API key.");return[2,a];case 2:throw i=s.sent(),console.error("Error in unified transcription creation:",i),i instanceof Error?i:new Error("Failed to create transcription. Please check your API key and settings.");case 3:return[2]}}))}))};function ys(e,t,n){return void 0===n&&(n="ru"),':      "'.concat(e,'"   ').concat(n,'.\n\n:\n-  2-3 \n-  :   + 1-2 \n-     \n\n:\n1.   : [  ]\n2.     ( )\n\n :\n-   |   |   |  \n\n:\n"book"  "  : "\n""  "  : " + " : "\n\n:\n<div class="grammar-item">\n  <span class="icon-pos">[]</span> <strong>[]:</strong> <span class="grammar-tag">[]</span>\n</div>\n\n   "').concat(e,'":')}function xs(e,t,n){return'   "'.concat(t,'"     :\n\n:\n').concat(e,"\n\n :\n1.    ? (  - )\n2.     ? (  ").concat(n,')\n3.    ? ( lemma, degree, notes, examples)\n\n       " "\n       \n\n  :')}function vs(e,t,n,r,o){return void 0===o&&(o="ru"),us(this,void 0,void 0,(function(){var r,a,i,s,l,c,u;return ds(this,(function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),console.log('Creating optimized linguistic info for "'.concat(n,'" (max 2 requests)')),r=ys(n,0,o),[4,e.createChatCompletion(t,[{role:"user",content:r}])];case 1:return(a=d.sent())&&a.content?(i=a.content.trim(),console.log("Initial reference created"),s=xs(i,n,o),[4,e.createChatCompletion(t,[{role:"user",content:s}])]):(console.log("Failed to generate initial linguistic info"),[2,{linguisticInfo:null,wasValidated:!1,attempts:1}]);case 2:return(l=d.sent())&&l.content?(c=l.content.trim()).includes(" ")||c.includes("")?(console.log("Reference validated as correct"),[2,{linguisticInfo:i,wasValidated:!0,attempts:2}]):(console.log("Reference was corrected by validator"),[2,{linguisticInfo:c,wasValidated:!0,attempts:2}]):(console.log("Validator failed, returning initial reference"),[2,{linguisticInfo:i,wasValidated:!1,attempts:2}]);case 3:return u=d.sent(),console.error("Error in optimized linguistic info creation:",u),[2,{linguisticInfo:null,wasValidated:!1,attempts:1}];case 4:return[2]}}))}))}var bs=function(){return bs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},bs.apply(this,arguments)},ws=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ss=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Cs=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ks=function(){function e(e,t){this.aiService=e,this.apiKey=t,this.agents=this.initializeAgents()}return e.prototype.initializeAgents=function(){return{supervisor:{name:"Supervisor",role:" ",systemPrompt:" - Supervisor AI Agent,      .\n                  -        .\n                         ,      .",execute:this.executeSupervisor.bind(this)},contentAnalyzer:{name:"Content Analyzer",role:" ",systemPrompt:" - Content Analyzer Agent,     .\n                  -   ,   ,    .\n                           .",execute:this.executeContentAnalyzer.bind(this)},questionQuality:{name:"Question Quality",role:"  ",systemPrompt:' - Question Quality Agent,       .\n\n : \n    ,  .\n\n  (isWorthwhile: false) -   :\n1.   -      \n2.  -     ("X  X")\n3.   -  \n4.   -  \n\n   ():\n "  HTML?"  "HTML -  HTML" ()\n "  ?"  " -  " ()\n   \n\n   ():\n "  ?"  "   " (,   )\n "  HTML?"  "HTML -    -" ( )\n "   ?"  "  ,   " ( )\n\n :\n- qualityScore < 5  isWorthwhile: false ( 6,  5)\n-      \n-   = \n-    isWorthwhile: false\n\n !   ,   .',execute:this.executeQuestionQuality.bind(this)},cardGenerator:{name:"Card Generator",role:" ",systemPrompt:' - Card Generator Agent,      .\n\n  :\n ,       .\n\n  :\n1.   -        \n2.   -    ,    \n3.   -   \n4.   -  ""  "",    ""\n5.   - , , , \n\n  (  ):\n "      ?"  " -   "\n "  ?"  " -   "\n\n :\n "         ?"  "    .  :  ,    ,    ,    "\n "   ,      ?"  " -    .  :     ,  ,  "\n\n :\n-     ,   \n-      \n-       \n-      ',execute:this.executeCardGenerator.bind(this)},validator:{name:"Validator",role:"  ",systemPrompt:" - Validator Agent,      .\n                  -          .\n                     ,    .\n                \n                  :\n                1.    ( , )\n                2.  1-2      \n                3.    (6+/10) -  \n                4.       ",execute:this.executeValidator.bind(this)},pageContentAnalyzer:{name:"Page Content Analyzer",role:"   ",systemPrompt:" - Page Content Analyzer Agent,    -   .\n                  -  ,    (, , ) \n                         .\n                        .",execute:this.executePageContentAnalyzer.bind(this)},contentEnhancer:{name:"Content Enhancer",role:"   ",systemPrompt:' - Content Enhancer Agent,       .\n                   -     ,       .\n                   "  " -         .\n                \n                 :\n                1.     \n                2.       (>7/10)\n                3.   \n                4.  : , , , ',execute:this.executeContentEnhancer.bind(this)},cardContentMatcher:{name:"Card Content Matcher",role:"   ",systemPrompt:" - Card Content Matcher Agent,         .\n                  -  ,      ,       .",execute:this.executeCardContentMatcher.bind(this)},textAnalyst:{name:"Text Analyst",role:"    ",systemPrompt:" - Text Analyst Agent,      .\n                \n                  :\n                1.     \n                2.     \n                3. ,      \n                4.    \n                5.    \n                \n                :\n                -      (  )\n                -  > \n                -       \n                -    -     ",execute:this.executeTextAnalyst.bind(this)},cardPlanner:{name:"Card Planner",role:"  ",systemPrompt:" - Card Planner Agent,       .\n                \n                 :\n                1.    Text Analyst\n                2.    \n                3.     (, , , )\n                4.    \n                5.      \n                \n                 :\n                -   ( /)\n                -    ( )\n                -   ( /)\n                -   \n                -  ",execute:this.executeCardPlanner.bind(this)},multimediaAssigner:{name:"Multimedia Assigner",role:"  ",systemPrompt:" - Multimedia Assigner Agent,      .\n                \n                   :\n                -     -     \n                -     \n                -       \n                \n                 :\n                1.     Card Planner\n                2.  ,       \n                3. :   \n                4.    ",execute:this.executeMultimediaAssigner.bind(this)}}},e.prototype.createCardsFromText=function(e,t,n){var r,o,a,i,s;return ws(this,void 0,void 0,(function(){var l,c,u,d,p,f,g,h,m,y,x,v,b,w,S,C,k,E,I,A,_,j;return Ss(this,(function(F){switch(F.label){case 0:if(F.trys.push([0,16,,17]),console.log(" AI Agent Workflow: Starting intelligent card creation with advanced analysis"),l={originalText:e,currentStep:"initialization",previousResults:{},metadata:{textLength:e.length,language:this.detectLanguage(e),topic:"",complexity:this.estimateComplexity(e)}},t?(l.previousResults.pageContext=t,console.log(" Page context: ".concat((null===(r=t.pageImages)||void 0===r?void 0:r.length)||0," images, ").concat((null===(o=t.formulas)||void 0===o?void 0:o.length)||0," formulas, ").concat((null===(a=t.codeBlocks)||void 0===a?void 0:a.length)||0," code blocks")),t.pageImages&&t.pageImages.length>0?(console.log(" Selected images details:"),t.pageImages.forEach((function(e,t){var n;console.log("  ".concat(t+1,'. "').concat(e.alt||"No alt",'" - ').concat((null===(n=e.src)||void 0===n?void 0:n.substring(0,50))||"No src","...")),console.log("      base64 available: ".concat(!!e.base64,", relevance: ").concat(e.relevanceScore))}))):console.log(" No images found in pageContext")):console.log(" No pageContext provided - no multimedia content available"),null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");return console.log(" Step 1: Deep text analysis and learning strategy"),l.currentStep="text_analysis",[4,this.agents.textAnalyst.execute({text:e,pageContext:t},l)];case 1:if(c=F.sent(),l.previousResults.textAnalysis=c,l.metadata.topic=(null===(i=c.mainTopics[0])||void 0===i?void 0:i.name)||" ",console.log(" Text analysis: ".concat(c.estimatedCards," cards recommended for ").concat(c.mainTopics.length," topics")),null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");return console.log(" Step 2: Card structure planning"),l.currentStep="card_planning",[4,this.agents.cardPlanner.execute({textAnalysis:c,originalText:e,pageContext:t},l)];case 2:if(u=F.sent(),l.previousResults.cardPlan=u,console.log(" Card plan: ".concat(u.totalCards," cards planned with multimedia distribution")),null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");return d=null,t&&(t.pageImages.length>0||t.formulas.length>0||t.codeBlocks.length>0)?(console.log(" Step 3: Intelligent multimedia assignment"),l.currentStep="multimedia_assignment",[4,this.agents.multimediaAssigner.execute({cardPlan:u,pageContext:t,originalText:e},l)]):[3,4];case 3:d=F.sent(),l.previousResults.multimediaDistribution=d,console.log(" Multimedia assigned: ".concat((null===(s=null==d?void 0:d.assignments)||void 0===s?void 0:s.length)||0," assignments created")),F.label=4;case 4:if(null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");return console.log(" Step 4: Structured card generation"),l.currentStep="card_generation",[4,this.agents.cardGenerator.execute({text:e,cardPlan:u,multimediaDistribution:d,textAnalysis:c},l)];case 5:if(p=F.sent(),l.previousResults.generatedCards=p,console.log(" Generated ".concat(p.length," cards based on plan")),null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");console.log(" Step 5: Question quality validation"),l.currentStep="quality_check",f=[],g=0,h=p,F.label=6;case 6:if(!(g<h.length))return[3,9];if(m=h[g],null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");return[4,this.agents.questionQuality.execute(m,l)];case 7:y=F.sent(),f.push(y),F.label=8;case 8:return g++,[3,6];case 9:if(l.previousResults.qualityResults=f,x=p.filter((function(e,t){var n=f[t],r=n.isWorthwhile&&n.qualityScore>=5&&n.relevanceScore>=5;return r||(console.log(" Card ".concat(t+1," rejected: Q=").concat(n.qualityScore,", R=").concat(n.relevanceScore,", W=").concat(n.isWorthwhile)),console.log("   Reason: ".concat(n.reasoning)),console.log("   Issues: ".concat(n.issues.join(", ")))),r})),console.log(" Quality filter: ".concat(x.length,"/").concat(p.length," cards passed optimized quality check")),0===x.length&&p.length>0&&(console.log(" All cards rejected by quality filter! Creating fallback quality card"),v={front:"     ?",back:"   : ".concat(e.substring(0,200),"... (       )"),tags:[l.metadata.topic||""],difficulty:"medium",concept:"  "},x.push(v),console.log(" Fallback card created to ensure user gets at least one card")),null==n?void 0:n.aborted)throw new Error("AI card creation was cancelled by user");if(b=x,w=t&&t.pageImages&&t.pageImages.length>0,console.log(" Selected images available: ".concat(w?null==t?void 0:t.pageImages.length:0)),w?(console.log(" Step 6: Applying multimedia to quality cards"),d&&d.assignments.length>0?(console.log(" Using intelligent multimedia distribution"),b=x.map((function(e,n){var r,o=null===(r=u.cardSpecs[n])||void 0===r?void 0:r.id,a=null==d?void 0:d.assignments.find((function(e){return e.cardId===o}));if(a){var i=bs({},e);if(a.imageIndices.length>0&&(i.attachedImages=a.imageIndices.map((function(e){return null==t?void 0:t.pageImages[e]})).filter(Boolean)),a.formulaIndices.length>0&&(i.attachedFormulas=a.formulaIndices.map((function(e){return null==t?void 0:t.formulas[e]})).filter(Boolean)),a.codeIndices.length>0&&(i.attachedCode=a.codeIndices.map((function(e){return null==t?void 0:t.codeBlocks[e]})).filter(Boolean)),console.log(" Card ".concat(n+1,": added ").concat(a.imageIndices.length," images, ").concat(a.formulaIndices.length," formulas, ").concat(a.codeIndices.length," code blocks")),i.attachedImages&&i.attachedImages.length>0){var s=i.attachedImages[0];s.base64?(i.image=s.base64,console.log("  image   ",n+1)):s.src&&(i.imageUrl=s.src,console.log("  imageUrl   ",n+1))}return i}return e}))):(console.log(" No multimedia distribution found, using fallback logic to ensure images are included"),console.log(" Forcing inclusion of ".concat(null==t?void 0:t.pageImages.length," selected images")),b.length>0&&(null==t?void 0:t.pageImages.length)>0&&(S=t.pageImages[0],b[0]=bs(bs({},b[0]),{attachedImages:t.pageImages,image:S.base64||null,imageUrl:S.src||null}),console.log(" FALLBACK: Added all ".concat(t.pageImages.length," images to first card")),console.log(" FALLBACK:  image/imageUrl    ")),b.length>1&&(null==t?void 0:t.pageImages.length)>1&&(C=Math.ceil(t.pageImages.length/b.length),b=b.map((function(e,n){var r=n*C,o=Math.min(r+C,t.pageImages.length),a=t.pageImages.slice(r,o);if(a.length>0){console.log(" FALLBACK: Added ".concat(a.length," images to card ").concat(n+1));var i=a[0];return bs(bs({},e),{attachedImages:a,image:i.base64||null,imageUrl:i.src||null})}return e})))),k=b.reduce((function(e,t){var n;return e+((null===(n=t.attachedImages)||void 0===n?void 0:n.length)||0)}),0),console.log(" Total images attached to cards: ".concat(k,"/").concat((null==t?void 0:t.pageImages.length)||0)),0===k&&(null==t?void 0:t.pageImages.length)>0&&(console.log(" CRITICAL: No images were attached despite having selected images!"),console.log(" Emergency fallback: Adding all images to all cards"),b=b.map((function(e,n){var r=t.pageImages[0];return bs(bs({},e),{attachedImages:t.pageImages,image:r.base64||null,imageUrl:r.src||null})})),console.log(" Emergency: Added ".concat(t.pageImages.length," images to ").concat(b.length," cards")))):console.log(" No selected images to apply"),E=b,I=b.length<2||b.some((function(e){return e.front.length<10||e.back.length<20})),!I)return[3,14];console.log(" Step 7: Quick final validation (detected potential issues)"),l.currentStep="final_validation",F.label=10;case 10:return F.trys.push([10,12,,13]),[4,this.agents.validator.execute({cards:b,originalText:e,context:l},l)];case 11:return(A=F.sent()).improvedCards&&A.overallScore>80?(E=A.improvedCards,console.log(" Applied validator improvements (score: ".concat(A.overallScore,")"))):console.log(" Skipped validator improvements (score: ".concat(A.overallScore,")")),[3,13];case 12:return _=F.sent(),console.log(" Validator failed, using cards as-is:",_),[3,13];case 13:return[3,15];case 14:console.log(" Step 7: Skipped validation - cards appear good quality"),F.label=15;case 15:return console.log(" Workflow completed: ".concat(E.length," high-quality cards created")),[2,this.convertToStoredCards(E,e)];case 16:throw j=F.sent(),console.error(" Error in AI agent workflow:",j),j;case 17:return[2]}}))}))},e.prototype.executeSupervisor=function(e,t){return ws(this,void 0,void 0,(function(){var n,r,o;return Ss(this,(function(a){switch(a.label){case 0:n=' - Supervisor AI Agent.        .\n\n: "'.concat(e,'"\n\n:\n- : ').concat(t.metadata.textLength," \n- : ").concat(t.metadata.complexity,"\n- : ").concat(t.metadata.language,'\n\n :\n1.    (single_concept, multiple_concepts, step_by_step, comparison)\n2.       \n3.     \n4.   \n\n:\n- single_concept:   \n- multiple_concepts:     \n- step_by_step:    \n- comparison:   \n\nJSON :\n{\n  "strategy": "step_by_step",\n  "agents": ["contentAnalyzer", "cardGenerator", "questionQuality", "validator"],\n  "instructions": {\n    "contentAnalyzer": "      ",\n    "cardGenerator": "         ",\n    "questionQuality": "       ",\n    "validator": "      "\n  },\n  "expectedOutput": "    ",\n  "reasoning": "  ,    "\n}'),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.supervisor.systemPrompt},{role:"user",content:n}])];case 2:if(!(null==(r=a.sent())?void 0:r.content))throw new Error("No response from supervisor agent");return[2,this.parseJSONResponse(r.content,"supervisor")];case 3:return o=a.sent(),console.error("Supervisor agent error:",o),[2,this.createFallbackSupervisorDecision()];case 4:return[2]}}))}))},e.prototype.executeContentAnalyzer=function(e,t){var n,r;return ws(this,void 0,void 0,(function(){var o,a,i,s;return Ss(this,(function(l){switch(l.label){case 0:o=(null===(r=null===(n=t.previousResults.supervisor)||void 0===n?void 0:n.instructions)||void 0===r?void 0:r.contentAnalyzer)||"   ",a=' - Content Analyzer Agent.    .\n\n: "'.concat(e,'"\n\n  SUPERVISOR: ').concat(o,'\n\n :\n1.      \n2.    \n3.   \n4.   \n5.    \n\nJSON :\n{\n  "mainTopic": " ",\n  "keyPoints": ["1", "2"],\n  "concepts": [\n    {\n      "name": "1",\n      "definition": "",\n      "importance": "high",\n      "prerequisites": ["1"],\n      "examples": ["1"]\n    }\n  ],\n  "relationships": [\n    {\n      "from": "1",\n      "to": "2", \n      "type": "depends_on"\n    }\n  ],\n  "learningObjectives": ["1", "2"],\n  "complexity": "medium",\n  "estimatedCards": 3\n}'),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.contentAnalyzer.systemPrompt},{role:"user",content:a}])];case 2:if(!(null==(i=l.sent())?void 0:i.content))throw new Error("No response from content analyzer agent");return[2,this.parseJSONResponse(i.content,"contentAnalyzer")];case 3:return s=l.sent(),console.error("Content analyzer error:",s),[2,this.createFallbackContentAnalysis(e)];case 4:return[2]}}))}))},e.prototype.executeCardGenerator=function(e,t){var n,r,o,a;return ws(this,void 0,void 0,(function(){var t,i,s,l,c,u,d,p;return Ss(this,(function(f){switch(f.label){case 0:t=e.text,i=e.cardPlan,s=e.textAnalysis,e.multimediaDistribution,l=e.analysis,c=e.instructions,u=i&&s?' - Card Generator Agent.       .\n\n: "'.concat(t,'"\n\n :\n-  : ').concat(s.mainTopics.map((function(e){return e.name})).join(", "),"\n-  : ").concat(s.estimatedCards,"\n- : ").concat(s.complexity,"\n-  : ").concat(s.hasMultimedia?"":"","\n\n  ( ):\n").concat(i.cardSpecs.map((function(e,t){return"\n ".concat(t+1," (").concat(e.id,"):\n- : ").concat(e.type,"\n- : ").concat(e.topic,"\n- : ").concat(e.priority,"\n- : ").concat(e.difficulty,"\n- : ").concat(e.description,"\n-  : ").concat(e.needsMultimedia?"":"","\n")})).join(""),'\n\n   :\n1.         \n2.    ,  \n3.      \n4.    \n5.   \n\n  (  ):\n "  ?"  " -  "\n "   ?"  " -   "\n "  ?"  "   "\n\n :\n "     ?"  "        ,     .    (, ) - "\n "      ?"  " : -    ,   .      "\n\n :\n1.   ').concat(i.totalCards,'   \n2.      CardSpec\n3.     -    \n4.    \n5.      \n\nJSON :\n{\n  "cards": [\n    {\n      "front": "   1 (     )",\n      "back": "     ",\n      "tags": ["').concat((null===(n=s.mainTopics[0])||void 0===n?void 0:n.name)||"",'"],\n      "difficulty": "medium",\n      "concept": "').concat((null===(r=i.cardSpecs[0])||void 0===r?void 0:r.topic)||"",'"\n    }\n  ]\n}'):' - Card Generator Agent.    .\n\n: "'.concat(t,'"\n\n :\n- : ').concat((null==l?void 0:l.mainTopic)||" ","\n-  : ").concat((null===(o=null==l?void 0:l.concepts)||void 0===o?void 0:o.map((function(e){return e.name})).join(", "))||" ","\n-  : ").concat((null===(a=null==l?void 0:l.learningObjectives)||void 0===a?void 0:a.join(", "))||" ","\n- : ").concat((null==l?void 0:l.complexity)||"medium","\n\n: ").concat(c||"   ",'\n\n   :\n1.         \n2.    ,  \n3.      \n4.    \n5.   \n\n  (  ):\n "  HTML?"  "HTML -  HTML"\n "   Python?"  "Python -  "\n "  JavaScript?"  "JavaScript   -"\n\n :\n " Python     ?"  "Python   ,    ,   ,      "\n "    JavaScript  ?"  "Node.js        ,     V8,   npm "\n\n  :\n1.   -  \n2. ,    \n3. ,    \n4.  \n5.  \n\nJSON :\n{\n  "cards": [\n    {\n      "front": "     ",\n      "back": "    ",\n      "tags": ["1"],\n      "difficulty": "medium",\n      "concept": " "\n    }\n  ]\n}'),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.cardGenerator.systemPrompt},{role:"user",content:u}])];case 2:if(!(null==(d=f.sent())?void 0:d.content))throw new Error("No response from card generator agent");return[2,this.parseJSONResponse(d.content,"cardGenerator").cards||[]];case 3:return p=f.sent(),console.error("Card generator error:",p),[2,this.createFallbackCards(t)];case 4:return[2]}}))}))},e.prototype.executeQuestionQuality=function(e,t){return ws(this,void 0,void 0,(function(){var n,r,o;return Ss(this,(function(a){switch(a.label){case 0:n=' - Question Quality Agent.     .\n\n  :\n: "'.concat(e.front,'"\n: "').concat(e.back,'"\n: ').concat(e.concept||" ",'\n\n : "').concat(t.originalText.substring(0,500),'..."\n\n :\n1.   :\n   -         ?\n   -     ?\n\n2.   :\n   -   - ?\n   -   ,   ?\n   -     ?\n\n3.   :\n   -   ?\n   -   ?\n   -    ?\n\n :\n- 9-10:  ,    \n- 7-8:     \n- 5-6:  ,  \n- 3-4:  ,  \n- 1-2:   , \n\n  (isWorthwhile: false) :\n-         \n-    \n-   6 \n-   \n\nJSON :\n{\n  "question": "').concat(e.front,'",\n  "answer": "').concat(e.back,'",\n  "qualityScore": 3,\n  "relevanceScore": 4,\n  "difficultyScore": 2,\n  "issues": ["  ", "  ", "  "],\n  "improvements": [" ", "   ", "   "],\n  "isWorthwhile": false,\n  "reasoning": "  - :  \'      ?\'   \' -   \'   .   ."\n}'),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.questionQuality.systemPrompt},{role:"user",content:n}])];case 2:if(!(null==(r=a.sent())?void 0:r.content))throw new Error("No response from question quality agent");return[2,this.parseJSONResponse(r.content,"questionQuality")];case 3:return o=a.sent(),console.error("Question quality error:",o),[2,this.createFallbackQualityCheck(e)];case 4:return[2]}}))}))},e.prototype.executeValidator=function(e,t){return ws(this,void 0,void 0,(function(){var t,n,r,o,a;return Ss(this,(function(i){switch(i.label){case 0:t=e.cards,n=e.originalText,r=' - Validator Agent.     .\n\n : "'.concat(n.substring(0,300),'..."\n\n (').concat(t.length," ):\n").concat(t.map((function(e,t){return"\n".concat(t+1,". Q: ").concat(e.front,"\n   A: ").concat(e.back,"\n")})).join(""),'\n\n :\n1.    ? (, )\n2.   ?\n3.    ?\n\n:\n-    (70+)    \n-     \n-      \n\nJSON :\n{\n  "isValid": true,\n  "overallScore": 75,\n  "cardScores": {0: 75, 1: 80},\n  "issues": [],\n  "suggestions": [],\n  "improvedCards": null,\n  "finalRecommendation": "  "\n}'),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.validator.systemPrompt},{role:"user",content:r}])];case 2:if(!(null==(o=i.sent())?void 0:o.content))throw new Error("No response from validator agent");return[2,this.parseJSONResponse(o.content,"validator")];case 3:return a=i.sent(),console.error("Validator error:",a),[2,this.createFallbackValidation(t)];case 4:return[2]}}))}))},e.prototype.executePageContentAnalyzer=function(e,t){var n,r,o;return ws(this,void 0,void 0,(function(){var t,a,i,s,l,c,u,d,p;return Ss(this,(function(f){switch(f.label){case 0:t=e.text,a=e.pageContext,i=' - Page Content Analyzer Agent.    ,     .\n\n : "'.concat(t,'"\n\n :\n (').concat(a.pageImages.length,"):\n").concat(a.pageImages.map((function(e,t){return"".concat(t+1,". ").concat(e.alt||" "," (").concat(e.isNearText?"  ":"  ",")")})).join("\n"),"\n\n (").concat(a.formulas.length,"):\n").concat(a.formulas.map((function(e,t){return"".concat(t+1,". ").concat(e.text," (").concat(e.type,")")})).join("\n"),"\n\n (").concat(a.codeBlocks.length,"):\n").concat(a.codeBlocks.map((function(e,t){return"".concat(t+1,". ").concat(e.language||"unknown",": ").concat(e.code.substring(0,100),"...")})).join("\n"),'\n\n :\n1. ,      \n2. ,     \n3. ,      \n4.   \n\n :\n- : , ,  \n- :  ,   \n- : , ,   \n\nJSON :\n{\n  "shouldIncludeImages": true,\n  "selectedImages": [0, 2],\n  "shouldIncludeFormulas": false,\n  "selectedFormulas": [],\n  "shouldIncludeCode": true,\n  "selectedCode": [0],\n  "reasoning": " 1  3   .    ."\n}'),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.pageContentAnalyzer.systemPrompt},{role:"user",content:i}])];case 2:if(!(null==(s=f.sent())?void 0:s.content))throw new Error("No response from page content analyzer agent");return l=this.parseJSONResponse(s.content,"pageContentAnalyzer"),c=(null===(n=l.selectedImages)||void 0===n?void 0:n.map((function(e){return a.pageImages[e]})).filter(Boolean))||[],u=(null===(r=l.selectedFormulas)||void 0===r?void 0:r.map((function(e){return a.formulas[e]})).filter(Boolean))||[],d=(null===(o=l.selectedCode)||void 0===o?void 0:o.map((function(e){return a.codeBlocks[e]})).filter(Boolean))||[],[2,{shouldIncludeImages:l.shouldIncludeImages||!1,selectedImages:c,shouldIncludeFormulas:l.shouldIncludeFormulas||!1,selectedFormulas:u,shouldIncludeCode:l.shouldIncludeCode||!1,selectedCode:d,reasoning:l.reasoning||"No reasoning provided"}];case 3:return p=f.sent(),console.error("Page content analyzer error:",p),[2,this.createFallbackContentEnhancement()];case 4:return[2]}}))}))},e.prototype.executeContentEnhancer=function(e,t){var n;return ws(this,void 0,void 0,(function(){var t,r,o,a,i,s,l,c,u,d,p=this;return Ss(this,(function(f){switch(f.label){case 0:t=e.cards,r=e.contentEnhancement,o=e.originalText,a=e.contentMatches,i=a&&a.cardMatches&&a.cardMatches.length>0,s=" - Content Enhancer Agent.        .\n\n".concat(i?" :      -      ,    .":" :    .",'\n\n : "').concat(o,'"\n\n (').concat(t.length,"):\n").concat(t.map((function(e,t){return"\n ".concat(t+1,":\n: ").concat(e.front,"\n: ").concat(e.back,"\n: ").concat(p.extractCardTopic(e.front,e.back),"\n").concat(i?" : ".concat(p.getMatchedContentForCard(t,a)):"","\n")})).join(""),"\n\n :\n").concat(r.shouldIncludeImages?" (".concat(r.selectedImages.length,"):\n").concat(r.selectedImages.map((function(e,t){return"".concat(t+1,'. "').concat(e.alt||" ",'" (: ').concat(e.relevanceScore,"/10)")})).join("\n")):": ","\n\n").concat(r.shouldIncludeFormulas?" (".concat(r.selectedFormulas.length,"):\n").concat(r.selectedFormulas.map((function(e,t){return"".concat(t+1,'. "').concat(e.text,'" (: ').concat(e.relevanceScore,"/10)")})).join("\n")):": ","\n\n").concat(r.shouldIncludeCode?" (".concat(r.selectedCode.length,"):\n").concat(r.selectedCode.map((function(e,t){return"".concat(t+1,". ").concat(e.language||"text",': "').concat(e.code.substring(0,60),'..." (: ').concat(e.relevanceScore,"/10)")})).join("\n")):": ","\n\n").concat(i?"\n  :\n".concat(a.cardMatches.map((function(e){return"\n ".concat(e.cardIndex+1,":\n- : [").concat(e.relevantImages.join(", "),"]\n- : [").concat(e.relevantFormulas.join(", "),"] \n- : [").concat(e.relevantCode.join(", "),"]\n- : ").concat(e.reasoning,"\n")})).join(""),"\n\n   !      ."):'\n  :\n1.    \n2.      8/10\n3.  : , , \n4.    "  "','\n\nJSON :\n{\n  "enhancedCards": [\n    {\n      "front": "  ?",\n      "back": " -             .\n\n[IMAGE:0]\n\n : [FORMULA:0]",\n      "multimedia": {\n        "images": [0],\n        "formulas": [0], \n        "code": []\n      },\n      "reasoning": "     ,      "\n    },\n    {\n      "front": "     ?",\n      "back": ", ,  CO2       .",\n      "multimedia": {\n        "images": [],\n        "formulas": [],\n        "code": []\n      },\n      "reasoning": "    -    ,   "\n    }\n  ]\n}\n\n:   [IMAGE:N], [FORMULA:N], [CODE:N]         .'),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.contentEnhancer.systemPrompt},{role:"user",content:s}])];case 2:if(!(null==(l=f.sent())?void 0:l.content))throw new Error("No response from content enhancer agent");return c=this.parseJSONResponse(l.content,"contentEnhancer"),console.log(" Content enhancer parsed result:",c),u=(null===(n=c.enhancedCards)||void 0===n?void 0:n.map((function(e,t){var n,o,a,i,s,l,c,u,d,p,f,g,h=e.back;console.log("   ".concat(t+1,": ").concat(e.front)),console.log("   :",e.multimedia);var m=h.match(/\[IMAGE:(\d+)\]/g);m&&(console.log("      ".concat(t+1,":"),m),m.forEach((function(e){var n=e.match(/\[IMAGE:(\d+)\]/);if(n){var o=parseInt(n[1]),a=r.selectedImages[o];if(console.log("  ".concat(e,"   ").concat(o,"   ").concat(t+1,":"),(null==a?void 0:a.src)||" "),a){var i=a.base64||a.src;console.log("  ".concat(a.base64?"base64":"URL","     ").concat(t+1));var s=a.alt&&""!==a.alt.trim()?a.alt:"";h=h.replace(e,"\n![".concat(s,"](").concat(i,")\n"))}else console.warn("    ".concat(o,"    selectedImages")),h=h.replace(e,"")}})));var y=h.match(/\[FORMULA:(\d+)\]/g);y&&(console.log("      ".concat(t+1,":"),y),y.forEach((function(e){var n=e.match(/\[FORMULA:(\d+)\]/);if(n){var o=parseInt(n[1]),a=r.selectedFormulas[o];console.log("  ".concat(e,"   ").concat(o,"   ").concat(t+1,":"),(null==a?void 0:a.text)||" "),a?h=h.replace(e,"\n$$".concat(a.text,"$$\n")):(console.warn("    ".concat(o,"    selectedFormulas")),h=h.replace(e,""))}})));var x=h.match(/\[CODE:(\d+)\]/g);return x&&(console.log("      ".concat(t+1,":"),x),x.forEach((function(e){var n,o=e.match(/\[CODE:(\d+)\]/);if(o){var a=parseInt(o[1]),i=r.selectedCode[a];console.log("  ".concat(e,"   ").concat(a,"   ").concat(t+1,":"),(null===(n=null==i?void 0:i.code)||void 0===n?void 0:n.substring(0,30))||" "),i?h=h.replace(e,"\n```".concat(i.language||"","\n").concat(i.code,"\n```\n")):(console.warn("    ".concat(a,"    selectedCode")),h=h.replace(e,""))}}))),h=h.replace(/\n{3,}/g,"\n\n"),console.log("  ".concat(t+1," . :"),{images:(null===(o=null===(n=e.multimedia)||void 0===n?void 0:n.images)||void 0===o?void 0:o.length)||0,formulas:(null===(i=null===(a=e.multimedia)||void 0===a?void 0:a.formulas)||void 0===i?void 0:i.length)||0,code:(null===(l=null===(s=e.multimedia)||void 0===s?void 0:s.code)||void 0===l?void 0:l.length)||0}),bs(bs({},e),{back:h,multimedia:e.multimedia,attachedImages:(null===(u=null===(c=e.multimedia)||void 0===c?void 0:c.images)||void 0===u?void 0:u.map((function(e){return r.selectedImages[e]})).filter(Boolean))||[],attachedFormulas:(null===(p=null===(d=e.multimedia)||void 0===d?void 0:d.formulas)||void 0===p?void 0:p.map((function(e){return r.selectedFormulas[e]})).filter(Boolean))||[],attachedCode:(null===(g=null===(f=e.multimedia)||void 0===f?void 0:f.code)||void 0===g?void 0:g.map((function(e){return r.selectedCode[e]})).filter(Boolean))||[]})})))||t,console.log(" Content Enhancement .  ".concat(u.length," ")),[2,{enhancedCards:u}];case 3:return d=f.sent(),console.error("Content enhancer error:",d),[2,{enhancedCards:t}];case 4:return[2]}}))}))},e.prototype.executeCardContentMatcher=function(e,t){return ws(this,void 0,void 0,(function(){var t,n,r,o,a,i,s,l=this;return Ss(this,(function(c){switch(c.label){case 0:t=e.cards,n=e.contentEnhancement,r=e.originalText,o=' - Card Content Matcher Agent.      ,     .\n\n : "'.concat(r,'"\n\n   (').concat(t.length,"):\n").concat(t.map((function(e,t){return"\n ".concat(t+1,":\n: ").concat(e.front,"\n: ").concat(e.back,"\n: ").concat(l.extractCardTopic(e.front,e.back),"\n")})).join(""),"\n\n :\n").concat(n.shouldIncludeImages?" (".concat(n.selectedImages.length,"):\n").concat(n.selectedImages.map((function(e,t){return"".concat(t+1,'. Alt: "').concat(e.alt||" ",'" | : ').concat(e.relevanceScore,"/10")})).join("\n")):": ","\n\n").concat(n.shouldIncludeFormulas?" (".concat(n.selectedFormulas.length,"):\n").concat(n.selectedFormulas.map((function(e,t){return"".concat(t+1,'. "').concat(e.text,'" | : ').concat(e.relevanceScore,"/10")})).join("\n")):": ","\n\n").concat(n.shouldIncludeCode?" (".concat(n.selectedCode.length,"):\n").concat(n.selectedCode.map((function(e,t){return"".concat(t+1,". ").concat(e.language||"text",': "').concat(e.code.substring(0,80),'..." | : ').concat(e.relevanceScore,"/10")})).join("\n")):": ",'\n\n :\n1.       (0-10)   \n2.         8/10\n3.  : , , \n4.         \n5. :  > \n\nJSON :\n{\n  "cardMatches": [\n    {\n      "cardIndex": 0,\n      "relevantImages": [0],\n      "relevantFormulas": [],\n      "relevantCode": [],\n      "reasoning": " 1     "\n    },\n    {\n      "cardIndex": 1,\n      "relevantImages": [],\n      "relevantFormulas": [0],\n      "relevantCode": [],\n      "reasoning": " 1     "\n    }\n  ]\n}'),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.cardContentMatcher.systemPrompt},{role:"user",content:o}])];case 2:if(!(null==(a=c.sent())?void 0:a.content))throw new Error("No response from card content matcher agent");return i=this.parseJSONResponse(a.content,"cardContentMatcher"),console.log(" Card content matcher result:",i),[2,i];case 3:return s=c.sent(),console.error("Card content matcher error:",s),[2,{cardMatches:[]}];case 4:return[2]}}))}))},e.prototype.extractCardTopic=function(e,t){var n=(e+" "+t).toLowerCase();return n.includes("")||n.includes("")||n.includes("")?"":n.includes("")||n.includes("")||n.includes("")?"":n.includes("")||n.includes("")||n.includes("")?"":n.includes("")||n.includes("")||n.includes("")?"":n.includes("")||n.includes("")||n.includes("")?"":""},e.prototype.executeTextAnalyst=function(e,t){var n,r,o;return ws(this,void 0,void 0,(function(){var t,a,i,s,l,c,u,d,p;return Ss(this,(function(f){switch(f.label){case 0:t=e.text,a=e.pageContext,i=(null===(n=null==a?void 0:a.pageImages)||void 0===n?void 0:n.length)>0,s=(null===(r=null==a?void 0:a.formulas)||void 0===r?void 0:r.length)>0,l=(null===(o=null==a?void 0:a.codeBlocks)||void 0===o?void 0:o.length)>0,c=" - Text Analyst Agent.         .\n\n   (".concat(t.length,' ):\n"').concat(t,'"\n\n  :\n- : ').concat(i?a.pageImages.length:0," ").concat(i?"( -  !)":"","\n- : ").concat(s?a.formulas.length:0,"\n- : ").concat(l?a.codeBlocks.length:0,'\n\n :\n1.      \n2.   \n3.       ( !)\n4.     \n5.  \n\n:\n-     \n-      \n-    -    \n-  > \n\nJSON :\n{\n  "textLength": ').concat(t.length,',\n  "complexity": "medium",\n  "mainTopics": [\n    {\n      "name": " ",\n      "importance": "critical",\n      "complexity": "medium",\n      "estimatedCards": 2,\n      "needsMultimedia": true,\n      "multimediaTypes": ["images"],\n      "subtopics": ["1", "2"]\n    }\n  ],\n  "estimatedCards": 3,\n  "learningObjectives": [" X", " Y"],\n  "hasMultimedia": ').concat(i||s||l,',\n  "multimediaTypes": [').concat(i?'"images"':"").concat(s?', "formulas"':"").concat(l?', "code"':"",'],\n  "priority": "high",\n  "reasoning": " "\n}'),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.textAnalyst.systemPrompt},{role:"user",content:c}])];case 2:if(!(null==(u=f.sent())?void 0:u.content))throw new Error("No response from text analyst agent");return d=this.parseJSONResponse(u.content,"textAnalyst"),console.log(" Text analysis result:",d),[2,d];case 3:return p=f.sent(),console.error("Text analyst error:",p),[2,{textLength:t.length,complexity:this.estimateComplexity(t),mainTopics:[{name:" ",importance:"important",complexity:"medium",estimatedCards:Math.min(5,Math.ceil(t.length/1e3)),needsMultimedia:i||s||l,multimediaTypes:Cs(Cs(Cs([],i?["images"]:[],!0),s?["formulas"]:[],!0),l?["code"]:[],!0),subtopics:[]}],estimatedCards:Math.min(5,Math.ceil(t.length/1e3)),learningObjectives:["  "],hasMultimedia:i||s||l,multimediaTypes:Cs(Cs(Cs([],i?["images"]:[],!0),s?["formulas"]:[],!0),l?["code"]:[],!0),priority:"medium",reasoning:"Fallback analysis due to error"}];case 4:return[2]}}))}))},e.prototype.executeCardPlanner=function(e,t){var n,r,o,a,i,s,l,c,u,d,p,f;return ws(this,void 0,void 0,(function(){var t,g,h,m,y,x,v;return Ss(this,(function(b){switch(b.label){case 0:t=e.textAnalysis,e.originalText,g=e.pageContext,h=" - Card Planner Agent.        .\n\n :\n : ".concat((null===(n=t.mainTopics)||void 0===n?void 0:n.map((function(e){return"".concat(e.name," (: ").concat(e.importance,")")})).join(", "))||" ","\n  : ").concat(t.estimatedCards,"\n: ").concat(t.complexity,"\n : ").concat(t.hasMultimedia?"":"","\n : ").concat((null===(r=t.multimediaTypes)||void 0===r?void 0:r.join(", "))||" ","\n\n :\n").concat((null===(o=null==g?void 0:g.pageImages)||void 0===o?void 0:o.length)>0?"- : ".concat(g.pageImages.length," ( -  !)"):"","\n").concat((null===(a=null==g?void 0:g.formulas)||void 0===a?void 0:a.length)>0?"- : ".concat(g.formulas.length):"","\n").concat((null===(i=null==g?void 0:g.codeBlocks)||void 0===i?void 0:i.length)>0?"- : ".concat(g.codeBlocks.length):"",'\n\n :\n1.     \n2.    (, , , )\n3.   \n4.    \n5.      \n\n :\n- concept:   ( /)\n- definition:  \n- formula:    ( )\n- code:   ( )\n- example:  \n- application:  \n\nJSON :\n{\n  "totalCards": 3,\n  "cardSpecs": [\n    {\n      "id": "card_1",\n      "type": "concept",\n      "topic": " ",\n      "priority": "high",\n      "difficulty": "medium",\n      "needsMultimedia": true,\n      "multimediaTypes": ["images"],\n      "estimatedLength": "medium",\n      "description": "      "\n    }\n  ],\n  "multimediaDistribution": {\n    "totalImages": ').concat((null===(s=null==g?void 0:g.pageImages)||void 0===s?void 0:s.length)||0,',\n    "totalFormulas": ').concat((null===(l=null==g?void 0:g.formulas)||void 0===l?void 0:l.length)||0,',\n    "totalCode": ').concat((null===(c=null==g?void 0:g.codeBlocks)||void 0===c?void 0:c.length)||0,',\n    "assignments": [],\n    "userSelectedImages": [0, 1],\n    "reasoning": " "\n  },\n  "learningFlow": ["card_1", "card_2", "card_3"],\n  "reasoning": " "\n}'),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.cardPlanner.systemPrompt},{role:"user",content:h}])];case 2:if(!(null==(m=b.sent())?void 0:m.content))throw new Error("No response from card planner agent");return y=this.parseJSONResponse(m.content,"cardPlanner"),console.log(" Card plan result:",y),[2,y];case 3:return x=b.sent(),console.error("Card planner error:",x),[2,{totalCards:v=Math.min(t.estimatedCards,5),cardSpecs:Array.from({length:v},(function(e,n){return{id:"card_".concat(n+1),type:"concept",topic:" ".concat(n+1),priority:"medium",difficulty:"medium",needsMultimedia:t.hasMultimedia,multimediaTypes:t.multimediaTypes||[],estimatedLength:"medium",description:" ".concat(n+1)}})),multimediaDistribution:{totalImages:(null===(u=null==g?void 0:g.pageImages)||void 0===u?void 0:u.length)||0,totalFormulas:(null===(d=null==g?void 0:g.formulas)||void 0===d?void 0:d.length)||0,totalCode:(null===(p=null==g?void 0:g.codeBlocks)||void 0===p?void 0:p.length)||0,assignments:[],userSelectedImages:(null===(f=null==g?void 0:g.pageImages)||void 0===f?void 0:f.map((function(e,t){return t})))||[],reasoning:"Fallback distribution"},learningFlow:Array.from({length:v},(function(e,t){return"card_".concat(t+1)})),reasoning:"Fallback plan due to error"}];case 4:return[2]}}))}))},e.prototype.executeMultimediaAssigner=function(e,t){var n,r,o,a,i,s,l,c,u,d;return ws(this,void 0,void 0,(function(){var t,p,f,g,h,m,y,x,v,b;return Ss(this,(function(w){switch(w.label){case 0:t=e.cardPlan,p=e.pageContext,e.originalText,f=" - Multimedia Assigner Agent.      .\n\n :\n".concat(t.cardSpecs.map((function(e,t){var n;return"\n ".concat(t+1," (").concat(e.id,"):\n- : ").concat(e.type,"\n- : ").concat(e.topic,"\n-  : ").concat(e.needsMultimedia?"":"","\n- : ").concat((null===(n=e.multimediaTypes)||void 0===n?void 0:n.join(", "))||" ","\n- : ").concat(e.description,"\n")})).join(""),"\n\n :\n").concat((null===(n=null==p?void 0:p.pageImages)||void 0===n?void 0:n.length)>0?"\n (".concat(p.pageImages.length,") - :\n").concat(p.pageImages.map((function(e,t){return"".concat(t,'. "').concat(e.alt||" ",'" (: ').concat(e.relevanceScore,"/10)")})).join("\n"),"\n"):": ","\n\n").concat((null===(r=null==p?void 0:p.formulas)||void 0===r?void 0:r.length)>0?"\n (".concat(p.formulas.length,"):\n").concat(p.formulas.map((function(e,t){return"".concat(t,'. "').concat(e.text,'" (: ').concat(e.type,")")})).join("\n"),"\n"):": ","\n\n").concat((null===(o=null==p?void 0:p.codeBlocks)||void 0===o?void 0:o.length)>0?"\n (".concat(p.codeBlocks.length,"):\n").concat(p.codeBlocks.map((function(e,t){return"".concat(t,". ").concat(e.language||"text",': "').concat(e.code.substring(0,60),'..."')})).join("\n"),"\n"):": ",'\n\n :\n-     -     \n-       \n-       (8/10)\n-           \n\nJSON :\n{\n  "totalImages": ').concat((null===(a=null==p?void 0:p.pageImages)||void 0===a?void 0:a.length)||0,',\n  "totalFormulas": ').concat((null===(i=null==p?void 0:p.formulas)||void 0===i?void 0:i.length)||0,',\n  "totalCode": ').concat((null===(s=null==p?void 0:p.codeBlocks)||void 0===s?void 0:s.length)||0,',\n  "assignments": [\n    {\n      "cardId": "card_1",\n      "imageIndices": [0],\n      "formulaIndices": [],\n      "codeIndices": [],\n      "reasoning": " 0    "\n    }\n  ],\n  "userSelectedImages": [').concat((null===(l=null==p?void 0:p.pageImages)||void 0===l?void 0:l.map((function(e,t){return t})).join(", "))||"",'],\n  "reasoning": " "\n}'),w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.aiService.createChatCompletion(this.apiKey,[{role:"system",content:this.agents.multimediaAssigner.systemPrompt},{role:"user",content:f}])];case 2:if(!(null==(g=w.sent())?void 0:g.content))throw new Error("No response from multimedia assigner agent");return h=this.parseJSONResponse(g.content,"multimediaAssigner"),console.log(" Multimedia assignment result:",h),[2,h];case 3:return m=w.sent(),console.error("Multimedia assigner error:",m),y=[],x=(null===(c=null==p?void 0:p.pageImages)||void 0===c?void 0:c.length)||0,v=(null===(u=null==p?void 0:p.formulas)||void 0===u?void 0:u.length)||0,b=(null===(d=null==p?void 0:p.codeBlocks)||void 0===d?void 0:d.length)||0,t.cardSpecs.forEach((function(e,n){var r={cardId:e.id,imageIndices:[],formulaIndices:[],codeIndices:[],reasoning:"Fallback assignment"};if(e.needsMultimedia&&Array.isArray(e.multimediaTypes)&&e.multimediaTypes.includes("images")&&x>0){var o=Math.ceil(x/t.cardSpecs.length),a=n*o,i=Math.min(a+o,x);r.imageIndices=Array.from({length:i-a},(function(e,t){return a+t}))}y.push(r)})),[2,{totalImages:x,totalFormulas:v,totalCode:b,assignments:y,userSelectedImages:Array.from({length:x},(function(e,t){return t})),reasoning:"Fallback distribution due to error"}];case 4:return[2]}}))}))},e.prototype.getMatchedContentForCard=function(e,t){if(!t||!t.cardMatches)return" ";var n=t.cardMatches.find((function(t){return t.cardIndex===e}));if(!n)return" ";var r=[];return n.relevantImages&&Array.isArray(n.relevantImages)&&n.relevantImages.length>0&&r.push(" [".concat(n.relevantImages.join(", "),"]")),n.relevantFormulas&&Array.isArray(n.relevantFormulas)&&n.relevantFormulas.length>0&&r.push(" [".concat(n.relevantFormulas.join(", "),"]")),n.relevantCode&&Array.isArray(n.relevantCode)&&n.relevantCode.length>0&&r.push(" [".concat(n.relevantCode.join(", "),"]")),r.length>0?r.join(", "):"  "},e.prototype.detectLanguage=function(e){return/[-]/i.test(e)?"russian":"english"},e.prototype.estimateComplexity=function(e){var t=e.split(/\s+/).length,n=t/e.split(/[.!?]+/).length;return n<10&&t<100?"simple":n<20&&t<500?"medium":"advanced"},e.prototype.parseJSONResponse=function(e,t){try{var n=e.match(/\{[\s\S]*\}/);if(!n)throw new Error("No JSON found in ".concat(t," response"));return JSON.parse(n[0])}catch(e){throw console.error("Error parsing ".concat(t," response:"),e),e}},e.prototype.createFallbackSupervisorDecision=function(){return{strategy:"multiple_concepts",agents:["contentAnalyzer","cardGenerator","questionQuality","validator"],instructions:{contentAnalyzer:"    ",cardGenerator:"    ",questionQuality:"   ",validator:"  "},expectedOutput:"  ",reasoning:"Fallback strategy - general approach"}},e.prototype.createFallbackContentAnalysis=function(e){return{mainTopic:" ",keyPoints:[e.substring(0,100)],concepts:[{name:" ",definition:e.substring(0,200),importance:"medium",prerequisites:[],examples:[]}],relationships:[],learningObjectives:["  "],complexity:"medium",estimatedCards:2}},e.prototype.createFallbackCards=function(e){return[{front:"What is discussed in this text?",back:e.substring(0,200)+(e.length>200?"...":""),difficulty:"medium",concept:"Main idea"}]},e.prototype.createFallbackQualityCheck=function(e){return{question:e.front,answer:e.back,qualityScore:7,relevanceScore:7,difficultyScore:7,issues:[],improvements:[],isWorthwhile:!0,reasoning:"Fallback quality check - acceptable card"}},e.prototype.createFallbackValidation=function(e){return{isValid:!0,overallScore:75,cardScores:e.reduce((function(e,t,n){var r;return bs(bs({},e),((r={})[n]=75,r))}),{}),issues:[],suggestions:[],finalRecommendation:"Cards passed basic validation"}},e.prototype.createFallbackContentEnhancement=function(){return{shouldIncludeImages:!1,selectedImages:[],shouldIncludeFormulas:!1,selectedFormulas:[],shouldIncludeCode:!1,selectedCode:[],reasoning:"Fallback - no multimedia content analysis"}},e.prototype.convertToStoredCards=function(e,t){return e.map((function(e,n){var r=bs(bs(bs(bs({id:"ai_agent_".concat(Date.now(),"_").concat(n,"_").concat(Math.random().toString(36).substr(2,9)),mode:_.GeneralTopic,front:e.front,back:e.back,text:t,createdAt:new Date,exportStatus:"not_exported"},e.tags&&{tags:e.tags}),e.difficulty&&{difficulty:e.difficulty}),e.concept&&{concept:e.concept}),e.qualityScore&&{qualityScore:e.qualityScore});if(e.attachedImages&&e.attachedImages.length>0){var o=e.attachedImages[0];o.base64?(r.image=o.base64,console.log("    base64   :",r.id)):o.src&&(r.imageUrl=o.src,console.log("      :",r.id))}return e.image&&(r.image=e.image,console.log("    card.image  :",r.id)),e.imageUrl&&(r.imageUrl=e.imageUrl,console.log("    card.imageUrl  :",r.id)),r}))},e}(),Es=function(e,t){return new ks(e,t)},Is=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},As=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},_s=function(){function e(){}return e.extractPageContent=function(e,t){return{selectedText:e,pageImages:this.extractImages(e,t),formulas:this.extractFormulas(e,t),codeBlocks:this.extractCodeBlocks(e,t),links:this.extractLinks(e,t),metadata:this.extractMetadata()}},e.extractPageContentAsync=function(e,t){return Is(this,void 0,void 0,(function(){var n,r,o,a,i;return As(this,(function(s){switch(s.label){case 0:return console.log("    ..."),[4,this.extractImagesAsync(e,t)];case 1:return n=s.sent(),r=this.extractFormulas(e,t),o=this.extractCodeBlocks(e,t),a=this.extractLinks(e,t),i=this.extractMetadata(),console.log("   :",{images:n.length,formulas:r.length,codeBlocks:o.length,links:a.length}),[2,{selectedText:e,pageImages:n,formulas:r,codeBlocks:o,links:a,metadata:i}]}}))}))},e.extractImages=function(e,t){var n=this,r=[],o=document.querySelectorAll("img");console.log("  ".concat(o.length,"   ")),o.forEach((function(o,a){if(o.width<30||o.height<30)console.log("    ".concat(a,": ").concat(o.width,"x").concat(o.height));else if(o.src)if(o.src.startsWith("data:image")&&o.src.length>5e3)console.log("   ".concat(a,":   data URL"));else{var i=n.isElementNearSelection(o,t,e),s=n.calculateImageRelevance(o,e,i);if(console.log("  ".concat(a,":"),{src:o.src.substring(0,50)+"...",alt:o.alt,size:"".concat(o.width,"x").concat(o.height),isNearText:i,relevanceScore:s,willInclude:s>.1}),s>.1){var l=n.convertImageToBase64(o);r.push({src:o.src,alt:o.alt||o.title||"",title:o.title,width:o.naturalWidth||o.width,height:o.naturalHeight||o.height,isNearText:i,relevanceScore:s,base64:l}),console.log("   ".concat(a," (score: ").concat(s,")"))}else console.log("  ".concat(a,"    (score: ").concat(s,")"))}else console.log("   ".concat(a,":  src"))}));var a=document.querySelectorAll("svg");console.log("  ".concat(a.length," SVG ")),a.forEach((function(o,a){var i,s,l=(null===(i=o.width.baseVal)||void 0===i?void 0:i.value)||0,c=(null===(s=o.height.baseVal)||void 0===s?void 0:s.value)||0;if(l<30||c<30)console.log("   SVG ".concat(a,": ").concat(l,"x").concat(c));else{var u=n.isElementNearSelection(o,t,e),d=n.calculateSvgRelevance(o,e,u);console.log(" SVG ".concat(a,":"),{size:"".concat(l,"x").concat(c),isNearText:u,relevanceScore:d,willInclude:d>.1}),d>.1&&(r.push({src:n.svgToDataUrl(o),alt:o.getAttribute("aria-label")||o.getAttribute("title")||"SVG ",width:l||200,height:c||200,isNearText:u,relevanceScore:d,base64:n.svgToDataUrl(o)}),console.log("  SVG ".concat(a," (score: ").concat(d,")")))}}));var i=r.sort((function(e,t){return t.relevanceScore-e.relevanceScore})).slice(0,10);if(0===i.length){console.log("    ,   ");var s=[];o.forEach((function(e,t){if(e.width>=30&&e.height>=30&&e.src){var r=n.convertImageToBase64(e);s.push({src:e.src,alt:e.alt||e.title||" ".concat(t+1),title:e.title,width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,isNearText:!1,relevanceScore:.5,base64:r})}})),i=s.slice(0,5),console.log("  :  ".concat(i.length," "))}return console.log("  : ".concat(i.length,"   ").concat(r.length," ")),i},e.extractImagesAsync=function(e,t){return Is(this,void 0,void 0,(function(){var n,r,o,a=this;return As(this,(function(i){switch(i.label){case 0:return n=[],r=document.querySelectorAll("img"),o=Array.from(r).map((function(n){return Is(a,void 0,void 0,(function(){var r,o,a;return As(this,(function(i){switch(i.label){case 0:return n.width<50||n.height<50||(!n.src||n.src.startsWith("data:image")&&n.src.length>1e3)?[2,null]:(r=this.isElementNearSelection(n,t,e),(o=this.calculateImageRelevance(n,e,r))<=.3?[2,null]:!n.src.startsWith("http")||n.src.includes(window.location.origin)?[3,2]:(console.log("   :",n.src),[4,this.fetchImageAsBase64(n.src)]));case 1:return a=i.sent(),[3,3];case 2:a=this.convertImageToBase64(n),i.label=3;case 3:return[2,{src:n.src,alt:n.alt||n.title||"",title:n.title,width:n.naturalWidth||n.width,height:n.naturalHeight||n.height,isNearText:r,relevanceScore:o,base64:a}]}}))}))})),[4,Promise.all(o)];case 1:return i.sent().forEach((function(e){e&&n.push(e)})),document.querySelectorAll("svg").forEach((function(r){var o,i,s=(null===(o=r.width.baseVal)||void 0===o?void 0:o.value)||0,l=(null===(i=r.height.baseVal)||void 0===i?void 0:i.value)||0;if(!(s<50||l<50)){var c=a.isElementNearSelection(r,t,e),u=a.calculateSvgRelevance(r,e,c);u>.3&&n.push({src:a.svgToDataUrl(r),alt:r.getAttribute("aria-label")||r.getAttribute("title")||"SVG ",width:s||200,height:l||200,isNearText:c,relevanceScore:u,base64:a.svgToDataUrl(r)})}})),console.log("  ".concat(n.length,"   ( ").concat(n.filter((function(e){return e.base64})).length,"  base64)")),[2,n.sort((function(e,t){return t.relevanceScore-e.relevanceScore})).slice(0,5)]}}))}))},e.extractFormulas=function(e,t){var n=this,r=[];document.querySelectorAll('.MathJax, .math, [class*="math"]').forEach((function(o){var a=n.extractFormulaText(o);if(a){var i=n.isElementNearSelection(o,t,e);r.push({text:a,type:n.detectFormulaType(o),isNearText:i,relevanceScore:n.calculateFormulaRelevance(a,e,i)})}}));var o=[/\$\$([^$]+)\$\$/g,/\$([^$]+)\$/g,/\\begin\{[^}]+\}[\s\S]*?\\end\{[^}]+\}/g],a=document.body.textContent||"";return o.forEach((function(t){for(var i;null!==(i=t.exec(a));){var s=i[1]||i[0],l=a.toLowerCase().includes(e.toLowerCase());r.push({text:s,type:t===o[0]?"block":"inline",isNearText:l,relevanceScore:n.calculateFormulaRelevance(s,e,l)})}})),r.filter((function(e){return e.relevanceScore>.2})).sort((function(e,t){return t.relevanceScore-e.relevanceScore})).slice(0,3)},e.extractCodeBlocks=function(e,t){var n=this,r=[];return document.querySelectorAll("pre code, .highlight code, .code-block, .codehilite").forEach((function(o){var a,i=null===(a=o.textContent)||void 0===a?void 0:a.trim();if(i&&i.length>10&&i.length<2e3){var s=n.isElementNearSelection(o,t,e),l=n.detectCodeLanguage(o);r.push({code:i,language:l,isNearText:s,relevanceScore:n.calculateCodeRelevance(i,e,s)})}})),document.querySelectorAll("code:not(pre code)").forEach((function(o){var a,i=null===(a=o.textContent)||void 0===a?void 0:a.trim();if(i&&i.length>3&&i.length<100){var s=n.isElementNearSelection(o,t,e);r.push({code:i,language:"inline",isNearText:s,relevanceScore:n.calculateCodeRelevance(i,e,s)})}})),r.filter((function(e){return e.relevanceScore>.3})).sort((function(e,t){return t.relevanceScore-e.relevanceScore})).slice(0,5)},e.extractLinks=function(e,t){var n=this,r=[];return document.querySelectorAll("a[href]").forEach((function(o){var a,i=o.getAttribute("href"),s=null===(a=o.textContent)||void 0===a?void 0:a.trim();if(i&&s&&i.startsWith("http")){var l=n.isElementNearSelection(o,t,e),c=n.calculateLinkRelevance(s,i,e,l);c>.2&&r.push({url:i,text:s,isNearText:l,relevanceScore:c})}})),r.sort((function(e,t){return t.relevanceScore-e.relevanceScore})).slice(0,3)},e.extractMetadata=function(){return{url:window.location.href,title:document.title,domain:window.location.hostname,language:document.documentElement.lang||"en",hasImages:document.querySelectorAll("img").length>0,hasFormulas:document.querySelectorAll('.MathJax, .math, [class*="math"]').length>0||(document.body.textContent||"").includes("$"),hasCode:document.querySelectorAll("pre code, .highlight, .code-block").length>0}},e.isElementNearSelection=function(e,t,n){var r;if(!t){var o=e.textContent||"",a=(null===(r=e.parentElement)||void 0===r?void 0:r.textContent)||"";return o.toLowerCase().includes((n||"").toLowerCase())||a.toLowerCase().includes((n||"").toLowerCase())}var i=e.getBoundingClientRect(),s=t.getBoundingClientRect();return Math.sqrt(Math.pow(i.left-s.left,2)+Math.pow(i.top-s.top,2))<500},e.calculateImageRelevance=function(e,t,n){var r=.3;n&&(r+=.4);var o=(e.alt||"").toLowerCase(),a=t.toLowerCase();(o.includes(a)||a.includes(o))&&(r+=.3);var i=e.naturalWidth||e.width,s=e.naturalHeight||e.height;return i>=50&&s>=50&&(r+=.2),(o.includes("icon")||o.includes("logo")||i<50||s<50)&&(r-=.2),(o.includes("diagram")||o.includes("chart")||o.includes("graph")||o.includes("figure")||o.includes("")||o.includes("")||o.includes("")||o.includes(""))&&(r+=.3),console.log(" Relevance calculation for image:",{alt:o.substring(0,30),size:"".concat(i,"x").concat(s),isNearText:n,finalScore:Math.max(0,Math.min(1,r))}),Math.max(0,Math.min(1,r))},e.calculateSvgRelevance=function(e,t,n){var r=0;n&&(r+=.5),r+=.3;var o=e.textContent||"";return(o.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(o.toLowerCase()))&&(r+=.2),Math.max(0,Math.min(1,r))},e.calculateFormulaRelevance=function(e,t,n){var r=0;n&&(r+=.4);var o=t.toLowerCase().match(/\b(|||||||||||||)\b/g);return o&&o.length>0&&(r+=.4),e.length>20&&(r+=.2),Math.max(0,Math.min(1,r))},e.calculateCodeRelevance=function(e,t,n){var r=0;n&&(r+=.4);var o=t.toLowerCase().match(/\b(||||||||||)\b/g);return o&&o.length>0&&(r+=.4),e.includes("\n")&&e.includes("{")&&e.includes("}")&&(r+=.2),Math.max(0,Math.min(1,r))},e.calculateLinkRelevance=function(e,t,n,r){var o=0;return r&&(o+=.3),(e.toLowerCase().includes(n.toLowerCase())||n.toLowerCase().includes(e.toLowerCase()))&&(o+=.4),(t.includes("wikipedia")||t.includes("edu")||t.includes("documentation"))&&(o+=.3),Math.max(0,Math.min(1,o))},e.convertImageToBase64=function(e){try{if(!e.complete||0===e.naturalWidth)return void console.warn("Image not loaded yet:",e.src);var t=document.createElement("canvas"),n=t.getContext("2d");if(!n)return;return t.width=e.naturalWidth||e.width,t.height=e.naturalHeight||e.height,n.fillStyle="#FFFFFF",n.fillRect(0,0,t.width,t.height),n.drawImage(e,0,0),t.toDataURL("image/png",1)}catch(e){return void console.warn("Could not convert image to base64:",e)}},e.fetchImageAsBase64=function(e){return Is(this,void 0,void 0,(function(){var t;return As(this,(function(n){try{return console.log("   :",e),(t=new Image).crossOrigin="anonymous",[2,new Promise((function(n){t.onload=function(){try{var e=document.createElement("canvas"),r=e.getContext("2d");if(!r)return void n(void 0);e.width=t.naturalWidth,e.height=t.naturalHeight,r.fillStyle="#FFFFFF",r.fillRect(0,0,e.width,e.height),r.drawImage(t,0,0);var o=e.toDataURL("image/png",1);console.log("     base64"),n(o)}catch(e){console.warn("   :",e),n(void 0)}},t.onerror=function(){console.warn("  :",e),n(void 0)},t.src=e}))]}catch(e){return console.warn("Failed to fetch image as base64:",e),[2,void 0]}return[2]}))}))},e.svgToDataUrl=function(e){var t=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,".concat(btoa(t))},e.extractFormulaText=function(e){var t=e.querySelector("math");return t?t.textContent||t.innerHTML:e.getAttribute("data-latex")||e.getAttribute("data-math")||e.textContent||null},e.detectFormulaType=function(e){if(e.querySelector("math"))return"mathml";var t=e.className.toLowerCase();return t.includes("display")||t.includes("block")?"block":t.includes("inline")?"inline":"latex"},e.detectCodeLanguage=function(e){var t=e.className.match(/language-(\w+)|lang-(\w+)|highlight-(\w+)/);if(t)return t[1]||t[2]||t[3];var n=e.getAttribute("data-lang")||e.getAttribute("data-language");if(n)return n;var r=e.textContent||"";return r.includes("function")&&r.includes("{")?"javascript":r.includes("def ")&&r.includes(":")?"python":r.includes("#include")||r.includes("int main")?"cpp":r.includes("public class")||r.includes("System.out")?"java":void 0},e}(),js=function(){return js=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},js.apply(this,arguments)},Fs=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ts=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ps=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const Rs=function(){r.useEffect((function(){var e=document.createElement("style");return e.textContent="\n            @keyframes fadeIn {\n                from { opacity: 0; }\n                to { opacity: 1; }\n            }\n            @keyframes slideUp {\n                from { \n                    opacity: 0;\n                    transform: translateY(30px) scale(0.95);\n                }\n                to { \n                    opacity: 1;\n                    transform: translateY(0) scale(1);\n                }\n            }\n            @keyframes slideIn {\n                from { \n                    opacity: 0;\n                    transform: translateX(-20px);\n                }\n                to { \n                    opacity: 1;\n                    transform: translateX(0);\n                }\n            }\n        ",document.head.appendChild(e),function(){document.head.removeChild(e)}}),[]);var e=(0,r.useState)(!1),t=e[0],n=e[1],o=(m((function(e){return e.deck.deckId})),Ue()),i=E(),s=(0,r.useCallback)((function(e){i({type:"SET_SOURCE_LANGUAGE",payload:e}),localStorage.setItem("source_language",e)}),[i]),l=o.text,c=o.translation,u=o.examples,d=o.image,p=o.imageUrl,f=o.front,g=o.back,h=o.currentCardId,y=o.linguisticInfo,x=o.transcription,v=(o.fieldIdPrefix,m((function(e){return e.settings.translateToLanguage}))),b=m((function(e){return e.settings.aiInstructions})),w=m((function(e){return e.settings.imageInstructions})),S=(m((function(e){return e.deck.decks})),m((function(e){return e.settings.mode}))),C=(0,r.useState)(""),k=C[0],I=C[1],A=(0,r.useCallback)((function(){var e=S===_.LanguageLearning?_.GeneralTopic:_.LanguageLearning;i(wt(e)),localStorage.setItem("selected_mode",e),i(Ie("")),i(Pe("")),i(Te(null)),i(_e(null)),i(Ae([])),i(je(null)),i(Fe(null)),i(Oe("")),i(ze("")),i(Be(null)),Bt(null),Xt(""),Dt(!1),n(!1),Pt(!1),kt([]),At(0)}),[S,i]),j=(m((function(e){return e.settings.useAnkiConnect})),m((function(e){return e.settings.ankiConnectUrl})),m((function(e){return e.settings.ankiConnectApiKey})),(0,r.useState)(!1)),F=j[0],T=j[1],P=(0,r.useState)(!1),R=P[0],B=P[1],O=(0,r.useState)(!1),z=O[0],L=O[1],N=(0,r.useState)(!1),D=N[0],M=N[1],U=(0,r.useState)(null),q=U[0],W=U[1],$=(0,r.useState)({completed:0,total:0}),G=$[0],V=$[1],H=(0,r.useState)(!1),K=H[0],Q=H[1],J=(0,r.useState)(0),X=J[0],Y=J[1],Z=(0,r.useRef)(null),ee=(0,r.useState)(!0),te=ee[0],ne=ee[1],re=(0,r.useState)(!1),oe=re[0],ae=re[1],ie=m((function(e){return e.settings.openAiKey})),se=m((function(e){return e.settings.groqApiKey})),le=m((function(e){return e.settings.groqModelName})),ce=m((function(e){return e.settings.modelProvider})),ue=m((function(e){return e.settings.shouldGenerateImage})),de=m((function(e){return e.settings.imageGenerationMode})),pe=(0,r.useState)(!1),fe=pe[0],ge=pe[1],he=(0,r.useState)(!1),me=he[0],ye=he[1],xe=(0,r.useState)(b),ve=xe[0],be=xe[1],we=(0,r.useState)(w),Se=we[0],Ce=we[1],Le=Di(),Ne=Le.showError,De=Le.renderErrorNotification,Me=function(e){var t=e.message.toLowerCase();return t.includes("quota")||t.includes("insufficient_quota")||t.includes("billing")||t.includes("exceeded")||t.includes("429")},qe=new Bi({apiKey:ie,dangerouslyAllowBrowser:!0}),We=(0,r.useState)(""),Ge=We[0],Ve=We[1],He=(0,r.useState)(!1),Ze=He[0],et=He[1],nt=(0,r.useState)(!1),rt=nt[0],ot=nt[1],at=(0,r.useState)([]),st=at[0],lt=at[1],ct=(0,r.useState)(!1),ut=ct[0],dt=ct[1],ft=(0,r.useState)(!1),gt=ft[0],yt=ft[1],xt=(0,r.useState)({}),vt=xt[0],bt=xt[1],St=(0,r.useState)([]),Ct=St[0],kt=St[1],Et=(0,r.useState)(0),It=Et[0],At=Et[1],_t=(0,r.useState)(!1),Ft=_t[0],Pt=_t[1],Rt=(0,r.useState)(null),Bt=(Rt[0],Rt[1]),Ot=(0,r.useState)(!1),Dt=(Ot[0],Ot[1]),qt=(0,r.useState)(""),Vt=qt[0],Xt=qt[1],Yt=(0,r.useState)([]),tn=Yt[0],nn=Yt[1],on=(0,r.useState)(!1),an=on[0],ln=on[1],cn=(0,r.useState)(0),un=cn[0],dn=cn[1],pn=(0,r.useState)(new Set),fn=pn[0],gn=pn[1],mn=(0,r.useState)(!1),yn=mn[0],xn=mn[1],vn=(0,r.useState)(""),bn=vn[0],wn=vn[1],Sn=(0,r.useRef)(null),Cn=o.storedCards,kn=(0,r.useMemo)((function(){return ps(ce)}),[ce]),En=(0,r.useMemo)((function(){return function(e,t,n){switch(void 0===n&&(n=""),e){case Ji.OpenAI:return t;case Ji.Groq:return n;default:return t}}(ce,ie,se)}),[ce,ie,se]),In=(0,r.useState)([]),An=In[0],_n=In[1],jn=(0,r.useCallback)((function(e){return!!e&&An.includes(e)}),[An]),Fn=(0,r.useMemo)((function(){if(console.log("Calculating isSaved:",{currentCardId:h,explicitlySaved:oe,isMultipleCards:Ft,currentCardIndex:It,createdCardsLength:Ct.length,explicitlySavedIds:An}),Ft&&Ct.length>0){var e=Ct[It];return!!e&&jn(e.id)}return!(!h||!oe)}),[h,oe,Ft,It,Ct,jn]);console.log("Card state details:",{isNewSubmission:te,explicitlySaved:oe,isSaved:Fn,currentCardId:h,text:l.substring(0,20)+(l.length>20?"...":""),localStorage_explicitly_saved:localStorage.getItem("explicitly_saved")});(0,r.useEffect)((function(){return console.log(" Loading state changed:",{loadingGetResult:F,isProcessingCustomInstruction:Ze,loadingNewImage:R,loadingNewExamples:z}),F?(console.log(" Starting timer for card creation"),Y(0),Z.current=setInterval((function(){Y((function(e){return e+1}))}),1e3)):Z.current&&(console.log(" Stopping timer for card creation"),clearInterval(Z.current),Z.current=null),function(){Z.current&&clearInterval(Z.current)}}),[F,Ze,R,z]);(0,r.useEffect)((function(){Fn&&Q(!0)}),[l,c,u,d,p,f,Fn]);var Tn=(0,r.useCallback)((function(e){if(e&&""!==e.trim()){var t=Hi().find((function(t){return t.text===e}));return!!t&&(console.log("Found existing card with matching text:",(null==t?void 0:t.text)||e,"ID:",t.id),console.log("Setting currentCardId but NOT setting explicitlySaved"),i(Be(t.id)),!0)}}),[i]),Pn=function(e){o.setText(e),Fn?Q(!0):Tn(e)},Rn=function(e){o.setTranslation(e),Fn&&Q(!0)},Bn=function(e){o.setExamples(e),Fn&&Q(!0)},On=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,a,i,s;return Ts(this,(function(c){switch(c.label){case 0:B(!0),c.label=1;case 1:return c.trys.push([1,6,7,8]),(null===(i=Sn.current)||void 0===i?void 0:i.signal.aborted)?(console.log("New image generation cancelled"),[2]):[4,kn.getDescriptionImage(En,l,w,null===(s=Sn.current)||void 0===s?void 0:s.signal)];case 2:return e=c.sent(),ce!==Ji.OpenAI?[3,4]:[4,Li(0,qe,ie,e,w)];case 3:return t=c.sent(),n=t.imageUrl,r=t.imageBase64,n&&o.setImageUrl(n),r&&o.setImage(r),[3,5];case 4:Ne("Image generation is not supported with the selected provider."),c.label=5;case 5:return[3,8];case 6:return(a=c.sent())instanceof Error&&Me(a)?(console.error("Quota error detected in image generation:",a.message),Ne(a.message),[2]):(console.error("Error generating image:",a),Ne(a instanceof Error?a.message:"Failed to generate image"),[3,8]);case 7:return B(!1),[7];case 8:return Fn&&Q(!0),[2]}}))}))},zn=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,a;return Ts(this,(function(i){switch(i.label){case 0:L(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),(null===(r=Sn.current)||void 0===r?void 0:r.signal.aborted)?(console.log("New examples generation cancelled"),[2]):[4,gs(kn,En,l,v,!0,b,(Ar?hr:pr)||void 0,null===(a=Sn.current)||void 0===a?void 0:a.signal)];case 2:return(e=i.sent())&&e.length>0&&(t=e.map((function(e){return[e.original,e.translated]})),o.setExamples(t)),[3,5];case 3:return(n=i.sent())instanceof Error&&Me(n)?(console.error("Quota error detected in examples generation:",n.message),Ne(n.message),[2]):(console.error("Error getting examples:",n),Ne(n instanceof Error?n.message:"Failed to generate examples"),[3,5]);case 4:return L(!1),[7];case 5:return Fn&&Q(!0),[2]}}))}))},Ln=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,a,i,s,c,u;return Ts(this,(function(d){switch(d.label){case 0:if(!Ge.trim()||Ze)return[2];et(!0),d.label=1;case 1:return d.trys.push([1,15,16,17]),Ge.toLowerCase().includes("image")||Ge.toLowerCase().includes("picture")||Ge.toLowerCase().includes("")||Ge.toLowerCase().includes("")?[4,tt(ie,l,Ge)]:[3,4];case 2:return i=d.sent(),[4,Li(0,qe,ie,i,Ge)];case 3:return e=d.sent(),t=e.imageUrl,n=e.imageBase64,t&&o.setImageUrl(t),n&&o.setImage(n),[3,14];case 4:return Ge.toLowerCase().includes("example")||Ge.toLowerCase().includes("sentence")||Ge.toLowerCase().includes("")||Ge.toLowerCase().includes("")?(console.log(" Starting examples generation..."),[4,kn.getExamples(En,l,v,!0,Ge)]):[3,6];case 5:return a=d.sent(),console.log(" Examples generation completed"),o.setExamples(a),[3,14];case 6:return Ge.toLowerCase().includes("translat")||Ge.toLowerCase().includes("")?[4,kn.translateText(En,l,v,Ge)]:[3,8];case 7:return(r=d.sent())&&o.setTranslation(r),[3,14];case 8:return[4,kn.translateText(En,l,v,Ge)];case 9:return r=d.sent(),console.log(" Starting examples generation (combined)..."),[4,kn.getExamples(En,l,v,!0,Ge)];case 10:return a=d.sent(),console.log(" Examples generation completed (combined)"),ue?[4,kn.getDescriptionImage(En,l,Ge)]:[3,13];case 11:return i=d.sent(),[4,null===(u=kn.getImageUrl)||void 0===u?void 0:u.call(kn,En,i)];case 12:(s=d.sent())&&o.setImageUrl(s),d.label=13;case 13:r&&o.setTranslation(r),o.setExamples(a),d.label=14;case 14:return Ve(""),[3,17];case 15:return(c=d.sent())instanceof Error&&Me(c)?(console.error("Quota error detected in custom instructions:",c.message),Ne(c.message),[2]):(console.error("Error applying custom instructions:",c),Ne(c instanceof Error?c.message:"Failed to apply custom instructions"),[3,17]);case 16:return console.log(" Custom instruction processing completed"),et(!1),[7];case 17:return[2]}}))}))},Nn=function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Ln())},Dn=function(){return ce!==Ji.Groq},Mn=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,o,a,s,u;return Ts(this,(function(f){console.log("*** HANDLE SAVE ALL CARDS: Starting ***"),console.log("Current Redux state at save all cards time:",{text:l,translation:c,image:d,imageUrl:p,hasImage:!!d,hasImageUrl:!!p,imageType:typeof d,imageUrlType:typeof p,shouldGenerateImage:ue,mode:S,createdCardsCount:Ct.length}),Ne(null);try{for(M(!0),Yn(),e=0,t=0,n=0,r=0,o=Ps([],An,!0),console.log("Starting to save cards. Total cards:",Ct.length,"Already saved:",An.length),a=function(a){var s=Ct[a];if(An.includes(s.id))return console.log("Card #".concat(a," (").concat(s.id,") already explicitly saved, skipping")),e++,"continue";try{console.log("Saving card #".concat(a," (").concat(s.id,") from multi-card set")),-1===Cn.findIndex((function(e){return e.id===s.id||e.text===s.text&&e.mode===s.mode}))?(i(ke(s)),n++,o.push(s.id),console.log("Card #".concat(a," (").concat(s.id,") saved as new")),e++):(console.log("Card #".concat(a," (").concat(s.id,") already in storage, updating")),i(Re(s)),r++,o.push(s.id),e++)}catch(e){console.error("Error saving card #".concat(a," (").concat(s.id,"):"),e),t++}},s=0;s<Ct.length;s++)a(s);console.log("Save all complete. Saved:",n,"Updated:",r,"Errors:",t),_n(o),ae(!0),localStorage.setItem("explicitly_saved","true"),(u=Ct[It])&&u.id&&(i(Be(u.id)),localStorage.setItem("current_card_id",u.id)),0===t?n>0&&r>0?"Saved ".concat(n," new cards and updated ").concat(r," existing cards."):n>0?"Saved ".concat(n," cards successfully!"):r>0?"Updated ".concat(r," cards successfully!"):"All ".concat(e," cards are now saved!"):Ne("Saved ".concat(e," cards, ").concat(t," failed."),"warning"),Q(!1),ne(!1),i(Ee())}catch(e){console.error("Error in save all cards operation:",e),Ne("Error saving cards. Please try again.")}finally{M(!1)}return[2]}))}))},Un=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,a,s,g;return Ts(this,(function(m){console.log("*** HANDLE ACCEPT: Starting to save card ***"),console.log("Current Redux state at save time:",{text:l,translation:c,image:d,imageUrl:p,hasImage:!!d,hasImageUrl:!!p,imageType:typeof d,imageUrlType:typeof p,imageLength:null==d?void 0:d.length,imageUrlLength:null==p?void 0:p.length,shouldGenerateImage:ue,mode:S}),Ne(null);try{if(M(!0),Ft&&Ct.length>0)return Yn(),(e=Ct[It])?(console.log("Saving current card from multi-card set:",e.id),-1===Cn.findIndex((function(t){return t.id===e.id||t.text===e.text&&t.mode===e.mode}))?(o.saveCardToStorage(e),console.log("Saved new card: ".concat(e.id))):(o.updateStoredCard(e),console.log("Updated existing card: ".concat(e.id))),_n((function(t){if(t.includes(e.id))return t;var n=Ps(Ps([],t,!0),[e.id],!1);return console.log("Updated explicitly saved IDs:",n),n})),i(Ee()),o.setCurrentCardId(e.id),localStorage.setItem("current_card_id",e.id),ae(!0),localStorage.setItem("explicitly_saved","true"),Q(!1),[2]):(Ne("Card data not found"),[2]);if(t=h||Date.now().toString(),console.log("Saving card with data:",{originalSelectedText:k,text:l,translation:c,examples:u.length,mode:S,currentCardId:h,linguisticInfo:y?"present":"absent"}),S===_.LanguageLearning){if(!l&&!k)return console.error("Missing text data for card"),Ne("Please enter or select some text for your card before saving."),[2];n={id:t,mode:S,text:k||l,translation:c,examples:u,linguisticInfo:y,transcription:x||"",image:d,imageUrl:p,createdAt:new Date,exportStatus:"not_exported"},console.log("*** CREATECARD: Preparing to save card to storage ***"),console.log("Card data being sent to Redux:",{id:n.id,text:n.text,mode:n.mode,hasImage:!!n.image,hasImageUrl:!!n.imageUrl,imageType:typeof n.image,imageUrlType:typeof n.imageUrl,imageLength:null===(r=n.image)||void 0===r?void 0:r.length,imageUrlLength:null===(a=n.imageUrl)||void 0===a?void 0:a.length,imageActualValue:n.image,imageUrlActualValue:n.imageUrl,imagePreview:null===(s=n.image)||void 0===s?void 0:s.substring(0,50),imageUrlPreview:null===(g=n.imageUrl)||void 0===g?void 0:g.substring(0,50)}),h?(console.log("Updating existing card by user action:",t),o.updateStoredCard(n)):(console.log("Saving new card by user action:",t),o.saveCardToStorage(n),o.setCurrentCardId(t))}else if(S===_.GeneralTopic){if(!f)return console.error("Missing front data for general topic card"),Ne("Please generate card content before saving."),[2];n={id:t,mode:S,front:f,back:c||f,text:k||l||"",linguisticInfo:y,transcription:x||"",image:d,imageUrl:p,createdAt:new Date,exportStatus:"not_exported"},console.log("Saving general topic card to storage:",n),h?(console.log("Updating existing general topic card by user action:",t),o.updateStoredCard(n)):(console.log("Saving new general topic card by user action:",t),o.saveCardToStorage(n),o.setCurrentCardId(t))}ae(!0),localStorage.setItem("explicitly_saved","true"),Q(!1),ne(!1)}catch(e){console.error("Error saving card:",e),Ne("Error saving card. Please try again.")}finally{M(!1)}return[2]}))}))},qn=function(){o.setCurrentPage("storedCards")},Wn=(0,r.useCallback)((function(e){console.log("Text selection handled for tab-specific state:",e),dt(!1),bt({}),lt([]),o.setText(e),console.log("Text set via tabAware.setText:",e)}),[o]);(0,r.useEffect)((function(){var e=function(e){var t,n=document.getElementById("sidebar");if(!n||!n.contains(e.target)){if(e.target&&e.composedPath)for(var r=0,o=e.composedPath();r<o.length;r++){var a=o[r];if(a instanceof Element&&"sidebar"===a.id)return;if(a instanceof ShadowRoot&&a.host&&"sidebar"===a.host.id)return}var i=null===(t=window.getSelection())||void 0===t?void 0:t.toString().trim();i&&i.length>0&&Wn(i)}};return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[Wn]),(0,r.useEffect)((function(){var e=localStorage.getItem("selected_mode");i(wt(e||_.LanguageLearning)),l&&c&&u.length>0?n(!0):n(!1),i(Ee())}),[i]),(0,r.useEffect)((function(){Fs(void 0,void 0,void 0,(function(){return Ts(this,(function(e){return console.log("Running saved cards check on mount"),i(Ee()),setTimeout((function(){var e=Hi();console.log("Loaded cards from storage:",e.length);var t=localStorage.getItem("current_card_id"),r=localStorage.getItem("explicitly_saved");if(console.log("localStorage values on mount:",{savedCardId:t,explicitlySavedFlag:r,cardCount:e.length}),t){console.log("Found current card ID in localStorage:",t);var a=e.find((function(e){return e.id===t}));a?(console.log("Restoring card from storage:",a),Q(!1),ne(!1),"true"===r?(console.log("Setting explicitlySaved to TRUE based on localStorage flag"),ae(!0)):(console.log("Setting explicitlySaved to FALSE based on localStorage flag"),ae(!1)),o.setCurrentCardId(t),o.setText(a.text),a.translation&&o.setTranslation(a.translation),a.examples&&o.setExamples(a.examples),a.image&&o.setImage(a.image),a.imageUrl&&o.setImageUrl(a.imageUrl),a.front&&o.setFront(a.front),a.back&&o.setBack(a.back),a.linguisticInfo&&o.setLinguisticInfo(a.linguisticInfo),a.transcription&&o.setTranscription(a.transcription),I(a.text),n(!0)):(console.log("Card ID from localStorage not found in storage, resetting"),localStorage.removeItem("current_card_id"),localStorage.removeItem("explicitly_saved"),o.setCurrentCardId(null),ne(!0),ae(!1))}else console.log("No current card ID in localStorage"),ne(!0),ae(!1)}),200),[2]}))}))}),[]),(0,r.useEffect)((function(){l&&!te&&""!==l.trim()&&(!t||h?(h||(console.log("Actively typing new card text - ensuring not marked as saved"),ae(!1),localStorage.removeItem("explicitly_saved")),Tn(l)):console.log("New card being created, skipping automatic saved detection"))}),[l,h,te,t,Tn]);var $n=function(){i({type:ht,payload:ve}),ge(!1)},Gn=function(){i({type:mt,payload:Se}),ye(!1)},Vn=function(){console.log("Canceling current card, clearing all state"),Sn.current&&(console.log("Aborting ongoing AI requests"),Sn.current.abort(),Sn.current=null),n(!1),Q(!1),i(Be(null)),ne(!0),ae(!1),localStorage.removeItem("explicitly_saved"),localStorage.removeItem("current_card_id"),o.setIsGeneratingCard(!1),T(!1),kt([]),Pt(!1),At(0),i(Ie("")),i(_e("")),i(Ae([])),i(je(null)),i(Fe(null)),i(Pe("")),i(Te(null)),i(Oe("")),i(ze("")),I("")},Hn=function(){switch(ce){case Ji.OpenAI:return(0,a.jsx)("span",js({style:{display:"inline-flex",alignItems:"center",marginLeft:"8px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#10a37f",color:"white",fontSize:"10px",fontWeight:"600"}},{children:"OpenAI"}));case Ji.Groq:return(0,a.jsx)("span",js({style:{display:"inline-flex",alignItems:"center",marginLeft:"8px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#7c3aed",color:"white",fontSize:"10px",fontWeight:"600"}},{children:"Groq"}));default:return null}},Kn=function(){if(console.log("Modal close handler. Card saved status:",Fn,"isEdited:",K),Ft)return console.log("Closing modal for multiple cards without automatic saving"),void ot(!1);!t||Fn||K||!c||Ft?Fn||(console.log("Card not saved, clearing all data"),i(Ie("")),i(_e("")),i(Ae([])),i(je(null)),i(Fe(null)),i(Pe("")),i(Te(null)),i(Oe("")),i(ze("")),n(!1)):window.confirm("Would you like to save this card to your collection?")?Un():(console.log("User chose not to save, clearing all card data"),i(Ie("")),i(_e("")),i(Ae([])),i(je(null)),i(Fe(null)),i(Pe("")),i(Te(null)),i(Oe("")),i(ze("")),n(!1));ot(!1)},Qn=function(){return Fs(void 0,void 0,void 0,(function(){var e,t,r,a,s,l,c,u,d,p,f,g,h,m,y,x,C,k,E,A,_,j,F,P,R,B,O,z,L,N,D,M,U,q,W,$,G;return Ts(this,(function(V){switch(V.label){case 0:if(0===(e=Object.keys(vt).filter((function(e){return vt[e]}))).length)return Ne("Please select at least one text option","warning"),[2];Sn.current=new AbortController,t=Sn.current.signal,console.log("*** MULTIPLE CARDS CREATION STARTED ***"),console.log("Image generation settings:",{imageGenerationMode:de,modelProvider:ce,isImageGenerationAvailable:Dn(),selectedOptionsCount:e.length}),dt(!1),T(!0),o.setIsGeneratingCard(!0),V.label=1;case 1:V.trys.push([1,29,30,31]),r=[],a=0,s=e,V.label=2;case 2:if(!(a<s.length))return[3,28];if(l=s[a],t.aborted)return console.log("Multiple cards creation cancelled by user"),[2];i(Ie("")),i(_e("")),i(Ae([])),i(Oe("")),i(Ie(l)),I(l),ae(!1),localStorage.removeItem("explicitly_saved"),V.label=3;case 3:return V.trys.push([3,26,,27]),[4,fs(kn,En,l,v,b,0,t)];case 4:return c=V.sent(),t.aborted?(console.log("Multiple cards creation cancelled by user after translation"),[2]):(c.translated&&i(_e(c.translated)),[4,gs(kn,En,l,v,!0,b,(Ar?hr:pr)||void 0,t)]);case 5:return u=V.sent(),t.aborted?(console.log("Multiple cards creation cancelled by user after examples"),[2]):(u&&u.length>0&&(d=u.map((function(e){return[e.original,e.translated]})),i(Ae(d))),[4,hs(kn,En,l,t)]);case 6:return p=V.sent(),t.aborted?(console.log("Multiple cards creation cancelled by user after flashcard"),[2]):(p.front&&i(Pe(p.front)),f="",(Ar?hr:pr)?(g=void 0,console.log('Using optimized linguistic info creation for "'.concat(l,'" (max 2 requests)')),[4,vs(kn,En,l,0,v)]):[3,8]);case 7:(g=V.sent()).linguisticInfo?(f=g.linguisticInfo,i(Oe(g.linguisticInfo)),g.wasValidated?console.log('Linguistic info for "'.concat(l,'" created and validated')):console.warn('Linguistic info for "'.concat(l,'" created but not fully validated'))):console.warn('Failed to generate linguistic info for "'.concat(l,'"')),V.label=8;case 8:h="",V.label=9;case 9:return V.trys.push([9,15,,16]),(m=Ar?hr:pr)?(console.log('Creating transcription for "'.concat(l,'" using source language: ').concat(m,", user language: ").concat(v)),[4,ms(kn,En,l,m,v)]):[3,13];case 10:return(y=V.sent())?[4,Wr(v)]:[3,12];case 11:x=V.sent(),(C=[y.userLanguageTranscription&&'<div class="transcription-item user-lang">\n                                            <span class="transcription-label">'.concat(x,':</span>\n                                            <span class="transcription-text">').concat(y.userLanguageTranscription,"</span>\n                                        </div>"),y.ipaTranscription&&'<div class="transcription-item ipa">\n                                            <span class="transcription-label">IPA:</span>\n                                            <span class="transcription-text">'.concat(y.ipaTranscription,"</span>\n                                        </div>")].filter(Boolean).join("\n"))&&(h=C,i(ze(C)),console.log('Transcription created successfully for "'.concat(l,'"'))),V.label=12;case 12:return[3,14];case 13:console.warn('No source language available for transcription of "'.concat(l,'"')),V.label=14;case 14:return[3,16];case 15:return k=V.sent(),console.error('Transcription generation failed for "'.concat(l,'":'),k),[3,16];case 16:if(E=null,A=null,"off"===de||!Dn())return[3,25];V.label=17;case 17:return V.trys.push([17,24,,25]),_="always"===de,j="","smart"!==de?[3,19]:[4,$r(l)];case 18:F=V.sent(),_=F.shouldGenerate,j=F.reason,console.log('Smart image analysis for "'.concat(l,'": ').concat(_?"YES":"NO"," - ").concat(j)),V.label=19;case 19:return _?(console.log('Generating image for "'.concat(l,'"')),[4,kn.getDescriptionImage(En,l,w)]):[3,22];case 20:return P=V.sent(),[4,Li(0,qe,ie,P,w)];case 21:return R=V.sent(),B=R.imageUrl,O=R.imageBase64,B&&(E=B,console.log('Image URL generated for "'.concat(l,'": ').concat(B.substring(0,50),"..."))),O&&(A=O,console.log('Image base64 generated for "'.concat(l,'": ').concat(O.substring(0,50),"..."))),[3,23];case 22:"smart"===de&&console.log('No image needed for "'.concat(l,'": ').concat(j)),V.label=23;case 23:return[3,25];case 24:return z=V.sent(),console.error('Image generation failed for "'.concat(l,'":'),z),[3,25];case 25:return L=Date.now().toString()+"_"+r.length,N={id:L,mode:S,text:l,translation:c.translated||"",examples:u.map((function(e){return[e.original,e.translated]})),linguisticInfo:f,transcription:h,front:p.front||"",back:c.translated||"",image:A,imageUrl:E,createdAt:new Date,exportStatus:"not_exported"},console.log("Created card ".concat(N.id," but NOT saving to storage yet. Image info:"),{hasImage:!!N.image,hasImageUrl:!!N.imageUrl,imageLength:null===(q=N.image)||void 0===q?void 0:q.length,imageUrlLength:null===(W=N.imageUrl)||void 0===W?void 0:W.length}),r.push(N),[3,27];case 26:if((D=V.sent())instanceof Error&&Me(D))throw console.error("Quota error detected, stopping multiple cards creation:",D.message),Ne(D.message),D;return console.error('Error creating card for "'.concat(l,'":'),D),Ne('Failed to create card for "'.concat(l.substring(0,20),'...": ').concat(D instanceof Error?D.message:"Unknown error"),"error"),[3,27];case 27:return a++,[3,2];case 28:return r.length>0?(kt(r),At(0),Pt(r.length>1),(M=r[0])&&(console.log("Loading first card into Redux state:",{cardId:M.id,hasImage:!!M.image,hasImageUrl:!!M.imageUrl,imageLength:null===($=M.image)||void 0===$?void 0:$.length,imageUrlLength:null===(G=M.imageUrl)||void 0===G?void 0:G.length}),"string"==typeof M.text&&i(Ie(M.text)),i(_e(void 0===M.translation?null:M.translation)),i(Ae(Array.isArray(M.examples)?M.examples:[])),i(je(void 0===M.image?null:M.image)),i(Fe(void 0===M.imageUrl?null:M.imageUrl)),"string"==typeof M.front&&i(Pe(M.front)),i(Te(void 0===M.back?null:M.back)),i(Oe(M.linguisticInfo||"")),M.transcription?i(ze(M.transcription)):i(ze("")),console.log("First card loaded into Redux state successfully")),ae(!1),_n([]),localStorage.removeItem("explicitly_saved"),console.log("Reset saved status for new multiple cards"),_n([]),localStorage.removeItem("explicitly_saved"),ae(!1),n(!0),ot(!0),console.log("Created new cards, none saved yet. Card IDs:",r.map((function(e){return e.id})))):Ne("Failed to create cards. Please try again.","error"),[3,31];case 29:if(U=V.sent(),t.aborted)throw console.log("Multiple cards creation was cancelled by user"),new Error("Operation cancelled by user");return U instanceof Error&&Me(U)?(console.error("Quota error detected in multiple cards creation:",U.message),Ne(U.message),[2]):(console.error("Error processing selected options:",U),Ne(U instanceof Error?U.message:"Failed to create cards. Please try again."),[3,31]);case 30:return console.log(" Multiple cards creation finally block reached"),setTimeout((function(){console.log(" Checking for pending operations in multiple cards creation...");var e=$e(),t=e.getStats(),n=t.inProgress>0;console.log(" Multiple cards tracker stats:",t),n?(console.log(" Keeping loader visible for multiple cards - operations still running"),setTimeout((function(){console.log(" Final check for multiple cards..."),0===e.getStats().inProgress&&(console.log(" Multiple cards operations completed - hiding loader"),T(!1),o.setIsGeneratingCard(!1),bt({}))}),3e3)):(console.log(" No pending operations in multiple cards - hiding loader"),T(!1),o.setIsGeneratingCard(!1),bt({}))}),1e3),Sn.current=null,[7];case 31:return[2]}}))}))},Jn=function(e){!function(e){bt((function(t){var n;return js(js({},t),((n={})[e]=!t[e],n))}))}(e)},Xn=function(){if(!(Ct.length<=1||It>=Ct.length-1)){Yn();var e=It+1;console.log("Moving from card ".concat(It," to card ").concat(e));var t=Ct[e];t&&(console.log("Loading next card data: ".concat(t.id,", text: ").concat(t.text,", linguistic info: ").concat(t.linguisticInfo?"yes":"no")),Zn(t),At(e))}},Yn=function(){if(Ct[It]){console.log("Saving current card state:",{index:It,text:l,linguisticInfo:y?y.substring(0,30)+"...":"empty"});var e=js(js({},Ct[It]),{text:l,translation:c,examples:u,image:d,imageUrl:p,front:f,back:g||null,linguisticInfo:y||"",transcription:x||""}),t=Ps([],Ct,!0);t[It]=e,kt(t),console.log("Updated card saved:",e.id)}},Zn=function(e){var t,n;console.log("Loading card data for card:",{id:e.id,text:e.text,hasLinguisticInfo:Boolean(e.linguisticInfo),hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length}),i(Ie("")),i(_e(null)),i(Ae([])),i(je(null)),i(Fe(null)),i(Pe("")),i(Te(null)),i(Oe("")),i(ze("")),"string"==typeof e.text&&i(Ie(e.text)),i(_e(void 0===e.translation?null:e.translation)),i(Ae(Array.isArray(e.examples)?e.examples:[])),i(je(void 0===e.image?null:e.image)),i(Fe(void 0===e.imageUrl?null:e.imageUrl)),"string"==typeof e.front&&i(Pe(e.front)),i(Te(void 0===e.back?null:e.back)),e.linguisticInfo?(console.log("Setting linguistic info:",e.linguisticInfo.substring(0,30)+"..."),i(Oe(e.linguisticInfo))):(console.log("No linguistic info found for this card"),i(Oe(""))),e.transcription?(console.log("Setting transcription:",e.transcription.substring(0,30)+"..."),i(ze(e.transcription))):(console.log("No transcription found for this card"),i(ze(""))),console.log("Card data loaded successfully, image status:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl})},er=function(){if(!(Ct.length<=1||It<=0)){Yn();var e=It-1;console.log("Moving from card ".concat(It," to card ").concat(e));var t=Ct[e];t&&(console.log("Loading previous card data: ".concat(t.id,", text: ").concat(t.text,", linguistic info: ").concat(t.linguisticInfo?"yes":"no")),Zn(t),At(e))}},tr=[{code:"ru",name:"",flag:"",englishName:"Russian"},{code:"en",name:"English",flag:"",englishName:"English"},{code:"es",name:"Espaol",flag:"",englishName:"Spanish"},{code:"fr",name:"Franais",flag:"",englishName:"French"},{code:"de",name:"Deutsch",flag:"",englishName:"German"},{code:"it",name:"Italiano",flag:"",englishName:"Italian"},{code:"pt",name:"Portugus",flag:"",englishName:"Portuguese"},{code:"ja",name:"",flag:"",englishName:"Japanese"},{code:"ko",name:"",flag:"",englishName:"Korean"},{code:"zh",name:"",flag:"",englishName:"Chinese"},{code:"ar",name:"",flag:"",englishName:"Arabic"},{code:"hi",name:"",flag:"",englishName:"Hindi"},{code:"bn",name:"",flag:"",englishName:"Bengali"},{code:"tr",name:"Trke",flag:"",englishName:"Turkish"},{code:"pl",name:"Polski",flag:"",englishName:"Polish"},{code:"nl",name:"Nederlands",flag:"",englishName:"Dutch"},{code:"cs",name:"etina",flag:"",englishName:"Czech"},{code:"sv",name:"Svenska",flag:"",englishName:"Swedish"},{code:"vi",name:"Ting Vit",flag:"",englishName:"Vietnamese"},{code:"th",name:"",flag:"",englishName:"Thai"},{code:"he",name:"",flag:"",englishName:"Hebrew"},{code:"id",name:"Bahasa Indonesia",flag:"",englishName:"Indonesian"},{code:"uk",name:"",flag:"",englishName:"Ukrainian"},{code:"el",name:"",flag:"",englishName:"Greek"},{code:"ro",name:"Romn",flag:"",englishName:"Romanian"},{code:"hu",name:"Magyar",flag:"",englishName:"Hungarian"},{code:"fi",name:"Suomi",flag:"",englishName:"Finnish"},{code:"da",name:"Dansk",flag:"",englishName:"Danish"},{code:"no",name:"Norsk",flag:"",englishName:"Norwegian"},{code:"sk",name:"Slovenina",flag:"",englishName:"Slovak"},{code:"lt",name:"Lietuvi",flag:"",englishName:"Lithuanian"},{code:"lv",name:"Latvieu",flag:"",englishName:"Latvian"},{code:"bg",name:"",flag:"",englishName:"Bulgarian"},{code:"hr",name:"Hrvatski",flag:"",englishName:"Croatian"},{code:"sr",name:"",flag:"",englishName:"Serbian"},{code:"et",name:"Eesti",flag:"",englishName:"Estonian"},{code:"sl",name:"Slovenina",flag:"",englishName:"Slovenian"}],nr=(0,r.useState)(!1),rr=nr[0],or=nr[1],ar=(0,r.useState)(""),ir=ar[0],sr=ar[1],lr=(0,r.useMemo)((function(){if(!ir)return tr;var e=ir.toLowerCase();return tr.filter((function(t){return t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e)}))}),[ir]),cr=(0,r.useMemo)((function(){return tr.find((function(e){return e.code===v}))||tr[0]}),[v]),ur=function(){return rr?(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"16px"},onClick:function(){return or(!1)}},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#FFFFFF",borderRadius:"12px",width:"90%",maxWidth:"360px",maxHeight:"80vh",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",js({style:{padding:"16px",borderBottom:"1px solid #E5E7EB",display:"flex",flexDirection:"column",gap:"12px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsx)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:"Select Your Language"})),(0,a.jsx)("button",js({onClick:function(){return or(!1)},style:{background:"none",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px"}},{children:(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsxs)("div",js({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:ir,onChange:function(e){return sr(e.target.value)},placeholder:"Search languages...",style:{width:"100%",padding:"10px 12px 10px 36px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",fontSize:"14px",color:"#374151",outline:"none"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#9CA3AF",viewBox:"0 0 16 16",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}},{children:(0,a.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})),ir&&(0,a.jsx)("button",js({onClick:function(){return sr("")},style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",backgroundColor:"#E5E7EB"}},{children:(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsx)("p",js({style:{margin:0,fontSize:"12px",color:"#6B7280",lineHeight:1.5}},{children:"This will be used for both the interface language and translations. Your cards will be created in this language."}))]})),(0,a.jsx)("div",js({style:{overflowY:"auto",maxHeight:"calc(80vh - 135px)",padding:"8px 0"}},{children:0===lr.length?(0,a.jsxs)("div",js({style:{padding:"16px",textAlign:"center",color:"#6B7280",fontSize:"14px"}},{children:['No languages found matching "',ir,'"']})):lr.map((function(e){return(0,a.jsxs)("button",js({onClick:function(){i(function(e){return{type:it,payload:e}}(e.code)),or(!1)},style:{display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",backgroundColor:e.code===v?"#EFF6FF":"transparent",border:"none",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(t){e.code!==v&&(t.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(t){e.code!==v&&(t.currentTarget.style.backgroundColor="transparent")}},{children:[(0,a.jsx)("span",js({style:{fontSize:"22px",marginRight:"12px",width:"28px",textAlign:"center"}},{children:e.flag})),(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},{children:[(0,a.jsx)("span",js({style:{color:e.code===v?"#2563EB":"#111827",fontWeight:e.code===v?"600":"normal",fontSize:"14px"}},{children:e.name})),e.englishName!==e.name&&(0,a.jsx)("span",js({style:{color:"#6B7280",fontSize:"12px"}},{children:e.englishName}))]})),e.code===v&&(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2563EB",viewBox:"0 0 16 16",style:{marginLeft:"auto"}},{children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})}))]}),e.code)}))}))]}))})):(0,a.jsxs)("div",js({style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",gap:"8px"}},{children:[(0,a.jsxs)("label",js({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0,display:"flex",alignItems:"center",gap:"6px"}},{children:["Your Language",(0,a.jsx)("span",js({style:{fontSize:"12px",color:"#6B7280",fontWeight:"normal",fontStyle:"italic"}},{children:"(translations)"}))]})),(0,a.jsxs)("button",js({onClick:function(){return or(!0)},style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",color:"#374151",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#F9FAFB"}},{children:[(0,a.jsxs)("span",js({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)("span",js({style:{fontSize:"18px"}},{children:cr.flag})),(0,a.jsx)("span",{children:cr.name})]})),(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})}))]}))]}))},dr=(0,r.useState)((function(){return localStorage.getItem("source_language")||""})),pr=dr[0],fr=dr[1],gr=(0,r.useState)((function(){return localStorage.getItem("detected_language")||null})),hr=gr[0],mr=gr[1],yr=(0,r.useState)(!1),xr=yr[0],vr=yr[1],br=(0,r.useState)(!1),wr=br[0],Sr=br[1],Cr=(0,r.useState)(""),kr=Cr[0],Er=Cr[1],Ir=(0,r.useState)((function(){return"false"!==localStorage.getItem("auto_detect_language")})),Ar=Ir[0],_r=Ir[1],jr=(0,r.useMemo)((function(){if(!kr)return tr;var e=kr.toLowerCase();return tr.filter((function(t){return t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e)}))}),[kr]),Fr=(0,r.useMemo)((function(){return pr?tr.find((function(e){return e.code===pr}))||null:hr&&tr.find((function(e){return e.code===hr}))||null}),[pr,hr]),Tr=(0,r.useState)(!1),Pr=(Tr[0],Tr[1]),Rr=(0,r.useCallback)((function(e){var t=e.trim().toLowerCase();if(/[-]/i.test(t))return"ru";if(/^[a-z\s\.,!?\-'"]+$/i.test(t)){var n=["the","and","is","in","to","of","a","for","with","on","at","by","from","this","that","it","he","she","they","we","you","was","were","are","have","has","had","can","will","would","could","should"],r=t.split(/\s+/);if(r.filter((function(e){return n.includes(e.replace(/[^\w]/g,""))})).length>0||1===r.length)return"en"}return/[]/i.test(t)?"es":/[]/i.test(t)?"fr":/[]/i.test(t)?"de":/[]/i.test(t)?"it":null}),[]),Br=(0,r.useCallback)((function(e){var t=e.trim().toLowerCase(),n=t.replace(/[-]/g,"C").replace(/[a-z]/g,"L").replace(/[0-9]/g,"N").replace(/\s+/g,"S").replace(/[^\w\s]/g,"P").slice(0,50);return"lang_pattern_".concat(n,"_").concat(t.length<20?t:t.slice(0,20))}),[]),Or=(0,r.useCallback)((function(e){return Fs(void 0,void 0,void 0,(function(){var t,n,r,o,a,i,l,c,u,d,p,f,g,h,m,y,x,v,b,w,S,C,k,E,I,A,_,j,F,T,P,R,B,O,z,L,N,D,M;return Ts(this,(function(U){switch(U.label){case 0:if(console.log("=== LANGUAGE DETECTION START ==="),console.log("Input text:",e.substring(0,100)+(e.length>100?"...":"")),console.log("Text length:",e.length),!e||e.trim().length<2)return console.log("Text too short for language detection"),[2];if(t=Rr(e))return console.log("Language detected offline:",t),mr(t),s(t),n=Br(e),localStorage.setItem(n,t),[2];if(r=Br(e),(o=localStorage.getItem(r))&&hr!==o)return console.log("Using smart cached language detection result:",o),mr(o),s(o),[2];if(hr&&o===hr)return console.log("Language already detected for this text:",hr),[2];if(Ke())return console.log("Language detection skipped due to cached quota error"),Xe()&&(d=Ye())&&(Ne(d),Je()),[2];if(a=localStorage.getItem("last_language_api_call"),i=Date.now(),a&&i-parseInt(a)<2e3)return console.log("Language detection API call skipped - too frequent calls"),[2];console.log("Making API call for language detection..."),localStorage.setItem("last_language_api_call",i.toString()),vr(!0),U.label=1;case 1:if(U.trys.push([1,14,15,16]),!(ce===Ji.OpenAI&&ie||ce===Ji.Groq&&se))return[3,12];if(ce!==Ji.OpenAI)return[3,6];if(Ke()){if(console.log("OpenAI language detection skipped due to cached quota error"),Xe()&&(d=Ye()))throw new Error(d);return[2]}U.label=2;case 2:return U.trys.push([2,4,,5]),[4,qe.chat.completions.create({model:"gpt-5-nano",messages:[{role:"system",content:"You are a language detection assistant. Respond only with the ISO 639-1 language code."},{role:"user",content:"Detect the language of this text and respond only with the ISO 639-1 language code (e.g. 'en', 'ru', 'fr', etc.): \"".concat(e,'"')}]})];case 3:return c=U.sent(),l=null===(P=c.choices[0].message.content)||void 0===P?void 0:P.trim().toLowerCase(),console.log("Language detected via OpenAI:",l),[3,5];case 4:throw(u=U.sent())instanceof Error&&((v=u.message).includes("quota")||v.includes("insufficient_quota")||v.includes("billing")||v.includes("exceeded")||v.includes("429"))&&(Qe(v),console.log("Quota error detected and cached in OpenAI language detection")),u;case 5:return[3,11];case 6:if(ce!==Ji.Groq)return[3,11];if(Ke()){if(console.log("Groq language detection skipped due to cached quota error"),Xe()&&(d=Ye()))throw new Error(d);return[2]}return[4,fetch("https://api.groq.com/openai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(se)},body:JSON.stringify({model:le,messages:[{role:"system",content:"You are a language detection assistant. Respond only with the ISO 639-1 language code."},{role:"user",content:"Detect the language of this text and respond only with the ISO 639-1 language code (e.g. 'en', 'ru', 'fr', etc.): \"".concat(e,'"')}]})})];case 7:return(p=U.sent()).ok?[3,9]:[4,p.json()];case 8:if(f=U.sent(),v="Groq API error: ".concat(p.status," ").concat(p.statusText," - ").concat(JSON.stringify(f)),429===p.status||f&&((null===(B=null===(R=f.error)||void 0===R?void 0:R.includes)||void 0===B?void 0:B.call(R,"quota"))||(null===(z=null===(O=f.error)||void 0===O?void 0:O.includes)||void 0===z?void 0:z.call(O,"limit"))))throw new Error("API rate limit exceeded. Please try again in a few minutes.");throw new Error(v);case 9:return[4,p.json()];case 10:g=U.sent(),l=null===(M=null===(D=null===(N=null===(L=g.choices)||void 0===L?void 0:L[0])||void 0===N?void 0:N.message)||void 0===D?void 0:D.content)||void 0===M?void 0:M.trim().toLowerCase(),console.log("Language detected via Groq:",l),U.label=11;case 11:return l&&tr.some((function(e){return e.code===l}))?(console.log("Language successfully detected:",l),mr(l),localStorage.setItem("detected_language",l),h=Br(e),localStorage.setItem(h,l),s(l)):console.log("Invalid or unrecognized language code:",l),[3,13];case 12:m=e.trim().toLowerCase().slice(0,100),S=/[-]/gi,C=/[a-z]/gi,k=/[\u4e00-\u9fff]/gi,E=/[\u3040-\u309f\u30a0-\u30ff]/gi,I=/[\uac00-\ud7af]/gi,A=/[\u0600-\u06ff]/gi,_=/[]/gi,j=["hasta","desde","como","pero","porque","adonde","quien","para","por"].some((function(e){return m===e||m.startsWith(e+" ")||m.includes(" "+e+" ")})),F="",S.test(m)?(console.log("Detected Cyrillic script - setting Russian"),F="ru"):k.test(m)?(console.log("Detected Chinese characters"),F="zh"):E.test(m)?(console.log("Detected Japanese characters"),F="ja"):I.test(m)?(console.log("Detected Korean characters"),F="ko"):A.test(m)?(console.log("Detected Arabic script"),F="ar"):_.test(m)||j?(console.log("Detected Spanish text or common Spanish word"),F="es"):C.test(m)&&(console.log("Detected Latin script, defaulting to English"),F="en"),F&&(console.log("Language detected using fallback method:",F),mr(F),localStorage.setItem("detected_language",F),y=Br(e),localStorage.setItem(y,F),s(F)),U.label=13;case 13:return[3,16];case 14:return x=U.sent(),console.error("Error detecting language:",x),x instanceof Error&&Me(x)?(console.error("Quota error detected in language detection:",x.message),Ne(x.message),Je(),[2]):(v=x instanceof Error?x.message:String(x),(v.includes("401")||v.includes("Unauthorized")||v.includes("Authentication")||v.includes("Invalid API key")||v.includes("Incorrect API key")||v.includes("API key is missing"))&&(console.warn("API key error detected, disabling auto-detection to prevent infinite retries"),_r(!1),localStorage.setItem("auto_detect_language","false"),b=ce===Ji.OpenAI?"OpenAI":ce===Ji.Groq?"Groq":"AI","function"==typeof Ne&&Ne("Language detection failed: Invalid ".concat(b," API key. Please check your API key in settings."),"error"),w=e.trim().toLowerCase().slice(0,100),S=/[-]/gi,C=/[a-z]/gi,k=/[\u4e00-\u9fff]/gi,E=/[\u3040-\u309f\u30a0-\u30ff]/gi,I=/[\uac00-\ud7af]/gi,A=/[\u0600-\u06ff]/gi,_=/[]/gi,j=["hasta","desde","como","pero","porque","adonde","quien","para","por"].some((function(e){return w===e||w.startsWith(e+" ")||w.includes(" "+e+" ")})),F="",S.test(w)?F="ru":k.test(w)?F="zh":E.test(w)?F="ja":I.test(w)?F="ko":A.test(w)?F="ar":_.test(w)||j?F="es":C.test(w)&&(F="en"),F&&(console.log("Language detected using fallback method in error handler:",F),mr(F),localStorage.setItem("detected_language",F),T=Br(e),localStorage.setItem(T,F),s(F))),[3,16]);case 15:return vr(!1),console.log("=== LANGUAGE DETECTION END ==="),[7];case 16:return[2]}}))}))}),[qe,ie,ce,se,le,i,tr]);(0,r.useEffect)((function(){if(l&&l.trim().length>2&&Ar){if(Ke()){if(console.log("Language detection skipped in useEffect due to cached quota error"),Xe()){var e=Ye();e&&(Ne(e),Je())}return}var t=setTimeout((function(){console.log("Attempting to detect language for text:",l.substring(0,50)+"..."),Or(l)}),1500);return function(){return clearTimeout(t)}}}),[l,Or,Ar]);var zr=function(){var e=!Ar;if(_r(e),localStorage.setItem("auto_detect_language",e?"true":"false"),Ar)hr&&s(hr);else if(s(""),l){if(Ke()){if(console.log("Language detection skipped in toggleAutoDetect due to cached quota error"),Xe()){var t=Ye();t&&(Ne(t),Je())}return}Or(l)}},Lr=function(){return wr?(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"16px"},onClick:function(){return Sr(!1)}},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#FFFFFF",borderRadius:"12px",width:"90%",maxWidth:"360px",maxHeight:"80vh",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",js({style:{padding:"16px",borderBottom:"1px solid #E5E7EB",display:"flex",flexDirection:"column",gap:"12px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsxs)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(Ht,{color:"#6366F1",size:18}),(0,a.jsx)("span",{children:"Select Source Language"})]})),(0,a.jsx)("button",js({onClick:function(){return Sr(!1)},style:{background:"none",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px"}},{children:(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsxs)("div",js({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:kr,onChange:function(e){return Er(e.target.value)},placeholder:"Search languages...",style:{width:"100%",padding:"10px 12px 10px 36px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",fontSize:"14px",color:"#374151",outline:"none"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#9CA3AF",viewBox:"0 0 16 16",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}},{children:(0,a.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})),kr&&(0,a.jsx)("button",js({onClick:function(){return Er("")},style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",backgroundColor:"#E5E7EB"}},{children:(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsx)("p",js({style:{margin:0,fontSize:"12px",color:"#6B7280",lineHeight:1.5}},{children:"Select the language of your text. This helps generate more accurate translations and examples."}))]})),(0,a.jsx)("div",js({style:{overflowY:"auto",maxHeight:"calc(80vh - 135px)",padding:"8px 0"}},{children:0===jr.length?(0,a.jsxs)("div",js({style:{padding:"16px",textAlign:"center",color:"#6B7280",fontSize:"14px"}},{children:['No languages found matching "',kr,'"']})):jr.map((function(e){return(0,a.jsxs)("button",js({onClick:function(){fr(e.code),Sr(!1),_r(!1)},style:{display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",backgroundColor:e.code===pr?"#EFF6FF":"transparent",border:"none",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(t){e.code!==pr&&(t.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(t){e.code!==pr&&(t.currentTarget.style.backgroundColor="transparent")}},{children:[(0,a.jsx)("span",js({style:{fontSize:"22px",marginRight:"12px",width:"28px",textAlign:"center"}},{children:e.flag})),(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},{children:[(0,a.jsx)("span",js({style:{color:e.code===pr?"#2563EB":"#111827",fontWeight:e.code===pr?"600":"normal",fontSize:"14px"}},{children:e.name})),e.englishName!==e.name&&(0,a.jsx)("span",js({style:{color:"#6B7280",fontSize:"12px"}},{children:e.englishName}))]})),e.code===pr&&(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2563EB",viewBox:"0 0 16 16",style:{marginLeft:"auto"}},{children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})}))]}),e.code)}))}))]}))})):(0,a.jsxs)("div",js({style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",gap:"8px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"}},{children:[(0,a.jsxs)("label",js({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0,display:"flex",alignItems:"center",gap:"6px"}},{children:[(0,a.jsx)("span",{children:"Source Language"}),(0,a.jsx)("span",js({style:{fontSize:"12px",color:"#6B7280",fontWeight:"normal",fontStyle:"italic"}},{children:"(of your text)"}))]})),(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)("span",js({style:{fontSize:"12px",color:Ar?"#10B981":"#9CA3AF",transition:"color 0.2s ease"}},{children:"Auto"})),(0,a.jsx)("button",js({onClick:zr,style:{width:"36px",height:"20px",backgroundColor:Ar?"#10B981":"#E5E7EB",border:"none",borderRadius:"10px",position:"relative",cursor:"pointer",transition:"background-color 0.2s ease"}},{children:(0,a.jsx)("span",{style:{position:"absolute",width:"16px",height:"16px",backgroundColor:"white",borderRadius:"50%",top:"2px",left:Ar?"18px":"2px",transition:"left 0.2s ease",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"}})}))]}))]})),(0,a.jsxs)("button",js({onClick:function(){return Sr(!0)},disabled:Ar,style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:Ar?"#F3F4F6":"#F9FAFB",color:"#374151",fontSize:"14px",cursor:Ar?"not-allowed":"pointer",opacity:Ar?.7:1,transition:"all 0.2s ease",textAlign:"left"},onMouseOver:function(e){return!Ar&&(e.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(e){return!Ar&&(e.currentTarget.style.backgroundColor="#F9FAFB")}},{children:[(0,a.jsx)("span",js({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:xr?(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#6B7280"}):Fr?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",js({style:{fontSize:"18px"}},{children:Fr.flag})),(0,a.jsx)("span",{children:Fr.name}),Ar&&(0,a.jsxs)("span",js({style:{fontSize:"12px",color:"#10B981",backgroundColor:"#ECFDF5",padding:"2px 6px",borderRadius:"4px",marginLeft:"4px",display:"flex",alignItems:"center",gap:"3px"}},{children:[(0,a.jsx)(Tt,{size:10}),(0,a.jsx)("span",{children:"Detected"})]}))]}):(0,a.jsx)("span",js({style:{color:"#9CA3AF"}},{children:Ar?"Detecting language...":"Select source language"}))})),!Ar&&(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})}))]})),(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",backgroundColor:"#F3F4F6",borderRadius:"6px",marginTop:"4px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"4px"}},{children:[(0,a.jsx)("span",js({style:{fontSize:"14px"}},{children:Fr?Fr.flag:""})),(0,a.jsx)(Ut,{size:12,color:"#6B7280"}),(0,a.jsx)("span",js({style:{fontSize:"14px"}},{children:cr.flag}))]})),(0,a.jsxs)("span",js({style:{fontSize:"12px",color:"#4B5563"}},{children:["Translating ",Fr?"from ".concat(Fr.englishName):""," to ",cr.englishName]})),Ar&&(0,a.jsx)("button",js({onClick:function(){if(Ke()){if(console.log("Language detection reset skipped due to cached quota error"),Xe()){var e=Ye();e&&(Ne(e),Je())}}else l&&(console.log("Manually triggering language detection for:",l.substring(0,50)+"..."),Or(l))},title:"Reset language detection",style:{marginLeft:"auto",background:"none",border:"none",display:"flex",padding:"2px",cursor:"pointer",color:"#6B7280"}},{children:(0,a.jsxs)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16"},{children:[(0,a.jsx)("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),(0,a.jsx)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})]}))}))]}))]}))},Nr=function(e){i(Oe(e)),Fn&&Q(!0)};(0,r.useEffect)((function(){var e=localStorage.getItem("source_language"),t=localStorage.getItem("detected_language"),n=localStorage.getItem("auto_detect_language");console.log("Initializing language settings from localStorage:",{savedSourceLanguage:e,savedDetectedLanguage:t,savedAutoDetect:n}),e?s(e):t&&"false"!==n&&s(t),"false"===n&&_r(!1)}),[]);var Dr,Mr,Ur,qr=(0,r.useCallback)((function(e){return Fs(void 0,void 0,void 0,(function(){var t,n,r,o;return Ts(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),En?(t='Return only the native name of the language with ISO 639-1 code "'.concat(e,'".\nExamples: \n- "en" -> "English"\n- "ru" -> "" \n- "es" -> "Espaol"\n- "fr" -> "Franais"\n- "de" -> "Deutsch"\n- "zh" -> ""\n- "ja" -> ""\n- "ar" -> ""\n\nRespond with ONLY the native language name, no additional text.'),[4,kn.createChatCompletion(En,[{role:"user",content:t}])]):[2,e.toUpperCase()];case 1:return(n=a.sent())&&n.content?(r=n.content.trim(),localStorage.setItem("language_name_".concat(e),r),[2,r]):[2,e.toUpperCase()];case 2:return o=a.sent(),console.error("Error getting language name from AI:",o),[2,e.toUpperCase()];case 3:return[2]}}))}))}),[En,kn]),Wr=(0,r.useCallback)((function(e){return Fs(void 0,void 0,void 0,(function(){var t;return Ts(this,(function(n){switch(n.label){case 0:return(t=localStorage.getItem("language_name_".concat(e)))?[2,t]:[4,qr(e)];case 1:return[2,n.sent()]}}))}))}),[qr]),$r=(0,r.useCallback)((function(e){return Fs(void 0,void 0,void 0,(function(){var t,n,r,o,a,i;return Ts(this,(function(s){switch(s.label){case 0:if(!e||0===e.trim().length)return[2,{shouldGenerate:!1,reason:"No text provided"}];s.label=1;case 1:return s.trys.push([1,3,,4]),t='Analyze this word/phrase and determine if a visual image would be helpful for language learning: "'.concat(e,'"\n\nConsider these criteria:\n- Concrete objects, animals, places, foods, tools, vehicles = YES\n- Abstract concepts, emotions, actions, grammar terms = NO\n- People, professions, activities that can be visualized = YES\n- Numbers, prepositions, conjunctions, abstract ideas = NO\n\nRespond with ONLY "YES" or "NO" followed by a brief reason (max 10 words).\nFormat: "YES - concrete object that can be visualized" or "NO - abstract concept"'),[4,kn.createChatCompletion(En,[{role:"user",content:t}])];case 2:return(n=s.sent())&&n.content?(r=n.content.trim(),o=r.toUpperCase().startsWith("YES"),a=r.includes(" - ")?r.split(" - ")[1]:"AI analysis",[2,{shouldGenerate:o,reason:a}]):[2,{shouldGenerate:!1,reason:"AI analysis failed"}];case 3:return i=s.sent(),console.error("Error analyzing text for image generation:",i),[2,{shouldGenerate:!1,reason:"Analysis error"}];case 4:return[2]}}))}))}),[kn,En]),Gr=function(e){i(function(e){return{type:pt,payload:e}}(e)),"always"===e&&l&&Dn()&&On(),"off"===e&&(i(je(null)),i(Fe(null)))},Vr=(0,r.useCallback)((function(e,t,r){return Fs(void 0,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,f,g,h,m,y,x,v,b,S,C;return Ts(this,(function(k){switch(k.label){case 0:if(!t.trim())return Ne("Please enter some text to create a card from","error"),[2];k.label=1;case 1:return k.trys.push([1,9,10,11]),o=r||e.prompt,a="".concat(o,'\n\nText: "').concat(t,'"\n\nProvide a clear, educational response that would work well as flashcard content. Be concise but informative.'),[4,kn.translateText(a,"en")];case 2:if(!(s=k.sent()))throw new Error("Failed to generate card content");if(l=e.name,c=s,"qa"===e.id&&s.includes("Q:")&&s.includes("A:")?(u=s.indexOf("Q:"),d=s.indexOf("A:"),-1!==u&&-1!==d&&d>u&&(l=s.substring(u+2,d).trim(),c=s.substring(d+2).trim())):"definition"===e.id?(p=s.split("\n").filter((function(e){return e.trim()}))).length>0&&((f=p[0]).includes(":")?(g=f.split(":"),l=g[0].trim(),c=g.slice(1).join(":").trim(),p.length>1&&(c+="\n"+p.slice(1).join("\n"))):(h=t.split(" ").filter((function(e){return e.length>3})),l=h.slice(0,3).join(" ")+(h.length>3?"...":""),c=s)):(m=t.length>50?t.substring(0,50)+"...":t,l="".concat(e.name,": ").concat(m),c=s),y=null,!ue||"off"===de||!Dn())return[3,8];k.label=3;case 3:return k.trys.push([3,7,,8]),[4,kn.getDescriptionImage(En,t,w)];case 4:return(x=k.sent())?[4,null===(C=kn.getImageUrl)||void 0===C?void 0:C.call(kn,En,x)]:[3,6];case 5:(v=k.sent())&&(y=v),k.label=6;case 6:return[3,8];case 7:return b=k.sent(),console.warn("Failed to generate image:",b),[3,8];case 8:return i(Pe(l)),i(Te(c)),i(Ie(t)),y&&i(Fe(y)),n(!0),[3,11];case 9:return S=k.sent(),console.error("Error generating general card:",S),Ne("Failed to generate card: ".concat(S instanceof Error?S.message:"Unknown error"),"error"),[3,11];case 10:return[7];case 11:return[2]}}))}))}),[kn,Ne,i,ue,de,Dn,w]),Hr=((0,r.useCallback)((function(e){Bt(e),l.trim()&&Vr(e,l),Dt(!1)}),[l,Vr]),(0,r.useCallback)((function(){return Fs(void 0,void 0,void 0,(function(){return Ts(this,(function(e){switch(e.label){case 0:return Vt.trim()&&l.trim()?[4,Vr({id:"custom",name:"Custom",description:"Custom prompt",icon:"",prompt:Vt},l,Vt)]:(Ne("Please enter both text and a custom prompt","error"),[2]);case 1:return e.sent(),Xt(""),[2]}}))}))}),[Vt,l,Vr,Ne]),(0,r.useCallback)((function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,o,a,i,s,c,u;return Ts(this,(function(d){switch(d.label){case 0:if(!l.trim())return Ne("Please enter or select text to create cards","error"),[2];Sn.current=new AbortController,e=Sn.current.signal,T(!0),d.label=1;case 1:if(d.trys.push([1,7,8,9]),e.aborted)throw new Error("Generation cancelled by user");t=Es(kn,En),n=void 0,d.label=2;case 2:return d.trys.push([2,4,,5]),r=window.getSelection(),o=void 0,r&&r.rangeCount>0&&(a=r.getRangeAt(0),o=a.commonAncestorContainer.nodeType===Node.ELEMENT_NODE?a.commonAncestorContainer:a.commonAncestorContainer.parentElement||void 0),[4,_s.extractPageContentAsync(l,o)];case 3:return n=d.sent(),console.log(" Extracted page content:",{images:n.pageImages.length,formulas:n.formulas.length,codeBlocks:n.codeBlocks.length,links:n.links.length,metadata:n.metadata,selectedText:l.substring(0,100)+"..."}),n.pageImages.forEach((function(e,t){console.log("  ".concat(t,":"),{src:e.src,alt:e.alt,relevanceScore:e.relevanceScore,isRelevant:e.relevanceScore>.3,hasBase64:!!e.base64})})),[3,5];case 4:return i=d.sent(),console.warn("Failed to extract page content, proceeding without multimedia:",i),n=void 0,[3,5];case 5:return[4,t.createCardsFromText(l,n,e)];case 6:return s=d.sent(),e.aborted?(console.log("AI card creation was cancelled by user"),[2]):(console.log(" AI Agents created ".concat(s.length," cards successfully")),s.forEach((function(e,t){var n;console.log("  ".concat(t,":"),{front:e.front,backPreview:e.back.substring(0,200)+"...",hasAttachedImages:!!e.attachedImages&&e.attachedImages.length>0,attachedImagesCount:(null===(n=e.attachedImages)||void 0===n?void 0:n.length)||0,multimedia:e.multimedia,hasImageInBack:e.back.includes("[IMAGE:")||e.back.includes("!["),hasFormulaInBack:e.back.includes("[FORMULA:")||e.back.includes("$$"),hasCodeInBack:e.back.includes("[CODE:")||e.back.includes("```")}),0===t&&console.log("  back  0:",e.back)})),nn(s),dn(0),ln(!0),[3,9]);case 7:return c=d.sent(),e.aborted?(console.log("AI card creation was cancelled by user"),[2]):(console.error(" Error in AI agent card creation:",c),u=c instanceof Error?c.message:"Unknown error",Ne("Card creation error: ".concat(u),"error"),[3,9]);case 8:return console.log(" Main card creation function finally block reached"),setTimeout((function(){console.log(" Checking for pending operations before hiding loader...");var e=$e(),t=e.getStats(),n=t.inProgress>0;console.log(" Tracker stats:",t),console.log(" Has pending requests:",n);var r=Ze||R||z;console.log(" Local loading states:",{isProcessingCustomInstruction:Ze,loadingNewImage:R,loadingNewExamples:z,hasLocalOperations:r}),n||r?(console.log(" Keeping loader visible - operations still running"),setTimeout((function(){console.log(" Second check after additional delay..."),e.getStats().inProgress>0||Ze||R||z?console.log(" Still has pending operations - keeping loader"):(console.log(" Second check passed - hiding loader"),T(!1),W(null),V({completed:0,total:0}))}),2e3)):(console.log(" No pending operations - hiding loader"),T(!1),W(null),V({completed:0,total:0}))}),1500),Sn.current=null,[7];case 9:return[2]}}))}))}),[l,kn,En,Ne])),Kr=function(){ln(!1),nn([]),dn(0),gn(new Set),wn("")},Qr=function(){return Fs(void 0,void 0,void 0,(function(){var e;return Ts(this,(function(t){M(!0);try{if(!(e=tn[un]))return Ne("No card to save","error"),[2];i(ke(e)),gn((function(e){return new Set(e).add(un)}))}catch(e){console.error("Error saving current card:",e),Ne("Error saving card","error")}finally{M(!1)}return[2]}))}))},Jr=m((function(e){return e.cards.isGeneratingCard}));return(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",flex:1,width:"100%",height:"100%",position:"relative"}},{children:[F&&(0,a.jsxs)("div",js({className:"loading-overlay",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(4px)",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"20px",padding:"0 20px",borderRadius:"12px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px"}},{children:[(0,a.jsx)(sn,{type:"spinner",size:"large",color:(null==q?void 0:q.color)||"#3B82F6"}),q&&(0,a.jsx)("div",js({style:{fontSize:"20px",opacity:.8}},{children:q.icon}))]})),(0,a.jsxs)("div",js({style:{textAlign:"center",color:"#374151",maxWidth:"400px"}},{children:[(0,a.jsx)("div",js({style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px",color:(null==q?void 0:q.color)||"#1f2937"}},{children:(null==q?void 0:q.currentStepTitle)||(null==q?void 0:q.title)||"Starting..."})),(0,a.jsx)("div",js({style:{fontSize:"14px",color:"#6b7280",lineHeight:"1.5"}},{children:(null==q?void 0:q.currentStepSubtitle)||(null==q?void 0:q.subtitle)||"Preparing your request..."})),G.total>0&&(0,a.jsxs)("div",js({style:{fontSize:"12px",color:"#9CA3AF",marginTop:"8px",fontWeight:"500"}},{children:[G.completed," of ",G.total," requests completed"]}))]})),(0,a.jsx)("div",js({style:{width:"280px",height:"8px",backgroundColor:"#f3f4f6",borderRadius:"4px",overflow:"hidden",marginTop:"12px",boxShadow:"inset 0 1px 2px rgba(0, 0, 0, 0.1)"}},{children:(0,a.jsx)("div",js({style:{height:"100%",width:"".concat(G.total>0?Math.max(5,G.completed/G.total*100):15,"%"),background:"linear-gradient(90deg, ".concat((null==q?void 0:q.color)||"#3B82F6"," 0%, ").concat((null==q?void 0:q.color)||"#3B82F6","dd 50%, ").concat((null==q?void 0:q.color)||"#3B82F6"," 100%)"),borderRadius:"4px",transition:"width 0.6s ease-out, background 0.3s ease-in-out",boxShadow:"0 0 10px ".concat((null==q?void 0:q.color)||"#3B82F6","40"),position:"relative",overflow:"hidden"}},{children:(0,a.jsx)("div",{style:{position:"absolute",top:0,left:"-100%",width:"100%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)",animation:"shimmer 2s infinite"}})}))})),(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",marginTop:"16px",padding:"8px 16px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"20px",border:"1px solid ".concat((null==q?void 0:q.color)||"#3B82F6","20"),boxShadow:"0 0 15px ".concat((null==q?void 0:q.color)||"#3B82F6","20")}},{children:[(0,a.jsx)(zt,{style:{color:(null==q?void 0:q.color)||"#3B82F6",fontSize:"14px",animation:"pulse 2s ease-in-out infinite"}}),(0,a.jsx)("span",js({style:{fontSize:"16px",fontWeight:"600",color:(null==q?void 0:q.color)||"#3B82F6",fontFamily:"monospace",letterSpacing:"1px"}},{children:(Dr=X,Mr=Math.floor(Dr/60),Ur=Dr%60,"".concat(Mr,":").concat(Ur.toString().padStart(2,"0")))}))]})),(0,a.jsxs)("button",js({onClick:Vn,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"10px"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"},title:"Cancel card generation"},{children:[(0,a.jsx)(rn,{}),"Cancel Generation"]}))]})),gt&&(0,a.jsxs)("div",js({style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:5,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"20px",padding:"0 20px"}},{children:[(0,a.jsx)(sn,{type:"spinner",size:"large",color:"#3B82F6",text:"Analyzing selected text..."}),(0,a.jsxs)("button",js({onClick:function(){return yt(!1)},style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"10px"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"},title:"Cancel text analysis"},{children:[(0,a.jsx)(rn,{}),"Cancel Analysis"]}))]})),(0,a.jsx)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",gap:"12px",width:"100%",padding:"12px",paddingTop:"16px",height:"100%",overflowY:"auto",backgroundColor:"#ffffff",paddingBottom:"16px"}},{children:(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",width:"100%",maxWidth:"320px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px",backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"8px",marginBottom:"8px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px",color:S===_.LanguageLearning?"#3B82F6":"#6B7280",fontSize:"14px",fontWeight:"500",transition:"color 0.2s ease"}},{children:[(0,a.jsx)($t,{}),"Language Learning"]})),(0,a.jsx)("button",js({onClick:A,style:{position:"relative",width:"48px",height:"24px",backgroundColor:S===_.GeneralTopic?"#3B82F6":"#CBD5E1",borderRadius:"12px",border:"none",cursor:"pointer",transition:"background-color 0.2s ease",outline:"none"},title:"Switch to ".concat(S===_.LanguageLearning?"General Cards":"Language Learning")},{children:(0,a.jsx)("div",{style:{position:"absolute",top:"2px",left:S===_.GeneralTopic?"26px":"2px",width:"20px",height:"20px",backgroundColor:"#ffffff",borderRadius:"50%",transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"}})})),(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px",color:S===_.GeneralTopic?"#3B82F6":"#6B7280",fontSize:"14px",fontWeight:"500",transition:"color 0.2s ease"}},{children:[(0,a.jsx)(jt,{}),"General Cards"]}))]})),S===_.LanguageLearning&&(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",gap:"8px"}},{children:[ur(),Lr(),(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",width:"100%",gap:"8px",marginTop:"4px"}},{children:[(0,a.jsx)("label",js({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0}},{children:"Image Generation:"})),(0,a.jsxs)("div",js({style:{display:"flex",width:"100%",backgroundColor:"#F3F4F6",borderRadius:"8px",padding:"4px",gap:"2px",opacity:Dn()?1:.5}},{children:[(0,a.jsx)("button",js({type:"button",onClick:function(){return Gr("off")},disabled:!Dn(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"off"===de?"#FFFFFF":"transparent",color:"off"===de?"#111827":"#6B7280",fontSize:"12px",fontWeight:"off"===de?"600":"500",cursor:Dn()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"off"===de?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:" Off"})),(0,a.jsx)("button",js({type:"button",onClick:function(){return Gr("smart")},disabled:!Dn(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"smart"===de?"#FFFFFF":"transparent",color:"smart"===de?"#111827":"#6B7280",fontSize:"12px",fontWeight:"smart"===de?"600":"500",cursor:Dn()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"smart"===de?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:" Smart"})),(0,a.jsx)("button",js({type:"button",onClick:function(){return Gr("always")},disabled:!Dn(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"always"===de?"#FFFFFF":"transparent",color:"always"===de?"#111827":"#6B7280",fontSize:"12px",fontWeight:"always"===de?"600":"500",cursor:Dn()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"always"===de?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:" Always"}))]})),(0,a.jsx)("div",js({style:{position:"relative",height:"2.8em",marginTop:"2px"}},{children:(0,a.jsxs)("div",js({style:{position:"absolute",top:0,left:0,right:0,fontSize:"11px",color:"#6B7280",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"}},{children:["off"===de&&"No images will be generated","smart"===de&&"AI decides: Images only for concrete objects, places, and visual concepts. Saves API costs by skipping abstract terms.","always"===de&&"Images generated for all cards"]}))})),!Dn()&&(0,a.jsx)("div",js({style:{fontSize:"12px",color:"#EF4444",backgroundColor:"#FEF2F2",padding:"6px 8px",borderRadius:"6px",border:"1px solid #FECACA"}},{children:"Image generation not available with Groq provider"}))]})),"off"!==de&&Dn()&&(ue?me?(0,a.jsxs)("div",js({style:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px",padding:"16px",width:"100%",marginBottom:"12px",marginTop:"8px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(Gt,{size:14,color:"#10B981"}),"Image Instructions"]})),(0,a.jsx)("button",js({onClick:function(){return ye(!1)},style:{background:"transparent",border:"none",cursor:"pointer",color:"#6B7280",fontSize:"13px"}},{children:"Cancel"}))]})),(0,a.jsxs)("div",js({style:{marginBottom:"16px"}},{children:[(0,a.jsx)("label",js({style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:500,color:"#374151"}},{children:"Image generation style"})),(0,a.jsx)("textarea",{value:Se,onChange:function(e){return Ce(e.target.value)},placeholder:"E.g., use anime style, make it minimalist, use pastel colors, make it black and white",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",minHeight:"100px",resize:"vertical"}}),(0,a.jsxs)("div",js({style:{fontSize:"12px",color:"#6B7280",marginTop:"8px",lineHeight:"1.4"}},{children:[(0,a.jsx)("p",js({style:{margin:"0 0 6px 0",fontWeight:"500"}},{children:"How to use:"})),(0,a.jsxs)("ul",js({style:{margin:0,paddingLeft:"16px"}},{children:[(0,a.jsxs)("li",{children:["These are ",(0,a.jsx)("strong",{children:"style instructions"})," for image generation"]}),(0,a.jsx)("li",{children:"The image will still be related to the word you're learning"}),(0,a.jsx)("li",{children:"Focus on artistic style, mood, colors, composition, etc."}),(0,a.jsx)("li",{children:'Examples: "watercolor style", "dark background", "realistic rendering"'})]}))]}))]})),(0,a.jsxs)("button",js({onClick:Gn,style:{backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)(Gt,{size:14}),"Save Image Instructions"]}))]})):(0,a.jsxs)("button",js({onClick:function(){return ye(!0)},style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",color:"#4B5563",cursor:"pointer",width:"100%",justifyContent:"center",marginTop:"8px"}},{children:[(0,a.jsx)(Gt,{size:14}),"Customize image generation"]})):null)]})),S===_.GeneralTopic&&(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},{children:[(0,a.jsx)(Zt,{style:{color:"#6366F1"}}),(0,a.jsx)("h4",js({style:{fontSize:"16px",fontWeight:"600",color:"#111827",margin:0}},{children:"AI Agent Card Creator"}))]})),(0,a.jsx)("p",js({style:{fontSize:"14px",color:"#6B7280",margin:0,lineHeight:"1.4"}},{children:"Select text on any page and AI agents will automatically create optimal cards for learning. The system analyzes content and creates 1 to several cards with quality validation."})),(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",backgroundColor:"#FEF3C7",borderRadius:"6px",border:"1px solid #F59E0B"}},{children:[(0,a.jsx)(Kt,{style:{color:"#F59E0B"}}),(0,a.jsx)("span",js({style:{fontSize:"12px",color:"#92400E",fontWeight:"500"}},{children:"AI analyzes text, creates cards and validates results"}))]})),!F&&(0,a.jsxs)("button",js({onClick:Hr,disabled:!l.trim()||F,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"8px 10px",backgroundColor:l.trim()&&!F?"#2563EB":"#E5E7EB",color:l.trim()&&!F?"#ffffff":"#9CA3AF",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"600",cursor:l.trim()&&!F?"pointer":"not-allowed",transition:"all 0.2s ease",marginTop:"4px",opacity:F?.7:1},onMouseOver:function(e){l.trim()&&!F&&(e.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(e){l.trim()&&!F&&(e.currentTarget.style.backgroundColor="#2563EB")}},{children:[F?(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}):(0,a.jsx)(Zt,{}),"Create Cards with AI"]}))]})),fe?(0,a.jsxs)("div",js({style:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px",padding:"16px",width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(Kt,{size:14,color:"#2563EB"}),"AI Instructions"]})),(0,a.jsx)("button",js({onClick:function(){return ge(!1)},style:{background:"transparent",border:"none",cursor:"pointer",color:"#6B7280",fontSize:"13px"}},{children:"Cancel"}))]})),(0,a.jsxs)("div",js({style:{marginBottom:"16px"}},{children:[(0,a.jsx)("label",js({style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:500,color:"#374151"}},{children:"Additional instructions for AI"})),(0,a.jsx)("textarea",{value:ve,onChange:function(e){return be(e.target.value)},placeholder:"E.g., Keep specialized terms untranslated. Make examples more advanced. Use formal language.",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",minHeight:"100px",resize:"vertical"}}),(0,a.jsxs)("div",js({style:{fontSize:"12px",color:"#6B7280",marginTop:"8px",lineHeight:"1.4"}},{children:[(0,a.jsx)("p",js({style:{margin:"0 0 6px 0",fontWeight:"500"}},{children:"How to use:"})),(0,a.jsxs)("ul",js({style:{margin:0,paddingLeft:"16px"}},{children:[(0,a.jsxs)("li",{children:["These are ",(0,a.jsx)("strong",{children:"additional"})," instructions that supplement the basic AI behavior"]}),(0,a.jsx)("li",{children:"The original word will always be used (no need to specify it)"}),(0,a.jsx)("li",{children:"Examples will always be generated for the word you're learning"}),(0,a.jsx)("li",{children:"Use this for style guidance, preferences, or special requirements"})]}))]}))]})),(0,a.jsxs)("button",js({onClick:$n,style:{backgroundColor:"#2563EB",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"}},{children:[(0,a.jsx)(Lt,{size:14}),"Save Instructions"]}))]})):(0,a.jsxs)("button",js({onClick:function(){return ge(!0)},style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",color:"#4B5563",cursor:"pointer",width:"100%",justifyContent:"center"}},{children:[(0,a.jsx)(Nt,{size:14}),"Customize AI behavior"]})),S===_.LanguageLearning&&(0,a.jsxs)("form",js({onSubmit:function(e){return Fs(void 0,void 0,void 0,(function(){var t,r,a,i,s,c,u,d,p,f,g,h,m,y,x,S,C,E,A,_,j,F,P,R,B,O,z;return Ts(this,(function(L){switch(L.label){case 0:if(e.preventDefault(),!l.trim())return[2];Sn.current=new AbortController,t=Sn.current.signal,Pr(!0),o.setIsGeneratingCard(!0),ae(!1),localStorage.removeItem("explicitly_saved"),kt([]),Pt(!1),o.setCurrentCardId(null),ue?k!==l&&(console.log("Text has changed, clearing existing images for new generation"),o.setImage(null),o.setImageUrl(null)):(console.log("Image generation is disabled, clearing existing images"),o.setImage(null),o.setImageUrl(null)),o.setLinguisticInfo(""),o.setTranscription(""),T(!0),W(null),$e().reset(),N=function(e){console.log(" Progress update: ".concat(e.completed,"/").concat(e.total," - ").concat(e.message.title)),W(e.message),V({completed:e.completed,total:e.total})},$e().onProgressUpdate=N,I(l),Ne(null),L.label=1;case 1:if(L.trys.push([1,37,38,39]),console.log("=== DEBUG INFO ==="),console.log("Model Provider:",ce),console.log("API Key available:",Boolean(En)),console.log("Model Name (if Groq):",ce===Ji.Groq?le:"N/A"),console.log("AI Service:",Object.keys(kn)),console.log("Source Language:",Ar?hr:pr),!En)throw new Error("API key for ".concat(ce," is missing. Please go to settings and add your API key."));r=Ar?hr:pr,a={translation:!1,examples:!1,flashcard:!1,image:!1,linguisticInfo:!1},L.label=2;case 2:if(L.trys.push([2,4,,5]),t.aborted)throw new Error("Generation cancelled by user");return[4,fs(kn,En,l,v,b,0,t)];case 3:if(i=L.sent(),t.aborted)throw new Error("Generation cancelled by user");return i.translated&&(o.setTranslation(i.translated),a.translation=!0),[3,5];case 4:if(s=L.sent(),t.aborted)throw console.log("Translation cancelled by user"),new Error("Translation cancelled by user");if(s instanceof Error&&Me(s))throw console.error("Quota error detected, stopping card creation:",s.message),Ne(s.message),s;throw console.error("Translation failed:",s),new Error("Translation failed: ".concat(s instanceof Error?s.message:"Unknown error"));case 5:if(L.trys.push([5,7,,8]),t.aborted)throw new Error("Generation cancelled by user");return[4,gs(kn,En,l,v,!0,b,r||void 0,t)];case 6:if(c=L.sent(),t.aborted)throw new Error("Generation cancelled by user");return c&&c.length>0&&(u=c.map((function(e){return[e.original,e.translated]})),o.setExamples(u),a.examples=!0),[3,8];case 7:if(d=L.sent(),t.aborted)throw console.log("Examples generation cancelled by user"),new Error("Examples generation cancelled by user");if(d instanceof Error&&Me(d))throw console.error("Quota error detected, stopping card creation:",d.message),Ne(d.message),d;if(console.error("Examples generation failed:",d),!a.translation)throw new Error("Examples generation failed: ".concat(d instanceof Error?d.message:"Unknown error"));return Ne("Examples generation failed: ".concat(d instanceof Error?d.message:"Unknown error",". Continuing with translation only."),"warning"),[3,8];case 8:if(L.trys.push([8,10,,11]),t.aborted)throw new Error("Generation cancelled by user");return[4,hs(kn,En,l,t)];case 9:if(p=L.sent(),t.aborted)throw new Error("Generation cancelled by user");return p.front&&(o.setFront(p.front),a.flashcard=!0),[3,11];case 10:if(f=L.sent(),t.aborted)throw console.log("Flashcard creation cancelled by user"),new Error("Flashcard creation cancelled by user");if(f instanceof Error&&Me(f))throw console.error("Quota error detected, stopping card creation:",f.message),Ne(f.message),f;if(console.error("Flashcard creation failed:",f),!a.translation)throw new Error("Flashcard creation failed: ".concat(f instanceof Error?f.message:"Unknown error"));return Ne("Flashcard creation failed: ".concat(f instanceof Error?f.message:"Unknown error",". Continuing with available data."),"warning"),[3,11];case 11:return L.trys.push([11,16,,17]),g=Ar?hr:pr,console.log("Creating validated linguistic info using source language: ".concat(g||"unknown",' for text: "').concat(l.substring(0,20),'...", user language: ').concat(v)),g?(h=void 0,console.log("Using optimized linguistic info creation (max 2 requests)"),[4,vs(kn,En,l,0,v)]):[3,13];case 12:return(h=L.sent()).linguisticInfo?(o.setLinguisticInfo(h.linguisticInfo),a.linguisticInfo=!0,h.wasValidated||Ne(" Grammar reference created but not fully validated","warning")):(console.warn("Failed to generate linguistic info after ".concat(h.attempts," attempts")),Ne("Failed to generate grammar reference","warning")),[3,15];case 13:return console.warn("No source language detected. Using target language (".concat(v,") as fallback for source")),h=void 0,console.log("Using optimized linguistic info creation (fallback mode, max 2 requests)"),[4,vs(kn,En,l,0,v)];case 14:(h=L.sent()).linguisticInfo?(o.setLinguisticInfo(h.linguisticInfo),a.linguisticInfo=!0,h.wasValidated||Ne(" Grammar reference created but not fully validated (fallback mode)","warning")):(console.warn("Failed to generate linguistic info after ".concat(h.attempts," attempts")),Ne("Failed to generate grammar reference","warning")),L.label=15;case 15:return[3,17];case 16:if((m=L.sent())instanceof Error&&Me(m))throw console.error("Quota error detected, stopping card creation:",m.message),Ne(m.message),m;return console.error("Error in linguistic info creation:",m),Ne("Failed to create grammar reference","warning"),[3,17];case 17:a.translation&&console.log("Continuing with available data after linguistic info generation"),L.label=18;case 18:return L.trys.push([18,24,,25]),(y=Ar?hr:pr)?(console.log("Creating transcription using source language: ".concat(y,", user language: ").concat(v)),[4,ms(kn,En,l,y,v)]):[3,22];case 19:return(x=L.sent())?[4,Wr(v)]:[3,21];case 20:S=L.sent(),(C=[x.userLanguageTranscription&&'<div class="transcription-item user-lang">\n                                    <span class="transcription-label">'.concat(S,':</span>\n                                    <span class="transcription-text">').concat(x.userLanguageTranscription,"</span>\n                                </div>"),x.ipaTranscription&&'<div class="transcription-item ipa">\n                                    <span class="transcription-label">IPA:</span>\n                                    <span class="transcription-text">'.concat(x.ipaTranscription,"</span>\n                                </div>")].filter(Boolean).join("\n"))&&(o.setTranscription(C),console.log("Transcription created successfully")),L.label=21;case 21:return[3,23];case 22:console.warn("No source language available for transcription"),L.label=23;case 23:return[3,25];case 24:if((E=L.sent())instanceof Error&&Me(E))throw console.error("Quota error detected, stopping card creation:",E.message),Ne(E.message),E;return console.error("Transcription generation failed:",E),[3,25];case 25:if("off"===de||!Dn())return[3,36];L.label=26;case 26:return L.trys.push([26,35,,36]),A="always"===de,_="","smart"!==de?[3,28]:[4,$r(l)];case 27:j=L.sent(),A=j.shouldGenerate,_=j.reason,console.log('Smart image analysis for "'.concat(l,'": ').concat(A?"YES":"NO"," - ").concat(_)),L.label=28;case 28:return A?[4,kn.getDescriptionImage(En,l,w)]:[3,33];case 29:return F=L.sent(),ce!==Ji.OpenAI?[3,31]:[4,Li(0,qe,ie,F,w)];case 30:return P=L.sent(),R=P.imageUrl,B=P.imageBase64,R&&(console.log("*** HANDLE SUBMIT: Setting imageUrl in Redux:",R.substring(0,50)),o.setImageUrl(R)),B&&(console.log("*** HANDLE SUBMIT: Setting image (base64) in Redux:",B.substring(0,50)),o.setImage(B)),a.image=!0,[3,32];case 31:console.log("Image generation not supported for this provider"),L.label=32;case 32:return[3,34];case 33:L.label=34;case 34:return[3,36];case 35:if((O=L.sent())instanceof Error&&Me(O))throw console.error("Quota error detected, stopping card creation:",O.message),Ne(O.message),O;return console.error("Image generation failed:",O),(a.translation||a.examples)&&Ne("Image generation failed: ".concat(O instanceof Error?O.message:"Unknown error",". Continuing without image."),"warning"),[3,36];case 36:if(o.setCurrentCardId(null),ae(!1),_n([]),localStorage.removeItem("explicitly_saved"),localStorage.removeItem("current_card_id"),console.log("Created new single card - reset all saved statuses"),!(a.translation||a.examples||a.flashcard))throw new Error("Failed to create card: No data was successfully generated. Please check your API key and try again.");return n(!0),ot(!0),ne(!0),setTimeout((function(){console.log(" Content is ready - hiding loading"),T(!1),W(null),V({completed:0,total:0})}),500),[3,39];case 37:if(z=L.sent(),t.aborted)throw console.log("Card generation was cancelled by user"),new Error("Operation cancelled by user");return z instanceof Error&&Me(z)?(console.error("Quota error detected in main catch:",z.message),Ne(z.message),T(!1),W(null),V({completed:0,total:0}),[2]):(console.error("Error processing text:",z),Ne(z instanceof Error?"".concat(z.message):"Failed to create card. Please check your API key and try again."),T(!1),W(null),V({completed:0,total:0}),[3,39]);case 38:return o.setIsGeneratingCard(!1),Sn.current=null,[7];case 39:return[2]}var N}))}))},style:{width:"100%",display:"flex",flexDirection:"column",gap:"8px",marginTop:"4px",marginBottom:"0"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"}},{children:[(0,a.jsxs)("label",js({htmlFor:"text",style:{color:"#111827",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center"}},{children:["Text:",Hn()]})),(0,a.jsx)("textarea",{id:"text",value:l,onChange:function(e){return Pn(e.target.value)},placeholder:"Enter text to translate or select text from a webpage",style:{width:"100%",minHeight:"80px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",resize:"vertical",outline:"none",transition:"all 0.2s ease"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})]})),(0,a.jsx)("button",js({type:"submit",disabled:F,style:{width:"100%",padding:"8px 10px",marginTop:"4px",borderRadius:"6px",backgroundColor:"#2563EB",color:"#ffffff",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:F?.7:1},onMouseOver:function(e){return!F&&(e.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(e){return!F&&(e.currentTarget.style.backgroundColor="#2563EB")}},{children:F?(0,a.jsx)("div",js({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Creating card"})})):"Create Card"}))]})),S===_.GeneralTopic&&(0,a.jsxs)("div",js({style:{width:"100%",display:"flex",flexDirection:"column",gap:"8px",marginTop:"4px"}},{children:[(0,a.jsxs)("label",js({htmlFor:"general-text",style:{color:"#111827",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center"}},{children:["Text for Analysis:",Hn()]})),(0,a.jsx)("textarea",{id:"general-text",value:l,onChange:function(e){return Pn(e.target.value)},placeholder:"Enter or select text from the page to create cards",style:{width:"100%",minHeight:"80px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",resize:"vertical",outline:"none",transition:"all 0.2s ease"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})]}))]}))})),function(){if(!ut)return null;var e=Object.values(vt).filter(Boolean).length;return(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:function(){bt({}),dt(!1)}},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"360px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",js({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsxs)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(Wt,{size:14,color:"#2563EB"}),"Select Terms for Cards"]})),(0,a.jsx)("button",js({onClick:function(){bt({}),lt([]),dt(!1)},style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(rn,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"14px"}},{children:[(0,a.jsxs)("p",js({style:{fontSize:"14px",color:"#4B5563",margin:0,lineHeight:"1.4"}},{children:["Found ",st.length," key terms"]})),e>0&&(0,a.jsxs)("span",js({style:{fontSize:"13px",fontWeight:500,color:"#2563EB",padding:"3px 8px",backgroundColor:"#EFF6FF",borderRadius:"6px"}},{children:[e," selected"]}))]})),(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 4px",marginBottom:"12px"}},{children:[(0,a.jsx)("button",js({onClick:function(){var t=e<st.length,n={};st.forEach((function(e){n[e]=t})),bt(n)},style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",background:"none",border:"none",padding:"4px 8px",borderRadius:"4px",color:"#4B5563",cursor:"pointer"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"}},{children:e===st.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",js({style:{fontSize:"13px"}},{children:""}))," Deselect all"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",js({style:{fontSize:"13px"}},{children:""}))," Select all"]})})),(0,a.jsx)("span",js({style:{fontSize:"12px",color:"#6B7280",fontStyle:"italic"}},{children:"Tap to select"}))]})),(0,a.jsx)("div",js({style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"16px",maxHeight:"300px",overflowY:"auto",padding:"4px",listStyle:"none"}},{children:gt?(0,a.jsx)("div",js({style:{display:"flex",justifyContent:"center",padding:"20px"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"large",color:"#3B82F6",text:"Analyzing selected text..."})})):st.map((function(e,t){return(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",padding:"10px 12px",backgroundColor:vt[e]?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat(vt[e]?"#BFDBFE":"#E5E7EB"),borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",position:"relative",listStyleType:"none"},onClick:function(){return Jn(e)}},{children:[(0,a.jsx)("input",{type:"checkbox",checked:!!vt[e],onChange:function(){return Jn(e)},style:{marginRight:"12px",width:"16px",height:"16px",accentColor:"#2563EB",minWidth:"16px"},id:"option-".concat(t)}),(0,a.jsx)("span",js({style:{fontSize:"14px",color:"#374151",flex:1,cursor:"pointer",wordBreak:"break-word",textAlign:"left",paddingLeft:"0",marginLeft:"0",display:"inline-block"}},{children:e.replace(/^[-\s]+/,"")})),(0,a.jsx)("span",js({style:{position:"absolute",right:"10px",top:"10px",fontSize:"10px",padding:"2px 6px",borderRadius:"10px",backgroundColor:e.split(/\s+/).length>1?"#DBEAFE":"#F3F4F6",color:e.split(/\s+/).length>1?"#1E40AF":"#6B7280",fontWeight:e.split(/\s+/).length>1?"500":"normal"}},{children:e.split(/\s+/).length>1?"phrase":"word"}))]}),t)}))})),(0,a.jsxs)("div",js({style:{display:"flex",gap:"8px",marginTop:"12px"}},{children:[(0,a.jsx)("button",js({onClick:function(){bt({}),dt(!1)},style:{flex:"1",padding:"10px 12px",backgroundColor:"#F9FAFB",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F9FAFB"}},{children:"Cancel"})),(0,a.jsxs)("button",js({onClick:Qn,disabled:0===e,style:{flex:"2",padding:"10px 12px",backgroundColor:0===e?"#E5E7EB":"#2563EB",color:0===e?"#9CA3AF":"#FFFFFF",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:0===e?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(t){e>0&&(t.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(t){e>0&&(t.currentTarget.style.backgroundColor="#2563EB")}},{children:[(0,a.jsx)(Qt,{size:14}),"Create ",e>0?"".concat(e," Card").concat(e>1?"s":""):"Cards"]}))]}))]}))}))}(),rt&&t?(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:Kn},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"340px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",js({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsx)("h3",js({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:Ft?"Card ".concat(It+1," of ").concat(Ct.length):"Your Card"})),(0,a.jsx)("button",js({onClick:Kn,style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(rn,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",js({style:{width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",js({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:Ge,onChange:function(e){return Ve(e.target.value)},onKeyDown:Nn,placeholder:"Enter custom instructions (e.g., 'more formal examples', 'change image style')",style:{width:"100%",padding:"10px 12px",paddingRight:"44px",borderRadius:"8px",border:"1px solid #E5E7EB",fontSize:"14px",color:"#374151",backgroundColor:Ze?"#F9FAFB":"#FFFFFF",transition:"all 0.2s ease",boxShadow:Ze?"inset 0 1px 2px rgba(0, 0, 0, 0.05)":"none"},disabled:Ze}),Ze?(0,a.jsx)("div",js({style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",color:"#4F46E5"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#4F46E5"})})):(0,a.jsx)("button",js({onClick:Ln,disabled:!Ge.trim()||Ze,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:Ge.trim()?"linear-gradient(to right, #4F46E5, #6366F1)":"none",border:"none",color:Ge.trim()?"#FFFFFF":"#9CA3AF",cursor:Ge.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",width:"28px",height:"28px",boxShadow:Ge.trim()?"0 1px 3px rgba(0, 0, 0, 0.1)":"none",transition:"all 0.2s ease"},title:"Apply instructions"},{children:(0,a.jsx)(Jt,{size:14})}))]})),(0,a.jsxs)("div",js({style:{fontSize:"12px",color:Ze?"#4F46E5":"#6B7280",marginTop:"6px",display:"flex",alignItems:"center",gap:"6px",fontWeight:Ze?"500":"normal"}},{children:[Ze&&(0,a.jsx)("span",{style:{display:"inline-block",width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#4F46E5",animation:"pulse 1.5s infinite"}}),Ze?"Applying your instructions...":"Type instructions and press Enter or click the magic wand"]})),(0,a.jsx)("style",{children:"\n                            @keyframes pulse {\n                                0% { opacity: 1; }\n                                50% { opacity: 0.4; }\n                                100% { opacity: 1; }\n                            }\n                        "})]})),Ft&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",js({style:{marginBottom:"8px",display:"flex",justifyContent:"center",alignItems:"center"}},{children:(0,a.jsxs)("div",js({style:{fontSize:"13px",color:"#4B5563",backgroundColor:"#F9FAFB",padding:"4px 10px",borderRadius:"16px",display:"flex",alignItems:"center",gap:"4px"}},{children:["Card ",It+1," of ",Ct.length,Ct[It]&&jn(Ct[It].id)&&(0,a.jsxs)("span",js({style:{display:"inline-flex",alignItems:"center",gap:"3px",backgroundColor:"#ECFDF5",color:"#10B981",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"bold"}},{children:[(0,a.jsx)(Tt,{size:8}),"SAVED"]}))]}))})),(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"space-between",gap:"8px",marginBottom:"12px"}},{children:[(0,a.jsxs)("button",js({onClick:er,disabled:0===It,style:{padding:"8px 16px",backgroundColor:0===It?"#F3F4F6":"#EFF6FF",color:0===It?"#9CA3AF":"#2563EB",border:"1px solid ".concat(0===It?"#E5E7EB":"#BFDBFE"),borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:0===It?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",flex:1}},{children:[" Prev",It>0&&Ct[It-1]&&(jn(Ct[It-1].id)?(0,a.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#10B981",marginLeft:"auto"}}):null)]})),(0,a.jsxs)("button",js({onClick:Xn,disabled:It===Ct.length-1,style:{padding:"8px 16px",backgroundColor:It===Ct.length-1?"#F3F4F6":"#EFF6FF",color:It===Ct.length-1?"#9CA3AF":"#2563EB",border:"1px solid ".concat(It===Ct.length-1?"#E5E7EB":"#BFDBFE"),borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:It===Ct.length-1?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",flex:1,justifyContent:"flex-end"}},{children:[It<Ct.length-1&&Ct[It+1]&&(jn(Ct[It+1].id)?(0,a.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#10B981",marginRight:"auto"}}):null),"Next "]}))]})),(0,a.jsx)("button",js({onClick:Mn,style:{width:"100%",padding:"10px 12px",backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},disabled:D},{children:D?(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",js({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})})),An.length>0?(0,a.jsxs)(a.Fragment,{children:["Save ",Ct.length-An.length," Remaining Cards",(0,a.jsxs)("span",js({style:{fontSize:"12px",backgroundColor:"rgba(255,255,255,0.25)",borderRadius:"4px",padding:"1px 6px",marginLeft:"4px"}},{children:[An.length," saved"]}))]}):(0,a.jsxs)(a.Fragment,{children:["Save All Cards (",Ct.length,")"]})]})}))]}),(0,a.jsx)(hn,{mode:S,front:f,translation:c,examples:u,imageUrl:p,image:d,linguisticInfo:y,transcription:x,onNewImage:On,onNewExamples:zn,onAccept:Un,onViewSavedCards:qn,onCancel:Vn,loadingNewImage:R,loadingNewExamples:z,createdAt:new Date,loadingAccept:D,loadingGetResult:F,shouldGenerateImage:ue,isSaved:Fn,isEdited:K,isGeneratingCard:Jr,setTranslation:Rn,setExamples:Bn,setLinguisticInfo:Nr})]}))})):null,wr&&Lr(),rr&&ur(),an&&tn.length>0&&(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",animation:"fadeIn 0.3s ease-out"}},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",maxWidth:"640px",width:"100%",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",border:"1px solid #EAEAEA",animation:"slideUp 0.4s ease-out"}},{children:[(0,a.jsx)("div",js({style:{padding:"20px 24px 16px 24px",borderBottom:"1px solid #EAEAEA"}},{children:(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",js({style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#000000",letterSpacing:"-0.025em"}},{children:"Review Cards"})),(0,a.jsxs)("p",js({style:{margin:"4px 0 0 0",fontSize:"14px",color:"#666666",fontWeight:"400"}},{children:[tn.length," cards generated by AI"]}))]}),(0,a.jsx)("button",js({onClick:Kr,style:{background:"none",border:"none",fontSize:"16px",color:"#999999",cursor:"pointer",padding:"6px",borderRadius:"4px",transition:"all 0.15s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F5F5F5",e.currentTarget.style.color="#666666"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#999999"}},{children:(0,a.jsx)(rn,{})}))]}))})),tn.length>1&&(0,a.jsx)("div",js({style:{padding:"12px 24px",backgroundColor:"#FAFAFA",borderBottom:"1px solid #EAEAEA",display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",gap:"12px"}},{children:[(0,a.jsx)("button",js({onClick:function(){un>0&&dn(un-1)},disabled:0===un,style:{backgroundColor:"transparent",color:0===un?"#CCCCCC":"#666666",border:"1px solid ".concat(0===un?"#EAEAEA":"#DDDDD"),borderRadius:"6px",padding:"6px 10px",fontSize:"13px",fontWeight:"500",cursor:0===un?"not-allowed":"pointer",transition:"all 0.15s ease",display:"flex",alignItems:"center",gap:"4px"},onMouseOver:function(e){0!==un&&(e.currentTarget.style.borderColor="#999999",e.currentTarget.style.color="#333333")},onMouseOut:function(e){0!==un&&(e.currentTarget.style.borderColor="#DDDDDD",e.currentTarget.style.color="#666666")}},{children:""})),(0,a.jsxs)("div",js({style:{fontSize:"13px",color:"#666666",fontWeight:"500",padding:"0 8px"}},{children:[un+1," of ",tn.length]})),(0,a.jsx)("button",js({onClick:function(){un<tn.length-1&&dn(un+1)},disabled:un===tn.length-1,style:{backgroundColor:"transparent",color:un===tn.length-1?"#CCCCCC":"#666666",border:"1px solid ".concat(un===tn.length-1?"#EAEAEA":"#DDDDDD"),borderRadius:"6px",padding:"6px 10px",fontSize:"13px",fontWeight:"500",cursor:un===tn.length-1?"not-allowed":"pointer",transition:"all 0.15s ease",display:"flex",alignItems:"center",gap:"4px"},onMouseOver:function(e){un!==tn.length-1&&(e.currentTarget.style.borderColor="#999999",e.currentTarget.style.color="#333333")},onMouseOut:function(e){un!==tn.length-1&&(e.currentTarget.style.borderColor="#DDDDDD",e.currentTarget.style.color="#666666")}},{children:""}))]}))})),(0,a.jsx)("div",js({style:{flex:1,overflow:"auto",padding:"16px",backgroundColor:"#ffffff"}},{children:tn[un]&&(0,a.jsx)("div",js({style:{animation:"slideIn 0.3s ease-out"}},{children:(0,a.jsx)(hn,{front:tn[un].front||null,back:tn[un].back||null,translation:null,examples:[],imageUrl:tn[un].imageUrl||null,image:tn[un].image||null,linguisticInfo:"",transcription:null,onNewImage:function(){},onNewExamples:function(){},onAccept:Qr,onViewSavedCards:function(){},loadingNewImage:!1,loadingNewExamples:!1,loadingAccept:D,createdAt:new Date,mode:_.GeneralTopic,shouldGenerateImage:!1,isSaved:fn.has(un),isEdited:!1,isGeneratingCard:!1,hideActionButtons:!0,setBack:function(e){var t=Ps([],tn,!0);t[un]=js(js({},t[un]),{back:e}),nn(t)}})}))})),(0,a.jsxs)("div",js({style:{padding:"16px 20px",borderTop:"1px solid #EAEAEA",backgroundColor:"#FAFAFA",display:"flex",flexDirection:"column",gap:"12px"}},{children:[(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)("button",js({onClick:Qr,disabled:D||fn.has(un),style:{backgroundColor:fn.has(un)?"#10B981":"#ffffff",color:fn.has(un)?"#ffffff":"#374151",border:"1px solid ".concat(fn.has(un)?"#10B981":"#D1D5DB"),borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:D||fn.has(un)?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px",minWidth:"100px",justifyContent:"center",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",opacity:D||fn.has(un)?.7:1},onMouseOver:function(e){D||fn.has(un)||(e.currentTarget.style.borderColor="#9CA3AF",e.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)")},onMouseOut:function(e){D||fn.has(un)||(e.currentTarget.style.borderColor="#D1D5DB",e.currentTarget.style.boxShadow="0 1px 2px 0 rgba(0, 0, 0, 0.05)")}},{children:fn.has(un)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Tt,{size:14}),"Saved"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(en,{size:14}),"Save"]})})),(0,a.jsxs)("button",js({onClick:function(){xn(!0),wn("")},disabled:D,style:{backgroundColor:"#ffffff",color:"#F59E0B",border:"1px solid #F59E0B",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:D?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px",minWidth:"100px",justifyContent:"center",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",opacity:D?.7:1},onMouseOver:function(e){D||(e.currentTarget.style.backgroundColor="#F59E0B",e.currentTarget.style.color="#ffffff",e.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)")},onMouseOut:function(e){D||(e.currentTarget.style.backgroundColor="#ffffff",e.currentTarget.style.color="#F59E0B",e.currentTarget.style.boxShadow="0 1px 2px 0 rgba(0, 0, 0, 0.05)")}},{children:[(0,a.jsx)(Mt,{size:14}),"Improve"]}))]})),(0,a.jsxs)("div",js({style:{display:"flex",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)("button",js({onClick:Kr,disabled:D,style:{backgroundColor:"#ffffff",color:"#6B7280",border:"1px solid #D1D5DB",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:D?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",opacity:D?.7:1},onMouseOver:function(e){D||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)")},onMouseOut:function(e){D||(e.currentTarget.style.backgroundColor="#ffffff",e.currentTarget.style.boxShadow="0 1px 2px 0 rgba(0, 0, 0, 0.05)")}},{children:"Cancel"})),(0,a.jsx)("button",js({onClick:function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n;return Ts(this,(function(r){M(!0);try{for(e=0,t=tn;e<t.length;e++)n=t[e],i(ke(n));ln(!1),nn([]),dn(0),i(Ie(""))}catch(e){console.error("Error saving preview cards:",e),Ne("Error saving cards","error")}finally{M(!1)}return[2]}))}))},disabled:D,style:{backgroundColor:D?"#9CA3AF":"#3B82F6",color:"#ffffff",border:"none",borderRadius:"6px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:D?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px",minWidth:"140px",justifyContent:"center",boxShadow:"0 4px 6px -1px rgba(59, 130, 246, 0.3)",opacity:D?.7:1},onMouseOver:function(e){D||(e.currentTarget.style.backgroundColor="#2563EB",e.currentTarget.style.boxShadow="0 6px 10px -1px rgba(59, 130, 246, 0.4)",e.currentTarget.style.transform="translateY(-1px)")},onMouseOut:function(e){D||(e.currentTarget.style.backgroundColor="#3B82F6",e.currentTarget.style.boxShadow="0 4px 6px -1px rgba(59, 130, 246, 0.3)",e.currentTarget.style.transform="translateY(0)")}},{children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Tt,{size:14}),"Save All (",tn.length,")"]})}))]}))]}))]}))})),yn&&(0,a.jsx)("div",js({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"}},{children:(0,a.jsxs)("div",js({style:{backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",maxWidth:"520px",width:"100%",maxHeight:"80vh",overflow:"hidden",display:"flex",flexDirection:"column",border:"1px solid #EAEAEA"}},{children:[(0,a.jsx)("div",js({style:{padding:"20px 24px 16px 24px",borderBottom:"1px solid #EAEAEA"}},{children:(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",js({style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#000000",letterSpacing:"-0.025em"}},{children:"Improve Card"})),(0,a.jsx)("p",js({style:{margin:"4px 0 0 0",fontSize:"14px",color:"#666666",fontWeight:"400"}},{children:"Provide feedback to create a better version"}))]}),(0,a.jsx)("button",js({onClick:function(){return xn(!1)},style:{background:"none",border:"none",fontSize:"16px",color:"#999999",cursor:"pointer",padding:"6px",borderRadius:"4px",transition:"all 0.15s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F5F5F5",e.currentTarget.style.color="#666666"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#999999"}},{children:(0,a.jsx)(rn,{})}))]}))})),(0,a.jsxs)("div",js({style:{padding:"24px",flex:1,overflow:"auto"}},{children:[(0,a.jsx)("textarea",{value:bn,onChange:function(e){return wn(e.target.value)},placeholder:"Example: Make the question more specific, simplify the answer, add more context, focus on practical examples...",style:{width:"100%",minHeight:"140px",padding:"16px",borderRadius:"6px",border:"1px solid #EAEAEA",backgroundColor:"#FAFAFA",fontSize:"14px",lineHeight:"1.6",resize:"vertical",fontFamily:"inherit",outline:"none",transition:"all 0.15s ease"},onFocus:function(e){e.currentTarget.style.borderColor="#0070F3",e.currentTarget.style.backgroundColor="#ffffff"},onBlur:function(e){e.currentTarget.style.borderColor="#EAEAEA",e.currentTarget.style.backgroundColor="#FAFAFA"}}),(0,a.jsx)("div",js({style:{marginTop:"16px",padding:"12px 16px",backgroundColor:"#F9F9F9",borderRadius:"6px",border:"1px solid #EAEAEA"}},{children:(0,a.jsxs)("div",js({style:{display:"flex",alignItems:"flex-start",gap:"8px",fontSize:"13px",color:"#666666",lineHeight:"1.5"}},{children:[(0,a.jsx)(Kt,{size:14,style:{color:"#999999",marginTop:"1px"}}),(0,a.jsx)("span",{children:"Be specific about what you want to change for better results"})]}))}))]})),(0,a.jsxs)("div",js({style:{padding:"20px 24px",borderTop:"1px solid #EAEAEA",backgroundColor:"#FAFAFA",display:"flex",justifyContent:"flex-end",gap:"8px"}},{children:[(0,a.jsx)("button",js({onClick:function(){return xn(!1)},style:{backgroundColor:"transparent",color:"#999999",border:"none",padding:"8px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer",transition:"all 0.15s ease",borderRadius:"5px"},onMouseOver:function(e){e.currentTarget.style.color="#666666",e.currentTarget.style.backgroundColor="#F5F5F5"},onMouseOut:function(e){e.currentTarget.style.color="#999999",e.currentTarget.style.backgroundColor="transparent"}},{children:"Cancel"})),(0,a.jsx)("button",js({onClick:function(){return Fs(void 0,void 0,void 0,(function(){var e,t,n,r,o,a,i,s,c,u,d,p;return Ts(this,(function(f){switch(f.label){case 0:xn(!1),M(!0),f.label=1;case 1:if(f.trys.push([1,7,8,9]),!(e=tn[un]))return Ne("No card to recreate","error"),[2];t=Es(kn,En),n="Please recreate this card with improvements. Original card:\nQuestion: ".concat(e.front,"\nAnswer: ").concat(e.back,"\nOriginal text: ").concat(l),bn.trim()&&(n+="\n\nUser feedback: ".concat(bn.trim())),n+="\n\nPlease create an improved version based on the feedback.",r=void 0,f.label=2;case 2:return f.trys.push([2,4,,5]),o=window.getSelection(),a=void 0,o&&o.rangeCount>0&&(i=o.getRangeAt(0),a=i.commonAncestorContainer.nodeType===Node.ELEMENT_NODE?i.commonAncestorContainer:i.commonAncestorContainer.parentElement||void 0),[4,_s.extractPageContentAsync(l,a)];case 3:return r=f.sent(),[3,5];case 4:return s=f.sent(),console.warn("Failed to extract page content for recreation:",s),r=void 0,[3,5];case 5:return[4,t.createCardsFromText(n,r)];case 6:return(c=f.sent()).length>0?((u=Ps([],tn,!0))[un]=c[0],nn(u),gn((function(e){var t=new Set(e);return t.delete(un),t}))):Ne("Failed to recreate card","error"),[3,9];case 7:return d=f.sent(),console.error("Error recreating card:",d),p=d instanceof Error?d.message:"Unknown error",Ne("Card recreation error: ".concat(p),"error"),[3,9];case 8:return M(!1),wn(""),[7];case 9:return[2]}}))}))},disabled:D,style:{backgroundColor:D?"#F5F5F5":"#000000",color:D?"#999999":"#ffffff",border:"none",borderRadius:"5px",padding:"8px 16px",fontSize:"13px",fontWeight:"500",cursor:D?"not-allowed":"pointer",transition:"all 0.15s ease",display:"flex",alignItems:"center",gap:"6px",opacity:D?.6:1},onMouseOver:function(e){D||(e.currentTarget.style.backgroundColor="#333333")},onMouseOut:function(e){D||(e.currentTarget.style.backgroundColor="#000000")}},{children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#999999"}),"Improving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Mt,{size:11}),"Improve Card"]})}))]}))]}))})),(0,a.jsx)("div",js({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,pointerEvents:"none"}},{children:(0,a.jsx)("div",js({style:{pointerEvents:"auto"}},{children:De()}))})),(0,a.jsx)("style",{children:"\n                    @keyframes shimmer {\n                        0% {\n                            left: -100%;\n                        }\n                        100% {\n                            left: 100%;\n                        }\n                    }\n                "})]}))},Bs=n.p+"assets/img/chat-gpt39f424be38a6852eb2c5.png",Os=n.p+"assets/img/copy-iconb2b0ec637a2b0fd4ca40.svg";var zs=function(){return zs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},zs.apply(this,arguments)},Ls=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ns=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};const Ds=function(e){e.onBackClick,e.popup;var t=E(),n=(0,r.useState)(null),o=n[0],i=n[1],s=m((function(e){return e.settings.openAiKey})),l=(m((function(e){return e.settings.ankiConnectUrl})),m((function(e){return e.settings.ankiConnectApiKey}))),c=m((function(e){return e.settings.groqApiKey})),u=m((function(e){return e.settings.groqModelName})),d=m((function(e){return e.settings.modelProvider})),p=function(e){t(function(e){return{type:ot,payload:e}}(e.target.value))},f=function(e){t(function(e){return{type:xt,payload:e}}(e.target.value))},g=function(e){var n;t((n=e.target.value,{type:vt,payload:n}))},h=chrome.runtime.getURL(Bs),y=chrome.runtime.getURL(Os),x=function(e){return Ls(void 0,void 0,void 0,(function(){var t,n,r,o,a,l,d,p;return Ns(this,(function(f){switch(f.label){case 0:i(null),f.label=1;case 1:switch(f.trys.push([1,4,,5]),t="",n={},r={},o="",e){case Ji.OpenAI:t="https://api.openai.com/v1/chat/completions",n={"Content-Type":"application/json",Authorization:"Bearer ".concat(o=s)},r={model:"gpt-5-nano",messages:[{role:"user",content:"Say hello"}]};break;case Ji.Groq:t="https://api.groq.com/openai/v1/chat/completions",n={"Content-Type":"application/json",Authorization:"Bearer ".concat(o=c)},r={model:u,messages:[{role:"user",content:"Say hello"}]}}return o.trim()?[4,fetch(t,{method:"POST",headers:n,body:JSON.stringify(r)})]:(i({success:!1,message:"API key is missing. Please enter your API key."}),[2]);case 2:return[4,(a=f.sent()).json()];case 3:return l=f.sent(),a.ok?(console.log("API test response:",l),i({success:!0,message:"Connection successful! API is working properly."})):(console.error("API test error:",l),i({success:!1,message:"Error: ".concat((null===(p=l.error)||void 0===p?void 0:p.message)||"Unknown error occurred")})),[3,5];case 4:return d=f.sent(),console.error("API connection test error:",d),i({success:!1,message:"Error: ".concat(d instanceof Error?d.message:"Unknown error occurred")}),[3,5];case 5:return[2]}}))}))},v=function(){return o?(0,a.jsx)("div",zs({style:{padding:"10px",marginTop:"10px",borderRadius:"6px",backgroundColor:o.success?"#ECFDF5":"#FEF2F2",color:o.success?"#065F46":"#B91C1C",fontSize:"14px",borderLeft:"4px solid ".concat(o.success?"#10B981":"#EF4444")}},{children:o.message})):null};return(0,a.jsxs)("div",zs({style:{padding:"12px",backgroundColor:"#ffffff",height:"100%",width:"100%",maxWidth:"320px",margin:"0 auto",overflowY:"auto",paddingBottom:"16px",marginTop:"20px"}},{children:[(0,a.jsxs)("div",zs({style:{marginBottom:"20px",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"8px"}},{children:[(0,a.jsx)("label",zs({htmlFor:"modelProvider",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"AI Provider"})),(0,a.jsx)("p",zs({style:{fontSize:"12px",marginBottom:"8px",color:"#6B7280"}},{children:"Select which provider to use for generating flashcards"})),(0,a.jsxs)("select",zs({id:"modelProvider",value:d,onChange:function(e){var n;t((n=e.target.value,{type:yt,payload:n})),i(null)},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",cursor:"pointer"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)("option",zs({value:Ji.OpenAI},{children:"OpenAI"})),(0,a.jsx)("option",zs({value:Ji.Groq},{children:"Groq"}))]}))]})),(0,a.jsxs)("div",{children:[d!==Ji.OpenAI?null:(0,a.jsxs)("div",zs({style:{marginBottom:"20px"}},{children:[(0,a.jsxs)("div",zs({style:{display:"flex",alignItems:"center",marginBottom:"8px"}},{children:[(0,a.jsx)("label",zs({htmlFor:"openAiKey",style:{display:"block",fontWeight:"600",marginBottom:"0",marginRight:"8px",color:"#111827",fontSize:"14px"}},{children:"OpenAI API Key"})),(0,a.jsx)("img",{src:h,alt:"ChatGPT Logo",style:{width:"16px",height:"16px",marginTop:"-2px"}})]})),(0,a.jsxs)("p",zs({style:{fontSize:"12px",marginBottom:"6px",color:"#6B7280"}},{children:["You can get your OpenAI API key from ",(0,a.jsx)("a",zs({href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#2563EB",textDecoration:"underline"}},{children:"here"})),"."]})),(0,a.jsx)("div",zs({style:{position:"relative",marginBottom:"16px"}},{children:(0,a.jsx)("input",{type:"text",id:"openAiKey",value:s,onChange:p,style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})})),(0,a.jsx)("button",zs({onClick:function(){return x(Ji.OpenAI)},style:{marginTop:"8px",padding:"6px 12px",backgroundColor:"#10a37f",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px"}},{children:"Test API Connection"})),v()]})),d!==Ji.Groq?null:(0,a.jsxs)("div",zs({style:{marginBottom:"20px"}},{children:[(0,a.jsx)("label",zs({htmlFor:"groqApiKey",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"Groq API Key"})),(0,a.jsxs)("p",zs({style:{fontSize:"12px",marginBottom:"8px",color:"#6B7280"}},{children:["You can get your Groq API key from ",(0,a.jsx)("a",zs({href:"https://console.groq.com/keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#2563EB",textDecoration:"underline"}},{children:"here"})),"."]})),(0,a.jsx)("input",{type:"text",id:"groqApiKey",value:c,onChange:f,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",marginBottom:"16px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("div",zs({style:{padding:"8px",backgroundColor:"#DBEAFE",borderRadius:"6px",marginBottom:"16px"}},{children:(0,a.jsxs)("p",zs({style:{fontSize:"12px",color:"#1E40AF",margin:0}},{children:[(0,a.jsx)("strong",{children:"Note:"})," Image generation is not available with Groq."]}))})),(0,a.jsx)("label",zs({htmlFor:"groqModelName",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"Groq Model"})),(0,a.jsxs)("select",zs({id:"groqModelName",value:u,onChange:g,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",cursor:"pointer",marginBottom:"16px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)("option",zs({value:"llama3-8b-8192"},{children:"Llama-3 8B"})),(0,a.jsx)("option",zs({value:"llama3-70b-8192"},{children:"Llama-3 70B"})),(0,a.jsx)("option",zs({value:"mixtral-8x7b-32768"},{children:"Mixtral 8x7B"})),(0,a.jsx)("option",zs({value:"gemma-7b-it"},{children:"Gemma 7B"}))]})),(0,a.jsx)("button",zs({onClick:function(){return x(Ji.Groq)},style:{marginTop:"8px",padding:"6px 12px",backgroundColor:"#7c3aed",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px"}},{children:"Test API Connection"})),v()]})),(0,a.jsx)("div",{style:{marginBottom:"20px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",zs({htmlFor:"ankiConnectApiKey",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"AnkiConnect API Key (optional)"})),(0,a.jsx)("input",{type:"text",id:"ankiConnectApiKey",value:null!==l?l:"",onChange:function(e){var n;t((n=e.target.value,{type:lt,payload:n}))},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",marginBottom:"20px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",zs({style:{fontSize:"13px",marginBottom:"8px",color:"#6B7280"}},{children:["Install the Anki plugin ",(0,a.jsx)("strong",{children:"AnkiConnect"})," and configure it as follows:"]})),(0,a.jsxs)("ul",zs({style:{fontSize:"13px",listStyle:"disc",paddingLeft:"20px",marginBottom:"8px",color:"#6B7280"}},{children:[(0,a.jsxs)("li",zs({style:{marginBottom:"4px"}},{children:["Go to ",(0,a.jsx)("strong",{children:"Tools"})," then ",(0,a.jsx)("strong",{children:"Add-ons"})," then ",(0,a.jsx)("strong",{children:"Get Add-ons..."})]})),(0,a.jsxs)("li",zs({style:{marginBottom:"4px",display:"flex",alignItems:"center"}},{children:["Paste Code",(0,a.jsxs)("button",zs({onClick:function(){return navigator.clipboard.writeText("2055492159")},style:{display:"flex",alignItems:"center",backgroundColor:"#F3F4F6",padding:"4px 6px",borderRadius:"4px",color:"#2563EB",transition:"all 0.2s ease",border:"none",cursor:"pointer"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#E5E7EB"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"}},{children:[(0,a.jsx)("img",{src:y,alt:"Copy Icon",style:{width:"16px",height:"16px",marginRight:"4px"}}),(0,a.jsx)("code",zs({style:{backgroundColor:"transparent",fontSize:"12px"}},{children:"2055492159"}))]}))]})),(0,a.jsxs)("li",zs({style:{marginBottom:"4px"}},{children:["Then click ",(0,a.jsx)("strong",{children:"OK"})]})),(0,a.jsx)("li",zs({style:{marginBottom:"4px"}},{children:"Restart Anki"})),(0,a.jsxs)("li",zs({style:{marginBottom:"4px"}},{children:["Navigate to ",(0,a.jsx)("strong",{children:"Tools"})," > ",(0,a.jsx)("strong",{children:"Add-ons"})," > ",(0,a.jsx)("strong",{children:"AnkiConnect"})," >",(0,a.jsx)("strong",{children:"Config"})]}))]})),(0,a.jsxs)("div",zs({style:{position:"relative",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"6px",marginBottom:"20px"}},{children:[(0,a.jsxs)("p",zs({style:{fontSize:"13px",marginBottom:"8px",color:"#6B7280"}},{children:["Copy paste the following config, you can change the ",(0,a.jsx)("code",{children:"apiKey"}),":"]})),(0,a.jsx)("pre",zs({style:{display:"block",overflow:"auto",padding:"10px",backgroundColor:"#F3F4F6",borderRadius:"4px",whiteSpace:"pre-wrap",cursor:"pointer",fontSize:"12px",color:"#374151",margin:0},onClick:function(){return navigator.clipboard.writeText(JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2))},title:"Click to copy"},{children:JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2)})),(0,a.jsx)("button",zs({onClick:function(){return navigator.clipboard.writeText(JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2))},style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",cursor:"pointer",padding:"4px"},title:"Copy to clipboard"},{children:(0,a.jsx)("img",{src:y,alt:"Copy Icon",style:{width:"16px",height:"16px"}})}))]}))]})]}))};var Ms="FETCH_DECKS_SUCCESS",Us="SET_DECK_ID",qs=function(e){return{type:Us,payload:e}},Ws=function(){return Ws=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ws.apply(this,arguments)},$s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Gs=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Vs=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const Hs=function(e){e.onBackClick;var t=E(),n=Ue(),o=n.storedCards,i=m((function(e){return e.deck.deckId})),s=m((function(e){return e.deck.decks})),l=m((function(e){return e.settings.useAnkiConnect})),c=m((function(e){return e.settings.ankiConnectUrl})),u=m((function(e){return e.settings.ankiConnectApiKey})),d=m((function(e){return e.settings.openAiKey})),p=m((function(e){return e.settings.imageInstructions})),f=m((function(e){return e.cards})),g=(0,r.useState)([]),h=g[0],y=g[1],x=(0,r.useState)(!1),v=x[0],b=x[1],w=(0,r.useState)(!1),S=w[0],C=w[1],k=(0,r.useState)("not_exported"),I=k[0],A=k[1],j=(0,r.useState)(!1),F=j[0],T=j[1],P=(0,r.useState)(null),R=P[0],B=P[1],O=(0,r.useState)(!1),z=O[0],L=O[1],N=(0,r.useState)(!1),D=(N[0],N[1]),M=(0,r.useState)(""),U=M[0],q=M[1],W=(0,r.useState)(!1),$=W[0],G=W[1],V=(0,r.useState)(null),H=V[0],K=V[1],Q=(0,r.useState)(!1),J=Q[0],X=Q[1],Y=(0,r.useState)(!1),Z=Y[0],ee=Y[1],te=(0,r.useState)(1),re=te[0],oe=te[1],ae=(0,r.useState)(10),ie=ae[0],se=ae[1],le=(0,r.useState)(1),ce=le[0],ue=le[1],de=(0,r.useState)(!1),pe=de[0],fe=de[1],ge=(0,r.useState)("anki_cards"),he=ge[0],me=ge[1],ye=(0,r.useState)(!1),xe=ye[0],ve=ye[1],be=Di(),we=be.showError,Se=be.renderErrorNotification;new Bi({apiKey:d,dangerouslyAllowBrowser:!0});(0,r.useEffect)((function(){$s(void 0,void 0,void 0,(function(){var e,n,r;return Gs(this,(function(a){console.log("StoredCards component mounted, forcing complete reload of cards...");try{if(e=localStorage.getItem("anki_stored_cards"))try{n=JSON.parse(e),console.log("Direct from localStorage, found cards:",n.length)}catch(e){console.error("Failed to parse localStorage data directly:",e)}else console.log("No cards found directly in localStorage")}catch(e){console.error("Error accessing localStorage directly:",e)}return t(Ee()),r=setTimeout((function(){if(console.log("Current stored cards after initial load:",o.length),0===o.length){console.log("No cards loaded, trying to load directly from localStorage...");try{var e=localStorage.getItem("anki_stored_cards");if(e){var n=JSON.parse(e);Array.isArray(n)&&n.length>0&&(console.log("Found cards directly in localStorage, manually setting in Redux..."),t({type:"SET_STORED_CARDS",payload:n}))}}catch(e){console.error("Failed to manually load cards:",e)}}if(o.length>0){var r=o.filter((function(e){return"not_exported"===e.exportStatus})).length,a=o.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})).length;console.log("Card stats: total=",o.length,"not_exported=",r,"exported=",a),o.forEach((function(e,t){var n,r,o,a;(e.image||e.imageUrl)&&console.log("Card ".concat(t," (").concat(e.id,") has images:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(n=e.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=e.imageUrl)||void 0===r?void 0:r.length,imageStart:null===(o=e.image)||void 0===o?void 0:o.substring(0,30),imageUrlStart:null===(a=e.imageUrl)||void 0===a?void 0:a.substring(0,30)})}))}}),500),[2,function(){return clearTimeout(r)}]}))}))}),[t,o.length]),(0,r.useEffect)((function(){console.log("Stored cards updated:",o)}),[o]);var ke=function(){return $s(void 0,void 0,void 0,(function(){var e,n;return Gs(this,(function(r){switch(r.label){case 0:if(!l)return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),C(!0),[4,ne(u)];case 2:return(e=r.sent()).result&&(t({type:"FETCH_DECKS_SUCCESS",payload:e.result}),!i&&e.result.length>0&&t(qs(e.result[0].deckId))),[3,5];case 3:return n=r.sent(),console.error("Error loading decks:",n),l&&we("Failed to load Anki decks. Make sure Anki is running with AnkiConnect plugin."),[3,5];case 4:return C(!1),[7];case 5:return[2]}}))}))};(0,r.useEffect)((function(){l&&0===s.length&&ke()}),[l]);var Ie=function(){if(console.log("All cards in store:",o.length,"cards"),!Array.isArray(o)||0===o.length)return console.log("No cards to filter"),[];var e,t={not_exported:0,exported_to_anki:0,exported_to_file:0,unknown:0};switch(o.forEach((function(e){"not_exported"===e.exportStatus?t.not_exported++:"exported_to_anki"===e.exportStatus?t.exported_to_anki++:"exported_to_file"===e.exportStatus?t.exported_to_file++:t.unknown++})),console.log("Card status counts:",t),I){case"not_exported":e=o.filter((function(e){return"not_exported"===e.exportStatus})),console.log("Filtered to not_exported cards:",e.length);break;case"exported":e=o.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})),console.log("Filtered to exported cards:",e.length);break;default:e=Vs([],o,!0),console.log("Using all cards:",e.length)}var n=e.sort((function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}));return console.log("Final filtered and sorted cards:",n.length),n}(),Ae=function(){if(0===Ie.length)return[];var e=(re-1)*ie,t=e+ie;return e>=Ie.length?(oe(1),Ie.slice(0,ie)):(console.log("Pagination debug:",{totalCards:o.length,filteredCards:Ie.length,currentPage:re,itemsPerPage:ie,startIndex:e,endIndex:t,cardsOnThisPage:Ie.slice(e,t).length}),Ie.slice(e,t))}();(0,r.useEffect)((function(){var e=Math.max(1,Math.ceil(Ie.length/ie));ue(e),re>e&&oe(1)}),[Ie.length,ie]);var _e={all:o.length,not_exported:o.filter((function(e){return"not_exported"===e.exportStatus})).length,exported:o.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})).length},je=function(e){var t=new Date(e),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0");return"".concat(r,"/").concat(n," ").concat(o,":").concat(a)},Fe=function(e){switch(e){case"exported_to_anki":return(0,a.jsx)("span",Ws({style:{fontSize:"11px",color:"#10B981",marginLeft:"8px"}},{children:" Anki"}));case"exported_to_file":return(0,a.jsx)("span",Ws({style:{fontSize:"11px",color:"#2563EB",marginLeft:"8px"}},{children:" File"}));default:return null}},Te=function(e){return R===e?null:(0,a.jsxs)("div",Ws({style:{padding:"8px"}},{children:[(e.text||e.front)&&(0,a.jsx)("p",Ws({style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px",color:"#111827",lineHeight:"1.4",wordWrap:"break-word"}},{children:e.mode===_.LanguageLearning?e.text:e.front})),(e.translation||e.back)&&(0,a.jsx)("div",Ws({style:{color:"#374151",fontSize:"13px",marginBottom:"8px",lineHeight:"1.4",wordWrap:"break-word"}},{children:e.mode===_.LanguageLearning?e.translation:e.back&&(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:(t=e.back.length>150?e.back.substring(0,150)+"...":e.back,n=t,n=(n=(n=(n=(n=n.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(function(e,t,n){var r=t&&""!==t&&"Image"!==t?t:"";return'<div style="text-align: center; margin: 6px 0;">\n            <img src="'.concat(n,'" alt="').concat(r,'" style="max-width: 100%; max-height: 120px; height: auto; border-radius: 3px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); display: block; margin: 0 auto;" />\n            ').concat(r?'<div style="font-size: 9px; color: #6B7280; margin-top: 2px; font-style: italic;">'.concat(r,"</div>"):"","\n        </div>")}))).replace(/\$\$([^$]+)\$\$/g,(function(e,t){return'<div style="text-align: center; margin: 8px 0; padding: 6px; background: #F8FAFC; border-radius: 4px; font-family: serif; font-size: 12px;">\n            <strong>:</strong> '.concat(t,"\n        </div>")}))).replace(/```(\w*)\n([\s\S]*?)\n```/g,(function(e,t,n){return'<div style="margin: 8px 0;">\n            <div style="background: #2D2D2D; color: #F8F8F2; padding: 8px; border-radius: 4px; font-family: monospace; overflow-x: auto; white-space: pre; font-size: 11px;">\n                '.concat(t?'<div style="color: #6B7280; margin-bottom: 4px; font-size: 9px;">'.concat(t,"</div>"):"","\n                ").concat(n,"\n            </div>\n        </div>")}))).replace(/`([^`]+)`/g,'<code style="background: #F3F4F6; padding: 1px 3px; border-radius: 2px; font-family: monospace; font-size: 11px;">$1</code>')).replace(/\n/g,"<br />"))}})})),e.mode===_.LanguageLearning&&e.examples&&e.examples.length>0&&(0,a.jsxs)("div",Ws({style:{marginTop:"8px"}},{children:[(0,a.jsx)("p",Ws({style:{fontSize:"12px",color:"#6B7280",marginBottom:"4px"}},{children:"Examples:"})),e.examples.slice(0,1).map((function(e,t){var n=e[0],r=e[1];return(0,a.jsxs)("div",Ws({style:{fontSize:"12px",marginBottom:"2px"}},{children:[(0,a.jsx)("p",Ws({style:{color:"#111827",marginBottom:"2px",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:n})),r&&(0,a.jsx)("p",Ws({style:{color:"#6B7280",fontStyle:"italic",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:r}))]}),t)})),e.examples.length>1&&(0,a.jsxs)("p",Ws({style:{fontSize:"11px",color:"#6B7280"}},{children:["+",e.examples.length-1," more examples"]}))]})),(e.image||e.imageUrl)&&(0,a.jsx)("div",Ws({style:{marginTop:"8px",textAlign:"center"}},{children:(0,a.jsx)("img",{src:e.image||e.imageUrl||"",alt:"Card image",style:{maxWidth:"100%",maxHeight:"80px",borderRadius:"4px",border:"1px solid #E5E7EB",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},onError:function(t){var n,r,o,a,i;console.error("Image failed to load for card:",e.id,"image data:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(n=e.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=e.imageUrl)||void 0===r?void 0:r.length,imagePreview:null===(o=e.image)||void 0===o?void 0:o.substring(0,50),imageUrlPreview:null===(a=e.imageUrl)||void 0===a?void 0:a.substring(0,50),imageSrc:(e.image||e.imageUrl||"").substring(0,100),usingType:e.image?"base64 (permanent)":"url (temporary)"});var s=t.target;s.style.display="none";var l=document.createElement("div");l.style.cssText="\n                                    width: 100%;\n                                    height: 60px;\n                                    background-color: #F3F4F6;\n                                    border: 1px dashed #D1D5DB;\n                                    border-radius: 4px;\n                                    display: flex;\n                                    align-items: center;\n                                    justify-content: center;\n                                    color: #6B7280;\n                                    font-size: 12px;\n                                ",l.textContent=e.image?" Image error":" URL expired",null===(i=s.parentNode)||void 0===i||i.insertBefore(l,s.nextSibling)},onLoad:function(){var t,n;console.log(" Image loaded successfully for card:",e.id,{usingType:e.image?"base64 (permanent)":"url (temporary)",imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length})}})})),(0,a.jsxs)("div",Ws({style:{marginTop:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsx)("span",Ws({style:{fontSize:"10px",color:"#6B7280",backgroundColor:e.mode===_.LanguageLearning?"#EEF2FF":"#F0FDF4",padding:"2px 6px",borderRadius:"12px",border:"1px solid ".concat(e.mode===_.LanguageLearning?"#C7D2FE":"#BBF7D0"),fontWeight:"500"}},{children:e.mode===_.LanguageLearning?" Language":" General"})),(0,a.jsx)("span",Ws({style:{fontSize:"10px",color:"#9CA3AF"}},{children:je(e.createdAt)}))]}))]}));var t,n},Pe=function(e){t(qs(e.target.value))},Re=function(){T((function(e){return!e}))},Be=function(e){console.log("Starting to edit card:",e.id),console.log("Card data:",e),B(e),K(Ws({},e)),L(!0),D(!0),q(""),G(!1),X(!1),ee(!1),console.log("Modal state set for editing card:",e.id)},Oe=function(){console.log("Canceling edit, resetting modal state..."),B(null),K(null),L(!1),D(!1),q(""),G(!1),X(!1),ee(!1),console.log("Edit canceled, modal should be hidden now.")},ze=function(){return $s(void 0,void 0,void 0,(function(){var e,t;return Gs(this,(function(r){if(!R||!H)return[2];try{if(ee(!0),(e=Ws(Ws({},R),{text:H.text||R.text||"",translation:H.translation||R.translation||"",examples:Array.isArray(H.examples)?H.examples:Array.isArray(R.examples)?R.examples:[],front:H.front||R.front||"",back:H.back||R.back||"",image:H.image||R.image||null,imageUrl:H.imageUrl||R.imageUrl||null,linguisticInfo:H.linguisticInfo||R.linguisticInfo||"",transcription:H.transcription||R.transcription||""})).mode===_.LanguageLearning){if(!e.text||!e.translation)return we("Please provide both text and translation"),[2];e.text=e.text.trim(),e.translation=e.translation.trim()}else{if(!e.front||!e.back)return we("Please provide both front and back content"),[2];e.front=e.front.trim(),e.back=(null===(t=e.back)||void 0===t?void 0:t.trim())||null}console.log("Final data being saved to Redux:",e),n.updateStoredCard(e),Oe()}catch(e){console.error("Error saving card:",e),we("Failed to update card. Please try again.")}finally{ee(!1)}return[2]}))}))},Le=function(){return $s(void 0,void 0,void 0,(function(){var e,t,n,r,o,a,i;return Gs(this,(function(s){switch(s.label){case 0:if(!R)return[2];s.label=1;case 1:if(s.trys.push([1,6,,7]),!d)throw new Error("OpenAI API key is not configured. Please add it in the settings.");return e=(null==H?void 0:H.text)||R.text,console.log("Starting image generation for text:",e),[4,tt(d,e,p)];case 2:if(t=s.sent(),console.log("Description generated:",t),!t)throw new Error("Failed to generate image description");return n=p?"".concat(t,". ").concat(p):t,[4,fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(d)},body:JSON.stringify({prompt:n,n:1,size:"512x512",response_format:"url"})})];case 3:return[4,s.sent().json()];case 4:if(r=s.sent(),console.log("OpenAI direct API response:",r),!r.data||!r.data[0]||!r.data[0].url)throw new Error("OpenAI did not return an image URL");return o=r.data[0].url,console.log("Image URL generated:",o),[4,new Promise((function(e,t){chrome.runtime.sendMessage(o,(function(n){if(chrome.runtime.lastError)return console.error("Error sending message:",chrome.runtime.lastError),void t(chrome.runtime.lastError);console.log("Response from background script:",n),n&&n.status&&n.data?e(n.data):t(new Error("Failed to get image data from background script"))}))}))];case 5:return a=s.sent(),console.log("Image data received from background"),H&&K(Ws(Ws({},H),{imageUrl:a,image:a})),[3,7];case 6:return i=s.sent(),console.error("Error generating image:",i),we("Image generation failed: ".concat((null==i?void 0:i.message)||"Unknown error")),[3,7];case 7:return[2]}}))}))},Ne=function(){return $s(void 0,void 0,void 0,(function(){return Gs(this,(function(e){if(!R)return[2];try{X(!0),(null==H?void 0:H.text)||R.text,we("Examples generation would be implemented here","info")}catch(e){console.error("Error generating examples:",e),we("Examples generation failed: ".concat((null==e?void 0:e.message)||"Unknown error"))}finally{X(!1)}return[2]}))}))},De=function(){return $s(void 0,void 0,void 0,(function(){return Gs(this,(function(e){if(!U.trim()||$||!R)return[2];G(!0);try{we('Custom instruction "'.concat(U,'" would be applied here'),"info"),q("")}catch(e){console.error("Error applying custom instructions:",e),we("Failed to apply custom instructions")}finally{G(!1)}return[2]}))}))},Me=function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),De())},qe=function(e){H&&K(Ws(Ws({},H),{translation:e}))},We=function(e){H&&K(Ws(Ws({},H),{examples:e}))},$e=function(e){H&&K(Ws(Ws({},H),{back:e}))},Ge=function(e){H&&K(Ws(Ws({},H),{linguisticInfo:e}))},Ve=function(e){e>=1&&e<=ce&&oe(e)},He=function(e){se(Number(e.target.value)),oe(1)};(0,r.useEffect)((function(){var e,t;console.log("Modal state changed:",{showEditModal:z,editingCard:null==R?void 0:R.id,currentCardData:{text:(null===(e=f.text)||void 0===e?void 0:e.substring(0,20))+"...",translation:(null===(t=f.translation)||void 0===t?void 0:t.substring(0,20))+"..."}})}),[z,R,f.text,f.translation]);var Ke,Qe=function(){return $s(void 0,void 0,void 0,(function(){var e,t,r,a,i,s,l,c;return Gs(this,(function(u){if(0===h.length)return we("Please select at least one card to export"),[2];try{ve(!0),e=o.filter((function(e){return h.includes(e.id)})),t="#separator:tab\n#html:true\n",e.forEach((function(e,n){var r,o,a,i;if(console.log("Processing card ".concat(n," for file export:"),{id:e.id,mode:e.mode,hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(r=e.image)||void 0===r?void 0:r.length,imageUrlLength:null===(o=e.imageUrl)||void 0===o?void 0:o.length,imagePreview:null===(a=e.image)||void 0===a?void 0:a.substring(0,50),imageUrlPreview:null===(i=e.imageUrl)||void 0===i?void 0:i.substring(0,50),hasLinguisticInfo:!!e.linguisticInfo}),e.mode===_.LanguageLearning){var s=e.text.trim(),l="";if(e.translation&&(l+="<b>".concat(e.translation,"</b>")),e.examples&&e.examples.length>0&&(l+="<br><br>",e.examples.forEach((function(e,t){var n=e[0],r=e[1];l+="".concat(t+1,". ").concat(n),r&&(l+="<br><span style='font-size: 0.8em;'><i>".concat(r,"</i></span>")),l+="<br><br>"}))),e.image){var c=e.image;if(c.startsWith("data:")){var u="base64,";if(-1!==(f=c.indexOf(u))){var d=c.substring(f+u.length);l+='<div><img src="data:image/jpeg;base64,'.concat(d,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="'.concat(c,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="data:image/jpeg;base64,'.concat(c,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else if(e.imageUrl){var p=e.imageUrl;if(p.startsWith("data:")){var f;u="base64,";if(-1!==(f=p.indexOf(u))){d=p.substring(f+u.length);l+='<div><img src="data:image/jpeg;base64,'.concat(d,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="'.concat(p,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else p.startsWith("http")?l+='<div><img src="'.concat(p,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>'):l+='<div><img src="data:image/jpeg;base64,'.concat(p,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}if(e.linguisticInfo&&e.linguisticInfo.trim()){var g=e.linguisticInfo.trim().split("\n").filter((function(e){return e.trim()})),h="";g.forEach((function(e){var t=e.trim();if(t.match(/^[-A-Z][^:]*:$/))h+='<div style="color: #2563EB; font-weight: bold; margin-top: 12px; margin-bottom: 4px;">'.concat(t,"</div>");else if(t.startsWith("")||t.startsWith("-")||t.startsWith("*")){var n=t.replace(/^[\-*]\s*/,"");h+='<div style="margin-left: 16px; margin-bottom: 2px; color: #374151;"> '.concat(n,"</div>")}else if(t.includes(":")&&!t.endsWith(":")){var r=t.split(":"),o=r[0],a=r.slice(1).join(":").trim();h+='<div style="margin-bottom: 4px;"><span style="color: #6B7280; font-weight: 500;">'.concat(o.trim(),':</span> <span style="color: #111827;">').concat(a,"</span></div>")}else t&&(h+='<div style="margin-bottom: 6px; color: #374151; line-height: 1.4;">'.concat(t,"</div>"))})),h&&(l+='<div style="margin-top: 20px; padding: 12px; background-color: #F8FAFC; border-left: 4px solid #2563EB; border-radius: 0 6px 6px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="color: #1E40AF; font-weight: bold; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center;"><span style="margin-right: 6px;"></span>Grammar & Linguistics</div>'.concat(h,"</div>"))}var m=s.replace(/\t/g," ").replace(/\n/g," ").trim(),y=l.replace(/\t/g," ").replace(/\r?\n/g,"<br>").trim();t+="".concat(m,"\t").concat(y,"\n"),console.log("Exported card ".concat(n,":"),{front:m.substring(0,50),backLength:y.length,hasLinguisticInfo:y.includes("Grammar & Linguistics")})}else if(e.mode===_.GeneralTopic){s=(e.front||"").trim();var x=(e.back||"").trim();m=s.replace(/\t/g," ").replace(/\n/g," ").trim(),y=x.replace(/\t/g," ").replace(/\r?\n/g,"<br>").trim();t+="".concat(m,"\t").concat(y,"\n")}})),(r=he.trim())||(r="anki_cards"),(r=r.replace(/[<>:"/\\|?*]/g,"_")).toLowerCase().endsWith(".txt")||(r+=".txt"),a=new Blob([t],{type:"text/plain;charset=utf-8;"}),i=URL.createObjectURL(a),(s=document.createElement("a")).setAttribute("href",i),s.setAttribute("download",r),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),l=e.length,c=e.filter((function(e){return e.linguisticInfo&&e.linguisticInfo.trim()})).length,console.log("Export complete: ".concat(l," cards exported, ").concat(c," with grammar information")),h.forEach((function(e){n.updateCardExportStatus(e,"exported_to_file"),console.log("Updated card ".concat(e," export status to 'exported_to_file'"))})),fe(!1),setTimeout((function(){try{var e=localStorage.getItem("anki_stored_cards");if(e){var t=JSON.parse(e);console.log("Verified localStorage after file export:",t.filter((function(e){return e.id&&h.includes(e.id)})).map((function(e){return{id:e.id,status:e.exportStatus}})))}}catch(e){console.error("Error verifying localStorage after file export:",e)}}),500)}catch(e){console.error("Error during file export:",e),we("Failed to export cards. Please try again.")}finally{ve(!1)}return[2]}))}))};return(0,a.jsxs)("div",Ws({style:{display:"flex",flexDirection:"column",height:"100%",padding:"12px",paddingBottom:"20px",overflowY:"auto",width:"100%",maxWidth:"320px",margin:"0 auto",position:"relative"}},{children:[(0,a.jsx)("div",Ws({style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"16px",paddingBottom:"12px",borderBottom:"1px solid #E5E7EB",marginTop:"20px"}},{children:(0,a.jsxs)("div",Ws({style:{fontWeight:"600",fontSize:"16px",color:"#111827",background:"linear-gradient(to right, #4F46E5, #2563EB)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",padding:"4px 12px",borderRadius:"16px",border:"1px solid #E5E7EB",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:["Saved Cards (",o.length,")"]}))})),o.length>0?(0,a.jsxs)(a.Fragment,{children:[(Ke={base:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",borderRadius:"6px 6px 0 0",cursor:"pointer",textAlign:"center",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px"},active:{backgroundColor:"#ffffff",color:"#2563EB",borderBottom:"2px solid #2563EB"},inactive:{backgroundColor:"#F3F4F6",color:"#6B7280",borderBottom:"2px solid transparent"}},(0,a.jsxs)("div",Ws({style:{display:"flex",width:"100%",borderBottom:"1px solid #E5E7EB",marginBottom:"16px",backgroundColor:"#F3F4F6"}},{children:[(0,a.jsxs)("div",Ws({onClick:function(){return A("not_exported")},style:Ws(Ws(Ws({},Ke.base),"not_exported"===I?Ke.active:Ke.inactive),{flex:1})},{children:["New",(0,a.jsx)("span",Ws({style:{backgroundColor:"not_exported"===I?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:_e.not_exported}))]})),(0,a.jsxs)("div",Ws({onClick:function(){return A("all")},style:Ws(Ws(Ws({},Ke.base),"all"===I?Ke.active:Ke.inactive),{flex:1})},{children:["All",(0,a.jsx)("span",Ws({style:{backgroundColor:"all"===I?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:_e.all}))]})),(0,a.jsxs)("div",Ws({onClick:function(){return A("exported")},style:Ws(Ws(Ws({},Ke.base),"exported"===I?Ke.active:Ke.inactive),{flex:1})},{children:["Exported",(0,a.jsx)("span",Ws({style:{backgroundColor:"exported"===I?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:_e.exported}))]}))]}))),l&&function(){var e;if(!l)return null;var t={container:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"16px",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"8px",border:"1px solid #E5E7EB"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},title:{fontSize:"14px",fontWeight:"600",color:"#111827"},button:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6B7280",display:"flex",alignItems:"center",padding:"0",fontSize:"12px"},selectContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%"},select:{flex:1,padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",cursor:"pointer"},refreshButton:{backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",cursor:"pointer",color:"#6B7280",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",minWidth:"36px",height:"38px"}};return F?(0,a.jsxs)("div",Ws({style:t.container},{children:[(0,a.jsxs)("div",Ws({style:t.header},{children:[(0,a.jsx)("span",Ws({style:t.title},{children:"Select Anki Deck"})),(0,a.jsx)("button",Ws({onClick:Re,style:t.button},{children:"Hide"}))]})),(0,a.jsxs)("div",Ws({style:t.selectContainer},{children:[(0,a.jsxs)("select",Ws({value:i,onChange:Pe,style:t.select,disabled:S},{children:[0===s.length&&(0,a.jsx)("option",Ws({value:""},{children:"No decks available"})),s.map((function(e){return(0,a.jsx)("option",Ws({value:e.deckId},{children:e.name}),e.deckId)}))]})),(0,a.jsx)("button",Ws({onClick:ke,disabled:S,title:"Refresh decks list",style:t.refreshButton,"aria-label":"Refresh decks"},{children:S?(0,a.jsx)("span",Ws({style:{marginLeft:"2px"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",color:"#4B5563"})})):(0,a.jsx)(tn,{size:14})}))]})),(0,a.jsx)("style",{children:"\n                    @keyframes spin {\n                        0% { transform: rotate(0deg); }\n                        100% { transform: rotate(360deg); }\n                    }\n                    "})]})):(0,a.jsxs)("div",Ws({style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:"12px",padding:"8px 12px",backgroundColor:"#F9FAFB",borderRadius:"6px",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",Ws({style:{fontSize:"13px",color:"#6B7280"}},{children:"Anki Deck:"})),(0,a.jsx)("span",Ws({style:{fontSize:"14px",fontWeight:"500",marginLeft:"8px",color:"#111827"}},{children:(null===(e=s.find((function(e){return e.deckId===i})))||void 0===e?void 0:e.name)||"None selected"}))]}),(0,a.jsx)("button",Ws({onClick:Re,style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#2563EB",fontSize:"13px"}},{children:"Change"}))]}))}(),(0,a.jsxs)("div",Ws({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",Ws({style:{display:"flex",alignItems:"center"}},{children:[(0,a.jsx)("input",{type:"checkbox",id:"selectAll",checked:h.length===Ie.length&&Ie.length>0,onChange:function(){R||(h.length===Ie.length?y([]):y(Ie.map((function(e){return e.id}))))},style:{marginRight:"8px"},disabled:null!==R}),(0,a.jsx)("label",Ws({htmlFor:"selectAll",style:{fontSize:"14px",cursor:null!==R?"default":"pointer",opacity:null!==R?.6:1}},{children:h.length===Ie.length&&Ie.length>0?"Deselect All":"Select All"}))]})),(0,a.jsxs)("div",Ws({style:{display:"flex",gap:"8px",flexWrap:"wrap"}},{children:[(0,a.jsx)("button",Ws({onClick:function(){return $s(void 0,void 0,void 0,(function(){var e,r,a,s;return Gs(this,(function(l){switch(l.label){case 0:if(0===h.length)return we("Please select at least one card to save"),[2];b(!0),l.label=1;case 1:return l.trys.push([1,6,7,8]),e="Basic",r=o.filter((function(e){return h.includes(e.id)})),a=[],s=[],r.forEach((function(e){if(e.mode===_.LanguageLearning&&e.translation){var t=null;if(e.image)if(e.image.startsWith("data:")){var n="base64,";t=-1!==(o=e.image.indexOf(n))?e.image.substring(o+n.length):e.image}else t=e.image;var r={text:e.text,translation:e.translation,examples:e.examples||[],image_base64:t,linguisticInfo:e.linguisticInfo};console.log("Adding language learning card to Anki export:",{cardId:e.id,text:e.text,hasImage:!!t,imageLength:null==t?void 0:t.length,imagePreview:null==t?void 0:t.substring(0,30)}),a.push(r)}else if(e.mode===_.GeneralTopic&&e.front&&e.back){t=null;if(e.image)if(e.image.startsWith("data:")){var o;n="base64,";t=-1!==(o=e.image.indexOf(n))?e.image.substring(o+n.length):e.image}else t=e.image;var i={front:e.front,back:e.back,text:e.text,image_base64:t};console.log("Adding general topic card to Anki export:",{cardId:e.id,text:e.text,hasImage:!!t,imageLength:null==t?void 0:t.length,imagePreview:null==t?void 0:t.substring(0,30)}),s.push(i)}})),a.length>0?[4,t(Ce(_.LanguageLearning,c,u,i,e,a))]:[3,3];case 2:l.sent(),l.label=3;case 3:return s.length>0?[4,t(Ce(_.GeneralTopic,c,u,i,e,s))]:[3,5];case 4:l.sent(),l.label=5;case 5:return h.forEach((function(e){n.updateCardExportStatus(e,"exported_to_anki"),console.log("Updated card ".concat(e," export status to 'exported_to_anki'"))})),setTimeout((function(){try{var e=localStorage.getItem("anki_stored_cards");if(e){var t=JSON.parse(e);console.log("Verified localStorage after export:",t.filter((function(e){return e.id&&h.includes(e.id)})).map((function(e){return{id:e.id,status:e.exportStatus}})))}}catch(e){console.error("Error verifying localStorage after export:",e)}}),500),[3,8];case 6:return l.sent(),we("Failed to save cards to Anki. Make sure Anki is running and AnkiConnect is properly configured."),[3,8];case 7:return b(!1),[7];case 8:return[2]}}))}))},disabled:v||0===h.length||!l||!i||null!==R,style:{padding:"6px 10px",borderRadius:"6px",backgroundColor:"#10B981",color:"#ffffff",fontSize:"13px",border:"none",cursor:"pointer",opacity:!v&&0!==h.length&&l&&i&&null===R?1:.6},title:null!==R?"Finish editing first":!i&&l?"Please select a deck first":""},{children:v?(0,a.jsx)("div",Ws({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving to Anki"})})):"Save to Anki"})),(0,a.jsxs)("button",Ws({onClick:function(){if(0!==h.length){var e=(new Date).toISOString().split("T")[0],t="anki_cards_".concat(e);me(t),fe(!0)}else we("Please select at least one card to export")},disabled:v||0===h.length||null!==R,style:{padding:"6px 10px",borderRadius:"6px",backgroundColor:"#2563EB",color:"#ffffff",fontSize:"13px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",opacity:v||0===h.length||null!==R?.6:1}},{children:[(0,a.jsx)(Dt,{size:12}),(0,a.jsx)("span",{children:"Export"})]}))]}))]})),(0,a.jsx)("div",Ws({style:{flex:1,overflow:"auto",marginBottom:"16px"}},{children:0===Ie.length?(0,a.jsx)("div",Ws({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"200px",color:"#6B7280",textAlign:"center",padding:"20px"}},{children:(0,a.jsx)("p",Ws({style:{fontSize:"14px"}},{children:"all"===I?"No cards yet":"not_exported"===I?"No new cards":"No exported cards"}))})):Ae.map((function(e){return(0,a.jsxs)("div",Ws({style:{border:"1px solid #E5E7EB",borderRadius:"6px",marginBottom:"8px",backgroundColor:h.includes(e.id)?"#F3F4F6":"#ffffff"}},{children:[(0,a.jsxs)("div",Ws({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",borderBottom:R===e?"none":"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",Ws({style:{display:"flex",alignItems:"center"}},{children:[(0,a.jsx)("input",{type:"checkbox",checked:h.includes(e.id),onChange:function(){return t=e.id,void(R||(h.includes(t)?y(h.filter((function(e){return e!==t}))):y(Vs(Vs([],h,!0),[t],!1))));var t},style:{marginRight:"8px"},disabled:null!==R}),(0,a.jsx)("div",Ws({style:{flex:1,minWidth:0}},{children:(0,a.jsxs)("div",Ws({style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"4px"}},{children:[(0,a.jsx)("span",Ws({style:{fontSize:"12px",color:"#6B7280"}},{children:e.mode===_.LanguageLearning?"Language":"Topic"})),(0,a.jsx)("span",Ws({style:{fontSize:"10px",color:"#9CA3AF"}},{children:je(e.createdAt)})),Fe(e.exportStatus)]}))}))]})),(0,a.jsx)("div",Ws({style:{display:"flex",alignItems:"center",gap:"4px"}},{children:R!==e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",Ws({onClick:function(){return Be(e)},style:{backgroundColor:"transparent",border:"1px solid #E5E7EB",borderRadius:"6px",cursor:"pointer",color:"#2563EB",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px 8px",fontSize:"12px",minWidth:"70px",height:"32px",transition:"all 0.2s ease",gap:"4px"},title:"Edit card",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#EFF6FF",e.currentTarget.style.borderColor="#2563EB"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)(Mt,{size:12}),"Edit"]})),(0,a.jsxs)("button",Ws({onClick:function(){return t=e.id,n.deleteStoredCard(t),void y((function(e){return e.filter((function(e){return e!==t}))}));var t},style:{backgroundColor:"transparent",border:"1px solid #E5E7EB",borderRadius:"6px",cursor:"pointer",color:"#EF4444",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px 8px",fontSize:"12px",minWidth:"70px",height:"32px",transition:"all 0.2s ease",gap:"4px"},title:"Delete card",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#FEF2F2",e.currentTarget.style.borderColor="#EF4444"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)(on,{size:12}),"Delete"]}))]})}))]})),Te(e)]}),e.id)}))})),(0,a.jsxs)("div",Ws({style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px",marginBottom:"16px",padding:"12px",backgroundColor:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",Ws({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsx)("div",Ws({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:(0,a.jsxs)("select",Ws({value:ie,onChange:He,style:{padding:"6px 8px",borderRadius:"6px",border:"1px solid #D1D5DB",fontSize:"13px",backgroundColor:"#FFFFFF",color:"#111827",fontWeight:"500",cursor:"pointer",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2212%22%20height%3D%2212%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20fill%3D%22%23424242%22%20d%3D%22M6%2C9L1.2%2C4.2%20c-0.4-0.4-0.4-1%2C0-1.4s1-0.4%2C1.4%2C0L6%2C6.2l3.4-3.4c0.4-0.4%2C1-0.4%2C1.4%2C0s0.4%2C1%2C0%2C1.4L6%2C9z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",paddingRight:"28px",minWidth:"90px"},"aria-label":"Cards per page"},{children:[(0,a.jsx)("option",Ws({value:5},{children:"5 per page"})),(0,a.jsx)("option",Ws({value:10},{children:"10 per page"})),(0,a.jsx)("option",Ws({value:20},{children:"20 per page"})),(0,a.jsx)("option",Ws({value:50},{children:"50 per page"}))]}))})),(0,a.jsx)("div",Ws({style:{display:"flex",alignItems:"center",fontSize:"13px",fontWeight:"500",color:"#4B5563"}},{children:Ie.length>0?"".concat(Math.min((re-1)*ie+1,Ie.length),"-").concat(Math.min(re*ie,Ie.length)," of ").concat(Ie.length," cards"):"0 cards"}))]})),(0,a.jsx)("div",Ws({style:{display:"flex",justifyContent:"center",alignItems:"center"}},{children:(0,a.jsxs)("div",Ws({style:{display:"flex",alignItems:"center",border:"1px solid #D1D5DB",borderRadius:"8px",overflow:"hidden",backgroundColor:"#FFFFFF",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:[(0,a.jsx)("button",Ws({onClick:function(){return Ve(1)},disabled:1===re,style:{padding:"8px 10px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:1===re?"default":"pointer",color:1===re?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){1!==re&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Go to first page",title:"First page"},{children:(0,a.jsx)("svg",Ws({width:"14",height:"14",fill:"currentColor",viewBox:"0 0 20 20"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414zm-6 0a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 1.414L5.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}))})),(0,a.jsx)("button",Ws({onClick:function(){return Ve(re-1)},disabled:1===re,style:{padding:"8px 12px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:1===re?"default":"pointer",color:1===re?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){1!==re&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Previous page",title:"Previous page"},{children:(0,a.jsx)(Rt,{size:14})})),(0,a.jsxs)("div",Ws({style:{padding:"6px 16px",fontSize:"13px",fontWeight:"500",color:"#111827",display:"flex",alignItems:"center",backgroundColor:"transparent",borderRight:"1px solid #E5E7EB",minWidth:"60px",justifyContent:"center"}},{children:[re," / ",ce||1]})),(0,a.jsx)("button",Ws({onClick:function(){return Ve(re+1)},disabled:re===ce||0===ce,style:{padding:"8px 12px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:re===ce||0===ce?"default":"pointer",color:re===ce||0===ce?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){re!==ce&&0!==ce&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Next page",title:"Next page"},{children:(0,a.jsx)(Bt,{size:14})})),(0,a.jsx)("button",Ws({onClick:function(){return Ve(ce)},disabled:re===ce||0===ce,style:{padding:"8px 10px",backgroundColor:"transparent",border:"none",cursor:re===ce||0===ce?"default":"pointer",color:re===ce||0===ce?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){re!==ce&&0!==ce&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Go to last page",title:"Last page"},{children:(0,a.jsx)("svg",Ws({width:"14",height:"14",fill:"currentColor",viewBox:"0 0 20 20"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L8.586 10l-4.293 4.293a1 1 0 000 1.414zm6 0a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L14.586 10l-4.293 4.293a1 1 0 000 1.414z",clipRule:"evenodd"})}))}))]}))}))]}))]}):(0,a.jsx)("div",Ws({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"300px",color:"#6B7280",textAlign:"center"}},{children:(0,a.jsx)("p",{children:"No saved cards yet."})})),pe&&(0,a.jsx)("div",Ws({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"}},{children:(0,a.jsxs)("div",Ws({style:{backgroundColor:"#ffffff",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",Ws({style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"}},{children:[(0,a.jsxs)("h3",Ws({style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(Dt,{size:16,style:{color:"#2563EB"}}),"Export Cards"]})),(0,a.jsx)("button",Ws({onClick:function(){return fe(!1)},disabled:xe,style:{backgroundColor:"transparent",border:"none",cursor:xe?"default":"pointer",padding:"4px",borderRadius:"4px",color:"#6B7280",opacity:xe?.5:1}},{children:(0,a.jsx)(rn,{size:16})}))]})),(0,a.jsxs)("div",Ws({style:{marginBottom:"20px"}},{children:[(0,a.jsxs)("p",Ws({style:{margin:"0 0 16px 0",fontSize:"14px",color:"#6B7280",lineHeight:"1.5"}},{children:["Export ",h.length," selected cards to a file. Choose a filename or use the default."]})),(0,a.jsx)("label",Ws({style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"}},{children:"Filename"})),(0,a.jsxs)("div",Ws({style:{position:"relative"}},{children:[(0,a.jsx)("input",{type:"text",value:he,onChange:function(e){return me(e.target.value)},placeholder:"Enter filename (without extension)",disabled:xe,style:{width:"100%",padding:"10px 12px",paddingRight:"48px",border:"1px solid #D1D5DB",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s ease",backgroundColor:xe?"#F9FAFB":"#ffffff",opacity:xe?.7:1,boxSizing:"border-box"},onFocus:function(e){xe||(e.target.style.borderColor="#2563EB",e.target.style.boxShadow="0 0 0 3px rgba(37, 99, 235, 0.1)")},onBlur:function(e){e.target.style.borderColor="#D1D5DB",e.target.style.boxShadow="none"},onKeyDown:function(e){"Enter"!==e.key||xe||Qe(),"Escape"===e.key&&fe(!1)}}),(0,a.jsx)("span",Ws({style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",fontSize:"13px",color:"#9CA3AF",pointerEvents:"none"}},{children:".txt"}))]})),(0,a.jsx)("p",Ws({style:{margin:"6px 0 0 0",fontSize:"12px",color:"#6B7280"}},{children:"The .txt extension will be added automatically"}))]})),(0,a.jsxs)("div",Ws({style:{display:"flex",gap:"12px",justifyContent:"flex-end"}},{children:[(0,a.jsx)("button",Ws({onClick:function(){return fe(!1)},disabled:xe,style:{padding:"10px 16px",border:"1px solid #D1D5DB",borderRadius:"8px",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:xe?"default":"pointer",transition:"all 0.2s ease",opacity:xe?.5:1},onMouseOver:function(e){xe||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#9CA3AF")},onMouseOut:function(e){xe||(e.currentTarget.style.backgroundColor="#ffffff",e.currentTarget.style.borderColor="#D1D5DB")}},{children:"Cancel"})),(0,a.jsx)("button",Ws({onClick:Qe,disabled:xe||!he.trim(),style:{padding:"10px 16px",border:"none",borderRadius:"8px",backgroundColor:!he.trim()||xe?"#9CA3AF":"#2563EB",color:"#ffffff",fontSize:"14px",fontWeight:"500",cursor:!he.trim()||xe?"default":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",minWidth:"100px",justifyContent:"center"},onMouseOver:function(e){!xe&&he.trim()&&(e.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(e){!xe&&he.trim()&&(e.currentTarget.style.backgroundColor="#2563EB")}},{children:xe?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),(0,a.jsx)("span",{children:"Exporting..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Dt,{size:14}),(0,a.jsx)("span",{children:"Export"})]})}))]}))]}))})),function(){if(console.log("renderEditModal called. showEditModal:",z,"editingCard:",R),!z||!R)return console.log("Modal not showing because showEditModal:",z,"editingCard:",!!R),null;if(!H)return console.log("No local editing card data available"),null;var e=H.text,t=H.translation,n=H.examples,r=H.front,o=H.back,i=H.image,s=H.imageUrl,l=H.linguisticInfo,c=H.transcription;return console.log("Rendering edit modal with local data:",{text:(null==e?void 0:e.substring(0,20))+"...",translation:(null==t?void 0:t.substring(0,20))+"...",examplesCount:null==n?void 0:n.length,hasImage:!!i,hasImageUrl:!!s}),(0,a.jsx)("div",Ws({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:Oe},{children:(0,a.jsxs)("div",Ws({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"340px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",Ws({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsx)("h3",Ws({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:"Edit Card"})),(0,a.jsx)("button",Ws({onClick:Oe,style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(rn,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",Ws({style:{width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",Ws({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:U,onChange:function(e){return q(e.target.value)},onKeyDown:Me,placeholder:"Enter custom instructions for this card (e.g., 'regenerate examples', 'change image style')",style:{width:"100%",padding:"10px 12px",paddingRight:"44px",borderRadius:"8px",border:"1px solid #E5E7EB",fontSize:"14px",color:"#374151",backgroundColor:$?"#F9FAFB":"#FFFFFF",transition:"all 0.2s ease",boxShadow:$?"inset 0 1px 2px rgba(0, 0, 0, 0.05)":"none"},disabled:$}),$?(0,a.jsx)("div",Ws({style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",color:"#4F46E5"}},{children:(0,a.jsx)(sn,{type:"spinner",size:"small",inline:!0,color:"#4F46E5"})})):(0,a.jsx)("button",Ws({onClick:De,disabled:!U.trim()||$,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:U.trim()?"linear-gradient(to right, #4F46E5, #6366F1)":"none",border:"none",color:U.trim()?"#FFFFFF":"#9CA3AF",cursor:U.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",width:"28px",height:"28px",boxShadow:U.trim()?"0 1px 3px rgba(0, 0, 0, 0.1)":"none",transition:"all 0.2s ease"},title:"Apply instructions"},{children:(0,a.jsx)(Jt,{size:14})}))]})),(0,a.jsxs)("div",Ws({style:{fontSize:"12px",color:$?"#4F46E5":"#6B7280",marginTop:"6px",display:"flex",alignItems:"center",gap:"6px",fontWeight:$?"500":"normal"}},{children:[$&&(0,a.jsx)("span",{style:{display:"inline-block",width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#4F46E5",animation:"pulse 1.5s infinite"}}),$?"Applying your instructions...":"Type instructions and press Enter or click the magic wand"]}))]})),(0,a.jsx)(hn,{mode:R.mode,front:r||null,back:o||null,translation:t||null,examples:n||[],imageUrl:s||null,image:i||null,linguisticInfo:l||void 0,transcription:c||null,onNewImage:Le,onNewExamples:Ne,onAccept:ze,onViewSavedCards:function(){},onCancel:Oe,loadingNewImage:!1,loadingNewExamples:J,loadingAccept:Z,shouldGenerateImage:!0,isSaved:!0,isEdited:!0,createdAt:R.createdAt?new Date(R.createdAt):new Date,setTranslation:qe,setBack:$e,setExamples:We,setLinguisticInfo:Ge})]}))}))}(),(0,a.jsx)("div",Ws({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,pointerEvents:"none"}},{children:(0,a.jsx)("div",Ws({style:{pointerEvents:"auto"}},{children:Se()}))}))]}))};var Ks="SET_ANKI_AVAILABILITY",Qs=function(e){return{type:Ks,payload:e}},Js="TOGGLE_SIDEBAR",Xs="SET_SIDEBAR_VISIBILITY",Ys="SET_GLOBAL_SIDEBAR_STATE",Zs="INHERIT_SIDEBAR_STATE",el="SHOW_NOTIFICATION",tl="HIDE_NOTIFICATION",nl=function(e){return{type:tl,payload:{id:e}}},rl=function(){return rl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},rl.apply(this,arguments)};const ol=function(){var e=m((function(e){return e.notifications.notifications})),t=E();(0,r.useEffect)((function(){e.forEach((function(e){var n=e.id,r=e.type,o=0;"success"===r||"info"===r?o=5e3:"warning"===r&&(o=6e3),o>0&&setTimeout((function(){t(nl(n))}),o)}))}),[e,t]);return 0===e.length?null:(0,a.jsx)("div",rl({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,maxWidth:"300px",width:"auto",display:"flex",flexDirection:"column",gap:"8px"}},{children:e.map((function(e){var n=function(e){switch(e){case"success":return{icon:(0,a.jsx)(Ft,{size:16}),color:"#059669",bgColor:"#ECFDF5",borderColor:"#10B981"};case"warning":return{icon:(0,a.jsx)(qt,{size:16}),color:"#D97706",bgColor:"#FFFBEB",borderColor:"#F59E0B"};case"info":return{icon:(0,a.jsx)(Vt,{size:16}),color:"#2563EB",bgColor:"#EFF6FF",borderColor:"#3B82F6"};default:return{icon:(0,a.jsx)(nn,{size:16}),color:"#DC2626",bgColor:"#FEF2F2",borderColor:"#EF4444"}}}(e.type),r=n.icon,o=n.color,i=n.bgColor,s=n.borderColor;return(0,a.jsxs)("div",rl({style:{transform:"translateX(0)",opacity:1,transition:"all 0.3s ease-out",backgroundColor:i,border:"1px solid ".concat(s),borderRadius:"12px",padding:"16px",minWidth:"280px",maxWidth:"320px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative",display:"flex",alignItems:"flex-start",gap:"12px"},role:"alert","aria-live":"polite"},{children:[(0,a.jsx)("div",rl({style:{color:o,marginTop:"2px",flexShrink:0}},{children:r})),(0,a.jsx)("div",rl({style:{flex:1,paddingRight:"8px"}},{children:(0,a.jsx)("p",rl({style:{color:"#374151",margin:0,fontSize:"14px",lineHeight:"1.5",fontWeight:500}},{children:e.message}))})),(0,a.jsx)("button",rl({onClick:function(){return n=e.id,void t(nl(n));var n},style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",color:"#9CA3AF",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="rgba(0, 0, 0, 0.1)",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9CA3AF"},"aria-label":"Close notification"},{children:(0,a.jsx)(rn,{size:12})}))]}),e.id)}))}))};var al=function(){return al=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},al.apply(this,arguments)},il=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},sl=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ll=function(e){var t=e.tabId,n=Ue(),o=n.currentPage,i=n.setCurrentPage,s=(m((function(e){return e.anki.isAnkiAvailable})),(0,r.useState)(!0)),l=s[0],c=s[1],u=E(),d=m((function(e){return e.settings.ankiConnectApiKey})),p=n.storedCards,f=n.isGeneratingCard;(0,r.useEffect)((function(){l&&il(void 0,void 0,void 0,(function(){var e,n,r;return sl(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),u(Ee()),console.log("Initial card load from App component for tab:",t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,ne(d)];case 2:return(e=o.sent()).error?(console.error("Anki returned an error:",e.error),u(Qs(!1))):(u(function(e){return{type:Ms,payload:e}}(e.result)),u(Qs(!0)),console.log("Anki is available")),[3,4];case 3:return n=o.sent(),console.error("Anki is unavailable:",n),u(Qs(!1)),[3,4];case 4:return[3,7];case 5:return r=o.sent(),console.error("Error initializing app:",r),[3,7];case 6:return c(!1),[7];case 7:return[2]}}))}))}),[u,d,l,t]),(0,r.useEffect)((function(){console.log("App: Stored cards count for tab ".concat(t,":"),p.length)}),[p,t]);var g,h=(0,r.useCallback)((function(e){i(e)}),[i]),y=(0,r.useCallback)((function(){u(function(e,t){return void 0===t&&(t=!0),{type:Js,payload:{tabId:e,persist:t}}}(t)),chrome.runtime.sendMessage({action:"toggleSidebar",tabId:t},(function(e){chrome.runtime.lastError?console.error("Error sending message:",chrome.runtime.lastError.message):console.log("Extension closed:",e)}))}),[u,t]);return(0,a.jsx)("div",al({className:"App",style:{backgroundColor:"#ffffff",height:"100vh",display:"flex",flexDirection:"column",position:"absolute",right:0,top:0,width:"350px",fontFamily:"Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.05), 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},{children:(0,a.jsxs)("div",al({style:{flex:1,width:"100%",height:"100%",position:"relative",display:"flex",flexDirection:"column"}},{children:[(g=p.filter((function(e){return"not_exported"===e.exportStatus})).length,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",al({onClick:y,className:"close-button",style:{position:"absolute",top:"6px",right:"12px",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"6px",color:"#6B7280",borderRadius:"5px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",zIndex:200},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#EF4444"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#6B7280"},title:"Close extension"},{children:(0,a.jsx)(rn,{size:14})})),"createCard"!==o&&(0,a.jsx)("div",al({style:{position:"absolute",top:"6px",left:"12px",right:"50px",zIndex:100}},{children:(0,a.jsxs)("button",al({onClick:function(){return h("createCard")},className:"new-card-button",style:{backgroundColor:"#2563EB",border:"none",cursor:"pointer",padding:"6px 14px",color:"#FFFFFF",borderRadius:"7px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"32px",boxShadow:"0 1px 3px rgba(37, 99, 235, 0.2)",fontSize:"13px",fontWeight:600},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#1D4ED8",e.currentTarget.style.transform="translateY(-0.5px)",e.currentTarget.style.boxShadow="0 2px 6px rgba(37, 99, 235, 0.25)"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#2563EB",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(37, 99, 235, 0.2)"},title:"Create a new card"},{children:[(0,a.jsx)(Yt,{style:{marginRight:"5px"},size:13}),"New Card"]}))})),(0,a.jsxs)("div",al({style:{position:"absolute",bottom:"8px",left:"12px",right:"12px",display:"flex",gap:"6px",zIndex:100}},{children:[(0,a.jsxs)("button",al({onClick:function(){return h("storedCards")},disabled:f,className:"nav-button",style:{backgroundColor:"storedCards"===o?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat("storedCards"===o?"#BFDBFE":"#E5E7EB"),cursor:f?"not-allowed":"pointer",padding:"10px 14px",color:f?"#9CA3AF":"storedCards"===o?"#2563EB":"#6B7280",borderRadius:"10px",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,gap:"3px",fontSize:"11px",fontWeight:"storedCards"===o?600:500,boxShadow:"storedCards"===o?"0 2px 4px rgba(37, 99, 235, 0.1)":"0 1px 2px rgba(0, 0, 0, 0.05)",position:"relative",opacity:f?.6:1},onMouseOver:function(e){"storedCards"===o||f||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.borderColor="#D1D5DB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){"storedCards"===o||f||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.color="#6B7280")},title:f?"Please wait while card is being generated":"View your saved cards"},{children:[(0,a.jsxs)("div",al({style:{position:"relative",display:"flex",alignItems:"center"}},{children:[(0,a.jsx)(Qt,{size:16}),g>0&&(0,a.jsx)("span",al({style:{position:"absolute",top:"-6px",right:"-8px",backgroundColor:"#EF4444",color:"white",borderRadius:"10px",fontSize:"10px",fontWeight:"bold",padding:"2px 6px",minWidth:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"}},{children:g>99?"99+":g}))]})),(0,a.jsx)("span",{children:"Cards"})]})),(0,a.jsxs)("button",al({onClick:function(){return h("settings")},disabled:f,className:"nav-button",style:{backgroundColor:"settings"===o?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat("settings"===o?"#BFDBFE":"#E5E7EB"),cursor:f?"not-allowed":"pointer",padding:"10px 14px",color:f?"#9CA3AF":"settings"===o?"#2563EB":"#6B7280",borderRadius:"10px",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,gap:"3px",fontSize:"11px",fontWeight:"settings"===o?600:500,boxShadow:"settings"===o?"0 2px 4px rgba(37, 99, 235, 0.1)":"0 1px 2px rgba(0, 0, 0, 0.05)",opacity:f?.6:1},onMouseOver:function(e){"settings"===o||f||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.borderColor="#D1D5DB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){"settings"===o||f||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.color="#6B7280")},title:f?"Please wait while card is being generated":"App settings and API configuration"},{children:[(0,a.jsx)(Nt,{size:16}),(0,a.jsx)("span",{children:"Settings"})]}))]}))]})),(0,a.jsxs)("header",al({className:"App-header",style:{width:"100%",flex:1,display:"flex",flexDirection:"column",backgroundColor:"#ffffff",marginTop:"0px",height:"100%",overflow:"auto"}},{children:[function(){var e="createCard"!==o?"46px":"12px",t="58px",n={width:"100%",height:"100%",paddingTop:e,paddingBottom:t,overflow:"auto",opacity:1,transform:"translateX(0)",transition:"all 0.3s ease-in-out"};switch(o){case"settings":return(0,a.jsx)("div",al({style:n},{children:(0,a.jsx)(Ds,{onBackClick:function(){return h("createCard")},popup:!1})}));case"storedCards":return(0,a.jsx)("div",al({style:n},{children:(0,a.jsx)(Hs,{onBackClick:function(){return h("createCard")}})}));default:return(0,a.jsx)("div",al({style:{width:"100%",flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%",position:"relative",paddingTop:e,paddingBottom:t,opacity:1,transform:"translateX(0)",transition:"all 0.3s ease-in-out"}},{children:(0,a.jsx)(Rs,{})}))}}(),(0,a.jsx)("div",al({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,maxWidth:"300px",width:"auto",pointerEvents:"none"}},{children:(0,a.jsxs)("div",al({style:{pointerEvents:"auto"}},{children:[" ",(0,a.jsx)(ol,{})]}))}))]}))]}))}))};const cl=function(e){var t=e.tabId,n=E();return(0,r.useEffect)((function(){n(function(e){return{type:j,payload:e}}(t)),console.log("App initialized for tab:",t)}),[n,t]),(0,a.jsx)(Me,al({tabId:t},{children:(0,a.jsx)(ll,{tabId:t})}))};
/**
 * @license
 * ReduxedChromeStorage v3.0.10
 * https://github.com/hindmost/reduxed-chrome-storage
 * Copyright (c) Savr Goryaev aka hindmost
 *
 * This source code is licensed under the MIT license
 * https://github.com/hindmost/reduxed-chrome-storage/blob/master/LICENSE
 *
 * Dependencies:
 *
 * uuid v8.3.2
 */
var ul,dl=new Uint8Array(16);function pl(){if(!ul&&!(ul="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ul(dl)}var fl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var gl=[],hl=0;hl<256;++hl)gl.push((hl+256).toString(16).substr(1));function ml(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(gl[e[t+0]]+gl[e[t+1]]+gl[e[t+2]]+gl[e[t+3]]+"-"+gl[e[t+4]]+gl[e[t+5]]+"-"+gl[e[t+6]]+gl[e[t+7]]+"-"+gl[e[t+8]]+gl[e[t+9]]+"-"+gl[e[t+10]]+gl[e[t+11]]+gl[e[t+12]]+gl[e[t+13]]+gl[e[t+14]]+gl[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&fl.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}function yl(e,t,n){var r=(e=e||{}).random||(e.rng||pl)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return ml(r)}function xl(e){return null==e||"object"!=typeof e?e:JSON.parse(JSON.stringify(e))}function vl(e,t){if(e===t)return!0;if(null==e||"object"!=typeof e||null==t||"object"!=typeof t||Array.isArray(e)!==Array.isArray(t))return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n)if(r.indexOf(o)<=-1||!vl(e[o],t[o]))return!1;return!0}function bl(e,t){if(e===t)return;if(null==e||"object"!=typeof e||null==t||"object"!=typeof t)return e;if(Array.isArray(e)||Array.isArray(t))return vl(e,t)?void 0:e;const n=Object.keys(e),r=Object.keys(t);let o=!0;const a=n.reduce(((n,a)=>{const i=r.indexOf(a)>-1?bl(e[a],t[a]):e[a];return void 0===i||(o=!1,n[a]=i),n}),{});return r.forEach((e=>{n.indexOf(e)>-1||(o=!1,a[e]=void 0)})),o?void 0:a}function wl(e,t,n){if(Array.isArray(t))return xl(t);if(null==e||"object"!=typeof e||Array.isArray(e)||null==t||"object"!=typeof t)return xl(void 0!==t?t:e);const r=Object.keys(e).concat(Object.keys(t).filter((t=>!(t in e)))).reduce(((r,o)=>(r[o]=wl(e[o],t[o],n),r)),{});if(!n)return r;const o=Object.keys(t);return Object.keys(e).forEach((e=>{o.indexOf(e)>-1||delete r[e]})),r}const Sl=e=>{if(void 0===e||!Array.isArray(e)||3!==e.length)return[e,"",0];const[t,n,r]=e;return"string"==typeof t&&"number"==typeof n?[r,t,n]:[e,"",0]};class Cl{constructor(e,t,n,r,o,a,i){this.container=e,this.storage=t,this.isolated=n,this.plain=r,this.timeout=o?Math.max(o,500):1e3,this.resetState=i,this.store=this._instantiateStore(),this.state=null,this.id=yl(),this.tmstamp=0,this.outdted=[],"function"==typeof a&&(this.lisner=a),this.lisners=[],this.getState=this.getState.bind(this),this.subscribe=this.subscribe.bind(this),this.dispatch=this.dispatch.bind(this),this.replaceReducer=this.replaceReducer.bind(this),this[Symbol.observable]=this[Symbol.observable].bind(this)}init(){this.tmstamp||this.isolated||this.storage.subscribe(((e,t)=>{const[n,r,o]=Sl(e);if(r===this.id||vl(n,this.state))return;const a=o>=this.tmstamp,i=a?wl(this.state,n,!0):wl(n,this.state,!0);!a&&vl(i,this.state)||(this._setState(i,o),this._renewStore(),vl(i,n)||this._send2Storage(),this._callListeners())}));const e=this.store.getState();return new Promise((t=>{this.storage.load((n=>{const[r,,o]=Sl(n);let a=r?wl(e,r):e;this.resetState&&(a=wl(a,this.resetState)),this._setState(a,o),this._renewStore(),vl(a,r)||this._send2Storage(),t(this)}))}))}initFrom(e){return this._setState(e,0),this._renewStore(),this}_setState(e,t){this.state=xl(e),(t=void 0!==t?t:Date.now())>this.tmstamp&&(this.tmstamp=t)}_renewStore(){this.plain?this.unsub&&this.unsub():this._clean();const e=this.store=this._instantiateStore(this.state),t=Date.now(),n=this.outdted.length;this.outdted=this.outdted.map((([e,r],o)=>e||o>=n-1?[e,r]:[t,r]));let r=xl(this.state);const o=this.store.subscribe((()=>{const t=e&&e.getState(),n=this.store===e;if(this._clean(),!vl(t,this.state)){if(n)this._setState(t);else{const e=bl(t,r);if(void 0===e)return;this._setState(wl(this.state,e)),this._renewStore()}this._send2Storage(),this._callListeners(!0,r),r=xl(t)}}));this.plain?this.unsub=o:this.outdted.push([0,o])}_clean(){if(this.plain)return;const e=Date.now(),t=this.outdted.length;this.outdted.forEach((([n,r],o)=>{o>=t-1||e-n<this.timeout||(r(),delete this.outdted[o])}))}_instantiateStore(e){const t=this.container(e);if("object"!=typeof t||"function"!=typeof t.getState)throw new Error("Invalid 'storeCreatorContainer' supplied");return t}_send2Storage(){var e,t,n;this.storage.save((e=this.state,t=this.id,n=this.tmstamp,[t,n,e]))}_callListeners(e,t){e&&this.lisner&&this.lisner(this,t);for(const e of this.lisners)e()}getState(){return this.state}subscribe(e){return"function"==typeof e&&this.lisners.push(e),()=>{"function"==typeof e&&(this.lisners=this.lisners.filter((t=>t!==e)))}}dispatch(e){return this.store.dispatch(e)}replaceReducer(e){return"function"==typeof e&&this.store.replaceReducer(e),this}[Symbol.observable](){const e=this.getState,t=this.subscribe;return{subscribe(n){if("object"!=typeof n||null===n)throw new TypeError("Expected the observer to be an object.");function r(){const t=n;t.next&&t.next(e())}r();return{unsubscribe:t(r)}},[Symbol.observable](){return this}}}}var kl;!function(e){e.local="local",e.sync="sync"}(kl||(kl={}));const El=e=>(new TextEncoder).encode(Object.entries(e).map((([e,t])=>e+JSON.stringify(t))).join("")).length;class Il{constructor({namespace:e,area:t,key:n}){this.ns=e,this.areaName=t===kl.sync?kl.sync:kl.local,this.key=n||"reduxed",this.listeners=[],this.errListeners=[]}regShared(){this.regListener(((e,t)=>{for(const n of this.listeners)n(e,t)}))}regListener(e){this.ns.storage.onChanged.addListener(((t,n)=>{if(n!==this.areaName||!(this.key in t))return;const{newValue:r,oldValue:o}=t[this.key];r&&e(r,o)}))}subscribe(e){"function"==typeof e&&this.listeners.push(e)}subscribeForError(e){"function"==typeof e&&this.errListeners.push(e)}fireErrorListeners(e,t){for(const n of this.errListeners)n(e,t)}callbackOnLoad(e,t,n){t(!this.ns.runtime.lastError&&(n?e:e&&e[this.key]))}callbackOnSave(e,t){if(!this.ns.runtime.lastError)return;const{message:n}=this.ns.runtime.lastError;if(!n||!e||!t)return void this.fireErrorListeners(n||"",!1);this.areaName===kl.sync&&t.QUOTA_BYTES_PER_ITEM&&El({[this.key]:e})>t.QUOTA_BYTES_PER_ITEM?this.fireErrorListeners(n,!0):this.load((r=>{const o="object"==typeof r&&t.QUOTA_BYTES>0&&El(Object.assign(Object.assign({},r),{[this.key]:e}))>t.QUOTA_BYTES;this.fireErrorListeners(n,o)}),!0)}}class Al extends Il{constructor({namespace:e,area:t,key:n}){super({namespace:e,area:t,key:n}),this.areaApi=this.ns.storage[this.areaName]}load(e,t){"function"==typeof e&&this.areaApi.get(t?null:this.key,(n=>{this.callbackOnLoad(n,e,t)}))}save(e){this.areaApi.set({[this.key]:e},(()=>{this.callbackOnSave(e,this.areaApi)}))}}class _l extends Il{constructor({namespace:e,area:t,key:n}){super({namespace:e,area:t,key:n}),this.areaApi=this.ns.storage[this.areaName]}load(e,t){"function"==typeof e&&this.areaApi.get(t?null:this.key).then((t=>{this.callbackOnLoad(t,e)}))}save(e){this.areaApi.set({[this.key]:e}).then((()=>{this.callbackOnSave(e,this.areaApi)}))}}var jl;function Fl(e){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fl(e)}function Tl(e){var t=function(e,t){if("object"!==Fl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Fl(t)?t:String(t)}function Pl(e,t,n){return(t=Tl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(n),!0).forEach((function(t){Pl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ol(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}!function(e){e.chrome="chrome",e.browser="browser"}(jl||(jl={}));var zl="function"==typeof Symbol&&Symbol.observable||"@@observable",Ll=function(){return Math.random().toString(36).substring(7).split("").join(".")},Nl={INIT:"@@redux/INIT"+Ll(),REPLACE:"@@redux/REPLACE"+Ll(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ll()}};function Dl(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Ml(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(Ol(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(Ol(1));return n(Ml)(e,t)}if("function"!=typeof e)throw new Error(Ol(2));var o=e,a=t,i=[],s=i,l=!1;function c(){s===i&&(s=i.slice())}function u(){if(l)throw new Error(Ol(3));return a}function d(e){if("function"!=typeof e)throw new Error(Ol(4));if(l)throw new Error(Ol(5));var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error(Ol(6));t=!1,c();var n=s.indexOf(e);s.splice(n,1),i=null}}}function p(e){if(!Dl(e))throw new Error(Ol(7));if(void 0===e.type)throw new Error(Ol(8));if(l)throw new Error(Ol(9));try{l=!0,a=o(a,e)}finally{l=!1}for(var t=i=s,n=0;n<t.length;n++){(0,t[n])()}return e}return p({type:Nl.INIT}),(r={dispatch:p,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ol(10));o=e,p({type:Nl.REPLACE})}})[zl]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(Ol(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[zl]=function(){return this},e},r}function Ul(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ql(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(Ol(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return r=Ul.apply(void 0,a)(n.dispatch),Bl(Bl({},n),{},{dispatch:r})}}}function Wl(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}var $l=Wl();$l.withExtraArgument=Wl;const Gl=$l;var Vl=function(){return Vl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Vl.apply(this,arguments)},Hl={decks:[],deckId:""};var Kl=function(){return Kl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Kl.apply(this,arguments)},Ql=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Jl=Kl({savedCards:[],storedCards:[],text:"",translation:"",examples:[],image:null,imageUrl:null,error:void 0,back:null,front:"",currentCardId:null,linguisticInfo:"",transcription:"",isGeneratingCard:!1});const Xl=function(e,t){var n,r,o,a,i,s,l,c,u,d;void 0===e&&(e=Jl);var p=Kl({},e);switch(t.type){case ae:p.savedCards=Ql(Ql([],e.savedCards,!0),t.payload,!0);break;case fe:console.log("*** REDUCER: SAVE_CARD_TO_STORAGE action received ***"),console.log("Action payload raw:",t.payload),console.log("Action payload image data:",{hasImage:!!t.payload.image,hasImageUrl:!!t.payload.imageUrl,imageType:typeof t.payload.image,imageUrlType:typeof t.payload.imageUrl,imageValue:t.payload.image,imageUrlValue:t.payload.imageUrl,imageUndefinedCheck:void 0!==t.payload.image,imageUrlUndefinedCheck:void 0!==t.payload.imageUrl});var f=Kl(Kl({},t.payload.id?t.payload:Kl(Kl({},t.payload),{id:Date.now().toString()})),{image:void 0!==t.payload.image?t.payload.image:null,imageUrl:void 0!==t.payload.imageUrl?t.payload.imageUrl:null,exportStatus:t.payload.exportStatus||"not_exported",linguisticInfo:t.payload.linguisticInfo||"",transcription:t.payload.transcription||""});console.log("REDUCER: Final card object created:",{cardId:f.id,hasImage:!!f.image,hasImageUrl:!!f.imageUrl,imageType:typeof f.image,imageUrlType:typeof f.imageUrl,imageLength:null===(n=f.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=f.imageUrl)||void 0===r?void 0:r.length,imageActualValue:f.image,imageUrlActualValue:f.imageUrl,imagePreview:null===(o=f.image)||void 0===o?void 0:o.substring(0,50),imageUrlPreview:null===(a=f.imageUrl)||void 0===a?void 0:a.substring(0,50)});var g=e.storedCards.find((function(e){return e.text===f.text}));g?(p.storedCards=e.storedCards.map((function(e){return e.id===g.id?Kl(Kl({},f),{id:g.id}):e})),console.log("Updated existing card with text:",f.text)):(p.storedCards=Ql(Ql([],e.storedCards,!0),[f],!1),console.log("Added new card:",f.text));break;case ye:p.storedCards=e.storedCards.map((function(e){return e.id===t.payload.cardId?Kl(Kl({},e),{exportStatus:t.payload.status}):e}));break;case xe:if(console.log("*** REDUCER: UPDATE_STORED_CARD action received ***"),console.log("Update payload image info:",{cardId:t.payload.id,hasImage:!!t.payload.image,hasImageUrl:!!t.payload.imageUrl,imageType:typeof t.payload.image,imageUrlType:typeof t.payload.imageUrl,imageValue:t.payload.image,imageUrlValue:t.payload.imageUrl,imageLength:null===(i=t.payload.image)||void 0===i?void 0:i.length,imageUrlLength:null===(s=t.payload.imageUrl)||void 0===s?void 0:s.length}),!t.payload.id)return console.error("Cannot update card without ID"),e;if(e.storedCards.some((function(e){return e.id===t.payload.id})))p.storedCards=e.storedCards.map((function(e){return e.id===t.payload.id?Kl(Kl({},t.payload),{exportStatus:t.payload.exportStatus||e.exportStatus,linguisticInfo:t.payload.linguisticInfo||e.linguisticInfo,transcription:t.payload.transcription||e.transcription}):e})),console.log("UPDATE_STORED_CARD: Updated existing card with ID:",t.payload.id,"image:",!!t.payload.image);else{var h=Kl(Kl({},t.payload),{exportStatus:t.payload.exportStatus||"not_exported",linguisticInfo:t.payload.linguisticInfo||"",transcription:t.payload.transcription||""});p.storedCards=Ql(Ql([],e.storedCards,!0),[h],!1),console.log("UPDATE_STORED_CARD: Added new card with ID:",t.payload.id,"image:",!!h.image)}break;case ge:break;case me:p.storedCards=t.payload;break;case he:p.storedCards=e.storedCards.filter((function(e){return e.id!==t.payload}));break;case ie:p.text=t.payload,""!==t.payload&&""!==t.payload.trim()||(console.log("Text cleared completely, also clearing images"),p.image=null,p.imageUrl=null);break;case se:p.translation=t.payload;break;case le:p.examples=t.payload;break;case ce:console.log("*** REDUCER: SET_IMAGE called with:",{hasPayload:!!t.payload,payloadType:typeof t.payload,payloadLength:null===(l=t.payload)||void 0===l?void 0:l.length,payloadPreview:null===(c=t.payload)||void 0===c?void 0:c.substring(0,50)}),p.image=t.payload;break;case ue:return console.log("*** REDUCER: SET_IMAGE_URL called with:",{hasPayload:!!t.payload,payloadType:typeof t.payload,payloadLength:null===(u=t.payload)||void 0===u?void 0:u.length,payloadPreview:null===(d=t.payload)||void 0===d?void 0:d.substring(0,50)}),Kl(Kl({},e),{imageUrl:t.payload});case de:return Kl(Kl({},e),{back:t.payload});case pe:return Kl(Kl({},e),{front:t.payload});case ve:return Kl(Kl({},e),{currentCardId:t.payload});case be:return Kl(Kl({},e),{linguisticInfo:t.payload});case we:return Kl(Kl({},e),{transcription:t.payload});case Se:return Kl(Kl({},e),{isGeneratingCard:t.payload});default:return e}return p};const Yl=function(e,t){return void 0===e&&(e="createCard"),"SET_CURRENT_PAGE"===t.type?t.currentPage:e};var Zl=function(){return Zl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Zl.apply(this,arguments)},ec={isAnkiAvailable:!1};const tc=function(e,t){return void 0===e&&(e=ec),t.type===Ks?Zl(Zl({},e),{isAnkiAvailable:t.payload}):e};var nc=function(){return nc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},nc.apply(this,arguments)},rc={globalState:{isVisible:!1,lastToggleTime:Date.now()},tabStates:{},inheritanceSettings:{enabled:!0,mode:"lastActive"}},oc=function(e,t){return e.tabStates[t]||{isVisible:e.globalState.isVisible,lastToggleTime:Date.now()}};const ac=function(e,t){var n,r,o;switch(void 0===e&&(e=rc),t.type){case Js:var a=t.payload||{},i=a.tabId,s=a.persist,l=void 0===s||s,c=Date.now();if(i){var u=!(h=oc(e,i)).isVisible,d=nc(nc({},e),{tabStates:nc(nc({},e.tabStates),(n={},n[i]=nc(nc({},h),{isVisible:u,lastToggleTime:c}),n))});return l&&(d.globalState=nc(nc({},e.globalState),{isVisible:u,lastActiveTabId:i,lastToggleTime:c})),d}return nc(nc({},e),{globalState:nc(nc({},e.globalState),{isVisible:!e.globalState.isVisible,lastToggleTime:c})});case Xs:var p=t.payload,f=p.isVisible,g=(i=p.tabId,p.persist);l=void 0===g||g,c=Date.now();if(i){var h=oc(e,i);d=nc(nc({},e),{tabStates:nc(nc({},e.tabStates),(r={},r[i]=nc(nc({},h),{isVisible:f,lastToggleTime:c}),r))});return l&&(d.globalState=nc(nc({},e.globalState),{isVisible:f,lastActiveTabId:i,lastToggleTime:c})),d}return nc(nc({},e),{globalState:nc(nc({},e.globalState),{isVisible:f,lastToggleTime:c})});case Ys:var m=t.payload,y=(f=m.isVisible,m.lastActiveTabId);return nc(nc({},e),{globalState:nc(nc({},e.globalState),{isVisible:f,lastActiveTabId:y||e.globalState.lastActiveTabId,lastToggleTime:Date.now()})});case Zs:var x=t.payload,v=x.fromTabId,b=x.toTabId,w=void 0,S=void 0;return v&&e.tabStates[v]?(w=e.tabStates[v].isVisible,S=v):(w=function(e){return e.globalState.lastActiveTabId&&e.tabStates[e.globalState.lastActiveTabId]?e.tabStates[e.globalState.lastActiveTabId].isVisible:e.globalState.isVisible}(e),S=e.globalState.lastActiveTabId),nc(nc({},e),{tabStates:nc(nc({},e.tabStates),(o={},o[b]={isVisible:w,inheritedFrom:S,lastToggleTime:Date.now()},o))});default:return e}};var ic=function(){return ic=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ic.apply(this,arguments)},sc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},lc={notifications:[]};var cc=function(){return cc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},cc.apply(this,arguments)},uc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},dc={currentTabId:null,tabStates:{}};const pc=function(e,t){var n,r,o,a,i,s,l,c,u,d;void 0===e&&(e=dc);var p=cc({},e);switch(t.type){case j:var f=t.payload;p.currentTabId=f,f&&!p.tabStates[f]&&(p.tabStates=cc(cc({},p.tabStates),((n={})[f]=function(e){return{cardData:{text:"",translation:"",examples:[],image:null,imageUrl:null,front:"",back:null,linguisticInfo:"",transcription:"",isGeneratingCard:!1,currentCardId:null},storedCards:[],fieldIdPrefix:"tab_".concat(e,"_").concat(Date.now(),"_"),currentPage:"createCard"}}(f),n)));break;case F:var g=t.payload,h=g.tabId,m=g.field,y=g.value;h&&p.tabStates[h]&&(p.tabStates=cc(cc({},p.tabStates),((r={})[h]=cc(cc({},p.tabStates[h]),{cardData:cc(cc({},p.tabStates[h].cardData),(o={},o[m]=y,o))}),r)));break;case T:var x=t.payload.tabId;x&&p.tabStates[x]&&(p.tabStates=cc(cc({},p.tabStates),((a={})[x]=cc(cc({},p.tabStates[x]),{cardData:{text:"",translation:"",examples:[],image:null,imageUrl:null,front:"",back:null,linguisticInfo:"",transcription:"",isGeneratingCard:!1,currentCardId:null}}),a)));break;case P:var v=t.payload,b=v.tabId,w=v.card;if(b&&p.tabStates[b]){var S=p.tabStates[b],C=cc(cc({},w),{id:w.id||"".concat(S.fieldIdPrefix).concat(Date.now()),createdAt:w.createdAt||new Date}),k=S.storedCards.findIndex((function(e){return e.text===C.text})),E=void 0;k>=0?(E=uc([],S.storedCards,!0))[k]=cc(cc({},C),{id:S.storedCards[k].id}):E=uc(uc([],S.storedCards,!0),[C],!1),p.tabStates=cc(cc({},p.tabStates),((i={})[b]=cc(cc({},S),{storedCards:E}),i))}break;case R:var I=t.payload,A=I.tabId,_=I.cardId;if(A&&p.tabStates[A]){S=p.tabStates[A];p.tabStates=cc(cc({},p.tabStates),((s={})[A]=cc(cc({},S),{storedCards:S.storedCards.filter((function(e){return e.id!==_}))}),s))}break;case B:var N=t.payload,D=N.tabId,M=N.cards;D&&p.tabStates[D]&&(p.tabStates=cc(cc({},p.tabStates),((l={})[D]=cc(cc({},p.tabStates[D]),{storedCards:M}),l)));break;case O:var U=t.payload,q=U.tabId,W=U.cardId,$=U.status;if(q&&p.tabStates[q]){S=p.tabStates[q];p.tabStates=cc(cc({},p.tabStates),((c={})[q]=cc(cc({},S),{storedCards:S.storedCards.map((function(e){return e.id===W?cc(cc({},e),{exportStatus:$}):e}))}),c))}break;case z:var G=t.payload,V=G.tabId,H=G.card;if(V&&p.tabStates[V]&&H.id){var K=(S=p.tabStates[V]).storedCards.some((function(e){return e.id===H.id}));E=void 0;E=K?S.storedCards.map((function(e){return e.id===H.id?cc({},H):e})):uc(uc([],S.storedCards,!0),[H],!1),p.tabStates=cc(cc({},p.tabStates),((u={})[V]=cc(cc({},S),{storedCards:E}),u))}break;case L:var Q=t.payload,J=Q.tabId,X=Q.currentPage;J&&p.tabStates[J]&&(p.tabStates=cc(cc({},p.tabStates),((d={})[J]=cc(cc({},p.tabStates[J]),{currentPage:X}),d)))}return p};var fc,gc=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"==typeof e[o]&&(n[o]=e[o])}var a,i=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Nl.INIT}))throw new Error(Ol(12));if(void 0===n(void 0,{type:Nl.PROBE_UNKNOWN_ACTION()}))throw new Error(Ol(13))}))}(n)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,o={},s=0;s<i.length;s++){var l=i[s],c=n[l],u=e[l],d=c(u,t);if(void 0===d){t&&t.type;throw new Error(Ol(14))}o[l]=d,r=r||d!==u}return(r=r||i.length!==Object.keys(e).length)?o:e}}({deck:function(e,t){switch(void 0===e&&(e=Hl),t.type){case Ms:return Vl(Vl({},e),{decks:t.payload});case Us:return Vl(Vl({},e),{deckId:t.payload});default:return e}},cards:Xl,settings:function(e,t){switch(void 0===e&&(e=Zi),t.type){case ot:return Xi(Xi({},e),{openAiKey:t.payload});case at:return Xi(Xi({},e),{mode:t.payload});case it:return Xi(Xi({},e),{translateToLanguage:t.payload});case st:return Xi(Xi({},e),{ankiConnectUrl:t.payload});case lt:return Xi(Xi({},e),{ankiConnectApiKey:t.payload});case ct:return Xi(Xi({},e),{useAnkiConnect:t.payload});case ut:return Xi(Xi({},e),{visibleSideBar:t.visible});case xt:return Xi(Xi({},e),{groqApiKey:t.payload});case vt:return Xi(Xi({},e),{groqModelName:t.payload});case dt:return Xi(Xi({},e),{shouldGenerateImage:t.payload});case ft:return Xi(Xi({},e),{translationPrompt:t.payload});case gt:return Xi(Xi({},e),{examplesPrompt:t.payload});case ht:return Xi(Xi({},e),{aiInstructions:t.payload});case mt:return Xi(Xi({},e),{imageInstructions:t.payload});case pt:return Xi(Xi({},e),{imageGenerationMode:t.payload});case yt:return Xi(Xi({},e),{modelProvider:t.payload});case bt:return Xi(Xi({},e),{sourceLanguage:t.payload});default:return e}},currentPage:Yl,anki:tc,sidebar:ac,notifications:function(e,t){switch(void 0===e&&(e=lc),t.type){case el:return e.notifications.find((function(e){return e.message===t.payload.message&&e.type===t.payload.type}))?e:ic(ic({},e),{notifications:sc(sc([],e.notifications,!0),[t.payload],!1)});case tl:return ic(ic({},e),{notifications:e.notifications.filter((function(e){return e.id!==t.payload.id}))});default:return e}},tabState:pc}),hc=function(e,t,n){const{namespace:r,chromeNs:o,browserNs:a,storageArea:i,storageKey:s,isolated:l,plainActions:c,outdatedTimeout:u}=t||{},{onGlobalChange:d,onLocalChange:p,onError:f}=n||{};if("function"!=typeof e)throw new Error("Missing argument for 'storeCreatorContainer'");const g=a||r===jl.browser?new _l({namespace:a||browser,area:i,key:s}):new Al({namespace:o||chrome,area:i,key:s});return"function"==typeof d&&g.regListener(((t,n)=>{const r=new Cl(e,g,!0,c),[o]=Sl(t),[a]=Sl(n);d(r.initFrom(o),a)})),l||g.regShared(),t=>{f&&g.subscribeForError(f);return new Cl(e,g,l,c,u,p,t).init()}}((function(e){return Ml(gc,e,ql(Gl,Qi))}));console.log("Content script works!"),console.log("Must reload extension for modifications to take effect."),fc="Using the 'printLine' function from the Print Module",console.log("===> FROM THE PRINT MODULE:",fc);const mc=document.createElement("div");mc.id="sidebar",mc.setAttribute("style","\n  all: initial;\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 350px;\n  height: 100%;\n  overflow: auto;\n  z-index: 9999;\n  background-color: #ffffff;\n  box-shadow: -2px 0 5px rgba(0, 0, 0, 0.15);\n  transform: translateX(100%); /*    */\n  transition: transform 0.3s ease-in-out;\n");const yc=mc.attachShadow({mode:"open"}),xc=document.createElement("link");xc.setAttribute("rel","stylesheet");const vc=chrome.runtime.getURL("tailwind.css");xc.setAttribute("href",vc),yc.appendChild(xc),document.body.appendChild(mc);const bc=(0,o.H)(yc),wc=()=>r.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",fontFamily:"system-ui, -apple-system, sans-serif",color:"#ffffff"}},[r.createElement("div",{key:"logo",style:{width:"48px",height:"48px",background:"rgba(255,255,255,0.2)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px",animation:"pulse 2s ease-in-out infinite"}},""),r.createElement("div",{key:"spinner",style:{width:"32px",height:"32px",border:"2px solid rgba(255,255,255,0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"20px"}}),r.createElement("h2",{key:"title",style:{color:"#ffffff",fontSize:"20px",fontWeight:"700",marginBottom:"8px",textAlign:"center",letterSpacing:"-0.025em"}},"Anki Flash Cards"),r.createElement("p",{key:"subtitle",style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",textAlign:"center",fontWeight:"400"}},"Initializing your learning assistant..."),r.createElement("div",{key:"progress-bar",style:{width:"200px",height:"2px",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"1px",marginTop:"24px",overflow:"hidden"}},r.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"#ffffff",animation:"progressBar 2s ease-in-out infinite"}})),r.createElement("style",{key:"styles"},"\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n      @keyframes pulse {\n        0%, 100% { transform: scale(1); opacity: 1; }\n        50% { transform: scale(1.05); opacity: 0.8; }\n      }\n      @keyframes progressBar {\n        0% { transform: translateX(-100%); }\n        50% { transform: translateX(0%); }\n        100% { transform: translateX(100%); }\n      }\n    ")]);const Sc=new class{constructor(){this.storageKeys={globalState:"sidebar_global_state",tabPrefix:"sidebar_tab_"}}getTabKey(e){return`${this.storageKeys.tabPrefix}${e}`}async getInheritanceSettings(){return{enabled:!0,mode:"lastActive"}}async getGlobalState(){return new Promise((e=>{chrome.storage.local.get([this.storageKeys.globalState],(t=>{const n={isVisible:!1,lastActiveTabId:null,lastToggleTime:Date.now()};e(t[this.storageKeys.globalState]||n)}))}))}async getTabState(e){const t=this.getTabKey(e);return new Promise((e=>{chrome.storage.local.get([t],(n=>{e(n[t]||null)}))}))}async saveGlobalState(e){return new Promise((t=>{chrome.storage.local.set({[this.storageKeys.globalState]:e},t)}))}async saveTabState(e,t){const n=this.getTabKey(e);return new Promise((e=>{chrome.storage.local.set({[n]:t},e)}))}async determineInitialState(e){const t=await this.getGlobalState();if(t.lastActiveTabId){const e=await this.getTabState(t.lastActiveTabId);if(e)return{isVisible:e.isVisible,source:"lastActive",inheritedFrom:t.lastActiveTabId}}return{isVisible:t.isVisible,source:"global_fallback",inheritedFrom:null}}async toggleSidebar(e){const t=await this.getTabState(e),n=await this.getGlobalState();let r;if(t)r=t.isVisible;else{r=(await this.determineInitialState(e)).isVisible}const o=!r,a=Date.now(),i={isVisible:o,lastToggleTime:a,...t?.inheritedFrom&&{inheritedFrom:t.inheritedFrom}},s={...n,isVisible:o,lastActiveTabId:e,lastToggleTime:a};return await Promise.all([this.saveTabState(e,i),this.saveGlobalState(s)]),{isVisible:o,wasInherited:!!t?.inheritedFrom}}async getCurrentState(e){const t=await this.getTabState(e);return t?{isVisible:t.isVisible,source:"existing",inheritedFrom:t.inheritedFrom}:await this.determineInitialState(e)}},Cc=(e,t,n="unknown")=>{e?(mc.style.transform="translateX(0)",document.body.style.marginRight="350px"):(mc.style.transform="translateX(100%)",document.body.style.marginRight="0"),console.log(`Sidebar state applied for tab ${t}: ${e?"visible":"hidden"} (source: ${n})`)},kc=()=>{const[e,t]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0),[a,i]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{chrome.runtime.sendMessage({action:"getTabId"},(async e=>{const t=e?.tabId||Math.floor(1e6*Math.random());i(t),console.log("Content script initialized with tab ID:",t);try{const e=await Sc.getCurrentState(t);Cc(e.isVisible,t,e.source),e.inheritedFrom&&console.log(`Sidebar state inherited from tab ${e.inheritedFrom}`)}catch(e){console.error("Error determining initial sidebar state:",e),Cc(!1,t,"error_fallback")}}));const e=await hc();t(e),setTimeout((()=>o(!1)),100)}catch(e){console.error("Error loading state from Chrome storage:",e),o(!1)}})()}),[]),n||!e||null===a?r.createElement(wc):r.createElement(w,{store:e},r.createElement(cl,{tabId:a}))},Ec=r.createElement(kc,{});bc.render(Ec),chrome.runtime.onMessage.addListener(((e,t,n)=>{if("toggleSidebar"===e.action){const t=e.tabId||"unknown";return"unknown"===t?(console.error("Cannot toggle sidebar: unknown tab ID"),n({status:"error",message:"Unknown tab ID"}),!0):(Sc.toggleSidebar(t).then((e=>{Cc(e.isVisible,t,"toggle"),n({status:"Sidebar toggled",visible:e.isVisible,tabId:t,wasInherited:e.wasInherited}),console.log(`Sidebar toggled for tab ${t}: ${e.isVisible?"visible":"hidden"}${e.wasInherited?" (was inherited)":""}`)})).catch((e=>{console.error("Error toggling sidebar:",e),n({status:"error",message:e.toString()})})),!0)}}))})();