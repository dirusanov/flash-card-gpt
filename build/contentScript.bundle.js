(()=>{"use strict";var e={146:(e,t,n)=>{var r=n(363),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?i:s[e.$$typeof]||o}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=i;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(g){var o=p(n);o&&o!==g&&e(t,o,r)}var i=u(n);d&&(i=i.concat(d(n)));for(var s=l(t),h=l(n),m=0;m<i.length;++m){var y=i[m];if(!(a[y]||r&&r[y]||h&&h[y]||s&&s[y])){var x=f(n,y);try{c(t,y,x)}catch(e){}}}}return t}},551:(e,t,n)=>{
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=n(982);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function h(e,t,n,r,o,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new h(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new h(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new h(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new h(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new h(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new h(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new h(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new h(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new h(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function v(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(g,e)||!d.call(p,e)&&(f.test(e)?g[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,x);m[t]=new h(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new h(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new h("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new h(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),I=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function B(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=R&&e[R]||e["@@iterator"])?e:null}var N,z=Object.assign;function L(e){if(void 0===N)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var D=!1;function M(e,t){if(!e||D)return"";D=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),a=r.stack.split("\n"),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(1!==i||1!==s)do{if(i--,0>--s||o[i]!==a[s]){var l="\n"+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=s);break}}}finally{D=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function U(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=M(e.type,!1);case 11:return e=M(e.type.render,!1);case 1:return e=M(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case k:return"Fragment";case S:return"Portal";case C:return"Profiler";case E:return"StrictMode";case A:return"Suspense";case F:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return $(e(t))}catch(e){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function X(e,t){J(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ae(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function he(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=he(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,ke=null,Ee=null;function Ce(e){if(e=bo(e)){if("function"!=typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=So(t),Se(e.stateNode,e.type,t))}}function _e(e){ke?Ee?Ee.push(e):Ee=[e]:ke=e}function Ie(){if(ke){var e=ke,t=Ee;if(Ee=ke=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function je(e,t){return e(t)}function Ae(){}var Fe=!1;function Te(e,t,n){if(Fe)return e(t,n);Fe=!0;try{return je(e,t,n)}finally{Fe=!1,(null!==ke||null!==Ee)&&(Ae(),Ie())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=So(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Oe=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Oe=!1}function Be(e,t,n,r,o,a,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Ne=!1,ze=null,Le=!1,De=null,Me={onError:function(e){Ne=!0,ze=e}};function Ue(e,t,n,r,o,a,i,s,l){Ne=!1,ze=null,Be.apply(Me,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if($e(e)!==e)throw Error(a(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Ve(o),e;if(i===r)return Ve(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=o.unstable_scheduleCallback,Ke=o.unstable_cancelCallback,Ye=o.unstable_shouldYield,Qe=o.unstable_requestPaint,Je=o.unstable_now,Xe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~o;0!==s?r=dt(s):0!==(a&=i)&&(r=dt(a))}else 0!==(i=n&~o)?r=dt(i):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&!(t&o)&&((o=r&-r)>=(a=t&-t)||16===o&&4194240&a))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-it(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ht(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function xt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,St,kt,Et,Ct,_t=!1,It=[],jt=null,At=null,Ft=null,Tt=new Map,Pt=new Map,Ot=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bt(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Nt(e,t,n,r,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=bo(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function zt(e){var t=vo(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Ct(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bo(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Dt(e,t,n){Lt(e)&&n.delete(t)}function Mt(){_t=!1,null!==jt&&Lt(jt)&&(jt=null),null!==At&&Lt(At)&&(At=null),null!==Ft&&Lt(Ft)&&(Ft=null),Tt.forEach(Dt),Pt.forEach(Dt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Mt)))}function $t(e){function t(t){return Ut(t,e)}if(0<It.length){Ut(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==jt&&Ut(jt,e),null!==At&&Ut(At,e),null!==Ft&&Ut(Ft,e),Tt.forEach(t),Pt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)zt(n),null===n.blockedOn&&Ot.shift()}var Wt=b.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var o=vt,a=Wt.transition;Wt.transition=null;try{vt=1,Gt(e,t,n,r)}finally{vt=o,Wt.transition=a}}function Ht(e,t,n,r){var o=vt,a=Wt.transition;Wt.transition=null;try{vt=4,Gt(e,t,n,r)}finally{vt=o,Wt.transition=a}}function Gt(e,t,n,r){if(Vt){var o=Yt(e,t,n,r);if(null===o)Vr(e,t,r,Kt,n),Bt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return jt=Nt(jt,e,t,n,r,o),!0;case"dragenter":return At=Nt(At,e,t,n,r,o),!0;case"mouseover":return Ft=Nt(Ft,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return Tt.set(a,Nt(Tt.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Pt.set(a,Nt(Pt.get(a)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Bt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==o;){var a=bo(o);if(null!==a&&wt(a),null===(a=Yt(e,t,n,r))&&Vr(e,t,r,Kt,n),a===o)break;o=a}null!==o&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Kt=null;function Yt(e,t,n,r){if(Kt=null,null!==(e=vo(e=we(r))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,o="value"in Jt?Jt.value:Jt.textContent,a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=z({},cn,{view:0,detail:0}),fn=on(dn),pn=z({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),gn=on(pn),hn=on(z({},pn,{dataTransfer:0})),mn=on(z({},dn,{relatedTarget:0})),yn=on(z({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=z({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=on(xn),bn=on(z({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function Cn(){return En}var _n=z({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=on(_n),jn=on(z({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=on(z({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Fn=on(z({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=z({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Tn),On=[9,13,27,32],Rn=u&&"CompositionEvent"in window,Bn=null;u&&"documentMode"in document&&(Bn=document.documentMode);var Nn=u&&"TextEvent"in window&&!Bn,zn=u&&(!Rn||Bn&&8<Bn&&11>=Bn),Ln=String.fromCharCode(32),Dn=!1;function Mn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){_e(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Kn(e){Lr(e,0)}function Yn(e){if(G(wo(e)))return e}function Qn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"==typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];qn(t,Gn,e,we(e)),Te(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function ar(e,t){if("click"===e)return Yn(t)}function ir(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(sr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=void 0===r.end?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=ur(n,a);var i=ur(n,r);o&&i&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,xr=null,vr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&lr(xr,r)||(xr=r,0<(r=Hr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},kr={},Er={};function Cr(e){if(kr[e])return kr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return kr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var _r=Cr("animationend"),Ir=Cr("animationiteration"),jr=Cr("animationstart"),Ar=Cr("transitionend"),Fr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Fr.set(e,t),l(t,[e])}for(var Or=0;Or<Tr.length;Or++){var Rr=Tr[Or];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(_r,"onAnimationEnd"),Pr(Ir,"onAnimationIteration"),Pr(jr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Br));function zr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,l,c){if(Ue.apply(this,arguments),Ne){if(!Ne)throw Error(a(198));var u=ze;Ne=!1,ze=null,Le||(Le=!0,De=u)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;zr(o,s,c),a=l}else for(i=0;i<r.length;i++){if(l=(s=r[i]).instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;zr(o,s,c),a=l}}}if(Le)throw e=De,Le=!1,De=null,e}function Dr(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Mr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function $r(e){if(!e[Ur]){e[Ur]=!0,i.forEach((function(t){"selectionchange"!==t&&(Nr.has(t)||Mr(t,!1,e),Mr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Mr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Qt(t)){case 1:var o=qt;break;case 4:o=Ht;break;default:o=Gt}n=o.bind(null,t,n,e),o=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,o){var a=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;i=i.return}for(;null!==s;){if(null===(i=vo(s)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}s=s.parentNode}}r=r.return}Te((function(){var r=a,o=we(n),i=[];e:{var s=Fr.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=hn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case _r:case Ir:case jr:l=yn;break;case Ar:l=Fn;break;case"scroll":l=fn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=jn}var u=!!(4&t),d=!u&&"scroll"===e,f=u?null!==s?s+"Capture":null:s;u=[];for(var p,g=r;null!==g;){var h=(p=g).stateNode;if(5===p.tag&&null!==h&&(p=h,null!==f&&(null!=(h=Pe(g,f))&&u.push(qr(g,h,p)))),d)break;g=g.return}0<u.length&&(s=new l(s,c,null,n,o),i.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!vo(c)&&!c[ho])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vo(c):null)&&(c!==(d=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=gn,h="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,h="onPointerLeave",f="onPointerEnter",g="pointer"),d=null==l?s:wo(l),p=null==c?s:wo(c),(s=new u(h,g+"leave",l,n,o)).target=d,s.relatedTarget=p,h=null,vo(o)===r&&((u=new u(f,g+"enter",c,n,o)).target=p,u.relatedTarget=d,h=u),d=h,l&&c)e:{for(f=c,g=0,p=u=l;p;p=Gr(p))g++;for(p=0,h=f;h;h=Gr(h))p++;for(;0<g-p;)u=Gr(u),g--;for(;0<p-g;)f=Gr(f),p--;for(;g--;){if(u===f||null!==f&&u===f.alternate)break e;u=Gr(u),f=Gr(f)}u=null}else u=null;null!==l&&Kr(i,s,l,u,!1),null!==c&&null!==d&&Kr(i,d,c,u,!0)}if("select"===(l=(s=r?wo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Qn;else if(Vn(s))if(Jn)m=ir;else{m=or;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ar);switch(m&&(m=m(e,r))?qn(i,m,n,o):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?wo(r):window,e){case"focusin":(Vn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,xr=null);break;case"focusout":xr=yr=mr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,br(i,n,o);break;case"selectionchange":if(hr)break;case"keydown":case"keyup":br(i,n,o)}var x;if(Rn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else $n?Mn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(zn&&"ko"!==n.locale&&($n||"onCompositionStart"!==v?"onCompositionEnd"===v&&$n&&(x=en()):(Xt="value"in(Jt=o)?Jt.value:Jt.textContent,$n=!0)),0<(y=Hr(r,v)).length&&(v=new bn(v,e,null,n,o),i.push({event:v,listeners:y}),x?v.data=x:null!==(x=Un(n))&&(v.data=x))),(x=Nn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Dn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Dn?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Rn&&Mn(e,t)?(e=en(),Zt=Xt=Jt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(o=new bn("onBeforeInput","beforeinput",null,n,o),i.push({event:o,listeners:r}),o.data=x))}Lr(i,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=Pe(e,n))&&r.unshift(qr(e,a,o)),null!=(a=Pe(e,t))&&r.push(qr(e,a,o))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,o){for(var a=t._reactName,i=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Pe(n,a))&&i.unshift(qr(n,l,s)):o||null!=(l=Pe(n,a))&&i.push(qr(n,l,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Jr(e){return("string"==typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(a(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"==typeof setTimeout?setTimeout:void 0,oo="function"==typeof clearTimeout?clearTimeout:void 0,ao="function"==typeof Promise?Promise:void 0,io="function"==typeof queueMicrotask?queueMicrotask:void 0!==ao?function(e){return ao.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout((function(){throw e}))}function lo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void $t(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);$t(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fo=Math.random().toString(36).slice(2),po="__reactFiber$"+fo,go="__reactProps$"+fo,ho="__reactContainer$"+fo,mo="__reactEvents$"+fo,yo="__reactListeners$"+fo,xo="__reactHandles$"+fo;function vo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ho]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[po])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function bo(e){return!(e=e[po]||e[ho])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function So(e){return e[go]||null}var ko=[],Eo=-1;function Co(e){return{current:e}}function _o(e){0>Eo||(e.current=ko[Eo],ko[Eo]=null,Eo--)}function Io(e,t){Eo++,ko[Eo]=e.current,e.current=t}var jo={},Ao=Co(jo),Fo=Co(!1),To=jo;function Po(e,t){var n=e.type.contextTypes;if(!n)return jo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Oo(e){return null!=(e=e.childContextTypes)}function Ro(){_o(Fo),_o(Ao)}function Bo(e,t,n){if(Ao.current!==jo)throw Error(a(168));Io(Ao,t),Io(Fo,n)}function No(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,W(e)||"Unknown",o));return z({},n,r)}function zo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jo,To=Ao.current,Io(Ao,e),Io(Fo,Fo.current),!0}function Lo(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=No(e,t,To),r.__reactInternalMemoizedMergedChildContext=e,_o(Fo),_o(Ao),Io(Ao,e)):_o(Fo),Io(Fo,n)}var Do=null,Mo=!1,Uo=!1;function $o(e){null===Do?Do=[e]:Do.push(e)}function Wo(){if(!Uo&&null!==Do){Uo=!0;var e=0,t=vt;try{var n=Do;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Do=null,Mo=!1}catch(t){throw null!==Do&&(Do=Do.slice(e+1)),Ge(Ze,Wo),t}finally{vt=t,Uo=!1}}return null}var Vo=[],qo=0,Ho=null,Go=0,Ko=[],Yo=0,Qo=null,Jo=1,Xo="";function Zo(e,t){Vo[qo++]=Go,Vo[qo++]=Ho,Ho=e,Go=t}function ea(e,t,n){Ko[Yo++]=Jo,Ko[Yo++]=Xo,Ko[Yo++]=Qo,Qo=e;var r=Jo;e=Xo;var o=32-it(r)-1;r&=~(1<<o),n+=1;var a=32-it(t)+o;if(30<a){var i=o-o%5;a=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Jo=1<<32-it(t)+o|n<<o|r,Xo=a+e}else Jo=1<<a|n<<o|r,Xo=e}function ta(e){null!==e.return&&(Zo(e,1),ea(e,1,0))}function na(e){for(;e===Ho;)Ho=Vo[--qo],Vo[qo]=null,Go=Vo[--qo],Vo[qo]=null;for(;e===Qo;)Qo=Ko[--Yo],Ko[Yo]=null,Xo=Ko[--Yo],Ko[Yo]=null,Jo=Ko[--Yo],Ko[Yo]=null}var ra=null,oa=null,aa=!1,ia=null;function sa(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function la(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,oa=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qo?{id:Jo,overflow:Xo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ra=e,oa=null,!0);default:return!1}}function ca(e){return!(!(1&e.mode)||128&e.flags)}function ua(e){if(aa){var t=oa;if(t){var n=t;if(!la(e,t)){if(ca(e))throw Error(a(418));t=co(n.nextSibling);var r=ra;t&&la(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,aa=!1,ra=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,ra=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function fa(e){if(e!==ra)return!1;if(!aa)return da(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oa)){if(ca(e))throw pa(),Error(a(418));for(;t;)sa(e,t),t=co(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oa=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oa=null}}else oa=ra?co(e.stateNode.nextSibling):null;return!0}function pa(){for(var e=oa;e;)e=co(e.nextSibling)}function ga(){oa=ra=null,aa=!1}function ha(e){null===ia?ia=[e]:ia.push(e)}var ma=b.ReactCurrentBatchConfig;function ya(e,t){if(e&&e.defaultProps){for(var n in t=z({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var xa=Co(null),va=null,ba=null,wa=null;function Sa(){wa=ba=va=null}function ka(e){var t=xa.current;_o(xa),e._currentValue=t}function Ea(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ca(e,t){va=e,wa=ba=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(bs=!0),e.firstContext=null)}function _a(e){var t=e._currentValue;if(wa!==e)if(e={context:e,memoizedValue:t,next:null},null===ba){if(null===va)throw Error(a(308));ba=e,va.dependencies={lanes:0,firstContext:e}}else ba=ba.next=e;return t}var Ia=null;function ja(e){null===Ia?Ia=[e]:Ia.push(e)}function Aa(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,ja(t)):(n.next=o.next,o.next=n),t.interleaved=n,Fa(e,r)}function Fa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ta=!1;function Pa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ra(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ba(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Al){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Fa(e,n)}return null===(o=r.interleaved)?(t.next=t,ja(r)):(t.next=o.next,o.next=t),r.interleaved=t,Fa(e,n)}function Na(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}function za(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function La(e,t,n,r){var o=e.updateQueue;Ta=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==a){var d=o.baseState;for(i=0,u=c=l=null,s=a;;){var f=s.lane,p=s.eventTime;if((r&f)===f){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,h=s;switch(f=t,p=n,h.tag){case 1:if("function"==typeof(g=h.payload)){d=g.call(p,d,f);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(f="function"==typeof(g=h.payload)?g.call(p,d,f):g))break e;d=z({},d,f);break e;case 2:Ta=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=o.effects)?o.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=f;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(f=s).next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{i|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);zl|=i,e.lanes=i,e.memoizedState=d}}function Da(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(a(191,o));o.call(r)}}}var Ma=(new r.Component).refs;function Ua(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:z({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var $a={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),o=nc(e),a=Ra(r,o);a.payload=t,null!=n&&(a.callback=n),null!==(t=Ba(e,a,o))&&(rc(t,e,o,r),Na(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),o=nc(e),a=Ra(r,o);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=Ba(e,a,o))&&(rc(t,e,o,r),Na(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),o=Ra(n,r);o.tag=2,null!=t&&(o.callback=t),null!==(t=Ba(e,o,r))&&(rc(t,e,r,n),Na(t,e,r))}};function Wa(e,t,n,r,o,a,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(o,a))}function Va(e,t,n){var r=!1,o=jo,a=t.contextType;return"object"==typeof a&&null!==a?a=_a(a):(o=Oo(t)?To:Ao.current,a=(r=null!=(r=t.contextTypes))?Po(e,o):jo),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=$a,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function qa(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$a.enqueueReplaceState(t,t.state,null)}function Ha(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=Ma,Pa(e);var a=t.contextType;"object"==typeof a&&null!==a?o.context=_a(a):(a=Oo(t)?To:Ao.current,o.context=Po(e,a)),o.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&$a.enqueueReplaceState(o,o.state,null),La(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function Ga(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;t===Ma&&(t=o.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ya(e){return(0,e._init)(e._payload)}function Qa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===P&&Ya(a)===t.type)?((r=o(t,n.props)).ref=Ga(e,t,n),r.return=e,r):((r=Bc(n.type,n.key,n.props,null,e.mode,r)).ref=Ga(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Nc(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Bc(t.type,t.key,t.props,null,e.mode,n)).ref=Ga(e,null,t),n.return=e,n;case S:return(t=Dc(t,e.mode,n)).return=e,t;case P:return f(e,(0,t._init)(t._payload),n)}if(te(t)||B(t))return(t=Nc(t,e.mode,n,null)).return=e,t;Ka(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===o?c(e,t,n,r):null;case S:return n.key===o?u(e,t,n,r):null;case P:return p(e,t,(o=n._init)(n._payload),r)}if(te(n)||B(n))return null!==o?null:d(e,t,n,r,null);Ka(e,n)}return null}function g(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case P:return g(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||B(r))return d(t,e=e.get(n)||null,r,o,null);Ka(t,r)}return null}function h(o,a,s,l){for(var c=null,u=null,d=a,h=a=0,m=null;null!==d&&h<s.length;h++){d.index>h?(m=d,d=null):m=d.sibling;var y=p(o,d,s[h],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(o,d),a=i(y,a,h),null===u?c=y:u.sibling=y,u=y,d=m}if(h===s.length)return n(o,d),aa&&Zo(o,h),c;if(null===d){for(;h<s.length;h++)null!==(d=f(o,s[h],l))&&(a=i(d,a,h),null===u?c=d:u.sibling=d,u=d);return aa&&Zo(o,h),c}for(d=r(o,d);h<s.length;h++)null!==(m=g(d,o,h,s[h],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?h:m.key),a=i(m,a,h),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),aa&&Zo(o,h),c}function m(o,s,l,c){var u=B(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,h=s,m=s=0,y=null,x=l.next();null!==h&&!x.done;m++,x=l.next()){h.index>m?(y=h,h=null):y=h.sibling;var v=p(o,h,x.value,c);if(null===v){null===h&&(h=y);break}e&&h&&null===v.alternate&&t(o,h),s=i(v,s,m),null===d?u=v:d.sibling=v,d=v,h=y}if(x.done)return n(o,h),aa&&Zo(o,m),u;if(null===h){for(;!x.done;m++,x=l.next())null!==(x=f(o,x.value,c))&&(s=i(x,s,m),null===d?u=x:d.sibling=x,d=x);return aa&&Zo(o,m),u}for(h=r(o,h);!x.done;m++,x=l.next())null!==(x=g(h,o,m,x.value,c))&&(e&&null!==x.alternate&&h.delete(null===x.key?m:x.key),s=i(x,s,m),null===d?u=x:d.sibling=x,d=x);return e&&h.forEach((function(e){return t(o,e)})),aa&&Zo(o,m),u}return function e(r,a,i,l){if("object"==typeof i&&null!==i&&i.type===k&&null===i.key&&(i=i.props.children),"object"==typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=a;null!==u;){if(u.key===c){if((c=i.type)===k){if(7===u.tag){n(r,u.sibling),(a=o(u,i.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===P&&Ya(c)===u.type){n(r,u.sibling),(a=o(u,i.props)).ref=Ga(r,u,i),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===k?((a=Nc(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=Bc(i.type,i.key,i.props,null,r.mode,l)).ref=Ga(r,a,i),l.return=r,r=l)}return s(r);case S:e:{for(u=i.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=o(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Dc(i,r.mode,l)).return=r,r=a}return s(r);case P:return e(r,a,(u=i._init)(i._payload),l)}if(te(i))return h(r,a,i,l);if(B(i))return m(r,a,i,l);Ka(r,i)}return"string"==typeof i&&""!==i||"number"==typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=o(a,i)).return=r,r=a):(n(r,a),(a=Lc(i,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var Ja=Qa(!0),Xa=Qa(!1),Za={},ei=Co(Za),ti=Co(Za),ni=Co(Za);function ri(e){if(e===Za)throw Error(a(174));return e}function oi(e,t){switch(Io(ni,t),Io(ti,e),Io(ei,Za),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_o(ei),Io(ei,t)}function ai(){_o(ei),_o(ti),_o(ni)}function ii(e){ri(ni.current);var t=ri(ei.current),n=le(t,e.type);t!==n&&(Io(ti,e),Io(ei,n))}function si(e){ti.current===e&&(_o(ei),_o(ti))}var li=Co(0);function ci(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ui=[];function di(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var fi=b.ReactCurrentDispatcher,pi=b.ReactCurrentBatchConfig,gi=0,hi=null,mi=null,yi=null,xi=!1,vi=!1,bi=0,wi=0;function Si(){throw Error(a(321))}function ki(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Ei(e,t,n,r,o,i){if(gi=i,hi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fi.current=null===e||null===e.memoizedState?ss:ls,e=n(r,o),vi){i=0;do{if(vi=!1,bi=0,25<=i)throw Error(a(301));i+=1,yi=mi=null,t.updateQueue=null,fi.current=cs,e=n(r,o)}while(vi)}if(fi.current=is,t=null!==mi&&null!==mi.next,gi=0,yi=mi=hi=null,xi=!1,t)throw Error(a(300));return e}function Ci(){var e=0!==bi;return bi=0,e}function _i(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yi?hi.memoizedState=yi=e:yi=yi.next=e,yi}function Ii(){if(null===mi){var e=hi.alternate;e=null!==e?e.memoizedState:null}else e=mi.next;var t=null===yi?hi.memoizedState:yi.next;if(null!==t)yi=t,mi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(mi=e).memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},null===yi?hi.memoizedState=yi=e:yi=yi.next=e}return yi}function ji(e,t){return"function"==typeof t?t(e):t}function Ai(e){var t=Ii(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=mi,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var l=s=null,c=null,u=i;do{var d=u.lane;if((gi&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=f,s=r):c=c.next=f,hi.lanes|=d,zl|=d}u=u.next}while(null!==u&&u!==i);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,hi.lanes|=i,zl|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Fi(e){var t=Ii(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);sr(i,t.memoizedState)||(bs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ti(){}function Pi(e,t){var n=hi,r=Ii(),o=t(),i=!sr(r.memoizedState,o);if(i&&(r.memoizedState=o,bs=!0),r=r.queue,Vi(Bi.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==yi&&1&yi.memoizedState.tag){if(n.flags|=2048,Di(9,Ri.bind(null,n,r,o,t),void 0,null),null===Fl)throw Error(a(349));30&gi||Oi(n,t,o)}return o}function Oi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=hi.updateQueue)?(t={lastEffect:null,stores:null},hi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ri(e,t,n,r){t.value=n,t.getSnapshot=r,Ni(t)&&zi(e)}function Bi(e,t,n){return n((function(){Ni(t)&&zi(e)}))}function Ni(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(e){return!0}}function zi(e){var t=Fa(e,1);null!==t&&rc(t,e,1,-1)}function Li(e){var t=_i();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,hi,e),[t.memoizedState,e]}function Di(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=hi.updateQueue)?(t={lastEffect:null,stores:null},hi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Mi(){return Ii().memoizedState}function Ui(e,t,n,r){var o=_i();hi.flags|=e,o.memoizedState=Di(1|t,n,void 0,void 0===r?null:r)}function $i(e,t,n,r){var o=Ii();r=void 0===r?null:r;var a=void 0;if(null!==mi){var i=mi.memoizedState;if(a=i.destroy,null!==r&&ki(r,i.deps))return void(o.memoizedState=Di(t,n,a,r))}hi.flags|=e,o.memoizedState=Di(1|t,n,a,r)}function Wi(e,t){return Ui(8390656,8,e,t)}function Vi(e,t){return $i(2048,8,e,t)}function qi(e,t){return $i(4,2,e,t)}function Hi(e,t){return $i(4,4,e,t)}function Gi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ki(e,t,n){return n=null!=n?n.concat([e]):null,$i(4,4,Gi.bind(null,t,e),n)}function Yi(){}function Qi(e,t){var n=Ii();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ki(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ji(e,t){var n=Ii();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ki(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xi(e,t,n){return 21&gi?(sr(n,t)||(n=ht(),hi.lanes|=n,zl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n)}function Zi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=pi.transition;pi.transition={};try{e(!1),t()}finally{vt=n,pi.transition=r}}function es(){return Ii().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))os(t,n);else if(null!==(n=Aa(e,t,n,r))){rc(n,e,r,tc()),as(n,t,r)}}function ns(e,t,n){var r=nc(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))os(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=a(i,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,i)){var l=t.interleaved;return null===l?(o.next=o,ja(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=Aa(e,t,o,r))&&(rc(n,e,r,o=tc()),as(n,t,r))}}function rs(e){var t=e.alternate;return e===hi||null!==t&&t===hi}function os(e,t){vi=xi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function as(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}var is={readContext:_a,useCallback:Si,useContext:Si,useEffect:Si,useImperativeHandle:Si,useInsertionEffect:Si,useLayoutEffect:Si,useMemo:Si,useReducer:Si,useRef:Si,useState:Si,useDebugValue:Si,useDeferredValue:Si,useTransition:Si,useMutableSource:Si,useSyncExternalStore:Si,useId:Si,unstable_isNewReconciler:!1},ss={readContext:_a,useCallback:function(e,t){return _i().memoizedState=[e,void 0===t?null:t],e},useContext:_a,useEffect:Wi,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Ui(4194308,4,Gi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ui(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ui(4,2,e,t)},useMemo:function(e,t){var n=_i();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_i();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,hi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_i().memoizedState=e},useState:Li,useDebugValue:Yi,useDeferredValue:function(e){return _i().memoizedState=e},useTransition:function(){var e=Li(!1),t=e[0];return e=Zi.bind(null,e[1]),_i().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=hi,o=_i();if(aa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Fl)throw Error(a(349));30&gi||Oi(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Wi(Bi.bind(null,r,i,e),[e]),r.flags|=2048,Di(9,Ri.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=_i(),t=Fl.identifierPrefix;if(aa){var n=Xo;t=":"+t+"R"+(n=(Jo&~(1<<32-it(Jo)-1)).toString(32)+n),0<(n=bi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:_a,useCallback:Qi,useContext:_a,useEffect:Vi,useImperativeHandle:Ki,useInsertionEffect:qi,useLayoutEffect:Hi,useMemo:Ji,useReducer:Ai,useRef:Mi,useState:function(){return Ai(ji)},useDebugValue:Yi,useDeferredValue:function(e){return Xi(Ii(),mi.memoizedState,e)},useTransition:function(){return[Ai(ji)[0],Ii().memoizedState]},useMutableSource:Ti,useSyncExternalStore:Pi,useId:es,unstable_isNewReconciler:!1},cs={readContext:_a,useCallback:Qi,useContext:_a,useEffect:Vi,useImperativeHandle:Ki,useInsertionEffect:qi,useLayoutEffect:Hi,useMemo:Ji,useReducer:Fi,useRef:Mi,useState:function(){return Fi(ji)},useDebugValue:Yi,useDeferredValue:function(e){var t=Ii();return null===mi?t.memoizedState=e:Xi(t,mi.memoizedState,e)},useTransition:function(){return[Fi(ji)[0],Ii().memoizedState]},useMutableSource:Ti,useSyncExternalStore:Pi,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ps="function"==typeof WeakMap?WeakMap:Map;function gs(e,t,n){(n=Ra(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),fs(0,t)},n}function hs(e,t,n){(n=Ra(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){fs(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){fs(0,t),"function"!=typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xs(e,t,n,r,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ra(-1,1)).tag=2,Ba(n,t,1))),n.lanes|=1),e)}var vs=b.ReactCurrentOwner,bs=!1;function ws(e,t,n,r){t.child=null===e?Xa(t,null,n,r):Ja(t,e.child,n,r)}function Ss(e,t,n,r,o){n=n.render;var a=t.ref;return Ca(t,o),r=Ei(e,t,n,r,a,o),n=Ci(),null===e||bs?(aa&&n&&ta(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,qs(e,t,o))}function ks(e,t,n,r,o){if(null===e){var a=n.type;return"function"!=typeof a||Oc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Bc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Es(e,t,a,r,o))}if(a=e.child,!(e.lanes&o)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return qs(e,t,o)}return t.flags|=1,(e=Rc(a,r)).ref=t.ref,e.return=t,t.child=e}function Es(e,t,n,r,o){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=a,!(e.lanes&o))return t.lanes=e.lanes,qs(e,t,o);131072&e.flags&&(bs=!0)}}return Is(e,t,n,r,o)}function Cs(e,t,n){var r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Io(Rl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Io(Rl,Ol),Ol|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(Rl,Ol),Ol|=n;else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Io(Rl,Ol),Ol|=r;return ws(e,t,o,n),t.child}function _s(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,n,r,o){var a=Oo(n)?To:Ao.current;return a=Po(t,a),Ca(t,o),n=Ei(e,t,n,r,a,o),r=Ci(),null===e||bs?(aa&&r&&ta(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,qs(e,t,o))}function js(e,t,n,r,o){if(Oo(n)){var a=!0;zo(t)}else a=!1;if(Ca(t,o),null===t.stateNode)Vs(e,t),Va(t,n,r),Ha(t,n,r,o),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=n.contextType;"object"==typeof c&&null!==c?c=_a(c):c=Po(t,c=Oo(n)?To:Ao.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate;d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==r||l!==c)&&qa(t,i,r,c),Ta=!1;var f=t.memoizedState;i.state=f,La(t,r,i,o),l=t.memoizedState,s!==r||f!==l||Fo.current||Ta?("function"==typeof u&&(Ua(t,n,u,r),l=t.memoizedState),(s=Ta||Wa(t,n,s,r,f,l,c))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=s):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Oa(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ya(t.type,s),i.props=c,d=t.pendingProps,f=i.context,"object"==typeof(l=n.contextType)&&null!==l?l=_a(l):l=Po(t,l=Oo(n)?To:Ao.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==d||f!==l)&&qa(t,i,r,l),Ta=!1,f=t.memoizedState,i.state=f,La(t,r,i,o);var g=t.memoizedState;s!==d||f!==g||Fo.current||Ta?("function"==typeof p&&(Ua(t,n,p,r),g=t.memoizedState),(c=Ta||Wa(t,n,c,r,f,g,l)||!1)?(u||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,g,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,g,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),i.props=r,i.state=g,i.context=l,r=c):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return As(e,t,n,r,a,o)}function As(e,t,n,r,o,a){_s(e,t);var i=!!(128&t.flags);if(!r&&!i)return o&&Lo(t,n,!1),qs(e,t,a);r=t.stateNode,vs.current=t;var s=i&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=Ja(t,e.child,null,a),t.child=Ja(t,null,s,a)):ws(e,t,s,a),t.memoizedState=r.state,o&&Lo(t,n,!0),t.child}function Fs(e){var t=e.stateNode;t.pendingContext?Bo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Bo(0,t.context,!1),oi(e,t.containerInfo)}function Ts(e,t,n,r,o){return ga(),ha(o),t.flags|=256,ws(e,t,n,r),t.child}var Ps,Os,Rs,Bs,Ns={dehydrated:null,treeContext:null,retryLane:0};function zs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,o=t.pendingProps,i=li.current,s=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Io(li,1&i),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},1&o||null===s?s=zc(l,o,0,null):(s.childLanes=0,s.pendingProps=l),e=Nc(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zs(n),t.memoizedState=Ns,e):Ds(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,s){if(n)return 256&t.flags?(t.flags&=-257,Ms(e,t,s,r=ds(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=zc({mode:"visible",children:r.children},o,0,null),(i=Nc(i,o,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,1&t.mode&&Ja(t,e.child,null,s),t.child.memoizedState=zs(s),t.memoizedState=Ns,i);if(!(1&t.mode))return Ms(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,Ms(e,t,s,r=ds(i=Error(a(419)),r,void 0))}if(l=!!(s&e.childLanes),bs||l){if(null!==(r=Fl)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=o&(r.suspendedLanes|s)?0:o)&&o!==i.retryLane&&(i.retryLane=o,Fa(e,o),rc(r,e,o,-1))}return mc(),Ms(e,t,s,r=ds(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=jc.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,oa=co(o.nextSibling),ra=t,aa=!0,ia=null,null!==e&&(Ko[Yo++]=Jo,Ko[Yo++]=Xo,Ko[Yo++]=Qo,Jo=e.id,Xo=e.overflow,Qo=t),t=Ds(t,r.children),t.flags|=4096,t)}(e,t,l,o,r,i,n);if(s){s=o.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:o.children};return 1&l||t.child===i?(o=Rc(i,c)).subtreeFlags=14680064&i.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null),null!==r?s=Rc(r,s):(s=Nc(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?zs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Ns,o}return e=(s=e.child).sibling,o=Rc(s,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Ds(e,t){return(t=zc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ms(e,t,n,r){return null!==r&&ha(r),Ja(t,e.child,null,n),(e=Ds(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ea(e.return,t,n)}function $s(e,t,n,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function Ws(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(ws(e,t,r.children,n),2&(r=li.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Io(li,r),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ci(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),$s(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ci(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}$s(t,!0,n,null,a);break;case"together":$s(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Vs(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),zl|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Oo(t.type)&&Ro(),Gs(t),null;case 3:return r=t.stateNode,ai(),_o(Fo),_o(Ao),di(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ia&&(sc(ia),ia=null))),Os(e,t),Gs(t),null;case 5:si(t);var o=ri(ni.current);if(n=t.type,null!==e&&null!=t.stateNode)Rs(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Gs(t),null}if(e=ri(ei.current),fa(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[po]=t,r[go]=i,e=!!(1&t.mode),n){case"dialog":Dr("cancel",r),Dr("close",r);break;case"iframe":case"object":case"embed":Dr("load",r);break;case"video":case"audio":for(o=0;o<Br.length;o++)Dr(Br[o],r);break;case"source":Dr("error",r);break;case"img":case"image":case"link":Dr("error",r),Dr("load",r);break;case"details":Dr("toggle",r);break;case"input":Q(r,i),Dr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Dr("invalid",r);break;case"textarea":oe(r,i),Dr("invalid",r)}for(var l in xe(n,i),o=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xr(r.textContent,c,e),o=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Dr("scroll",r)}switch(n){case"input":H(r),Z(r,i,!0);break;case"textarea":H(r),ie(r);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[po]=t,e[go]=r,Ps(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":Dr("cancel",e),Dr("close",e),o=r;break;case"iframe":case"object":case"embed":Dr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Br.length;o++)Dr(Br[o],e);o=r;break;case"source":Dr("error",e),o=r;break;case"img":case"image":case"link":Dr("error",e),Dr("load",e),o=r;break;case"details":Dr("toggle",e),o=r;break;case"input":Q(e,r),o=Y(e,r),Dr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=z({},r,{value:void 0}),Dr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Dr("invalid",e)}for(i in xe(n,o),c=o)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?me(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&fe(e,u):"number"==typeof u&&fe(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Dr("scroll",e):null!=u&&v(e,i,u,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Bs(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(n=ri(ni.current),ri(ei.current),fa(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(i=r.nodeValue!==n)&&null!==(e=ra))switch(e.tag){case 3:Xr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return Gs(t),null;case 13:if(_o(li),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&1&t.mode&&!(128&t.flags))pa(),ga(),t.flags|=98560,i=!1;else if(i=fa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[po]=t}else ga(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),i=!1}else null!==ia&&(sc(ia),ia=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&li.current?0===Bl&&(Bl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return ai(),Os(e,t),null===e&&$r(t.stateNode.containerInfo),Gs(t),null;case 10:return ka(t.type._context),Gs(t),null;case 19:if(_o(li),null===(i=t.memoizedState))return Gs(t),null;if(r=!!(128&t.flags),null===(l=i.rendering))if(r)Hs(i,!1);else{if(0!==Bl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ci(e))){for(t.flags|=128,Hs(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Io(li,1&li.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Wl&&(t.flags|=128,r=!0,Hs(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ci(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!aa)return Gs(t),null}else 2*Je()-i.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Hs(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,n=li.current,Io(li,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Ol)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ys(e,t){switch(na(t),t.tag){case 1:return Oo(t.type)&&Ro(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ai(),_o(Fo),_o(Ao),di(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return si(t),null;case 13:if(_o(li),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ga()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _o(li),null;case 4:return ai(),null;case 10:return ka(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Ps=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Rs=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,ri(ei.current);var a,i=null;switch(n){case"input":o=Y(e,o),r=Y(e,r),i=[];break;case"select":o=z({},o,{value:void 0}),r=z({},r,{value:void 0}),i=[];break;case"textarea":o=re(e,o),r=re(e,r),i=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=Zr)}for(u in xe(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Dr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Bs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qs=!1,Js=!1,Xs="function"==typeof WeakSet?WeakSet:Set,Zs=null;function el(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Cc(e,t,n)}else n.current=null}function tl(e,t,n){try{n()}catch(n){Cc(e,t,n)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&tl(t,n,a)}o=o.next}while(o!==r)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[po],delete t[go],delete t[mo],delete t[yo],delete t[xo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,fl=!1;function pl(e,t,n){for(n=n.child;null!==n;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,n)}catch(e){}switch(n.tag){case 5:Js||el(n,t);case 6:var r=dl,o=fl;dl=null,pl(e,t,n),fl=o,null!==(dl=r)&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),$t(e)):lo(dl,n.stateNode));break;case 4:r=dl,o=fl,dl=n.stateNode.containerInfo,fl=!0,pl(e,t,n),dl=r,fl=o;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var a=o,i=a.destroy;a=a.tag,void 0!==i&&(2&a||4&a)&&tl(n,t,i),o=o.next}while(o!==r)}pl(e,t,n);break;case 1:if(!Js&&(el(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Cc(n,t,e)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Js=(r=Js)||null!==n.memoizedState,pl(e,t,n),Js=r):pl(e,t,n);break;default:pl(e,t,n)}}function hl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xs),t.forEach((function(t){var r=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,fl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,fl=!0;break e}l=l.return}if(null===dl)throw Error(a(160));gl(i,s,o),dl=null,fl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(e){Cc(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),xl(e),4&r){try{rl(3,e,e.return),ol(3,e)}catch(t){Cc(e,e.return,t)}try{rl(5,e,e.return)}catch(t){Cc(e,e.return,t)}}break;case 1:ml(t,e),xl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),xl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var o=e.stateNode;try{fe(o,"")}catch(t){Cc(e,e.return,t)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(o,i),ve(l,s);var u=ve(l,i);for(s=0;s<c.length;s+=2){var d=c[s],f=c[s+1];"style"===d?me(o,f):"dangerouslySetInnerHTML"===d?de(o,f):"children"===d?fe(o,f):v(o,d,f,u)}switch(l){case"input":X(o,i);break;case"textarea":ae(o,i);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var g=i.value;null!=g?ne(o,!!i.multiple,g,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(o,!!i.multiple,i.defaultValue,!0):ne(o,!!i.multiple,i.multiple?[]:"",!1))}o[go]=i}catch(t){Cc(e,e.return,t)}}break;case 6:if(ml(t,e),xl(e),4&r){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(t){Cc(e,e.return,t)}}break;case 3:if(ml(t,e),xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(t){Cc(e,e.return,t)}break;case 4:default:ml(t,e),xl(e);break;case 13:ml(t,e),xl(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||($l=Je())),4&r&&hl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Js=(u=Js)||d,ml(t,e),Js=u):ml(t,e),xl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Zs=e,d=e.child;null!==d;){for(f=Zs=d;null!==Zs;){switch(g=(p=Zs).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var h=p.stateNode;if("function"==typeof h.componentWillUnmount){r=p,n=p.return;try{t=r,h.props=t.memoizedProps,h.state=t.memoizedState,h.componentWillUnmount()}catch(e){Cc(r,n,e)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){Sl(f);continue}}null!==g?(g.return=p,Zs=g):Sl(f)}d=d.sibling}e:for(d=null,f=e;;){if(5===f.tag){if(null===d){d=f;try{o=f.stateNode,u?"function"==typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=f.stateNode,s=null!=(c=f.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=he("display",s))}catch(t){Cc(e,e.return,t)}}}else if(6===f.tag){if(null===d)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(t){Cc(e,e.return,t)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ml(t,e),xl(e),4&r&&hl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(fe(o,""),r.flags&=-33),ul(e,ll(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;cl(e,ll(e),i);break;default:throw Error(a(161))}}catch(t){Cc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Zs=e,bl(e,t,n)}function bl(e,t,n){for(var r=!!(1&e.mode);null!==Zs;){var o=Zs,a=o.child;if(22===o.tag&&r){var i=null!==o.memoizedState||Qs;if(!i){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Js;s=Qs;var c=Js;if(Qs=i,(Js=l)&&!c)for(Zs=o;null!==Zs;)l=(i=Zs).child,22===i.tag&&null!==i.memoizedState?kl(o):null!==l?(l.return=i,Zs=l):kl(o);for(;null!==a;)Zs=a,bl(a,t,n),a=a.sibling;Zs=o,Qs=s,Js=c}wl(e)}else 8772&o.subtreeFlags&&null!==a?(a.return=o,Zs=a):wl(e)}}function wl(e){for(;null!==Zs;){var t=Zs;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Js||ol(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Js)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ya(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Da(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Da(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var f=d.dehydrated;null!==f&&$t(f)}}}break;default:throw Error(a(163))}Js||512&t.flags&&al(t)}catch(e){Cc(t,t.return,e)}}if(t===e){Zs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zs=n;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zs=n;break}Zs=t.return}}function kl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ol(4,t)}catch(e){Cc(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(e){Cc(t,o,e)}}var a=t.return;try{al(t)}catch(e){Cc(t,a,e)}break;case 5:var i=t.return;try{al(t)}catch(e){Cc(t,i,e)}}}catch(e){Cc(t,t.return,e)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var El,Cl=Math.ceil,_l=b.ReactCurrentDispatcher,Il=b.ReactCurrentOwner,jl=b.ReactCurrentBatchConfig,Al=0,Fl=null,Tl=null,Pl=0,Ol=0,Rl=Co(0),Bl=0,Nl=null,zl=0,Ll=0,Dl=0,Ml=null,Ul=null,$l=0,Wl=1/0,Vl=null,ql=!1,Hl=null,Gl=null,Kl=!1,Yl=null,Ql=0,Jl=0,Xl=null,Zl=-1,ec=0;function tc(){return 6&Al?Je():-1!==Zl?Zl:Zl=Je()}function nc(e){return 1&e.mode?2&Al&&0!==Pl?Pl&-Pl:null!==ma.transition?(0===ec&&(ec=ht()),ec):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Qt(e.type):1}function rc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(a(185));yt(e,n,r),2&Al&&e===Fl||(e===Fl&&(!(2&Al)&&(Ll|=n),4===Bl&&lc(e,Pl)),oc(e,r),1===n&&0===Al&&!(1&t.mode)&&(Wl=Je()+500,Mo&&Wo()))}function oc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),s=1<<i,l=o[i];-1===l?s&n&&!(s&r)||(o[i]=pt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ft(e,e===Fl?Pl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Mo=!0,$o(e)}(cc.bind(null,e)):$o(cc.bind(null,e)),io((function(){!(6&Al)&&Wo()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Fc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Zl=-1,ec=0,6&Al)throw Error(a(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ft(e,e===Fl?Pl:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=yc(e,r);else{t=r;var o=Al;Al|=2;var i=hc();for(Fl===e&&Pl===t||(Vl=null,Wl=Je()+500,pc(e,t));;)try{vc();break}catch(t){gc(e,t)}Sa(),_l.current=i,Al=o,null!==Tl?t=0:(Fl=null,Pl=0,t=Bl)}if(0!==t){if(2===t&&(0!==(o=gt(e))&&(r=o,t=ic(e,o))),1===t)throw n=Nl,pc(e,0),lc(e,r),oc(e,Je()),n;if(6===t)lc(e,r);else{if(o=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!sr(a(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=yc(e,r),2===t&&(i=gt(e),0!==i&&(r=i,t=ic(e,i))),1!==t)))throw n=Nl,pc(e,0),lc(e,r),oc(e,Je()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Sc(e,Ul,Vl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=$l+500-Je())){if(0!==ft(e,0))break;if(((o=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(Sc.bind(null,e,Ul,Vl),t);break}Sc(e,Ul,Vl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-it(r);i=1<<s,(s=t[s])>o&&(o=s),r&=~i}if(r=o,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=ro(Sc.bind(null,e,Ul,Vl),r);break}Sc(e,Ul,Vl);break;default:throw Error(a(329))}}}return oc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Ml;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Ul,Ul=n,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function lc(e,t){for(t&=~Dl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(6&Al)throw Error(a(327));kc();var t=ft(e,0);if(!(1&t))return oc(e,Je()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Nl,pc(e,0),lc(e,t),oc(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,Ul,Vl),oc(e,Je()),null}function uc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Wl=Je()+500,Mo&&Wo())}}function dc(e){null!==Yl&&0===Yl.tag&&!(6&Al)&&kc();var t=Al;Al|=1;var n=jl.transition,r=vt;try{if(jl.transition=null,vt=1,e)return e()}finally{vt=r,jl.transition=n,!(6&(Al=t))&&Wo()}}function fc(){Ol=Rl.current,_o(Rl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(na(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ro();break;case 3:ai(),_o(Fo),_o(Ao),di();break;case 5:si(r);break;case 4:ai();break;case 13:case 19:_o(li);break;case 10:ka(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Fl=e,Tl=e=Rc(e.current,null),Pl=Ol=t,Bl=0,Nl=null,Dl=Ll=zl=0,Ul=Ml=null,null!==Ia){for(t=0;t<Ia.length;t++)if(null!==(r=(n=Ia[t]).interleaved)){n.interleaved=null;var o=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=o,r.next=i}n.pending=r}Ia=null}return e}function gc(e,t){for(;;){var n=Tl;try{if(Sa(),fi.current=is,xi){for(var r=hi.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}xi=!1}if(gi=0,yi=mi=hi=null,vi=!1,bi=0,Il.current=null,null===n||null===n.return){Bl=1,Nl=t,Tl=null;break}e:{var i=e,s=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,f=d.tag;if(!(1&d.mode||0!==f&&11!==f&&15!==f)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=ys(s);if(null!==g){g.flags&=-257,xs(g,s,l,0,t),1&g.mode&&ms(i,u,t),c=u;var h=(t=g).updateQueue;if(null===h){var m=new Set;m.add(c),t.updateQueue=m}else h.add(c);break e}if(!(1&t)){ms(i,u,t),mc();break e}c=Error(a(426))}else if(aa&&1&l.mode){var y=ys(s);if(null!==y){!(65536&y.flags)&&(y.flags|=256),xs(y,s,l,0,t),ha(us(c,l));break e}}i=c=us(c,l),4!==Bl&&(Bl=2),null===Ml?Ml=[i]:Ml.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,za(i,gs(0,c,t));break e;case 1:l=c;var x=i.type,v=i.stateNode;if(!(128&i.flags||"function"!=typeof x.getDerivedStateFromError&&(null===v||"function"!=typeof v.componentDidCatch||null!==Gl&&Gl.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,za(i,hs(i,l,t));break e}}i=i.return}while(null!==i)}wc(n)}catch(e){t=e,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function hc(){var e=_l.current;return _l.current=is,null===e?is:e}function mc(){0!==Bl&&3!==Bl&&2!==Bl||(Bl=4),null===Fl||!(268435455&zl)&&!(268435455&Ll)||lc(Fl,Pl)}function yc(e,t){var n=Al;Al|=2;var r=hc();for(Fl===e&&Pl===t||(Vl=null,pc(e,t));;)try{xc();break}catch(t){gc(e,t)}if(Sa(),Al=n,_l.current=r,null!==Tl)throw Error(a(261));return Fl=null,Pl=0,Bl}function xc(){for(;null!==Tl;)bc(Tl)}function vc(){for(;null!==Tl&&!Ye();)bc(Tl)}function bc(e){var t=El(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?wc(e):Tl=t,Il.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Bl=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Ks(n,t,Ol)))return void(Tl=n);if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Bl&&(Bl=5)}function Sc(e,t,n){var r=vt,o=jl.transition;try{jl.transition=null,vt=1,function(e,t,n,r){do{kc()}while(null!==Yl);if(6&Al)throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-it(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}(e,i),e===Fl&&(Tl=Fl=null,Pl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Kl||(Kl=!0,Fc(tt,(function(){return kc(),null}))),i=!!(15990&n.flags),!!(15990&n.subtreeFlags)||i){i=jl.transition,jl.transition=null;var s=vt;vt=1;var l=Al;Al|=4,Il.current=null,function(e,t){if(eo=Vt,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var g;f!==n||0!==o&&3!==f.nodeType||(l=s+o),f!==i||0!==r&&3!==f.nodeType||(c=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(g=f.firstChild);)p=f,f=g;for(;;){if(f===e)break t;if(p===n&&++u===o&&(l=s),p===i&&++d===r&&(c=s),null!==(g=f.nextSibling))break;p=(f=p).parentNode}f=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Vt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,1028&t.subtreeFlags&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var h=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==h){var m=h.memoizedProps,y=h.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:ya(t.type,m),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(e){Cc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}h=nl,nl=!1}(e,n),yl(n,e),gr(to),Vt=!!eo,to=eo=null,e.current=n,vl(n,e,o),Qe(),Al=l,vt=s,jl.transition=i}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Ql=o),i=e.pendingLanes,0===i&&(Gl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),oc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;!!(1&Ql)&&0!==e.tag&&kc(),i=e.pendingLanes,1&i?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,Wo()}(e,t,n,r)}finally{jl.transition=o,vt=r}return null}function kc(){if(null!==Yl){var e=bt(Ql),t=jl.transition,n=vt;try{if(jl.transition=null,vt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Ql=0,6&Al)throw Error(a(331));var o=Al;for(Al|=4,Zs=e.current;null!==Zs;){var i=Zs,s=i.child;if(16&Zs.flags){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zs=u;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:rl(8,d,i)}var f=d.child;if(null!==f)f.return=d,Zs=f;else for(;null!==Zs;){var p=(d=Zs).sibling,g=d.return;if(il(d),d===u){Zs=null;break}if(null!==p){p.return=g,Zs=p;break}Zs=g}}}var h=i.alternate;if(null!==h){var m=h.child;if(null!==m){h.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Zs=i}}if(2064&i.subtreeFlags&&null!==s)s.return=i,Zs=s;else e:for(;null!==Zs;){if(2048&(i=Zs).flags)switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var x=i.sibling;if(null!==x){x.return=i.return,Zs=x;break e}Zs=i.return}}var v=e.current;for(Zs=v;null!==Zs;){var b=(s=Zs).child;if(2064&s.subtreeFlags&&null!==b)b.return=s,Zs=b;else e:for(s=v;null!==Zs;){if(2048&(l=Zs).flags)try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(e){Cc(l,l.return,e)}if(l===s){Zs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zs=w;break e}Zs=l.return}}if(Al=o,Wo(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(e){}r=!0}return r}finally{vt=n,jl.transition=t}}return!1}function Ec(e,t,n){e=Ba(e,t=gs(0,t=us(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),oc(e,t))}function Cc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=Ba(t,e=hs(t,e=us(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),oc(t,e));break}}t=t.return}}function _c(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Fl===e&&(Pl&n)===n&&(4===Bl||3===Bl&&(130023424&Pl)===Pl&&500>Je()-$l?pc(e,0):Dl|=n),oc(e,t)}function Ic(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=tc();null!==(e=Fa(e,t))&&(yt(e,t,n),oc(e,n))}function jc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ic(e,n)}function Fc(e,t){return Ge(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Tc(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Bc(e,t,n,r,o,i){var s=2;if(r=e,"function"==typeof e)Oc(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case k:return Nc(n.children,o,i,t);case E:s=8,o|=8;break;case C:return(e=Pc(12,n,t,2|o)).elementType=C,e.lanes=i,e;case A:return(e=Pc(13,n,t,o)).elementType=A,e.lanes=i,e;case F:return(e=Pc(19,n,t,o)).elementType=F,e.lanes=i,e;case O:return zc(n,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case I:s=9;break e;case j:s=11;break e;case T:s=14;break e;case P:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Pc(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Nc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function zc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,o,a,i,s,l){return e=new Mc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Pc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pa(a),e}function $c(e){if(!e)return jo;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Oo(n))return No(e,n,t)}return t}function Wc(e,t,n,r,o,a,i,s,l){return(e=Uc(n,r,!0,e,0,a,0,s,l)).context=$c(null),n=e.current,(a=Ra(r=tc(),o=nc(n))).callback=null!=t?t:null,Ba(n,a,o),e.current.lanes=o,yt(e,o,r),oc(e,r),e}function Vc(e,t,n,r){var o=t.current,a=tc(),i=nc(o);return n=$c(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ra(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ba(o,t,i))&&(rc(e,o,i,a),Na(e,o,i)),i}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fo.current)bs=!0;else{if(!(e.lanes&n||128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Fs(t),ga();break;case 5:ii(t);break;case 1:Oo(t.type)&&zo(t);break;case 4:oi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Io(xa,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Io(li,1&li.current),t.flags|=128,null):n&t.child.childLanes?Ls(e,t,n):(Io(li,1&li.current),null!==(e=qs(e,t,n))?e.sibling:null);Io(li,1&li.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return Ws(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Io(li,li.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return qs(e,t,n)}(e,t,n);bs=!!(131072&e.flags)}else bs=!1,aa&&1048576&t.flags&&ea(t,Go,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vs(e,t),e=t.pendingProps;var o=Po(t,Ao.current);Ca(t,n),o=Ei(null,t,r,e,o,n);var i=Ci();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oo(r)?(i=!0,zo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Pa(t),o.updater=$a,t.stateNode=o,o._reactInternals=t,Ha(t,r,e,n),t=As(null,t,r,!0,i,n)):(t.tag=0,aa&&i&&ta(t),ws(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Oc(e)?1:0;if(null!=e){if((e=e.$$typeof)===j)return 11;if(e===T)return 14}return 2}(r),e=ya(r,e),o){case 0:t=Is(null,t,r,e,n);break e;case 1:t=js(null,t,r,e,n);break e;case 11:t=Ss(null,t,r,e,n);break e;case 14:t=ks(null,t,r,ya(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Is(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 1:return r=t.type,o=t.pendingProps,js(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 3:e:{if(Fs(t),null===e)throw Error(a(387));r=t.pendingProps,o=(i=t.memoizedState).element,Oa(e,t),La(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ts(e,t,r,n,o=us(Error(a(423)),t));break e}if(r!==o){t=Ts(e,t,r,n,o=us(Error(a(424)),t));break e}for(oa=co(t.stateNode.containerInfo.firstChild),ra=t,aa=!0,ia=null,n=Xa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ga(),r===o){t=qs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return ii(t),null===e&&ua(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==i&&no(r,i)&&(t.flags|=32),_s(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return Ls(e,t,n);case 4:return oi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ja(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ss(e,t,r,o=t.elementType===r?o:ya(r,o),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,s=o.value,Io(xa,r._currentValue),r._currentValue=s,null!==i)if(sr(i.value,s)){if(i.children===o.children&&!Fo.current){t=qs(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Ra(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ea(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ea(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}ws(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Ca(t,n),r=r(o=_a(o)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return o=ya(r=t.type,t.pendingProps),ks(e,t,r,o=ya(r.type,o),n);case 15:return Es(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ya(r,o),Vs(e,t),t.tag=1,Oo(r)?(e=!0,zo(t)):e=!1,Ca(t,n),Va(t,r,o),Ha(t,r,o,n),As(null,t,r,!0,e,n);case 19:return Ws(e,t,n);case 22:return Cs(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"==typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,o){var a=n._reactRootContainer;if(a){var i=a;if("function"==typeof o){var s=o;o=function(){var e=qc(i);s.call(e)}}Vc(t,i,e,o)}else i=function(e,t,n,r,o){if(o){if("function"==typeof r){var a=r;r=function(){var e=qc(i);a.call(e)}}var i=Wc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[ho]=i.current,$r(8===e.nodeType?e.parentNode:e),dc(),i}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof r){var s=r;r=function(){var e=qc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[ho]=l.current,$r(8===e.nodeType?e.parentNode:e),dc((function(){Vc(t,l,n,r)})),l}(n,t,e,o,r);return qc(i)}Qc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vc(e,t,null,null)},Qc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Vc(null,e,null,null)})),t[ho]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&zt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(xt(t,1|n),oc(t,Je()),!(6&Al)&&(Wl=Je()+500,Wo()))}break;case 13:dc((function(){var t=Fa(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Gc(e,1)}},St=function(e){if(13===e.tag){var t=Fa(e,134217728);if(null!==t)rc(t,e,134217728,tc());Gc(e,134217728)}},kt=function(e){if(13===e.tag){var t=nc(e),n=Fa(e,t);if(null!==n)rc(n,e,t,tc());Gc(e,t)}},Et=function(){return vt},Ct=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=So(r);if(!o)throw Error(a(90));G(r),X(r,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},je=uc,Ae=dc;var tu={usingClientEntryPoint:!1,Events:[bo,wo,So,_e,Ie,uc]},nu={findFiberByHostInstance:vo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{ot=ou.inject(ru),at=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(a(299));var n=!1,r="",o=Kc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,o),e[ho]=t.current,$r(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(a(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",s=Kc;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,o,0,i,s),e[ho]=t.current,$r(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Qc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(a(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[ho]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},338:(e,t,n)=>{var r=n(961);t.H=r.createRoot,r.hydrateRoot},961:(e,t,n)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(551)},799:(e,t)=>{
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.suspense_list"):60120,h=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,x=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case a:case s:case i:case p:return e;default:switch(e=e&&e.$$typeof){case c:case f:case m:case h:case l:return e;default:return t}}case o:return t}}}function S(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=f,t.Fragment=a,t.Lazy=m,t.Memo=h,t.Portal=o,t.Profiler=s,t.StrictMode=i,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||w(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===f},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===h},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===i},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===i||e===p||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===h||e.$$typeof===l||e.$$typeof===c||e.$$typeof===f||e.$$typeof===x||e.$$typeof===v||e.$$typeof===b||e.$$typeof===y)},t.typeOf=w},363:(e,t,n)=>{e.exports=n(799)},989:(e,t)=>{var n,r=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");
/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case a:case s:case i:case f:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case h:case g:case l:return e;default:return t}}case o:return t}}}n=Symbol.for("react.module.reference")},737:(e,t,n)=>{n(989)},20:(e,t,n)=>{
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},287:(e,t)=>{
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function x(){}function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=y.prototype;var b=v.prototype=new x;b.constructor=v,h(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var o,a={},i=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)S.call(t,o)&&!E.hasOwnProperty(o)&&(a[o]=t[o]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===a[o]&&(a[o]=l[o]);return{$$typeof:n,type:e,key:i,ref:s,props:a,_owner:k.current}}function _(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function j(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,o,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+j(l,0):a,w(i)?(o="",null!=e&&(o=e.replace(I,"$&/")+"/"),A(i,t,o,"",(function(e){return e}))):null!=i&&(_(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(I,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+j(s=e[c],c);l+=A(s,t,o,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=A(s=s.value,t,o,u=a+j(s,c++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function F(e,t,n){if(null==e)return e;var r=[],o=0;return A(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},O={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};function B(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:F,forEach:function(e,t,n){F(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return F(e,(function(){t++})),t},toArray:function(e){return F(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=o,t.Profiler=i,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=B,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=h({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!E.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=B,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},540:(e,t,n)=>{e.exports=n(287)},848:(e,t,n)=>{e.exports=n(20)},463:(e,t)=>{
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,f=null,p=3,g=!1,h=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,b(e),!h)if(null!==r(c))h=!0,O(S);else{var t=r(u);null!==t&&R(w,t.startTime-e)}}function S(e,n){h=!1,m&&(m=!1,x(_),_=-1),g=!0;var a=p;try{for(b(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!A());){var i=f.callback;if("function"==typeof i){f.callback=null,p=f.priorityLevel;var s=i(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?f.callback=s:f===r(c)&&o(c),b(n)}else o(c);f=r(c)}if(null!==f)var l=!0;else{var d=r(u);null!==d&&R(w,d.startTime-n),l=!1}return l}finally{f=null,p=a,g=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,E=!1,C=null,_=-1,I=5,j=-1;function A(){return!(t.unstable_now()-j<I)}function F(){if(null!==C){var e=t.unstable_now();j=e;var n=!0;try{n=C(!0,e)}finally{n?k():(E=!1,C=null)}}else E=!1}if("function"==typeof v)k=function(){v(F)};else if("undefined"!=typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=F,k=function(){P.postMessage(null)}}else k=function(){y(F,0)};function O(e){C=e,E||(E=!0,k())}function R(e,n){_=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){h||g||(h=!0,O(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>i?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(m?(x(_),_=-1):m=!0,R(w,a-i))):(e.sortIndex=s,n(c,e),h||g||(h=!0,O(S))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},982:(e,t,n)=>{e.exports=n(463)},63:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,i=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return s((function(){o.value=n,o.getSnapshot=t,c(o)&&u({inst:o})}),[e,n,t]),i((function(){return c(o)&&u({inst:o}),e((function(){c(o)&&u({inst:o})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},940:(e,t,n)=>{
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=n(540),o=n(888);var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=o.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=s(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=c((function(){function e(e){if(!l){if(l=!0,i=e,e=r(e),void 0!==o&&f.hasValue){var t=f.value;if(o(t,e))return s=t}return s=e}if(t=s,a(i,e))return t;var n=r(e);return void 0!==o&&o(t,n)?t:(i=e,s=n)}var i,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,o]);var p=i(e,d[0],d[1]);return l((function(){f.hasValue=!0,f.value=p}),[p]),u(p),p}},888:(e,t,n)=>{e.exports=n(63)},242:(e,t,n)=>{e.exports=n(940)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.p="/";var r=n(540),o=n(338),a=n(848),i=n(888),s=n(242),l=n(961);let c=function(e){e()};const u=()=>c,d=(0,r.createContext)(null);function f(){return(0,r.useContext)(d)}let p=()=>{throw new Error("uSES not initialized!")};const g=(e,t)=>e===t;function h(e=d){const t=e===d?f:()=>(0,r.useContext)(e);return function(e,n=g){const{store:o,subscription:a,getServerState:i}=t(),s=p(a.addNestedSub,o.getState,i||o.getState,e,n);return(0,r.useDebugValue)(s),s}}const m=h();n(146),n(737);const y={notify(){},get:()=>[]};function x(e,t){let n,r=y;function o(){i.onStateChange&&i.onStateChange()}function a(){n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){const e=u();let t=null,n=null;return{clear(){t=null,n=null},notify(){e((()=>{let e=t;for(;e;)e.callback(),e=e.next}))},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}())}const i={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=y)},getListeners:()=>r};return i}const v=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement)?r.useLayoutEffect:r.useEffect;let b=null;const w=function({store:e,context:t,children:n,serverState:o}){const a=(0,r.useMemo)((()=>{const t=x(e);return{store:e,subscription:t,getServerState:o?()=>o:void 0}}),[e,o]),i=(0,r.useMemo)((()=>e.getState()),[e]);v((()=>{const{subscription:t}=a;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),i!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[a,i]);const s=t||d;return r.createElement(s.Provider,{value:a},n)};function S(e=d){const t=e===d?f:()=>(0,r.useContext)(e);return function(){const{store:e}=t();return e}}const k=S();function E(e=d){const t=e===d?k:S(e);return function(){return t().dispatch}}const C=E();var _,I;_=s.useSyncExternalStoreWithSelector,p=_,(e=>{b=e})(i.useSyncExternalStore),I=l.unstable_batchedUpdates,c=I;var j,A=function(e){return{type:"SET_CURRENT_PAGE",currentPage:e}};!function(e){e.LanguageLearning="language-learning",e.GeneralTopic="general-topic"}(j||(j={}));var F=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},T=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function P(e){var t=e.examples.map((function(t){return function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r="0.8em");var o=e.replace(t,"<b>".concat(t,"</b>"));if(n){var a=n.split(" ").slice(1).join(" ");return"".concat(o,"<br><span style='font-size: ").concat(r,";'><i>").concat(a,"</i></span>")}return o}(t[0],e.text,t[1])})).join("<br><br>"),n="";if(e.image_base64){var r=e.image_base64;if(r.startsWith("data:")){var o="base64,",a=r.indexOf(o);if(-1!==a){var i=r.substring(a+7);n='<div><img src="data:image/jpeg;base64,'.concat(i,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else n='<div><img src="'.concat(r,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else n='<div><img src="data:image/jpeg;base64,'.concat(r,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}var s="";if(e.linguisticInfo&&e.linguisticInfo.trim()){var l=e.linguisticInfo.trim().split("\n").filter((function(e){return e.trim()})),c="";l.forEach((function(e){var t=e.trim();if(t.match(/^[А-ЯЁA-Z][^:]*:$/))c+='<div style="color: #2563EB; font-weight: bold; margin-top: 12px; margin-bottom: 4px;">'.concat(t,"</div>");else if(t.startsWith("•")||t.startsWith("-")||t.startsWith("*")){var n=t.replace(/^[•\-*]\s*/,"");c+='<div style="margin-left: 16px; margin-bottom: 2px; color: #374151;">• '.concat(n,"</div>")}else if(t.includes(":")&&!t.endsWith(":")){var r=t.split(":"),o=r[0],a=r.slice(1).join(":").trim();c+='<div style="margin-bottom: 4px;"><span style="color: #6B7280; font-weight: 500;">'.concat(o.trim(),':</span> <span style="color: #111827;">').concat(a,"</span></div>")}else t&&(c+='<div style="margin-bottom: 6px; color: #374151; line-height: 1.4;">'.concat(t,"</div>"))})),c&&(s='\n                <div style="margin-top: 20px; padding: 12px; background-color: #F8FAFC; border-left: 4px solid #2563EB; border-radius: 0 6px 6px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n                    <div style="color: #1E40AF; font-weight: bold; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center;">\n                        <span style="margin-right: 6px;">📚</span>\n                        Grammar & Linguistics\n                    </div>\n                    '.concat(c,"\n                </div>\n            "))}return"\n        <b>".concat(e.translation,"</b>\n        <br><br>").concat(t,"<br><br>\n        ").concat(n,"\n        ").concat(s,"\n    ")}function O(e,t){var n=e.replace("Key points:","").trim().split("-").map((function(e){return"<li>".concat(e.trim(),"</li>")})).join(""),r="";if(t){var o=t;if(o.startsWith("data:")){var a="base64,",i=o.indexOf(a);if(-1!==i){var s=o.substring(i+7);r='<div><img src="data:image/jpeg;base64,'.concat(s,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else r='<div><img src="'.concat(o,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else r='<div><img src="data:image/jpeg;base64,'.concat(o,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}return"\n        <b>Key points:</b>\n        <ul>\n            ".concat(n,"\n        </ul>\n        ").concat(r,"\n    ")}var R=function(e,t,n,r,o,a){return F(void 0,void 0,void 0,(function(){var i,s,l,c,u;return T(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),i=JSON.stringify({action:"createDeck",version:6,key:n,params:{deck:r}}),[4,fetch(t,{method:"POST",body:i,headers:{"Content-Type":"application/json"}})];case 1:if(!d.sent().ok)throw new Error("Failed to create deck.");return s=a.map((function(t){var n;if(e===j.LanguageLearning&&"translation"in t&&"examples"in t&&"image_base64"in t)n={Front:t.text,Back:P(t)};else if(e===j.GeneralTopic&&"back"in t){var a=t;n={Front:a.front,Back:O(a.back,a.image_base64)}}return{deckName:r,modelName:o,fields:n,options:{allowDuplicate:!1},tags:[]}})),l=JSON.stringify({action:"addNotes",version:6,key:n,params:{notes:s}}),[4,fetch(t,{method:"POST",body:l,headers:{"Content-Type":"application/json"}})];case 2:if(!(c=d.sent()).ok)throw new Error("Failed to add notes.");return[4,c.json()];case 3:if((u=d.sent()).error)throw new Error("Anki error: ".concat(u.error));return[2,u.result];case 4:throw d.sent();case 5:return[2]}}))}))};function B(e){return F(this,void 0,void 0,(function(){return T(this,(function(t){return[2,new Promise((function(t,n){chrome.runtime.sendMessage(e,(function(e){e.status&&void 0!==e.data?t(e.data):(console.error("Error fetching image:",e.error),n(null))}))}))]}))}))}var N=function(e){return F(void 0,void 0,void 0,(function(){var t,n,r;return T(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch("http://localhost:8765",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deckNames",version:6,key:e})})];case 1:if(!(t=o.sent()).ok)throw new Error("HTTP error! Status: ".concat(t.status));return[4,t.json()];case 2:return(n=o.sent()).result?[2,{result:n.result.map((function(e){return{deckId:e,name:e}})),error:n.error}]:[2,n];case 3:throw r=o.sent(),console.error("Error fetching decks:",r),r;case 4:return[2]}}))}))},z=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},L=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},D="SAVE_ANKI_CARDS",M="SET_TEXT",U="SET_TRANSLATION",$="SET_EXAMPLES",W="SET_IMAGE",V="SET_IMAGE_URL",q="SET_BACK",H="SET_FRONT",G="SAVE_CARD_TO_STORAGE",K="LOAD_STORED_CARDS",Y="DELETE_STORED_CARD",Q="SET_STORED_CARDS",J="UPDATE_CARD_EXPORT_STATUS",X="UPDATE_STORED_CARD",Z="SET_CURRENT_CARD_ID",ee="SET_LINGUISTIC_INFO",te="SET_TRANSCRIPTION",ne="SET_IS_GENERATING_CARD",re=function(e,t,n,r,o,a){return void 0===n&&(n=null),function(i){return z(void 0,void 0,void 0,(function(){var s,l;return L(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,R(e,t,n,r,o,a)];case 1:return s=c.sent(),i({type:D,payload:s}),[3,3];case 2:throw l=c.sent(),console.error("Error saving Anki cards:",l),l;case 3:return[2]}}))}))}},oe=function(e){var t,n,r,o;return console.log("*** ACTION: saveCardToStorage called with card data ***"),console.log("Action payload image info:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imageValue:e.image,imageUrlValue:e.imageUrl,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)}),{type:G,payload:e}},ae=function(){return{type:K}},ie=function(e){return{type:M,payload:e}},se=function(e){return{type:$,payload:e}},le=function(e){return{type:U,payload:e}},ce=function(e){return{type:W,payload:e}},ue=function(e){return{type:V,payload:e}},de=function(e){return{type:q,payload:e}},fe=function(e){return{type:H,payload:e}},pe=function(e,t){return{type:J,payload:{cardId:e,status:t}}},ge=function(e){var t,n,r,o;return console.log("*** ACTION: updateStoredCard called ***"),console.log("Updated card image info:",{cardId:e.id,hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imageValue:e.image,imageUrlValue:e.imageUrl,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)}),{type:X,payload:e}},he=function(e){return{type:Z,payload:e}},me=function(e){return{type:ee,payload:e}},ye=function(e){return{type:te,payload:e}},xe=function(e){return{type:ne,payload:e}},ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},be=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},we=function(e){if(!e||!e.error)return"Unknown OpenAI API error";var t=e.error,n=t.message,r=t.type,o=t.code,a="";return a="insufficient_quota"===o?"Your OpenAI account has exceeded its quota.\n\nPlease check your billing details or use a different API key.":"invalid_request_error"===r?"Invalid request to OpenAI.\n\nPlease check your API key and settings.":"rate_limit_exceeded"===r?"OpenAI rate limit exceeded.\n\nPlease try again in a few minutes.":"OpenAI API Error: ".concat(n||"Unknown error"),a+="\n\nDetails:\n- Type: ".concat(r||"unknown","\n- Code: ").concat(o||"none")},Se=function(e,t,n,r){return void 0===n&&(n="ru"),void 0===r&&(r=""),ve(void 0,void 0,void 0,(function(){var o,a,i,s,l,c,u,d,f,p,g;return be(this,(function(h){switch(h.label){case 0:if(h.trys.push([0,5,,6]),!e)throw new Error("OpenAI API key is missing. Please check your settings.");return o="Translate the following text to ".concat(n),a=r?"".concat(o,". ").concat(r):o,i={model:"gpt-4o-mini",messages:[{role:"system",content:a},{role:"user",content:"".concat(t)}],max_tokens:900},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(i)})];case 1:return(s=h.sent()).ok?[3,3]:[4,s.json()];case 2:if((l=h.sent())&&l.error)throw new Error(we(l));throw new Error("OpenAI API error: ".concat(s.status," ").concat(s.statusText));case 3:return[4,s.json()];case 4:return c=h.sent(),[2,null!==(g=null===(p=null===(f=null===(d=c.choices[0])||void 0===d?void 0:d.message)||void 0===f?void 0:f.content)||void 0===p?void 0:p.trim())&&void 0!==g?g:null];case 5:throw u=h.sent(),console.error("Error during translation:",u),u;case 6:return[2]}}))}))},ke=function(e,t,n,r,o){return void 0===r&&(r=!1),void 0===o&&(o=""),ve(void 0,void 0,void 0,(function(){var a,i,s,l,c,u,d,f,p,g,h,m,y,x,v,b,w,S,k,E;return be(this,(function(C){switch(C.label){case 0:if(!e)throw new Error("OpenAI API key is missing. Please check your settings.");a=o.replace(/\{word\}/g,t),i="Give me three example sentences using the word '".concat(t,"' in the original language (the language of this word). \nEach example should show natural usage of '").concat(t,"' in its native language context.\nReturn ONLY the examples, one per line, without any numbering, explanations, or translations."),s=o?"".concat(i," ").concat(a):i,l=[{role:"system",content:s}],C.label=1;case 1:return C.trys.push([1,13,,14]),c={model:"gpt-4o-mini",messages:l,max_tokens:3500},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(c)})];case 2:return(u=C.sent()).ok?[3,4]:[4,u.json()];case 3:if((d=C.sent())&&d.error)throw new Error(we(d));throw new Error("Could not generate examples. OpenAI API error: ".concat(u.status," ").concat(u.statusText));case 4:return[4,u.json()];case 5:f=C.sent(),p=null===(k=null===(S=f.choices[0])||void 0===S?void 0:S.message)||void 0===k?void 0:k.content,g=null!==(E=null==p?void 0:p.trim().split("\n"))&&void 0!==E?E:[],h=[],m=0,y=g,C.label=6;case 6:if(!(m<y.length))return[3,12];if(!(x=y[m]).trim())return[3,11];if(v=null,!r)return[3,10];C.label=7;case 7:return C.trys.push([7,9,,10]),[4,Se(e,x,n)];case 8:return v=C.sent(),[3,10];case 9:return b=C.sent(),console.error("Error translating example:",b),[3,10];case 10:h.push([x,v]),C.label=11;case 11:return m++,[3,6];case 12:if(0===h.length)throw new Error("Could not generate examples. Please try again with a different word or check your API key.");return[2,h];case 13:throw w=C.sent(),console.error("Error during getting examples:",w),w;case 14:return[2]}}))}))},Ee=function(e,t){return ve(void 0,void 0,void 0,(function(){var n,r,o,a,i,s,l,c,u,d;return be(this,(function(f){switch(f.label){case 0:if(!e)throw new Error("OpenAI API key is missing. Please check your settings.");n=[{role:"system",content:"Is the word '".concat(t,"' an abstract concept or a concrete object? Answer 'abstract' or 'concrete':")}],f.label=1;case 1:return f.trys.push([1,6,,7]),r={model:"gpt-4o-mini",messages:n,max_tokens:900},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(r)})];case 2:return(o=f.sent()).ok?[3,4]:[4,o.json()];case 3:if((a=f.sent())&&a.error)throw new Error(we(a));throw new Error("OpenAI API error: ".concat(o.status," ").concat(o.statusText));case 4:return[4,o.json()];case 5:return i=f.sent(),[2,"abstract"===(null!==(d=null===(u=null===(c=null===(l=i.choices[0])||void 0===l?void 0:l.message)||void 0===c?void 0:c.content)||void 0===u?void 0:u.trim().toLowerCase())&&void 0!==d?d:"")];case 6:return s=f.sent(),console.error("Error during determining abstractness:",s),[2,!1];case 7:return[2]}}))}))},Ce=function(e,t,n){return void 0===n&&(n=""),ve(void 0,void 0,void 0,(function(){var r,o,a,i,s,l,c,u,d,f,p,g,h;return be(this,(function(m){switch(m.label){case 0:if(!e)throw new Error("OpenAI API key is missing. Please check your settings.");r="Provide a detailed description for an image that represents the concept of '".concat(t,"'"),o=n?"".concat(r,". ").concat(n):r,a=[{role:"system",content:o}],m.label=1;case 1:return m.trys.push([1,6,,7]),i={model:"gpt-4o-mini",messages:a,max_tokens:100},[4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(i)})];case 2:return(s=m.sent()).ok?[3,4]:[4,s.json()];case 3:if((l=m.sent())&&l.error)throw new Error(we(l));throw new Error("Could not generate image description. OpenAI API error: ".concat(s.status," ").concat(s.statusText));case 4:return[4,s.json()];case 5:if(c=m.sent(),!(u=null!==(h=null===(g=null===(p=null===(f=c.choices[0])||void 0===f?void 0:f.message)||void 0===p?void 0:p.content)||void 0===g?void 0:g.trim())&&void 0!==h?h:""))throw new Error("Could not generate a valid image description. Please try again.");return[2,u];case 6:throw d=m.sent(),console.error("Error during getting description image:",d),d;case 7:return[2]}}))}))},_e=function(e,t,n){return void 0===n&&(n=""),ve(void 0,void 0,void 0,(function(){var r,o,a,i,s,l,c;return be(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),r=n?"".concat(t,". ").concat(n):t,[4,e.images.generate({prompt:r,n:1,size:"512x512",response_format:"url"})];case 1:if(!(o=u.sent()).data||!(null===(c=o.data[0])||void 0===c?void 0:c.url))throw new Error("OpenAI did not return an image URL. Please try again.");return[2,o.data[0].url];case 2:if(a=u.sent(),console.error("Error during image generation:",a),a instanceof Error){if((i=a.message||"").includes("quota")||i.includes("billing"))throw new Error("Your OpenAI account has exceeded its quota.\n\nPlease check your billing details or use a different API key.");if(i.includes("rate limit"))throw new Error("OpenAI rate limit exceeded.\n\nPlease try again in a few minutes.");if(i.includes("invalid API key"))throw new Error("Invalid OpenAI API key.\n\nPlease check your API key in settings.");if(i.includes("moderation")||i.includes("policy"))throw new Error("OpenAI content policy violation.\n\nThe image request was flagged for content policy violation. Please modify your request.");if(i.includes("{")&&i.includes("}"))try{if(s=i.substring(i.indexOf("{"),i.lastIndexOf("}")+1),(l=JSON.parse(s))&&l.error)return[2,we(l)]}catch(e){}throw a}throw new Error("Failed to generate image.\n\nPlease check your OpenAI API key and try again.");case 3:return[2]}}))}))},Ie=function(e,t,n,r){return void 0===r&&(r=""),ve(void 0,void 0,void 0,(function(){var o,a,i;return be(this,(function(s){switch(s.label){case 0:if(!t)throw new Error("OpenAI API key is missing. Please check your settings.");s.label=1;case 1:return s.trys.push([1,8,,9]),[4,Ee(t,n)];case 2:return s.sent()?[4,Ce(t,n,r)]:[3,5];case 3:return o=s.sent(),[4,_e(e,"Create a vivid, high-quality illustration representing the concept of '".concat(o,"'"),r)];case 4:return[2,s.sent()];case 5:return a="Create a high-quality, photorealistic image of a ".concat(n," with a neutral expression and clear features"),[4,_e(e,a,r)];case 6:return[2,s.sent()];case 7:return[3,9];case 8:if(i=s.sent(),console.error("Error during getting image for word:",i),i instanceof Error){if(i.message.includes("OpenAI API Error")||i.message.includes("exceeded its quota")||i.message.includes("rate limit")||i.message.includes("API key"))throw i;throw new Error('Failed to generate image for "'.concat(n,'". ').concat(i.message))}throw new Error('Failed to generate image for "'.concat(n,'". Please check your OpenAI API key and try again.'));case 9:return[2]}}))}))},je="SET_OPEN_AI_KEY",Ae="SET_SELECTED_MODE",Fe="SET_TRANSLATE_TO_LANGUAGE",Te="SET_ANKI_CONNECT_URL",Pe="SET_ANKI_CONNECT_API_KEY",Oe="SET_USE_ANKI_CONNECT",Re="SET_VISIBLE_SIDEBAR",Be="SET_SHOULD_GENERATE_IMAGE",Ne="SET_IMAGE_GENERATION_MODE",ze="SET_TRANSLATION_PROMPT",Le="SET_EXAMPLES_PROMPT",De="SET_AI_INSTRUCTIONS",Me="SET_IMAGE_INSTRUCTIONS",Ue="SET_MODEL_PROVIDER",$e="SET_GROQ_API_KEY",We="SET_GROQ_MODEL_NAME",Ve="SET_SOURCE_LANGUAGE",qe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},He=r.createContext&&r.createContext(qe),Ge=function(){return Ge=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ge.apply(this,arguments)},Ke=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function Ye(e){return e&&e.map((function(e,t){return r.createElement(e.tag,Ge({key:t},e.attr),Ye(e.child))}))}function Qe(e){return function(t){return r.createElement(Je,Ge({attr:Ge({},e.attr)},t),Ye(e.child))}}function Je(e){var t=function(t){var n,o=e.attr,a=e.size,i=e.title,s=Ke(e,["attr","size","title"]),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",Ge({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,s,{className:n,style:Ge(Ge({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&r.createElement("title",null,i),e.children)};return void 0!==He?r.createElement(He.Consumer,null,(function(e){return t(e)})):t(qe)}function Xe(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function Ze(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}}]})(e)}function et(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"}}]})(e)}function tt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}}]})(e)}function nt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}}]})(e)}function rt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}}]})(e)}function ot(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"}}]})(e)}function at(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(e)}function it(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(e)}function st(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(e)}function lt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z"}}]})(e)}function ct(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"}}]})(e)}function ut(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"}}]})(e)}function dt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"}}]})(e)}function ft(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"}}]})(e)}function pt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}}]})(e)}function gt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M152.1 236.2c-3.5-12.1-7.8-33.2-7.8-33.2h-.5s-4.3 21.1-7.8 33.2l-11.1 37.5H163zM616 96H336v320h280c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm-24 120c0 6.6-5.4 12-12 12h-11.4c-6.9 23.6-21.7 47.4-42.7 69.9 8.4 6.4 17.1 12.5 26.1 18 5.5 3.4 7.3 10.5 4.1 16.2l-7.9 13.9c-3.4 5.9-10.9 7.8-16.7 4.3-12.6-7.8-24.5-16.1-35.4-24.9-10.9 8.7-22.7 17.1-35.4 24.9-5.8 3.5-13.3 1.6-16.7-4.3l-7.9-13.9c-3.2-5.6-1.4-12.8 4.2-16.2 9.3-5.7 18-11.7 26.1-18-7.9-8.4-14.9-17-21-25.7-4-5.7-2.2-13.6 3.7-17.1l6.5-3.9 7.3-4.3c5.4-3.2 12.4-1.7 16 3.4 5 7 10.8 14 17.4 20.9 13.5-14.2 23.8-28.9 30-43.2H412c-6.6 0-12-5.4-12-12v-16c0-6.6 5.4-12 12-12h64v-16c0-6.6 5.4-12 12-12h16c6.6 0 12 5.4 12 12v16h64c6.6 0 12 5.4 12 12zM0 120v272c0 13.3 10.7 24 24 24h280V96H24c-13.3 0-24 10.7-24 24zm58.9 216.1L116.4 167c1.7-4.9 6.2-8.1 11.4-8.1h32.5c5.1 0 9.7 3.3 11.4 8.1l57.5 169.1c2.6 7.8-3.1 15.9-11.4 15.9h-22.9a12 12 0 0 1-11.5-8.6l-9.4-31.9h-60.2l-9.1 31.8c-1.5 5.1-6.2 8.7-11.5 8.7H70.3c-8.2 0-14-8.1-11.4-15.9z"}}]})(e)}function ht(e){return Qe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"}}]})(e)}function mt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(e)}function yt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"}}]})(e)}function xt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"}}]})(e)}function vt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(e)}function bt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function wt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"}}]})(e)}function St(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"}}]})(e)}function kt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function Et(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(e)}var Ct=function(){return Ct=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ct.apply(this,arguments)};const _t=function(e){var t=e.size,n=void 0===t?"medium":t,r=e.type,o=void 0===r?"spinner":r,i=e.color,s=void 0===i?"#3B82F6":i,l=e.text,c=e.fullScreen,u=void 0!==c&&c,d=e.overlay,f=void 0!==d&&d,p=e.inline,g=void 0!==p&&p,h={small:{container:"16px",fontSize:"12px",spacing:"8px"},medium:{container:"24px",fontSize:"14px",spacing:"12px"},large:{container:"32px",fontSize:"16px",spacing:"16px"}}[n],m={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:h.spacing,zIndex:1e3};return u&&(m.position="fixed",m.top=0,m.left=0,m.right=0,m.bottom=0),f&&(m.position="absolute",m.top=0,m.left=0,m.right=0,m.bottom=0,m.backgroundColor="rgba(255, 255, 255, 0.8)"),g&&(m.display="inline-flex",m.flexDirection="row",m.marginLeft="8px",m.marginRight="8px"),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("style",{children:["\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n  ","\n    @keyframes pulse {\n      0%, 100% { opacity: 1; transform: scale(1); }\n      50% { opacity: 0.5; transform: scale(0.8); }\n    }\n  ","\n    @keyframes dots1 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n    }\n    @keyframes dots2 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n      animation-delay: 0.2s;\n    }\n    @keyframes dots3 {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n      animation-delay: 0.4s;\n    }\n  "]}),(0,a.jsxs)("div",Ct({style:m},{children:[function(){switch(o){case"spinner":return(0,a.jsx)("div",{style:{width:h.container,height:h.container,border:"2px solid ".concat(s),borderTopColor:"transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite"}});case"pulse":return(0,a.jsx)("div",{style:{width:h.container,height:h.container,backgroundColor:s,borderRadius:"50%",animation:"pulse 1.2s ease-in-out infinite"}});case"dots":return(0,a.jsx)("div",Ct({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"}},{children:[1,2,3].map((function(e){return(0,a.jsx)("div",{style:{width:"calc(".concat(h.container," / 3)"),height:"calc(".concat(h.container," / 3)"),backgroundColor:s,borderRadius:"50%",animation:"dots".concat(e," 1.4s infinite ease-in-out both"),animationDelay:"".concat(.2*(e-1),"s")}},e)}))}));default:return null}}(),l&&(0,a.jsx)("div",Ct({style:{color:s,fontSize:h.fontSize,fontWeight:500,textAlign:"center"}},{children:l}))]}))]})};var It=function(){return It=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},It.apply(this,arguments)};const jt=function(e){var t=e.content,n=e.isEditable,r=void 0!==n&&n,o=e.onEditClick;return(0,a.jsxs)("div",It({className:"grammar-card-container",style:{position:"relative"},onClick:function(e){e.stopPropagation()}},{children:[(0,a.jsx)("div",{className:"grammar-card grammar-reference",dangerouslySetInnerHTML:{__html:t||""},onClick:function(e){e.stopPropagation()}}),r&&o&&(0,a.jsxs)("button",It({onClick:function(e){e.stopPropagation(),o()},style:{position:"absolute",top:"8px",right:"8px",background:"rgba(255, 255, 255, 0.8)",border:"1px solid #E5E7EB",color:"#3B82F6",fontSize:"12px",padding:"4px 8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:[(0,a.jsx)(st,{size:12}),"Edit"]}))]}))};var At=function(){return At=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},At.apply(this,arguments)},Ft=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const Tt=function(e){var t=e.front,n=e.translation,o=e.examples,i=e.imageUrl,s=(e.image,e.linguisticInfo),l=e.transcription,c=e.onNewImage,u=e.onNewExamples,d=e.onAccept,f=e.onViewSavedCards,p=e.onCancel,g=e.mode,h=(void 0===g&&j.LanguageLearning,e.loadingNewImage),m=e.loadingNewExamples,y=e.loadingAccept,x=e.loadingGetResult,v=void 0!==x&&x,b=(e.shouldGenerateImage,e.isSaved),w=void 0!==b&&b,S=(e.isEdited,e.isGeneratingCard),k=e.setTranslation,E=e.setExamples,C=e.setLinguisticInfo,_=(0,r.useState)(!1),I=_[0],A=_[1],F=(0,r.useState)(n||""),T=F[0],P=F[1],O=(0,r.useState)(!1),R=O[0],B=O[1],N=(0,r.useState)(!0),z=(N[0],N[1],(0,r.useState)(!0)),L=z[0],D=z[1];(0,r.useEffect)((function(){P(n||"")}),[n]),(0,r.useEffect)((function(){ae(s||"")}),[s]);var M=function(){B(!0)},U=function(){if(I&&k&&(k(T),A(!1)),null!==K&&E){var e=Ft([],o,!0);e[K]=[J,Z],E(e),Y(null)}te&&C&&(C(oe),ne(!1)),w&&d(),B(!1)},$=function(){R&&(A(!0),P(n||""))},W=function(){k&&k(T),A(!1)},V=function(e,t,n){if(R&&E&&o){var r=Ft([],o,!0);t?r[e][0]=n:r[e][1]=n||null,E(r)}},q=(0,r.useState)(!1),H=(q[0],q[1],(0,r.useState)(n||"")),G=(H[0],H[1],(0,r.useState)(null)),K=G[0],Y=G[1],Q=(0,r.useState)(""),J=Q[0],X=(Q[1],(0,r.useState)("")),Z=X[0],ee=(X[1],(0,r.useState)(!1)),te=ee[0],ne=ee[1],re=(0,r.useState)(s||""),oe=re[0],ae=re[1];return(0,a.jsxs)("div",At({style:{padding:"16px",borderRadius:"8px",width:"100%",maxWidth:"100%",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",overflowX:"hidden",backgroundColor:R?"#FAFAFA":"#ffffff",borderLeft:R?"3px solid #3B82F6":"3px solid transparent"}},{children:[(0,a.jsxs)("div",At({style:{fontSize:"10px",color:"#9CA3AF",marginBottom:"12px",textAlign:"right",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"4px",padding:"4px 8px",backgroundColor:R?"#EFF6FF":w?"#ECFDF5":"#F9FAFB",borderRadius:"4px",border:R?"1px solid #DBEAFE":w?"1px solid #D1FAE5":"1px solid #F3F4F6"}},{children:[(0,a.jsx)("span",{style:{display:"inline-block",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:R?"#3B82F6":w?"#10B981":"#6B7280"}}),(0,a.jsx)("strong",At({style:{color:R?"#1E40AF":w?"#059669":"#4B5563"}},{children:R?"Editing":w?"Saved to Collection":"New - Not Saved Yet"}))]})),R?(0,a.jsxs)("button",At({onClick:U,disabled:y,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",padding:"10px 12px",fontSize:"14px",fontWeight:"600",cursor:"pointer",marginBottom:"12px",width:"100%",opacity:y?.7:1},onMouseOver:function(e){return!y&&(e.currentTarget.style.backgroundColor="#2563EB")},onMouseOut:function(e){return!y&&(e.currentTarget.style.backgroundColor="#3B82F6")}},{children:[(0,a.jsx)(bt,{size:14}),y?(0,a.jsx)("div",At({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving"})})):w?"Save & Finish Editing":"Finish Editing"]})):R?null:(0,a.jsxs)("button",At({onClick:M,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 12px",fontSize:"14px",fontWeight:"600",cursor:"pointer",marginBottom:"12px",width:"100%"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#1F2937"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"}},{children:[(0,a.jsx)(st,{size:14}),"Edit Card"]})),R?(0,a.jsxs)("div",At({style:{marginBottom:"16px",backgroundColor:"#EFF6FF",borderRadius:"6px",padding:"10px",border:"1px solid #DBEAFE",fontSize:"13px",color:"#1E40AF"}},{children:[(0,a.jsxs)("div",At({style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px",fontWeight:"600"}},{children:[(0,a.jsx)(st,{size:12}),"Editing Mode"]})),(0,a.jsxs)("p",At({style:{margin:0,fontSize:"12px"}},{children:['Click on text elements to edit them. When finished, click "',w?"Save & Finish Editing":"Finish Editing",'" at the top of the card.']}))]})):null,t&&(0,a.jsx)("div",At({style:{marginBottom:"12px"}},{children:t.includes("/")?function(){var e,n=t.split(/\s*\//),r=(null===(e=n[0])||void 0===e?void 0:e.trim())||"",o=n.length>1?"/".concat(n.slice(1).join("/").replace(/\/$/,"")):"";return(0,a.jsxs)("div",At({style:{textAlign:"center",padding:"12px",backgroundColor:"#F3F4F6",borderRadius:"8px"}},{children:[(0,a.jsx)("h3",At({style:{fontSize:"20px",fontWeight:"700",margin:"0 0 6px 0",color:"#111827"}},{children:r})),o&&(0,a.jsx)("div",At({style:{fontSize:"14px",color:"#6B7280",fontStyle:"italic"}},{children:o}))]}))}():(0,a.jsx)("h3",At({style:{fontSize:"18px",fontWeight:"600",textAlign:"center",margin:"2px 0",color:"#111827",padding:"10px",backgroundColor:"#F3F4F6",borderRadius:"8px"}},{children:t}))})),l&&(0,a.jsx)("div",At({style:{marginBottom:"12px",textAlign:"center",padding:"8px 12px",backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0",borderRadius:"6px"}},{children:(0,a.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.6",color:"#475569"},dangerouslySetInnerHTML:{__html:l}})})),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"10px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),I&&R?(0,a.jsxs)("div",At({style:{marginBottom:"12px",position:"relative"}},{children:[(0,a.jsx)("input",{type:"text",value:T,onChange:function(e){return P(e.target.value)},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #3B82F6",backgroundColor:"#ffffff",color:"#111827",fontSize:"14px",outline:"none",fontWeight:"600",textAlign:"center"},autoFocus:!0,onBlur:W,onKeyDown:function(e){"Enter"===e.key&&W()}}),(0,a.jsx)("div",At({style:{fontSize:"11px",color:"#6B7280",textAlign:"center",marginTop:"4px"}},{children:"Press Enter or click outside to save"}))]})):(0,a.jsxs)("div",At({style:At({marginBottom:"12px",textAlign:"center",position:"relative",paddingRight:R?"24px":"0"},R?{padding:"8px",border:"1px dashed #E5E7EB",borderRadius:"4px",transition:"all 0.2s ease",cursor:"pointer",backgroundColor:"#FAFAFA"}:{}),onClick:R?$:void 0,onMouseOver:function(e){R&&(e.currentTarget.style.borderColor="#3B82F6",e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){R&&(e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.backgroundColor="#FAFAFA")}},{children:[(0,a.jsx)("p",At({style:{fontWeight:"600",color:"#111827",fontSize:"14px",margin:0}},{children:n})),R&&(0,a.jsx)("button",At({onClick:function(e){e.stopPropagation(),$()},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#F3F4F6",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6B7280",display:"flex",padding:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},title:"Edit translation",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#3B82F6"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#6B7280"}},{children:(0,a.jsx)(xt,{size:12})}))]}))]}),s&&(0,a.jsxs)("div",At({style:{marginTop:"12px",marginBottom:"16px",borderRadius:"10px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",border:"1px solid",borderColor:L?"#BFDBFE":"#E5E7EB",backgroundColor:L?"#EFF6FF":"#F9FAFB",transition:"all 0.3s ease",overflow:"hidden"}},{children:[(0,a.jsxs)("div",At({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:L?"1px solid #BFDBFE":"none",transition:"background-color 0.2s"}},{children:[(0,a.jsxs)("div",At({style:{display:"flex",alignItems:"center",gap:"10px",fontWeight:600,fontSize:"14px",color:L?"#1D4ED8":"#4B5563",flex:1}},{children:[(0,a.jsx)(dt,{size:16,color:L?"#2563EB":"#6B7280"}),(0,a.jsx)("span",{children:"Grammar & Linguistics"})]})),(0,a.jsx)("button",At({onClick:function(e){e.stopPropagation(),D(!L)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="rgba(0,0,0,0.05)"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"}},{children:L?(0,a.jsx)(rt,{size:14,color:"#6B7280"}):(0,a.jsx)(et,{size:14,color:"#6B7280"})}))]})),L&&(0,a.jsx)("div",At({style:{padding:"16px"}},{children:te?(0,a.jsxs)("div",At({style:{width:"100%"}},{children:[(0,a.jsx)("textarea",{value:oe,onChange:function(e){ae(e.target.value)},style:{width:"100%",minHeight:"120px",padding:"10px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",lineHeight:"1.5",resize:"vertical",marginBottom:"8px"}}),(0,a.jsxs)("div",At({style:{display:"flex",justifyContent:"flex-end",gap:"8px"}},{children:[(0,a.jsx)("button",At({onClick:function(){ae(s||""),ne(!1)},style:{padding:"6px 12px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"13px",cursor:"pointer"}},{children:"Cancel"})),(0,a.jsx)("button",At({onClick:function(){C&&C(oe),ne(!1)},style:{padding:"6px 12px",backgroundColor:"#2563EB",color:"white",border:"none",borderRadius:"6px",fontSize:"13px",cursor:"pointer"}},{children:"Save"}))]}))]})):(0,a.jsx)("div",At({style:{position:"relative"}},{children:(0,a.jsx)(jt,{content:s||"",isEditable:R,onEditClick:function(){return ne(!0)}})}))}))]})),o.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"10px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),(0,a.jsxs)("div",At({style:{marginBottom:"12px"}},{children:[(0,a.jsx)("div",At({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}},{children:(0,a.jsx)("h4",At({style:{fontSize:"14px",fontWeight:"600",color:"#374151",margin:0}},{children:"Examples"}))})),(0,a.jsx)("ul",At({style:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"8px"}},{children:o.map((function(e,t){var n=e[0],r=e[1];return(0,a.jsxs)("li",At({style:At({padding:"12px",backgroundColor:"#F9FAFB",borderRadius:"6px",position:"relative",minHeight:"auto",wordWrap:"break-word",overflow:"visible"},R?{border:"1px dashed #CBD5E1",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}:{})},{children:[R&&(0,a.jsx)("div",At({style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"8px",zIndex:5}},{children:(0,a.jsxs)("button",At({onClick:function(){return function(e){if(R&&E&&o){var t=Ft([],o,!0);t.splice(e,1),E(t)}}(t)},style:{background:"#FEE2E2",border:"none",borderRadius:"4px",cursor:"pointer",color:"#EF4444",padding:"4px 6px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"500"},title:"Delete example",onMouseOver:function(e){e.currentTarget.style.backgroundColor="#FECACA"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#FEE2E2"}},{children:[(0,a.jsx)(Et,{size:10,style:{marginRight:"4px"}}),"Delete"]}))})),R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",At({style:{marginBottom:"8px"}},{children:(0,a.jsx)("textarea",{value:n,onChange:function(e){return V(t,!0,e.target.value)},style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid #E5E7EB",fontSize:"13px",color:"#111827",fontWeight:"500",backgroundColor:"#ffffff",minHeight:"40px",resize:"vertical",fontFamily:"inherit",lineHeight:"1.4"},placeholder:"Example sentence"})})),(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{value:r||"",onChange:function(e){return V(t,!1,e.target.value)},style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid #E5E7EB",fontSize:"13px",color:"#6B7280",fontStyle:"italic",backgroundColor:"#ffffff",minHeight:"40px",resize:"vertical",fontFamily:"inherit",lineHeight:"1.4"},placeholder:"Translation (optional)"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",At({style:{fontWeight:"500",color:"#111827",fontSize:"13px",marginBottom:r?"6px":0,lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:n})),r&&(0,a.jsx)("div",At({style:{color:"#6B7280",fontSize:"13px",fontStyle:"italic",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:r}))]})]}),t)}))})),R&&(0,a.jsxs)("button",At({onClick:function(){if(R&&E&&o){var e=Ft([],o,!0);e.push(["",null]),E(e)}},style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#EFF6FF",color:"#3B82F6",fontSize:"14px",fontWeight:"500",border:"1px dashed #BFDBFE",cursor:"pointer",marginTop:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#DBEAFE",e.currentTarget.style.borderColor="#93C5FD"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#EFF6FF",e.currentTarget.style.borderColor="#BFDBFE"}},{children:[(0,a.jsx)(vt,{size:12}),"Add Example"]}))]}))]}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #E5E7EB"}}),(0,a.jsx)("div",At({style:{marginBottom:"16px"}},{children:(0,a.jsx)("img",{src:i,alt:"",style:{width:"100%",borderRadius:"6px",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"}})}))]}),!w&&(0,a.jsxs)("div",At({style:{display:"flex",gap:"6px",marginBottom:"8px"}},{children:[i&&(0,a.jsx)("button",At({onClick:c,disabled:h,style:{flex:1,padding:"8px 12px",borderRadius:"6px",backgroundColor:"#F59E0B",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:h?.7:1},onMouseOver:function(e){return!h&&(e.currentTarget.style.backgroundColor="#D97706")},onMouseOut:function(e){return!h&&(e.currentTarget.style.backgroundColor="#F59E0B")}},{children:h?(0,a.jsx)("div",At({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"pulse",size:"small",inline:!0,color:"#ffffff",text:"Generating"})})):"New Image"})),o.length>0&&(0,a.jsx)("button",At({onClick:u,disabled:m,style:{flex:1,padding:"8px 12px",borderRadius:"6px",backgroundColor:"#F59E0B",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:m?.7:1},onMouseOver:function(e){return!m&&(e.currentTarget.style.backgroundColor="#D97706")},onMouseOut:function(e){return!m&&(e.currentTarget.style.backgroundColor="#F59E0B")}},{children:m?(0,a.jsx)("div",At({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"dots",size:"small",inline:!0,color:"#ffffff",text:"Loading"})})):"New Examples"}))]})),(0,a.jsxs)("div",At({style:{marginBottom:"10px"}},{children:[!R&&(!w||S||v)&&(0,a.jsxs)("div",At({style:{display:"flex",gap:"8px",width:"100%"}},{children:[(0,a.jsxs)("button",At({onClick:p,disabled:y,style:{flex:"1",padding:"10px",borderRadius:"6px",backgroundColor:"#F3F4F6",color:"#4B5563",fontWeight:"600",fontSize:"14px",border:"1px solid #E5E7EB",cursor:y?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:y?.7:1},onMouseOver:function(e){y||(e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){y||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563")}},{children:[(0,a.jsx)(kt,{}),S||v?"Cancel Generation":"Cancel"]})),!S&&!v&&(0,a.jsxs)("button",At({onClick:d,disabled:y,style:{flex:"2",padding:"10px",borderRadius:"6px",backgroundColor:"#22C55E",color:"#ffffff",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:y?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(e){return!y&&(e.currentTarget.style.backgroundColor="#15803D")},onMouseOut:function(e){return!y&&(e.currentTarget.style.backgroundColor="#22C55E")}},{children:[(0,a.jsx)(Ze,{}),y?(0,a.jsx)("div",At({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving"})})):"Save Card"]}))]})),!R&&w&&(0,a.jsxs)("div",At({style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#ECFDF5",border:"1px solid #D1FAE5",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)("div",At({style:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10B981",color:"white"}},{children:(0,a.jsx)(Ze,{size:12})})),(0,a.jsx)("span",At({style:{fontWeight:"600",fontSize:"14px",color:"#059669"}},{children:"Saved to Collection"}))]})),!R&&!w&&(0,a.jsx)("p",At({style:{fontSize:"11px",color:"#6B7280",textAlign:"center",margin:"4px 0 0 0"}},{children:"The card will be saved to your collection"}))]})),(0,a.jsxs)("button",At({onClick:f,style:{width:"100%",padding:"10px",borderRadius:"6px",backgroundColor:"#4B5563",color:"#ffffff",fontWeight:"600",fontSize:"13px",border:"none",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#374151"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#4B5563"}},{children:[(0,a.jsx)(mt,{size:14}),"View Saved Cards"]}))]}))},Pt="RFC3986",Ot={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},Rt=(Object.prototype.hasOwnProperty,Array.isArray),Bt=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();const Nt=1024;function zt(e,t){if(Rt(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const Lt=Object.prototype.hasOwnProperty,Dt={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},Mt=Array.isArray,Ut=Array.prototype.push,$t=function(e,t){Ut.apply(e,Mt(t)?t:[t])},Wt=Date.prototype.toISOString,Vt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,o)=>{if(0===e.length)return e;let a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let i="";for(let e=0;e<a.length;e+=Nt){const t=a.length>=Nt?a.slice(e,e+Nt):a,n=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===o&&(40===r||41===r)?n[n.length]=t.charAt(e):r<128?n[n.length]=Bt[r]:r<2048?n[n.length]=Bt[192|r>>6]+Bt[128|63&r]:r<55296||r>=57344?n[n.length]=Bt[224|r>>12]+Bt[128|r>>6&63]+Bt[128|63&r]:(e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),n[n.length]=Bt[240|r>>18]+Bt[128|r>>12&63]+Bt[128|r>>6&63]+Bt[128|63&r])}i+=n.join("")}return i},encodeValuesOnly:!1,format:Pt,formatter:Ot[Pt],indices:!1,serializeDate:e=>Wt.call(e),skipNulls:!1,strictNullHandling:!1};const qt={};function Ht(e,t,n,r,o,a,i,s,l,c,u,d,f,p,g,h,m,y){let x=e,v=y,b=0,w=!1;for(;void 0!==(v=v.get(qt))&&!w;){const t=v.get(e);if(b+=1,void 0!==t){if(t===b)throw new RangeError("Cyclic object value");w=!0}void 0===v.get(qt)&&(b=0)}if("function"==typeof c?x=c(t,x):x instanceof Date?x=f?.(x):"comma"===n&&Mt(x)&&(x=zt(x,(function(e){return e instanceof Date?f?.(e):e}))),null===x){if(a)return l&&!h?l(t,Vt.encoder,m,"key",p):t;x=""}if("string"==typeof(S=x)||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S||function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}(x)){if(l){const e=h?t:l(t,Vt.encoder,m,"key",p);return[g?.(e)+"="+g?.(l(x,Vt.encoder,m,"value",p))]}return[g?.(t)+"="+g?.(String(x))]}var S;const k=[];if(void 0===x)return k;let E;if("comma"===n&&Mt(x))h&&l&&(x=zt(x,l)),E=[{value:x.length>0?x.join(",")||null:void 0}];else if(Mt(c))E=c;else{const e=Object.keys(x);E=u?e.sort(u):e}const C=s?String(t).replace(/\./g,"%2E"):String(t),_=r&&Mt(x)&&1===x.length?C+"[]":C;if(o&&Mt(x)&&0===x.length)return _+"[]";for(let t=0;t<E.length;++t){const v=E[t],w="object"==typeof v&&void 0!==v.value?v.value:x[v];if(i&&null===w)continue;const S=d&&s?v.replace(/\./g,"%2E"):v,C=Mt(x)?"function"==typeof n?n(_,S):_:_+(d?"."+S:"["+S+"]");y.set(e,b);const I=new WeakMap;I.set(qt,y),$t(k,Ht(w,C,n,r,o,a,i,s,"comma"===n&&h&&Mt(x)?null:l,c,u,d,f,p,g,h,m,I))}return k}function Gt(e,t={}){let n=e;const r=function(e=Vt){if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||Vt.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Pt;if(void 0!==e.format){if(!Lt.call(Ot,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=Ot[n];let o,a=Vt.filter;if(("function"==typeof e.filter||Mt(e.filter))&&(a=e.filter),o=e.arrayFormat&&e.arrayFormat in Dt?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":Vt.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=void 0===e.allowDots?1==!!e.encodeDotInKeys||Vt.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:Vt.addQueryPrefix,allowDots:i,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:Vt.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:Vt.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?Vt.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:Vt.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:Vt.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:Vt.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:Vt.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:Vt.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:Vt.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:Vt.strictNullHandling}}(t);let o,a;"function"==typeof r.filter?(a=r.filter,n=a("",n)):Mt(r.filter)&&(a=r.filter,o=a);const i=[];if("object"!=typeof n||null===n)return"";const s=Dt[r.arrayFormat],l="comma"===s&&r.commaRoundTrip;o||(o=Object.keys(n)),r.sort&&o.sort(r.sort);const c=new WeakMap;for(let e=0;e<o.length;++e){const t=o[e];r.skipNulls&&null===n[t]||$t(i,Ht(n[t],t,s,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const u=i.join(r.delimiter);let d=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Kt="4.100.0";let Yt,Qt,Jt,Xt,Zt,en,tn,nn,rn,on=!1,an=null,sn=null,ln=null,cn=null;class un{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}const dn=()=>{Yt||function(e,t={auto:!1}){if(on)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Yt)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Yt}'\``);on=t.auto,Yt=e.kind,Qt=e.fetch,an=e.Request,sn=e.Response,ln=e.Headers,Jt=e.FormData,cn=e.Blob,Xt=e.File,Zt=e.ReadableStream,en=e.getMultipartRequestOptions,tn=e.getDefaultAgent,nn=e.fileFromPath,rn=e.isFsReadStream}(function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,o,a;try{n=fetch,r=Request,o=Response,a=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:o,Headers:a,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new un(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0})};dn();class fn extends Error{}class pn extends fn{constructor(e,t,n,r){super(`${pn.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t;const o=t;this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(e,t,n){const r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new hn({message:n,cause:hr(t)});const o=t?.error;return 400===e?new yn(e,o,n,r):401===e?new xn(e,o,n,r):403===e?new vn(e,o,n,r):404===e?new bn(e,o,n,r):409===e?new wn(e,o,n,r):422===e?new Sn(e,o,n,r):429===e?new kn(e,o,n,r):e>=500?new En(e,o,n,r):new pn(e,o,n,r)}}class gn extends pn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class hn extends pn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class mn extends hn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class yn extends pn{}class xn extends pn{}class vn extends pn{}class bn extends pn{}class wn extends pn{}class Sn extends pn{}class kn extends pn{}class En extends pn{}class Cn extends fn{constructor(){super("Could not parse response content as the length limit was reached")}}class _n extends fn{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var In,jn=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},An=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Fn{constructor(){In.set(this,void 0),this.buffer=new Uint8Array,jn(this,In,null,"f")}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?(new TextEncoder).encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let o;for(;null!=(o=Tn(this.buffer,An(this,In,"f")));){if(o.carriage&&null==An(this,In,"f")){jn(this,In,o.index,"f");continue}if(null!=An(this,In,"f")&&(o.index!==An(this,In,"f")+1||o.carriage)){r.push(this.decodeText(this.buffer.slice(0,An(this,In,"f")-1))),this.buffer=this.buffer.slice(An(this,In,"f")),jn(this,In,null,"f");continue}const e=null!==An(this,In,"f")?o.preceding-1:o.preceding,t=this.decodeText(this.buffer.slice(0,e));r.push(t),this.buffer=this.buffer.slice(o.index),jn(this,In,null,"f")}return r}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new fn(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new fn(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new fn("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function Tn(e,t){for(let n=t??0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function Pn(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}function On(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}In=new WeakMap,Fn.NEWLINE_CHARS=new Set(["\n","\r"]),Fn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Rn{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new Rn((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(e,t){if(!e.body)throw t.abort(),new fn("Attempted to iterate over a response with no body");const n=new Bn,r=new Fn,o=On(e.body);for await(const e of async function*(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,o=new Uint8Array(t.length+e.length);for(o.set(t),o.set(e,t.length),t=o;-1!==(r=Pn(t));)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}(o))for(const t of r.decode(e)){const e=n.decode(t);e&&(yield e)}for(const e of r.flush()){const t=n.decode(e);t&&(yield t)}}(e,t))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let t;try{t=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if(t&&t.error)throw new pn(void 0,t.error,void 0,nr(e.headers));yield t}else{let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new pn(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}static fromReadableStream(e,t){let n=!1;return new Rn((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const t of async function*(){const t=new Fn,n=On(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}())r||t&&(yield JSON.parse(t));r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new Rn((()=>r(e)),this.controller),new Rn((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Zt({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:o}=await t.next();if(o)return e.close();const a=n.encode(JSON.stringify(r)+"\n");e.enqueue(a)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}class Bn{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}const Nn=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,zn=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&Ln(e),Ln=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,Dn=e=>zn(e)||Nn(e)||rn(e);async function Mn(e,t,n){if(e=await e,zn(e))return e;if(Nn(e)){const r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Ln(r)?[await r.arrayBuffer()]:[r];return new Xt(o,t,n)}const r=await async function(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Ln(e))t.push(await e.arrayBuffer());else{if(!$n(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const n of e)t.push(n)}return t}(e);if(t||(t=function(e){return Un(e.name)||Un(e.filename)||Un(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!n?.type){const e=r[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new Xt(r,t,n)}const Un=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,$n=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],Wn=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],Vn=async e=>{const t=await qn(e.body);return en(t,e)},qn=async e=>{const t=new Jt;return await Promise.all(Object.entries(e||{}).map((([e,n])=>Hn(t,e,n)))),t},Hn=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)e.append(t,String(n));else if(Dn(n)){const r=await Mn(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>Hn(e,t+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>Hn(e,`${t}[${n}]`,r))))}}};var Gn,Kn=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Yn=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function Qn(e){const{response:t}=e;if(e.options.stream)return wr("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Rn.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type"),r=n?.split(";")[0]?.trim();if(r?.includes("application/json")||r?.endsWith("+json")){const e=await t.json();return wr("response",t.status,t.url,t.headers,e),Jn(e,t)}const o=await t.text();return wr("response",t.status,t.url,t.headers,o),o}function Jn(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}dn();class Xn extends Promise{constructor(e,t=Qn){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Xn(this.responsePromise,(async t=>Jn(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Zn{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:o}){this.baseURL=e,this.maxRetries=gr("maxRetries",t),this.timeout=gr("timeout",n),this.httpAgent=r,this.fetch=o??Qt}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...cr(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Sr()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&Ln(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const n={...e},{method:r,path:o,query:a,headers:i={}}=n,s=ArrayBuffer.isView(n.body)||n.__binaryRequest&&"string"==typeof n.body?n.body:Wn(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,l=this.calculateContentLength(s),c=this.buildURL(o,a);"timeout"in n&&gr("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const u=n.httpAgent??this.httpAgent??tn(c),d=n.timeout+1e3;"number"==typeof u?.options?.timeout&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&"get"!==r&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:r,...s&&{body:s},headers:this.buildHeaders({options:n,headers:i,contentLength:l,retryCount:t}),...u&&{agent:u},signal:n.signal??null},url:c,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const o={};n&&(o["content-length"]=n);const a=this.defaultHeaders(e);return vr(o,a),vr(o,t),Wn(e.body)&&"node"!==Yt&&delete o["content-type"],void 0===kr(a,"x-stainless-retry-count")&&void 0===kr(t,"x-stainless-retry-count")&&(o["x-stainless-retry-count"]=String(r)),void 0===kr(a,"x-stainless-timeout")&&void 0===kr(t,"x-stainless-timeout")&&e.timeout&&(o["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(o,t),o}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return pn.generate(e,t,n,r)}request(e,t=null){return new Xn(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);const{req:o,url:a,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(o,{url:a,options:n}),wr("request",a,n,o.headers),n.signal?.aborted)throw new gn;const s=new AbortController,l=await this.fetchWithTimeout(a,o,i,s).catch(hr);if(l instanceof Error){if(n.signal?.aborted)throw new gn;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new mn;throw new hn({cause:l})}const c=nr(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return wr(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,a,c),this.retryRequest(n,t,c)}const e=await l.text().catch((e=>hr(e).message)),r=ur(e),o=r?void 0:e;wr(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,o);throw this.makeStatusError(l.status,r,o,c)}return{response:l,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new tr(this,n,e)}buildURL(e,t){const n=fr(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return yr(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new fn(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:o,...a}=t||{};o&&o.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n),s={signal:r.signal,...a};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally((()=>{clearTimeout(i)}))}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let r;const o=n?.["retry-after-ms"];if(o){const e=parseFloat(o);Number.isNaN(e)||(r=e)}const a=n?.["retry-after"];if(a&&!r){const e=parseFloat(a);r=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await pr(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Kt}`}}class er{constructor(e,t,n,r){Gn.set(this,void 0),Kn(this,Gn,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new fn("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await Yn(this,Gn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Gn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class tr extends Xn{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await Qn(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const nr=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),rr={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},or=e=>"object"==typeof e&&null!==e&&!yr(e)&&Object.keys(e).every((e=>xr(rr,e))),ar=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kt,"X-Stainless-OS":sr(Deno.build.os),"X-Stainless-Arch":ir(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kt,"X-Stainless-OS":sr(process.platform),"X-Stainless-Arch":ir(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const ir=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",sr=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let lr;const cr=()=>lr??(lr=ar()),ur=e=>{try{return JSON.parse(e)}catch(e){return}},dr=/^[a-z][a-z0-9+.-]*:/i,fr=e=>dr.test(e),pr=e=>new Promise((t=>setTimeout(t,e))),gr=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new fn(`${e} must be an integer`);if(t<0)throw new fn(`${e} must be a positive integer`);return t},hr=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},mr=e=>"undefined"!=typeof process?process.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function yr(e){if(!e)return!0;for(const t in e)return!1;return!0}function xr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function vr(e,t){for(const n in t){if(!xr(t,n))continue;const r=n.toLowerCase();if(!r)continue;const o=t[n];null===o?delete e[r]:void 0!==o&&(e[r]=o)}}const br=new Set(["authorization","api-key"]);function wr(e,...t){if("undefined"!=typeof process&&"true"===process?.env?.DEBUG){const n=t.map((e=>{if(!e)return e;if(e.headers){const t={...e,headers:{...e.headers}};for(const n in e.headers)br.has(n.toLowerCase())&&(t.headers[n]="REDACTED");return t}let t=null;for(const n in e)br.has(n.toLowerCase())&&(t??(t={...e}),t[n]="REDACTED");return t??e}));console.log(`OpenAI:DEBUG:${e}`,...n)}}const Sr=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),kr=(e,t)=>{const n=t.toLowerCase();if((e=>"function"==typeof e?.get)(e)){const r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const o of[t,n,t.toUpperCase(),r]){const t=e.get(o);if(t)return t}}for(const[r,o]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function Er(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class Cr{constructor(e){this._client=e}}class _r extends Cr{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Ir extends Cr{list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,Pr,{query:t,...n})}}class jr extends er{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ar extends er{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class Fr extends Cr{constructor(){super(...arguments),this.messages=new Ir(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/chat/completions",Tr,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class Tr extends Ar{}class Pr extends Ar{}Fr.ChatCompletionsPage=Tr,Fr.Messages=Ir;class Or extends Cr{constructor(){super(...arguments),this.completions=new Fr(this._client)}}Or.Completions=Fr,Or.ChatCompletionsPage=Tr;class Rr extends Cr{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&wr("Request","User defined encoding_format:",e.encoding_format);const o=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?o:(wr("response","Decoding base64 embeddings to float32 array"),o._thenUnwrap((e=>(e&&e.data&&e.data.forEach((e=>{const t=e.embedding;e.embedding=(e=>{if("undefined"!=typeof Buffer){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}})(t)})),e))))}}class Br extends Cr{create(e,t){return this._client.post("/files",Vn({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/files",Nr,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),o=Date.now();let a=await this.retrieve(e);for(;!a.status||!r.has(a.status);)if(await pr(t),a=await this.retrieve(e),Date.now()-o>n)throw new mn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class Nr extends Ar{}Br.FileObjectsPage=Nr;class zr extends Cr{createVariation(e,t){return this._client.post("/images/variations",Vn({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Vn({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Lr extends Cr{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class Dr extends Cr{create(e,t){return this._client.post("/audio/transcriptions",Vn({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class Mr extends Cr{create(e,t){return this._client.post("/audio/translations",Vn({body:e,...t,__metadata:{model:e.model}}))}}class Ur extends Cr{constructor(){super(...arguments),this.transcriptions=new Dr(this._client),this.translations=new Mr(this._client),this.speech=new Lr(this._client)}}Ur.Transcriptions=Dr,Ur.Translations=Mr,Ur.Speech=Lr;class $r extends Cr{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Wr extends Cr{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Vr,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Vr extends jr{}Wr.ModelsPage=Vr;class qr extends Cr{}class Hr extends Cr{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class Gr extends Cr{constructor(){super(...arguments),this.graders=new Hr(this._client)}}Gr.Graders=Hr;class Kr extends Cr{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,Yr,{body:t,method:"post",...n})}retrieve(e,t={},n){return or(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class Yr extends jr{}Kr.PermissionCreateResponsesPage=Yr;class Qr extends Cr{constructor(){super(...arguments),this.permissions=new Kr(this._client)}}Qr.Permissions=Kr,Qr.PermissionCreateResponsesPage=Yr;class Jr extends Cr{list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Xr,{query:t,...n})}}class Xr extends Ar{}Jr.FineTuningJobCheckpointsPage=Xr;class Zr extends Cr{constructor(){super(...arguments),this.checkpoints=new Jr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",eo,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return or(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,to,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class eo extends Ar{}class to extends Ar{}Zr.FineTuningJobsPage=eo,Zr.FineTuningJobEventsPage=to,Zr.Checkpoints=Jr,Zr.FineTuningJobCheckpointsPage=Xr;class no extends Cr{constructor(){super(...arguments),this.methods=new qr(this._client),this.jobs=new Zr(this._client),this.checkpoints=new Qr(this._client),this.alpha=new Gr(this._client)}}no.Methods=qr,no.Jobs=Zr,no.FineTuningJobsPage=eo,no.FineTuningJobEventsPage=to,no.Checkpoints=Qr,no.Alpha=Gr;class ro extends Cr{}class oo extends Cr{constructor(){super(...arguments),this.graderModels=new ro(this._client)}}oo.GraderModels=ro;class ao extends Cr{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,io,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const o=await this.retrieve(e,t,{...n,headers:r}).withResponse(),a=o.data;switch(a.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await pr(e);break;case"failed":case"completed":return a}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,so,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class io extends Ar{}class so extends jr{}ao.VectorStoreFilesPage=io,ao.FileContentResponsesPage=so;class lo extends Cr{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return or(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,io,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:a}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(o.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await pr(e);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=r?.maxConcurrency??5,a=Math.min(o,t.length),i=this._client,s=t.values(),l=[...n];const c=Array(a).fill(s).map((async function(e){for(let t of e){const e=await i.files.create({file:t,purpose:"assistants"},r);l.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)console.error(e.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const e of t)"fulfilled"===e.status&&r.push(e.value);return r})(c),await this.createAndPoll(e,{file_ids:l})}}class co extends Cr{constructor(){super(...arguments),this.files=new ao(this._client),this.fileBatches=new lo(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/vector_stores",uo,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,fo,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class uo extends Ar{}class fo extends jr{}co.VectorStoresPage=uo,co.VectorStoreSearchResponsesPage=fo,co.Files=ao,co.VectorStoreFilesPage=io,co.FileContentResponsesPage=so,co.FileBatches=lo;class po extends Cr{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/assistants",go,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class go extends Ar{}function ho(e){return"function"==typeof e.parse}po.AssistantsPage=go;const mo=e=>"assistant"===e?.role,yo=e=>"function"===e?.role,xo=e=>"tool"===e?.role;var vo,bo,wo,So,ko,Eo,Co,_o,Io,jo,Ao,Fo,To,Po=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Oo=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ro{constructor(){vo.add(this),this.controller=new AbortController,bo.set(this,void 0),wo.set(this,(()=>{})),So.set(this,(()=>{})),ko.set(this,void 0),Eo.set(this,(()=>{})),Co.set(this,(()=>{})),_o.set(this,{}),Io.set(this,!1),jo.set(this,!1),Ao.set(this,!1),Fo.set(this,!1),Po(this,bo,new Promise(((e,t)=>{Po(this,wo,e,"f"),Po(this,So,t,"f")})),"f"),Po(this,ko,new Promise(((e,t)=>{Po(this,Eo,e,"f"),Po(this,Co,t,"f")})),"f"),Oo(this,bo,"f").catch((()=>{})),Oo(this,ko,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),Oo(this,vo,"m",To).bind(this))}),0)}_connected(){this.ended||(Oo(this,wo,"f").call(this),this._emit("connect"))}get ended(){return Oo(this,Io,"f")}get errored(){return Oo(this,jo,"f")}get aborted(){return Oo(this,Ao,"f")}abort(){this.controller.abort()}on(e,t){return(Oo(this,_o,"f")[e]||(Oo(this,_o,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=Oo(this,_o,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(Oo(this,_o,"f")[e]||(Oo(this,_o,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{Po(this,Fo,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){Po(this,Fo,!0,"f"),await Oo(this,ko,"f")}_emit(e,...t){if(Oo(this,Io,"f"))return;"end"===e&&(Po(this,Io,!0,"f"),Oo(this,Eo,"f").call(this));const n=Oo(this,_o,"f")[e];if(n&&(Oo(this,_o,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return Oo(this,Fo,"f")||n?.length||Promise.reject(e),Oo(this,So,"f").call(this,e),Oo(this,Co,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];Oo(this,Fo,"f")||n?.length||Promise.reject(e),Oo(this,So,"f").call(this,e),Oo(this,Co,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function Bo(e){return"auto-parseable-response-format"===e?.$brand}function No(e){return"auto-parseable-tool"===e?.$brand}function zo(e,t){const n=e.choices.map((e=>{if("length"===e.finish_reason)throw new Cn;if("content_filter"===e.finish_reason)throw new _n;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map((e=>function(e,t){const n=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:No(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}(t,e)))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?Lo(t,e.message.content):null}}}));return{...e,choices:n}}function Lo(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function Do(e,t){if(!e)return!1;const n=e.tools?.find((e=>e.function?.name===t.function.name));return No(n)||n?.function.strict||!1}function Mo(e){return!!Bo(e.response_format)||(e.tools?.some((e=>No(e)||"function"===e.type&&!0===e.function.strict))??!1)}bo=new WeakMap,wo=new WeakMap,So=new WeakMap,ko=new WeakMap,Eo=new WeakMap,Co=new WeakMap,_o=new WeakMap,Io=new WeakMap,jo=new WeakMap,Ao=new WeakMap,Fo=new WeakMap,vo=new WeakSet,To=function(e){if(Po(this,jo,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new gn),e instanceof gn)return Po(this,Ao,!0,"f"),this._emit("abort",e);if(e instanceof fn)return this._emit("error",e);if(e instanceof Error){const t=new fn(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new fn(String(e)))};var Uo,$o,Wo,Vo,qo,Ho,Go,Ko,Yo=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const Qo=10;class Jo extends Ro{constructor(){super(...arguments),Uo.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(yo(e)||xo(e))&&e.content)this._emit("functionCallResult",e.content);else if(mo(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(mo(e)&&e.tool_calls)for(const t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new fn("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Yo(this,Uo,"m",$o).call(this)}async finalMessage(){return await this.done(),Yo(this,Uo,"m",Wo).call(this)}async finalFunctionCall(){return await this.done(),Yo(this,Uo,"m",Vo).call(this)}async finalFunctionCallResult(){return await this.done(),Yo(this,Uo,"m",qo).call(this)}async totalUsage(){return await this.done(),Yo(this,Uo,"m",Ho).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Yo(this,Uo,"m",Wo).call(this);t&&this._emit("finalMessage",t);const n=Yo(this,Uo,"m",$o).call(this);n&&this._emit("finalContent",n);const r=Yo(this,Uo,"m",Vo).call(this);r&&this._emit("finalFunctionCall",r);const o=Yo(this,Uo,"m",qo).call(this);null!=o&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",Yo(this,Uo,"m",Ho).call(this))}async _createChatCompletion(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Yo(this,Uo,"m",Go).call(this,t);const o=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(zo(o,t))}async _runChatCompletion(e,t,n){for(const e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const r="function",{function_call:o="auto",stream:a,...i}=t,s="string"!=typeof o&&o?.name,{maxChatCompletions:l=Qo}=n||{},c={};for(const e of t.functions)c[e.name||e.function.name]=e;const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...i,function_call:o,functions:u,messages:[...this.messages]},n),a=t.choices[0]?.message;if(!a)throw new fn("missing message in ChatCompletion response");if(!a.function_call)return;const{name:l,arguments:d}=a.function_call,f=c[l];if(!f){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:l,content:e});continue}if(s&&s!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(s)} requested. Please try again`;this._addMessage({role:r,name:l,content:e});continue}let p;try{p=ho(f)?await f.parse(d):d}catch(e){this._addMessage({role:r,name:l,content:e instanceof Error?e.message:String(e)});continue}const g=await f.function(p,this),h=Yo(this,Uo,"m",Ko).call(this,g);if(this._addMessage({role:r,name:l,content:h}),s)return}}async _runTools(e,t,n){const r="tool",{tool_choice:o="auto",stream:a,...i}=t,s="string"!=typeof o&&o?.function?.name,{maxChatCompletions:l=Qo}=n||{},c=t.tools.map((e=>{if(No(e)){if(!e.$callback)throw new fn("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),u={};for(const e of c)"function"===e.type&&(u[e.function.name||e.function.function.name]=e.function);const d="tools"in t?c.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...i,tool_choice:o,tools:d,messages:[...this.messages]},n),a=t.choices[0]?.message;if(!a)throw new fn("missing message in ChatCompletion response");if(!a.tool_calls?.length)return;for(const e of a.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:o}=e.function,a=u[n];if(!a){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}if(s&&s!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(s)} requested. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}let i;try{i=ho(a)?await a.parse(o):o}catch(e){const n=e instanceof Error?e.message:String(e);this._addMessage({role:r,tool_call_id:t,content:n});continue}const l=await a.function(i,this),c=Yo(this,Uo,"m",Ko).call(this,l);if(this._addMessage({role:r,tool_call_id:t,content:c}),s)return}}}}Uo=new WeakSet,$o=function(){return Yo(this,Uo,"m",Wo).call(this).content??null},Wo=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(mo(t)){const{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new fn("stream ended without producing a ChatCompletionMessage with role=assistant")},Vo=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(mo(t)&&t?.function_call)return t.function_call;if(mo(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},qo=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(yo(t)&&null!=t.content)return t.content;if(xo(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},Ho=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Go=function(e){if(null!=e.n&&e.n>1)throw new fn("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ko=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class Xo extends Jo{static runFunctions(e,t,n){const r=new Xo,o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,o))),r}static runTools(e,t,n){const r=new Xo,o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,o))),r}_addMessage(e,t=!0){super._addMessage(e,t),mo(e)&&e.content&&this._emit("content",e.content)}}const Zo=1,ea=2,ta=4,na=8,ra=16,oa=32,aa=64,ia=128,sa=256,la=511;class ca extends Error{}class ua extends Error{}const da=(e,t)=>{const n=e.length;let r=0;const o=e=>{throw new ca(`${e} at position ${r}`)},a=e=>{throw new ua(`${e} at position ${r}`)},i=()=>(d(),r>=n&&o("Unexpected end of input"),'"'===e[r]?s():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||ra&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||oa&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||oa&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||ia&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||sa&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||aa&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const i=r;let s=!1;for(r++;r<n&&('"'!==e[r]||s&&"\\"===e[r-1]);)s="\\"===e[r]&&!s,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(i,++r-Number(s)))}catch(e){a(String(e))}else if(Zo&t)try{return JSON.parse(e.substring(i,r-Number(s))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},l=()=>{r++,d();const a={};try{for(;"}"!==e[r];){if(d(),r>=n&&na&t)return a;const o=s();d(),r++;try{const e=i();Object.defineProperty(a,o,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(na&t)return a;throw e}d(),","===e[r]&&r++}}catch(e){if(na&t)return a;o("Expected '}' at end of object")}return r++,a},c=()=>{r++;const n=[];try{for(;"]"!==e[r];)n.push(i()),d(),","===e[r]&&r++}catch(e){if(ta&t)return n;o("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&ea&t&&o("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(ea&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}a(String(n))}}const i=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||ea&t||o("Unterminated number literal");try{return JSON.parse(e.substring(i,r))}catch(n){"-"===e.substring(i,r)&&ea&t&&o("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){a(String(e))}}},d=()=>{for(;r<n&&" \n\r\t".includes(e[r]);)r++};return i()},fa=e=>function(e,t=la){if("string"!=typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return da(e.trim(),t)}(e,la^ea);var pa,ga,ha,ma,ya,xa,va,ba,wa,Sa,ka,Ea,Ca=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},_a=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ia extends Jo{constructor(e){super(),pa.add(this),ga.set(this,void 0),ha.set(this,void 0),ma.set(this,void 0),Ca(this,ga,e,"f"),Ca(this,ha,[],"f")}get currentChatCompletionSnapshot(){return _a(this,ma,"f")}static fromReadableStream(e){const t=new Ia(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const r=new Ia(t);return r._run((()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),_a(this,pa,"m",ya).call(this);const o=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of o)_a(this,pa,"m",va).call(this,e);if(o.controller.signal?.aborted)throw new gn;return this._addChatCompletion(_a(this,pa,"m",Sa).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),_a(this,pa,"m",ya).call(this),this._connected();const r=Rn.fromReadableStream(e,this.controller);let o;for await(const e of r)o&&o!==e.id&&this._addChatCompletion(_a(this,pa,"m",Sa).call(this)),_a(this,pa,"m",va).call(this,e),o=e.id;if(r.controller.signal?.aborted)throw new gn;return this._addChatCompletion(_a(this,pa,"m",Sa).call(this))}[(ga=new WeakMap,ha=new WeakMap,ma=new WeakMap,pa=new WeakSet,ya=function(){this.ended||Ca(this,ma,void 0,"f")},xa=function(e){let t=_a(this,ha,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},_a(this,ha,"f")[e.index]=t,t)},va=function(e){if(this.ended)return;const t=_a(this,pa,"m",Ea).call(this,e);this._emit("chunk",e,t);for(const n of e.choices){const e=t.choices[n.index];null!=n.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),null!=n.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const r=_a(this,pa,"m",xa).call(this,e);e.finish_reason&&(_a(this,pa,"m",wa).call(this,e),null!=r.current_tool_call_index&&_a(this,pa,"m",ba).call(this,e,r.current_tool_call_index));for(const t of n.delta.tool_calls??[])r.current_tool_call_index!==t.index&&(_a(this,pa,"m",wa).call(this,e),null!=r.current_tool_call_index&&_a(this,pa,"m",ba).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(const t of n.delta.tool_calls??[]){const n=e.message.tool_calls?.[t.index];n?.type&&("function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}))}}},ba=function(e,t){if(_a(this,pa,"m",xa).call(this,e).done_tool_calls.has(t))return;const n=e.message.tool_calls?.[t];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const e=_a(this,ga,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:t,arguments:n.function.arguments,parsed_arguments:No(e)?e.$parseRaw(n.function.arguments):e?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},wa=function(e){const t=_a(this,pa,"m",xa).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const n=_a(this,pa,"m",ka).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},Sa=function(){if(this.ended)throw new fn("stream has ended, this shouldn't happen");const e=_a(this,ma,"f");if(!e)throw new fn("request ended without sending any chunks");return Ca(this,ma,void 0,"f"),Ca(this,ha,[],"f"),function(e,t){const{id:n,choices:r,created:o,model:a,system_fingerprint:i,...s}=e,l={...s,id:n,choices:r.map((({message:t,finish_reason:n,index:r,logprobs:o,...a})=>{if(!n)throw new fn(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:s,tool_calls:l,...c}=t,u=t.role;if(!u)throw new fn(`missing role for choice ${r}`);if(s){const{arguments:e,name:l}=s;if(null==e)throw new fn(`missing function_call.arguments for choice ${r}`);if(!l)throw new fn(`missing function_call.name for choice ${r}`);return{...a,message:{content:i,function_call:{arguments:e,name:l},role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:o}}return l?{...a,index:r,finish_reason:n,logprobs:o,message:{...c,role:u,content:i,refusal:t.refusal??null,tool_calls:l.map(((t,n)=>{const{function:o,type:a,id:i,...s}=t,{arguments:l,name:c,...u}=o||{};if(null==i)throw new fn(`missing choices[${r}].tool_calls[${n}].id\n${ja(e)}`);if(null==a)throw new fn(`missing choices[${r}].tool_calls[${n}].type\n${ja(e)}`);if(null==c)throw new fn(`missing choices[${r}].tool_calls[${n}].function.name\n${ja(e)}`);if(null==l)throw new fn(`missing choices[${r}].tool_calls[${n}].function.arguments\n${ja(e)}`);return{...s,id:i,type:a,function:{...u,name:c,arguments:l}}}))}}:{...a,message:{...c,content:i,role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:o}})),created:o,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(e,t){return t&&Mo(t)?zo(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}})))}}(l,t)}(e,_a(this,ga,"f"))},ka=function(){const e=_a(this,ga,"f")?.response_format;return Bo(e)?e:null},Ea=function(e){var t,n,r,o;let a=_a(this,ma,"f");const{choices:i,...s}=e;a?Object.assign(a,s):a=Ca(this,ma,{...s,choices:[]},"f");for(const{delta:i,finish_reason:s,index:l,logprobs:c=null,...u}of e.choices){let e=a.choices[l];if(e||(e=a.choices[l]={finish_reason:s,index:l,message:{},logprobs:c,...u}),c)if(e.logprobs){const{content:r,refusal:o,...a}=c;Object.assign(e.logprobs,a),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),o&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...o))}else e.logprobs=Object.assign({},c);if(s&&(e.finish_reason=s,_a(this,ga,"f")&&Mo(_a(this,ga,"f")))){if("length"===s)throw new Cn;if("content_filter"===s)throw new _n}if(Object.assign(e,u),!i)continue;const{content:d,refusal:f,function_call:p,role:g,tool_calls:h,...m}=i;if(Object.assign(e.message,m),f&&(e.message.refusal=(e.message.refusal||"")+f),g&&(e.message.role=g),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),d&&(e.message.content=(e.message.content||"")+d,!e.message.refusal&&_a(this,pa,"m",ka).call(this)&&(e.message.parsed=fa(e.message.content))),h){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:n,type:r,function:a,...i}of h){const s=(o=e.message.tool_calls)[t]??(o[t]={});Object.assign(s,i),n&&(s.id=n),r&&(s.type=r),a&&(s.function??(s.function={name:a.name??"",arguments:""})),a?.name&&(s.function.name=a.name),a?.arguments&&(s.function.arguments+=a.arguments,Do(_a(this,ga,"f"),s)&&(s.function.parsed_arguments=fa(s.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Rn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function ja(e){return JSON.stringify(e)}class Aa extends Ia{static fromReadableStream(e){const t=new Aa(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const r=new Aa(null),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,o))),r}static runTools(e,t,n){const r=new Aa(t),o={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,o))),r}}class Fa extends Cr{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new fn(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new fn(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>zo(t,e)))}runFunctions(e,t){return e.stream?Aa.runFunctions(this._client,e,t):Xo.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Aa.runTools(this._client,e,t):Xo.runTools(this._client,e,t)}stream(e,t){return Ia.createChatCompletion(this._client,e,t)}}class Ta extends Cr{constructor(){super(...arguments),this.completions=new Fa(this._client)}}!function(e){e.Completions=Fa}(Ta||(Ta={}));class Pa extends Cr{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Oa extends Cr{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Ra extends Cr{constructor(){super(...arguments),this.sessions=new Pa(this._client),this.transcriptionSessions=new Oa(this._client)}}Ra.Sessions=Pa,Ra.TranscriptionSessions=Oa;var Ba,Na,za,La,Da,Ma,Ua,$a,Wa,Va,qa,Ha,Ga,Ka,Ya,Qa,Ja,Xa,Za,ei,ti,ni,ri=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},oi=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n};class ai extends Ro{constructor(){super(...arguments),Ba.add(this),Na.set(this,[]),za.set(this,{}),La.set(this,{}),Da.set(this,void 0),Ma.set(this,void 0),Ua.set(this,void 0),$a.set(this,void 0),Wa.set(this,void 0),Va.set(this,void 0),qa.set(this,void 0),Ha.set(this,void 0),Ga.set(this,void 0)}[(Na=new WeakMap,za=new WeakMap,La=new WeakMap,Da=new WeakMap,Ma=new WeakMap,Ua=new WeakMap,$a=new WeakMap,Wa=new WeakMap,Va=new WeakMap,qa=new WeakMap,Ha=new WeakMap,Ga=new WeakMap,Ba=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ai;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=Rn.fromReadableStream(e,this.controller);for await(const e of r)ri(this,Ba,"m",Ka).call(this,e);if(r.controller.signal?.aborted)throw new gn;return this._addRun(ri(this,Ba,"m",Ya).call(this))}toReadableStream(){return new Rn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,o){const a=new ai;return a._run((()=>a._runToolAssistantStream(e,t,n,r,{...o,headers:{...o?.headers,"X-Stainless-Helper-Method":"stream"}}))),a}async _createToolAssistantStream(e,t,n,r,o){const a=o?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(()=>this.controller.abort())));const i={...r,stream:!0},s=await e.submitToolOutputs(t,n,i,{...o,signal:this.controller.signal});this._connected();for await(const e of s)ri(this,Ba,"m",Ka).call(this,e);if(s.controller.signal?.aborted)throw new gn;return this._addRun(ri(this,Ba,"m",Ya).call(this))}static createThreadAssistantStream(e,t,n){const r=new ai;return r._run((()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(e,t,n,r){const o=new ai;return o._run((()=>o._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}currentEvent(){return ri(this,qa,"f")}currentRun(){return ri(this,Ha,"f")}currentMessageSnapshot(){return ri(this,Da,"f")}currentRunStepSnapshot(){return ri(this,Ga,"f")}async finalRunSteps(){return await this.done(),Object.values(ri(this,za,"f"))}async finalMessages(){return await this.done(),Object.values(ri(this,La,"f"))}async finalRun(){if(await this.done(),!ri(this,Ma,"f"))throw Error("Final run was not received.");return ri(this,Ma,"f")}async _createThreadAssistantStream(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const o={...t,stream:!0},a=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(const e of a)ri(this,Ba,"m",Ka).call(this,e);if(a.controller.signal?.aborted)throw new gn;return this._addRun(ri(this,Ba,"m",Ya).call(this))}async _createAssistantStream(e,t,n,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const a={...n,stream:!0},i=await e.create(t,a,{...r,signal:this.controller.signal});this._connected();for await(const e of i)ri(this,Ba,"m",Ka).call(this,e);if(i.controller.signal?.aborted)throw new gn;return this._addRun(ri(this,Ba,"m",Ya).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null!=t)if("index"!==n&&"type"!==n){if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else{if(!Er(t)||!Er(r)){if(Array.isArray(t)&&Array.isArray(r)){if(t.every((e=>"string"==typeof e||"number"==typeof e))){t.push(...r);continue}for(const e of r){if(!Er(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const n=e.index;if(null==n)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`)}t=this.accumulateDelta(t,r)}e[n]=t}else e[n]=r;else e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,o){return await this._createToolAssistantStream(n,e,t,r,o)}}Ka=function(e){if(!this.ended)switch(oi(this,qa,e,"f"),ri(this,Ba,"m",Xa).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ri(this,Ba,"m",ni).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ri(this,Ba,"m",Ja).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ri(this,Ba,"m",Qa).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ya=function(){if(this.ended)throw new fn("stream has ended, this shouldn't happen");if(!ri(this,Ma,"f"))throw Error("Final run has not been received");return ri(this,Ma,"f")},Qa=function(e){const[t,n]=ri(this,Ba,"m",ei).call(this,e,ri(this,Da,"f"));oi(this,Da,t,"f"),ri(this,La,"f")[t.id]=t;for(const e of n){const n=t.content[e.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,r.text)}if(n.index!=ri(this,Ua,"f")){if(ri(this,$a,"f"))switch(ri(this,$a,"f").type){case"text":this._emit("textDone",ri(this,$a,"f").text,ri(this,Da,"f"));break;case"image_file":this._emit("imageFileDone",ri(this,$a,"f").image_file,ri(this,Da,"f"))}oi(this,Ua,n.index,"f")}oi(this,$a,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==ri(this,Ua,"f")){const t=e.data.content[ri(this,Ua,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,ri(this,Da,"f"));break;case"text":this._emit("textDone",t.text,ri(this,Da,"f"))}}ri(this,Da,"f")&&this._emit("messageDone",e.data),oi(this,Da,void 0,"f")}},Ja=function(e){const t=ri(this,Ba,"m",Za).call(this,e);switch(oi(this,Ga,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==ri(this,Wa,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(ri(this,Va,"f")&&this._emit("toolCallDone",ri(this,Va,"f")),oi(this,Wa,e.index,"f"),oi(this,Va,t.step_details.tool_calls[e.index],"f"),ri(this,Va,"f")&&this._emit("toolCallCreated",ri(this,Va,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":oi(this,Ga,void 0,"f");"tool_calls"==e.data.step_details.type&&ri(this,Va,"f")&&(this._emit("toolCallDone",ri(this,Va,"f")),oi(this,Va,void 0,"f")),this._emit("runStepDone",e.data,t)}},Xa=function(e){ri(this,Na,"f").push(e),this._emit("event",e)},Za=function(e){switch(e.event){case"thread.run.step.created":return ri(this,za,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=ri(this,za,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=ai.accumulateDelta(t,n.delta);ri(this,za,"f")[e.data.id]=r}return ri(this,za,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ri(this,za,"f")[e.data.id]=e.data}if(ri(this,za,"f")[e.data.id])return ri(this,za,"f")[e.data.id];throw new Error("No snapshot available")},ei=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=ri(this,Ba,"m",ti).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ti=function(e,t){return ai.accumulateDelta(t,e)},ni=function(e){switch(oi(this,Ha,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":oi(this,Ma,e.data,"f"),ri(this,Va,"f")&&(this._emit("toolCallDone",ri(this,Va,"f")),oi(this,Va,void 0,"f"))}};class ii extends Cr{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,si,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class si extends Ar{}ii.MessagesPage=si;class li extends Cr{retrieve(e,t,n,r={},o){return or(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...o,headers:{"OpenAI-Beta":"assistants=v2",...o?.headers}})}list(e,t,n={},r){return or(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,ci,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class ci extends Ar{}li.RunStepsPage=ci;class ui extends Cr{constructor(){super(...arguments),this.steps=new li(this._client)}create(e,t,n){const{include:r,...o}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:o,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,di,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return ai.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:a}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await pr(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,t,n){return ai.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const o=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,o.id,r)}submitToolOutputsStream(e,t,n,r){return ai.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class di extends Ar{}ui.RunsPage=di,ui.Steps=li,ui.RunStepsPage=ci;class fi extends Cr{constructor(){super(...arguments),this.runs=new ui(this._client),this.messages=new ii(this._client)}create(e={},t){return or(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return ai.createThreadAssistantStream(e,this._client.beta.threads,t)}}fi.Runs=ui,fi.RunsPage=di,fi.Messages=ii,fi.MessagesPage=si;class pi extends Cr{constructor(){super(...arguments),this.realtime=new Ra(this._client),this.chat=new Ta(this._client),this.assistants=new po(this._client),this.threads=new fi(this._client)}}pi.Realtime=Ra,pi.Assistants=po,pi.AssistantsPage=go,pi.Threads=fi;class gi extends Cr{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/batches",hi,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class hi extends Ar{}gi.BatchesPage=hi;class mi extends Cr{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Vn({body:t,...n}))}}class yi extends Cr{constructor(){super(...arguments),this.parts=new mi(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}function xi(e,t){return t&&function(e){if(Bo(e.text?.format))return!0;return!1}(t)?vi(e,t):{...e,output_parsed:null,output:e.output.map((e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map((e=>({...e,parsed:null})))}:e))}}function vi(e,t){const n=e.output.map((e=>{if("function_call"===e.type)return{...e,parsed_arguments:ki(t,e)};if("message"===e.type){const n=e.content.map((e=>"output_text"===e.type?{...e,parsed:bi(t,e.text)}:e));return{...e,content:n}}return e})),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||Ei(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const e of r.output)if("message"===e.type)for(const t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed;return null}}),r}function bi(e,t){if("json_schema"!==e.text?.format?.type)return null;if("$parseRaw"in e.text?.format){const n=e.text?.format;return n.$parseRaw(t)}return JSON.parse(t)}function wi(e){return"auto-parseable-tool"===e?.$brand}function Si(e,t){return e.find((e=>"function"===e.type&&e.name===t))}function ki(e,t){const n=Si(e.tools??[],t.name);return{...t,...t,parsed_arguments:wi(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}function Ei(e){const t=[];for(const n of e.output)if("message"===n.type)for(const e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}yi.Parts=mi;class Ci extends Cr{list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,Di,{query:t,...n})}}var _i,Ii,ji,Ai,Fi,Ti,Pi,Oi,Ri,Bi=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},Ni=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class zi extends Ro{constructor(e){super(),_i.add(this),Ii.set(this,void 0),ji.set(this,void 0),Ai.set(this,void 0),Bi(this,Ii,e,"f")}static createResponse(e,t,n){const r=new zi(t);return r._run((()=>r._createResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createResponse(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Ni(this,_i,"m",Fi).call(this);const o=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of o)Ni(this,_i,"m",Ti).call(this,e);if(o.controller.signal?.aborted)throw new gn;return Ni(this,_i,"m",Pi).call(this)}[(Ii=new WeakMap,ji=new WeakMap,Ai=new WeakMap,_i=new WeakSet,Fi=function(){this.ended||Bi(this,ji,void 0,"f")},Ti=function(e){if(this.ended)return;const t=Ni(this,_i,"m",Oi).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new fn(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new fn(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new fn(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new fn(`missing output at index ${e.output_index}`);"function_call"===n.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:n.arguments});break}default:this._emit(e.type,e)}},Pi=function(){if(this.ended)throw new fn("stream has ended, this shouldn't happen");const e=Ni(this,ji,"f");if(!e)throw new fn("request ended without sending any events");Bi(this,ji,void 0,"f");const t=function(e,t){return xi(e,t)}(e,Ni(this,Ii,"f"));return Bi(this,Ai,t,"f"),t},Oi=function(e){let t=Ni(this,ji,"f");if(!t){if("response.created"!==e.type)throw new fn(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return t=Bi(this,ji,e.response,"f"),t}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{const n=t.output[e.output_index];if(!n)throw new fn(`missing output at index ${e.output_index}`);"message"===n.type&&n.content.push(e.part);break}case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new fn(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new fn(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new fn(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new fn(`missing output at index ${e.output_index}`);"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.completed":Bi(this,ji,e.response,"f")}return t},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Ni(this,Ai,"f");if(!e)throw new fn("stream ended without producing a ChatCompletion");return e}}class Li extends Cr{constructor(){super(...arguments),this.inputItems=new Ci(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap((e=>("object"in e&&"response"===e.object&&Ei(e),e)))}retrieve(e,t={},n){return or(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...n})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap((t=>vi(t,e)))}stream(e,t){return zi.createResponse(this._client,e,t)}}class Di extends Ar{}Li.InputItems=Ci;class Mi extends Cr{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return or(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,Ui,{query:n,...r})}}class Ui extends Ar{}Mi.OutputItemListResponsesPage=Ui;class $i extends Cr{constructor(){super(...arguments),this.outputItems=new Mi(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,Wi,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class Wi extends Ar{}$i.RunListResponsesPage=Wi,$i.OutputItems=Mi,$i.OutputItemListResponsesPage=Ui;class Vi extends Cr{constructor(){super(...arguments),this.runs=new $i(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return or(e)?this.list({},e):this._client.getAPIList("/evals",qi,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class qi extends Ar{}Vi.EvalListResponsesPage=qi,Vi.Runs=$i,Vi.RunListResponsesPage=Wi;class Hi extends Zn{constructor({baseURL:e=mr("OPENAI_BASE_URL"),apiKey:t=mr("OPENAI_API_KEY"),organization:n=mr("OPENAI_ORG_ID")??null,project:r=mr("OPENAI_PROJECT_ID")??null,...o}={}){if(void 0===t)throw new fn("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:n,project:r,...o,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new fn("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new _r(this),this.chat=new Or(this),this.embeddings=new Rr(this),this.files=new Br(this),this.images=new zr(this),this.audio=new Ur(this),this.moderations=new $r(this),this.models=new Wr(this),this.fineTuning=new no(this),this.graders=new oo(this),this.vectorStores=new co(this),this.beta=new pi(this),this.batches=new gi(this),this.uploads=new yi(this),this.responses=new Li(this),this.evals=new Vi(this),this._options=a,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Gt(e,{arrayFormat:"brackets"})}}Ri=Hi,Hi.OpenAI=Ri,Hi.DEFAULT_TIMEOUT=6e5,Hi.OpenAIError=fn,Hi.APIError=pn,Hi.APIConnectionError=hn,Hi.APIConnectionTimeoutError=mn,Hi.APIUserAbortError=gn,Hi.NotFoundError=bn,Hi.ConflictError=wn,Hi.RateLimitError=kn,Hi.BadRequestError=yn,Hi.AuthenticationError=xn,Hi.InternalServerError=En,Hi.PermissionDeniedError=vn,Hi.UnprocessableEntityError=Sn,Hi.toFile=Mn,Hi.fileFromPath=nn,Hi.Completions=_r,Hi.Chat=Or,Hi.ChatCompletionsPage=Tr,Hi.Embeddings=Rr,Hi.Files=Br,Hi.FileObjectsPage=Nr,Hi.Images=zr,Hi.Audio=Ur,Hi.Moderations=$r,Hi.Models=Wr,Hi.ModelsPage=Vr,Hi.FineTuning=no,Hi.Graders=oo,Hi.VectorStores=co,Hi.VectorStoresPage=uo,Hi.VectorStoreSearchResponsesPage=fo,Hi.Beta=pi,Hi.Batches=gi,Hi.BatchesPage=hi,Hi.Uploads=yi,Hi.Responses=Li,Hi.Evals=Vi,Hi.EvalListResponsesPage=qi;new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var Gi=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ki=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function Yi(e,t,n,r,o){return void 0===o&&(o=""),Gi(this,void 0,void 0,(function(){var e,a,i,s;return Ki(this,(function(l){switch(l.label){case 0:if(console.log("getImage called with description:",r),e=null,a=null,!r)throw new Error("Cannot generate image: missing description");if(!n)throw new Error("Cannot generate image: no OpenAI API key provided. Please check your settings.");l.label=1;case 1:return l.trys.push([1,7,,8]),console.log("Using OpenAI with key:",n?n.substring(0,5)+"...":"null"),[4,Ie(t,n,r,o)];case 2:if(e=l.sent(),console.log("OpenAI returned URL:",e?"success":"null"),!e)return[3,6];l.label=3;case 3:return l.trys.push([3,5,,6]),[4,B(e)];case 4:return a=l.sent(),console.log("Image URL converted to base64:",a?"success":"null"),[3,6];case 5:return i=l.sent(),console.error("Error converting URL to base64:",i),[3,6];case 6:return[3,8];case 7:throw s=l.sent(),console.error("OpenAI image generation error:",s),s instanceof Error?s:new Error("Failed to generate image with OpenAI. Please check your API key and try again.");case 8:if(!e)throw new Error("Failed to generate image. Please check your API key and try again.");return[2,{imageUrl:e,imageBase64:a}]}}))}))}var Qi=function(){return Qi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Qi.apply(this,arguments)};const Ji=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],o=(0,r.useState)("error"),i=o[0],s=o[1],l=(0,r.useState)(!1),c=l[0],u=l[1],d=(0,r.useState)(!1),f=d[0],p=d[1],g=function(){p(!1),setTimeout((function(){u(!1),n(null)}),300)};return{showError:function(e,t){void 0===t&&(t="error"),console.log("showError called:",{message:e,errorType:t,visible:c,isAnimating:f}),e?(n(e),s(t),u(!0),setTimeout((function(){p(!0)}),50),setTimeout((function(){g()}),5e3)):g()},renderErrorNotification:function(){if(console.log("renderErrorNotification called:",{visible:c,error:t,isAnimating:f,type:i}),!c||!t)return null;var e,n=function(){switch(i){case"success":return{icon:(0,a.jsx)(Xe,{size:16}),color:"#059669",bgColor:"#ECFDF5",borderColor:"#10B981"};case"warning":return{icon:(0,a.jsx)(ct,{size:16}),color:"#D97706",bgColor:"#FFFBEB",borderColor:"#F59E0B"};case"info":return{icon:(0,a.jsx)(pt,{size:16}),color:"#2563EB",bgColor:"#EFF6FF",borderColor:"#3B82F6"};default:return{icon:(0,a.jsx)(St,{size:16}),color:"#DC2626",bgColor:"#FEF2F2",borderColor:"#EF4444"}}}(),r=n.icon,o=n.color,s=n.bgColor,l=n.borderColor,u=(e=t).includes("401")||e.includes("Unauthorized")||e.includes("Authentication")?"API Authentication failed: Please check your API key in Settings.":e.includes("429")||e.includes("Rate limit")?"API rate limit exceeded: Please try again in a few minutes.":e.includes("500")||e.includes("502")||e.includes("503")||e.includes("504")?"AI service is currently unavailable. Please try again later.":e.includes("key is missing")||e.includes("API key")?"API key is missing or invalid. Please check your settings.":e.includes("OpenAI")?"OpenAI API error: ".concat(e.split("OpenAI").pop()):e.includes("Groq")?"Groq API error: ".concat(e.split("Groq").pop()):e;return(0,a.jsxs)("div",Qi({style:{transform:f?"translateX(0)":"translateX(100%)",opacity:f?1:0,transition:"all 0.3s ease-out",backgroundColor:s,border:"1px solid ".concat(l),borderRadius:"12px",padding:"16px",minWidth:"280px",maxWidth:"320px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative",display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"8px"},role:"alert","aria-live":"polite"},{children:[(0,a.jsx)("div",Qi({style:{color:o,marginTop:"2px",flexShrink:0}},{children:r})),(0,a.jsx)("div",Qi({style:{flex:1,paddingRight:"8px"}},{children:(0,a.jsx)("p",Qi({style:{color:"#374151",margin:0,fontSize:"14px",lineHeight:"1.5",fontWeight:500}},{children:u}))})),(0,a.jsx)("button",Qi({onClick:g,style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",color:"#9CA3AF",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="rgba(0, 0, 0, 0.1)",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9CA3AF"},"aria-label":"Close notification"},{children:(0,a.jsx)(kt,{size:12})})),(0,a.jsx)("div",Qi({style:{position:"absolute",bottom:0,left:0,right:0,height:"3px",backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"0 0 12px 12px",overflow:"hidden"}},{children:(0,a.jsx)("div",{style:{height:"100%",backgroundColor:l,width:"100%",transition:"width 5s linear",transformOrigin:"left"}})}))]}))}}};var Xi=function(){return Xi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xi.apply(this,arguments)},Zi=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},es="anki_stored_cards",ts=function(e){try{return e.startsWith("data:image/")&&e.length>1e5?(console.log("Large image detected, applying basic compression"),console.warn("Large image (".concat(Math.round(e.length/1024),"KB) detected. Consider using smaller images.")),e):e}catch(t){return console.error("Error compressing image:",t),e}},ns=function(e){try{var t=JSON.stringify(e,(function(e,t){return t instanceof Date?t.toISOString():t})),n=new Blob([t]).size/1048576;if(console.log("Storage analysis: ".concat(e.length," cards, ").concat(n.toFixed(2),"MB")),n<4)return e;console.warn("Storage size is large, optimizing...");for(var r=Zi([],e,!0).sort((function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()})),o=[],a=0,i=0,s=r;i<s.length;i++){var l=s[i],c=JSON.stringify(l,(function(e,t){return t instanceof Date?t.toISOString():t})),u=new Blob([c]).size;if(a+u>4194304){console.warn("Stopping at ".concat(o.length," cards to stay within storage limit"));break}o.push(l),a+=u}return o}catch(t){return console.error("Error managing storage quota:",t),e}},rs=function(){try{var e=localStorage.getItem(es);if(console.log("Loading cards from localStorage. Data exists:",!!e),e)try{var t=JSON.parse(e);if(console.log("Successfully parsed cards from localStorage, total count:",t.length),t.length>0){var n=t.slice(0,Math.min(3,t.length)),r=t.length>3?t.slice(-3):[];console.log("First few cards:",n.map((function(e){var t;return{id:e.id,text:null===(t=e.text)||void 0===t?void 0:t.substring(0,20)}}))),r.length>0&&console.log("Last few cards:",r.map((function(e){var t;return{id:e.id,text:null===(t=e.text)||void 0===t?void 0:t.substring(0,20)}})))}if(!Array.isArray(t))return console.error("Stored cards is not an array!",t),[];var o=t.filter((function(e){var t=!!e.id,n=!!e.text,r=!!e.createdAt;return!!(t&&n&&r)||(console.warn("Found invalid card, removing from results:",e),!1)}));console.log("Card validation: ".concat(o.length," valid out of ").concat(t.length," total"));var a=o.map((function(e){return Xi(Xi({},e),{createdAt:new Date(e.createdAt)})})),i=a.filter((function(e){return e.image||e.imageUrl}));return console.log("Loaded cards with images:",i.length),i.forEach((function(e){var t,n,r,o;console.log("Loaded card ".concat(e.id," image data:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)})})),a}catch(e){return console.error("JSON parse error:",e),localStorage.removeItem(es),[]}}catch(e){console.error("Error loading cards from localStorage:",e);try{localStorage.removeItem(es)}catch(e){console.error("Could not clean up localStorage:",e)}}return[]},os=function(e){try{console.log("Saving cards to localStorage:",e),console.log("Total cards count:",e.length);var t=e.filter((function(e){return e.image||e.imageUrl}));console.log("Cards with images:",t.length),t.forEach((function(e){var t,n,r,o;console.log("Card ".concat(e.id," image data:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length,imagePreview:null===(r=e.image)||void 0===r?void 0:r.substring(0,50),imageUrlPreview:null===(o=e.imageUrl)||void 0===o?void 0:o.substring(0,50)})}));var n=ns(e);n.length<e.length&&console.warn("Storage optimization: keeping ".concat(n.length," of ").concat(e.length," cards to preserve images"));var r=JSON.stringify(n,(function(e,t){return t instanceof Date?t.toISOString():t})),o=new Blob([r]).size;console.log("Storage size in bytes:",o,"Approximate max size: ~5MB"),o>4194304&&console.warn("Warning: localStorage size is getting large (>4MB). This might cause issues in some browsers."),localStorage.setItem(es,r),console.log("Cards saved successfully to localStorage with image preservation")}catch(t){console.error("Error saving cards to localStorage:",t);var a=0;try{var i=JSON.stringify(e,(function(e,t){return t instanceof Date?t.toISOString():t}));a=new Blob([i]).size}catch(e){console.error("Could not determine original size:",e)}if(t instanceof DOMException&&("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&(console.error("localStorage quota exceeded. Cannot save more cards. Trying to preserve images by using other strategies."),console.warn("⚠️ Storage quota exceeded! This usually happens when you have many cards with large images."),console.warn("💡 To fix this:"),console.warn("   • Use smaller images"),console.warn("   • Export older cards and delete them"),console.warn("   • Consider using image URLs instead of embedded images"),e.length>0)){console.warn("CRITICAL: Storage quota exceeded. Attempting to preserve images while managing storage.");try{console.warn("Storage quota exceeded. Using intelligent optimization to preserve images...");var s=ns(e);if(s.length>0){var l=JSON.stringify(s,(function(e,t){return t instanceof Date?t.toISOString():t}));if(new Blob([l]).size<=4718592)return localStorage.setItem(es,l),void console.warn("Smart optimization: Saved ".concat(s.length," of ").concat(e.length," cards with images preserved"))}var c=e.map((function(e){return Xi(Xi({},e),{image:e.image?ts(e.image):null,id:e.id,text:e.text,translation:e.translation,front:e.front,back:e.back,examples:e.examples,imageUrl:e.imageUrl,createdAt:e.createdAt,exportStatus:e.exportStatus,linguisticInfo:e.linguisticInfo,transcription:e.transcription})}));console.warn("Attempting to save cards with compressed images instead of removing them.");var u=JSON.stringify(c,(function(e,t){return t instanceof Date?t.toISOString():t})),d=new Blob([u]).size;if(console.log("Reduced size from ".concat(a," to ").concat(d," bytes")),d>4718592){console.warn("Still too large after size reduction, falling back to limiting card count");for(var f=Zi([],c,!0).sort((function(e,t){return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()})),p=Math.min(10,f.length),g=void 0;p<f.length;){g=f.slice(0,p);var h=JSON.stringify(g,(function(e,t){return t instanceof Date?t.toISOString():t}));if(new Blob([h]).size>4718592)break;p+=5}console.warn("Emergency preservation: keeping ".concat(p," cards out of ").concat(f.length," total (removing oldest to preserve newest with images)"));var m=f.slice(-p);localStorage.setItem(es,JSON.stringify(m,(function(e,t){return t instanceof Date?t.toISOString():t})))}else localStorage.setItem(es,u);return void console.log("Saved cards with image preservation strategy to fit within quota")}catch(e){console.error("Failed to save with data reduction:",e)}}}};const as=function(e){return function(t){return function(n){var r=t(n);switch(n.type){case K:try{var o=rs();e.dispatch({type:"SET_STORED_CARDS",payload:o})}catch(t){console.error("Error in LOAD_STORED_CARDS middleware:",t),e.dispatch({type:"SET_STORED_CARDS",payload:[]})}break;case G:case Y:case X:case J:try{var a=e.getState().cards.storedCards;os(a)}catch(e){console.error("Error in card storage middleware:",e)}break;case Z:n.payload?localStorage.setItem("current_card_id",n.payload):(localStorage.removeItem("current_card_id"),localStorage.removeItem("explicitly_saved"));break;case M:0===e.getState().cards.storedCards.length&&e.dispatch({type:K})}return r}}};var is,ss=function(){return ss=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ss.apply(this,arguments)};!function(e){e.OpenAI="openai",e.Groq="groq"}(is||(is={}));var ls,cs={openAiKey:"",mode:j.LanguageLearning,translateToLanguage:"ru",ankiConnectUrl:"http://127.0.0.1:8765",ankiConnectApiKey:null,useAnkiConnect:!1,visibleSideBar:!0,groqApiKey:"",groqModelName:"llama3-8b-8192",shouldGenerateImage:!0,imageGenerationMode:"smart",translationPrompt:"",examplesPrompt:"",aiInstructions:"",imageInstructions:"",modelProvider:is.OpenAI,sourceLanguage:"en"},us=function(e,t,n){var r="".concat(e," - ");return r+=401===t?"Authentication error. Please check your API key.":429===t?"Rate limit exceeded. Please try again later.":500===t||503===t?"Service unavailable. The model might be overloaded or offline.":400===t?"Bad request. The input may be invalid.":"Error code ".concat(t,". ").concat(ds(n))},ds=function(e){if(!e)return"Unknown error";if(e.error){if("string"==typeof e.error)return e.error;if(e.error.message)return e.error.message;if(e.error.type)return"Error type: ".concat(e.error.type)}if(e.message)return e.message;try{return JSON.stringify(e)}catch(e){return"Unable to parse error details"}},fs=(ls=function(e,t){return ls=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ls(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ls(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ps=function(){return ps=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ps.apply(this,arguments)},gs=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},hs=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ms=function(){function e(e,t){void 0===t&&(t=""),this.apiKey=e,this.modelName=t}return e.prototype.extractPlainText=function(e){if(!e)return null;var t=e.replace(/<\/?[^>]+(>|$)/g,"");return t=t.replace(/^#+\s+/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/```[\s\S]*?```/g,"").replace(/\[(.*?)\]\((.*?)\)/g,"$1").trim()},e.prototype.getPrompts=function(){return{translate:function(e,t){return"Translate the following text to ".concat(t,': "').concat(e,'". \nOutput ONLY the direct translation, without any additional text, explanations, quotes, examples, or formatting.\nProvide the most common and appropriate translation. Only include multiple meanings if the word has distinctly different translations that are equally common.\nIf multiple translations are needed, separate them with commas (e.g., "перевод1, перевод2, перевод3").\nDo not include definitions, examples, notes, or part of speech information in English like (noun), (verb), (adjective), etc.\nOnly provide the clean translated word or phrase without any parenthetical information.')},examples:function(e,t){var n=t?"Give me exactly three example sentences using the word '".concat(e,"' in the language with code \"").concat(t,'".'):"Give me exactly three example sentences using the word '".concat(e,"' in its original language.");return"".concat(n,"\nEach sentence should show natural usage of '").concat(e,"' in that language.\nFormat your response as follows:\n1. [First example sentence here]\n2. [Second example sentence here] \n3. [Third example sentence here]\nDo not include definitions, explanations, or translations, ONLY the numbered example sentences as shown above.")},imageDescription:function(e){return'Create a short visual description of the word/concept "'.concat(e,'" for image generation.\nThe description should be concrete, visual, and focus on representational elements.\nKeep the description under 50 words and make sure it is purely descriptive without any formatting.')}}},e.prototype.translateText=function(e,t,n){return void 0===t&&(t="ru"),void 0===n&&(n=""),gs(this,void 0,void 0,(function(){var r,o,a,i,s,l,c,u;return hs(this,(function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),r=this.getPrompts().translate(e,t),o=n?"".concat(r,". ").concat(n):r,[4,this.sendRequest(o)];case 1:return(a=d.sent())?(i=this.extractPlainText(a))&&(i=i.replace(/^translation[:\s-]*/i,"").replace(/^["']|["']$/g,"").replace(/^.*?:\s*/i,"").replace(/^\s*-\s*/,"").replace(/^translated\s*as\s*:?\s*/i,"").replace(/^перевод\s*:?\s*/i,"").replace(/\s*definition:[\s\S]*$/i,"").replace(/\s*examples:[\s\S]*$/i,"").replace(/\s*example:[\s\S]*$/i,"").replace(/\s*example sentences:[\s\S]*$/i,"").replace(/\s*примеры:[\s\S]*$/i,"").replace(/\s*пример:[\s\S]*$/i,"").replace(/\s*notes:[\s\S]*$/i,"").replace(/\s*определение:[\s\S]*$/i,"").replace(/\s*here is the response[\s\S]*$/i,"").replace(/\s*\(adjective\)[\s\S]*$/i,"").replace(/\s*\(noun\)[\s\S]*$/i,"").replace(/\s*\(verb\)[\s\S]*$/i,"").replace(/\s*\(adverb\)[\s\S]*$/i,"").replace(/\s*\(preposition\)[\s\S]*$/i,"").replace(/\s*\(pronoun\)[\s\S]*$/i,"").replace(/\s*\(conjunction\)[\s\S]*$/i,"").replace(/\s*\(interjection\)[\s\S]*$/i,"").replace(/\s*\([^)]*\)[\s\S]*$/i,"").replace(/^the word[\s\S]*translated as[\s:]*/i,"").replace(/^словосочетание[\s\S]*переводится как[\s:]*/i,"").replace(/^слово[\s\S]*переводится как[\s:]*/i,"").replace(/^.*?это[\s:]*/i,"").replace(/^.*?означает[\s:]*/i,"").replace(/^.*?means[\s:]*/i,"").replace(/^the translation is[\s:]*/i,"").split("\n")[0].trim(),s=i.split(/\s+/),i.includes(",")?(l=i.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).slice(0,3),i=l.join(", ")):s.length>8&&((c=e.split(/\s+/).length)<=5||s.length<=2*c||(console.log("Translation too long, trimming:",i),i=s.slice(0,8).join(" "))),!i&&a)?[2,a.split("\n")[0].trim()]:(console.log("Original translation:",a),console.log("Cleaned translation:",i),[2,i]):[2,null];case 2:throw u=d.sent(),console.error("Error during translation:",u),u;case 3:return[2]}}))}))},e.prototype.getExamples=function(e,t,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=""),gs(this,void 0,void 0,(function(){var a,i,s,l,c,u,d,f,p,g,h,m,y,x,v;return hs(this,(function(b){switch(b.label){case 0:return b.trys.push([0,9,,10]),a=this.getPrompts().examples(e,o),i=r?"".concat(a," ").concat(r.replace(/\{word\}/g,e)):a,[4,this.sendRequest(i)];case 1:if(!(s=b.sent()))throw new Error("Failed to generate examples. Please try again with a different word.");for(console.log("Raw examples response:",s),l=this.extractPlainText(s)||"",c=l.replace(/^[\s\S]*?((?:\d+\s*\.\s*|•\s*|[\-\*]\s*).+$)/m,"$1").trim(),u=/(?:^|\n)(?:\d+\s*\.\s*|•\s*|[\-\*]\s*)(.+?)(?=(?:\n+(?:\d+\s*\.\s*|•\s*|[\-\*]\s*)|\n*$))/g,d=[],f=void 0;null!==(f=u.exec(c));)f[1]&&d.push(f[1].trim());0===d.length&&(d=c.split(/\n+/).map((function(e){return e.replace(/^\d+\s*\.\s*|^\s*•\s*|^\s*[\-\*]\s*/,"").trim()})).filter((function(t){return t.length>0&&t.toLowerCase().includes(e.toLowerCase())})).slice(0,3)),0===d.length&&(d=c.split(/\n+/).map((function(e){return e.replace(/^\d+\s*\.\s*|^\s*•\s*|^\s*[\-\*]\s*/,"").trim()})).filter((function(e){return e.length>0})).slice(0,3)),d=d.map((function(e){return e.replace(/^(example|sentence|пример|предложение)[\s:]*/i,"").replace(/^["']|["']$/g,"")})),console.log("Processed examples:",d),p=[],g=0,h=d,b.label=2;case 2:if(!(g<h.length))return[3,8];if(!(m=h[g]).trim())return[3,7];if(y=null,!n)return[3,6];b.label=3;case 3:return b.trys.push([3,5,,6]),[4,this.translateText(m,t)];case 4:return y=b.sent(),[3,6];case 5:return x=b.sent(),console.error("Error translating example:",x),[3,6];case 6:if(p.push([m,y]),p.length>=3)return[3,8];b.label=7;case 7:return g++,[3,2];case 8:if(0===p.length)throw new Error("Could not generate examples. Please try again with a different word or check your API key.");return[2,p];case 9:throw v=b.sent(),console.error("Error getting examples:",v),v;case 10:return[2]}}))}))},e.prototype.getDescriptionImage=function(e,t){return void 0===t&&(t=""),gs(this,void 0,void 0,(function(){var n,r,o,a;return hs(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n=this.getPrompts().imageDescription(e),r=t?"".concat(n," ").concat(t):n,[4,this.sendRequest(r)];case 1:if(!(o=i.sent()))throw new Error("Failed to generate image description. Please try again.");return[2,this.extractPlainText(o)||o];case 2:throw a=i.sent(),console.error("Error generating image description:",a),a;case 3:return[2]}}))}))},e.prototype.generateAnkiFront=function(e){return gs(this,void 0,void 0,(function(){var t,n,r,o;return hs(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t='For the word or phrase "'.concat(e,'", provide ONLY the word itself without any pronunciation or additional formatting.\nJust return the clean word/phrase as it should appear on the front of an Anki card.\nFor example: if input is "hello", return "hello"\nIf input is "beautiful", return "beautiful"\nYour response should contain ONLY the word/phrase, no pronunciation, no IPA, no additional text.'),[4,this.sendRequest(t)];case 1:return(n=a.sent())?(r=(r=this.extractPlainText(n)||n).split("\n")[0].replace(/^["']|["']$/g,"").replace(/\/.*?\//g,"").replace(/\[.*?\]/g,"").replace(/\(.*?\)/g,"").replace(/^front:[\s:]*/i,"").replace(/^word:[\s:]*/i,"").trim(),console.log("Front card response:",r),[2,r||e]):[2,e];case 2:return o=a.sent(),console.error("Error generating Anki front:",o),[2,e];case 3:return[2]}}))}))},e.prototype.createTranscription=function(e,t,n){return gs(this,void 0,void 0,(function(){var r,o,a;return hs(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),r=this.createTranscriptionPrompt(e,t,n),[4,this.sendRequest(r)];case 1:return(o=i.sent())?[2,this.parseTranscriptionResponse(o)]:[2,null];case 2:return a=i.sent(),console.error("Error creating transcription:",a),[2,null];case 3:return[2]}}))}))},e.prototype.createTranscriptionPrompt=function(e,t,n){return'Create transcriptions for the word/phrase "'.concat(e,'" (in ').concat(t,"):\n\n1. User language transcription: Show how to pronounce this word using ").concat(n,' phonetics/script\n2. IPA transcription: International Phonetic Alphabet notation\n\nIMPORTANT:\n- For user language: Write how "').concat(e,'" sounds using ').concat(n," pronunciation system\n- For IPA: Use proper IPA symbols [ˈ ˌ ə ɪ ɛ æ ɑ ɔ ʊ ʌ θ ð ʃ ʒ ʧ ʤ ŋ etc.]\n- Format exactly as shown below:\n\nUSER_LANG: [how the word sounds in ").concat(n,']\nIPA: [ˈaɪ.pi.eɪ notation]\n\nExample for Russian "короткая" with Spanish user language:\nUSER_LANG: korotkaya\nIPA: [kəˈrotkəjə]\n\nProvide ONLY the two lines as shown above, no additional text.')},e.prototype.parseTranscriptionResponse=function(e){var t=this.extractPlainText(e)||e,n=null,r=null,o=t.match(/USER_LANG:\s*(.+)/i);o&&(n=o[1].trim());var a=t.match(/IPA:\s*(.+)/i);return a&&(r=a[1].trim().replace(/^\[|\]$/g,"").replace(/^\/|\/$/g,""))&&!r.startsWith("[")&&(r="[".concat(r,"]")),{userLanguageTranscription:n,ipaTranscription:r}},e}(),ys=function(e){function t(t,n){void 0===n&&(n="gpt-3.5-turbo");var r=e.call(this,t,n)||this;return r.openai=new Hi({apiKey:t,dangerouslyAllowBrowser:!0}),r}return fs(t,e),t.prototype.sendRequest=function(e,t){var n,r,o;return void 0===t&&(t={}),gs(this,void 0,void 0,(function(){var a,i;return hs(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.openai.chat.completions.create(ps({model:this.modelName,messages:[{role:"user",content:e}]},t))];case 1:return a=s.sent(),[2,(null===(o=null===(r=null===(n=a.choices[0])||void 0===n?void 0:n.message)||void 0===r?void 0:r.content)||void 0===o?void 0:o.trim())||null];case 2:throw i=s.sent(),console.error("Error in OpenAI request:",i),i;case 3:return[2]}}))}))},t.prototype.getImageUrl=function(e){var t,n;return gs(this,void 0,void 0,(function(){var r,o;return hs(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.openai.images.generate({model:"dall-e-3",prompt:e,n:1,size:"1024x1024"})];case 1:return r=a.sent(),[2,(null===(n=null===(t=r.data)||void 0===t?void 0:t[0])||void 0===n?void 0:n.url)||null];case 2:throw o=a.sent(),console.error("Error generating image with OpenAI:",o),o;case 3:return[2]}}))}))},t.prototype.extractKeyTerms=function(e){return gs(this,void 0,void 0,(function(){var t,n,r,o;return hs(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t="You are a helpful language learning assistant. Extract key terms from the text that would be useful to learn as flashcards. Limit to 5 most important terms max. Return only the terms, one per line, without any additional text or formatting.",[4,this.sendRequest(t,{messages:[{role:"system",content:t},{role:"user",content:e}]})];case 1:return n=a.sent(),(r=n||"")?[2,r.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))]:[2,[]];case 2:return o=a.sent(),console.error("Error extracting key terms with OpenAI:",o),[2,[]];case 3:return[2]}}))}))},t.prototype.createChatCompletion=function(e,t){var n,r,o;return gs(this,void 0,void 0,(function(){var e,a,i,s;return hs(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),e=t.map((function(e){return{role:e.role,content:e.content}})),[4,this.openai.chat.completions.create({model:this.modelName,messages:e})];case 1:return a=l.sent(),(i=(null===(o=null===(r=null===(n=a.choices[0])||void 0===n?void 0:n.message)||void 0===r?void 0:r.content)||void 0===o?void 0:o.trim())||"")?[2,{content:i}]:[2,null];case 2:throw s=l.sent(),console.error("Error in OpenAI chat completion:",s),s;case 3:return[2]}}))}))},t}(ms),xs=function(e){function t(t,n){void 0===n&&(n="llama3-8b-8192");var r=e.call(this,t,n)||this;return r.apiBaseUrl="https://api.groq.com/openai/v1",r}return fs(t,e),t.prototype.sendRequest=function(e,t){var n,r,o,a,i;return void 0===t&&(t={}),gs(this,void 0,void 0,(function(){var s,l,c,u;return hs(this,(function(d){switch(d.label){case 0:if(d.trys.push([0,5,,6]),!this.apiKey)throw new Error("Groq API key is missing. Please check your settings.");return[4,fetch("".concat(this.apiBaseUrl,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.apiKey)},body:JSON.stringify({model:this.modelName,messages:[{role:"user",content:e}],max_tokens:t.max_tokens||1e3})})];case 1:return(s=d.sent()).ok?[3,3]:[4,s.json()];case 2:throw l=d.sent(),new Error(us("Groq API Error",s.status,l));case 3:return[4,s.json()];case 4:return c=d.sent(),[2,null!==(i=null===(a=null===(o=null===(r=null===(n=c.choices)||void 0===n?void 0:n[0])||void 0===r?void 0:r.message)||void 0===o?void 0:o.content)||void 0===a?void 0:a.trim())&&void 0!==i?i:null];case 5:throw u=d.sent(),console.error("Error in Groq API request:",u),u;case 6:return[2]}}))}))},t.prototype.getImageUrl=function(){throw new Error("Image generation is not supported by Groq.")},t.prototype.extractKeyTerms=function(e){return gs(this,void 0,void 0,(function(){var t,n,r,o;return hs(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t="You are a helpful language learning assistant. Extract key terms from the text that would be useful to learn as flashcards. Limit to 5 most important terms max. Return only the terms, one per line, without any additional text or formatting.",[4,this.sendRequest(t,{messages:[{role:"system",content:t},{role:"user",content:e}]})];case 1:return n=a.sent(),(r=n||"")?[2,r.split("\n").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))]:[2,[]];case 2:return o=a.sent(),console.error("Error extracting key terms with Groq:",o),[2,[]];case 3:return[2]}}))}))},t.prototype.createChatCompletion=function(e,t){var n,r,o,a,i;return gs(this,void 0,void 0,(function(){var e,s,l,c,u;return hs(this,(function(d){switch(d.label){case 0:if(d.trys.push([0,5,,6]),!this.apiKey)throw new Error("Groq API key is missing. Please check your settings.");return[4,fetch("".concat(this.apiBaseUrl,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.apiKey)},body:JSON.stringify({model:this.modelName,messages:t,max_tokens:1e3})})];case 1:return(e=d.sent()).ok?[3,3]:[4,e.json()];case 2:throw s=d.sent(),new Error(us("Groq API Error",e.status,s));case 3:return[4,e.json()];case 4:return l=d.sent(),(c=null!==(i=null===(a=null===(o=null===(r=null===(n=l.choices)||void 0===n?void 0:n[0])||void 0===r?void 0:r.message)||void 0===o?void 0:o.content)||void 0===a?void 0:a.trim())&&void 0!==i?i:"")?[2,{content:c}]:[2,null];case 5:throw u=d.sent(),console.error("Error in Groq chat completion:",u),u;case 6:return[2]}}))}))},t}(ms),vs=function(e,t,n){switch(void 0===n&&(n=""),e){case is.OpenAI:return new ys(t,n||"gpt-3.5-turbo");case is.Groq:return new xs(t,n||"llama3-8b-8192");default:return new ys(t,n||"gpt-3.5-turbo")}},bs=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},ws=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ss=function(e){return function(e){return{translateText:function(t,n,r,o){return void 0===r&&(r="ru"),void 0===o&&(o=""),bs(void 0,void 0,void 0,(function(){return ws(this,(function(a){return[2,vs(e,t).translateText(n,r,o)]}))}))},getExamples:function(t,n,r,o,a,i){return void 0===o&&(o=!1),void 0===a&&(a=""),bs(void 0,void 0,void 0,(function(){return ws(this,(function(s){return[2,vs(e,t).getExamples(n,r,o,a,i)]}))}))},getDescriptionImage:function(t,n,r){return void 0===r&&(r=""),bs(void 0,void 0,void 0,(function(){return ws(this,(function(o){return[2,vs(e,t).getDescriptionImage(n,r)]}))}))},getImageUrl:function(t,n){return bs(void 0,void 0,void 0,(function(){var r;return ws(this,(function(o){return[2,(r=vs(e,t)).getImageUrl?r.getImageUrl(n):null]}))}))},generateAnkiFront:function(t,n){return bs(void 0,void 0,void 0,(function(){return ws(this,(function(r){return[2,vs(e,t).generateAnkiFront(n)]}))}))},extractKeyTerms:function(t,n){return bs(void 0,void 0,void 0,(function(){return ws(this,(function(r){return[2,vs(e,t).extractKeyTerms(n)]}))}))},createChatCompletion:function(t,n){return bs(void 0,void 0,void 0,(function(){var r;return ws(this,(function(o){return(r=vs(e,t)).createChatCompletion?[2,r.createChatCompletion(t,n)]:(console.error("createChatCompletion not implemented in the provider"),[2,null])}))}))},createTranscription:function(t,n,r,o){return bs(void 0,void 0,void 0,(function(){return ws(this,(function(a){return[2,vs(e,t).createTranscription(n,r,o)]}))}))}}}(e)},ks=function(e,t,n,r,o,a){return bs(void 0,void 0,void 0,(function(){var a,i;return ws(this,(function(s){switch(s.label){case 0:if(s.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.translateText(t,n,r,o)];case 1:return a=s.sent(),[2,{original:n,translated:a}];case 2:throw i=s.sent(),console.error("Error in unified translation:",i),i instanceof Error?i:new Error("Failed to translate text. Please check your API key and settings.");case 3:return[2]}}))}))},Es=function(e,t,n,r,o,a,i){return void 0===o&&(o=!1),bs(void 0,void 0,void 0,(function(){var s;return ws(this,(function(l){switch(l.label){case 0:if(l.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.getExamples(t,n,r,o,a,i)];case 1:return[2,l.sent().map((function(e){return{original:e[0],translated:e[1]}}))];case 2:throw s=l.sent(),console.error("Error in unified examples generation:",s),s instanceof Error?s:new Error("Failed to generate examples. Please check your API key and settings.");case 3:return[2]}}))}))},Cs=function(e,t,n){return bs(void 0,void 0,void 0,(function(){var r,o;return ws(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.generateAnkiFront(t,n)];case 1:if(!(r=a.sent()))throw new Error("Failed to generate flashcard content. Please try again or check your API key.");return[2,{front:r}];case 2:throw o=a.sent(),console.error("Error in unified flashcard creation:",o),o instanceof Error?o:new Error("Failed to create flashcard. Please check your API key and settings.");case 3:return[2]}}))}))},_s=function(e,t,n,r,o){return void 0===o&&(o="ru"),bs(void 0,void 0,void 0,(function(){var a,i;return ws(this,(function(s){switch(s.label){case 0:if(s.trys.push([0,2,,3]),!t)throw new Error("API key is missing. Please check your settings.");return[4,e.createTranscription(t,n,r,o)];case 1:if(!(a=s.sent()))throw new Error("Failed to generate transcription. Please try again or check your API key.");return[2,a];case 2:throw i=s.sent(),console.error("Error in unified transcription creation:",i),i instanceof Error?i:new Error("Failed to create transcription. Please check your API key and settings.");case 3:return[2]}}))}))};function Is(e,t,n,r,o){return void 0===o&&(o="ru"),bs(this,void 0,void 0,(function(){var a,i,s,l;return ws(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),console.log('Creating linguistic info for "'.concat(n,'" in ').concat(r,", interface: ").concat(o)),a=function(e,t,n){void 0===n&&(n="ru");var r=function(e){switch(e){case"ru":return{name:"RUSSIAN",terms:"Глагол, Существительное, Прилагательное, Наречие",gender:"Мужской, Женский, Средний",number:"Единственное число, Множественное число",tense:"Настоящее время, Прошедшее время, Будущее время",case:"Именительный, Родительный, Дательный, Винительный, Творительный, Предложный",person:"1-е лицо, 2-е лицо, 3-е лицо",labels:{partOfSpeech:"Часть речи",baseForm:"Основная форма",gender:"Род",number:"Число",case:"Падеж",tense:"Время/Вид",person:"Лицо/Число"},forbidden:"Verb, Noun, Adjective, Present, Past, Masculine, Feminine, Singular, Plural"};case"es":return{name:"SPANISH",terms:"Verbo, Sustantivo, Adjetivo, Adverbio",gender:"Masculino, Femenino, Neutro",number:"Singular, Plural",tense:"Presente, Pasado, Futuro",case:"Nominativo, Genitivo, Dativo, Acusativo",person:"1ª persona, 2ª persona, 3ª persona",labels:{partOfSpeech:"Categoría gramatical",baseForm:"Forma base",gender:"Género",number:"Número",case:"Caso",tense:"Tiempo/Aspecto",person:"Persona/Número"},forbidden:"Verb, Noun, Adjective, Present, Past, Masculine, Feminine, Singular, Plural"};case"fr":return{name:"FRENCH",terms:"Verbe, Nom, Adjectif, Adverbe",gender:"Masculin, Féminin, Neutre",number:"Singulier, Pluriel",tense:"Présent, Passé, Futur",case:"Nominatif, Génitif, Datif, Accusatif",person:"1ère personne, 2ème personne, 3ème personne",labels:{partOfSpeech:"Catégorie grammaticale",baseForm:"Forme de base",gender:"Genre",number:"Nombre",case:"Cas",tense:"Temps/Aspect",person:"Personne/Nombre"},forbidden:"Verb, Noun, Adjective, Present, Past, Masculine, Feminine, Singular, Plural"};case"de":return{name:"GERMAN",terms:"Verb, Substantiv, Adjektiv, Adverb",gender:"Maskulin, Feminin, Neutrum",number:"Singular, Plural",tense:"Präsens, Präteritum, Futur",case:"Nominativ, Genitiv, Dativ, Akkusativ",person:"1. Person, 2. Person, 3. Person",labels:{partOfSpeech:"Wortart",baseForm:"Grundform",gender:"Geschlecht",number:"Numerus",case:"Kasus",tense:"Tempus/Aspekt",person:"Person/Numerus"},forbidden:"English terms like Verb, Noun, Present, Past, Masculine, Feminine"};case"it":return{name:"ITALIAN",terms:"Verbo, Sostantivo, Aggettivo, Avverbio",gender:"Maschile, Femminile, Neutro",number:"Singolare, Plurale",tense:"Presente, Passato, Futuro",case:"Nominativo, Genitivo, Dativo, Accusativo",person:"1ª persona, 2ª persona, 3ª persona",labels:{partOfSpeech:"Categoria grammaticale",baseForm:"Forma base",gender:"Genere",number:"Numero",case:"Caso",tense:"Tempo/Aspetto",person:"Persona/Numero"},forbidden:"Verb, Noun, Adjective, Present, Past, Masculine, Feminine, Singular, Plural"};default:return{name:"ENGLISH",terms:"Verb, Noun, Adjective, Adverb",gender:"Masculine, Feminine, Neuter",number:"Singular, Plural",tense:"Present, Past, Future",case:"Nominative, Genitive, Dative, Accusative",person:"1st person, 2nd person, 3rd person",labels:{partOfSpeech:"Part of speech",baseForm:"Base form",gender:"Gender",number:"Number",case:"Case",tense:"Tense/Aspect",person:"Person/Number"},forbidden:"Russian, Spanish, French, German terms"}}}(n),o='You are a professional linguist creating grammar references for language learners.\n\n⚠️ CRITICAL LANGUAGE REQUIREMENTS ⚠️\n1. ONLY analyze the SOURCE TERM "'.concat(e,'" in "').concat(t,'" language\n2. DO NOT analyze any translation - ONLY the ORIGINAL TERM\n3. ALL interface labels and grammatical terms MUST be in ').concat(r.name,' ONLY\n4. Base forms of words should be in the source language "').concat(t,'"\n5. NEVER mix languages - use ONLY ').concat(r.name," throughout\n\n").concat(r.name," LANGUAGE REQUIREMENTS:\n- Use ONLY ").concat(r.name," grammatical terms: ").concat(r.terms,"\n- Use ONLY ").concat(r.name," gender terms: ").concat(r.gender,"\n- Use ONLY ").concat(r.name," number terms: ").concat(r.number,"\n- Use ONLY ").concat(r.name," tense terms: ").concat(r.tense,"\n- Use ONLY ").concat(r.name," case terms: ").concat(r.case,"\n- Use ONLY ").concat(r.name," person terms: ").concat(r.person,"\n\nFORBIDDEN TERMS:\n❌ Never use: ").concat(r.forbidden,"\n✅ Always use: ").concat(r.terms,'\n\nUSE EMOJI SYMBOLS FOR CATEGORIES:\n📚 For part of speech\n🏠 For root/base form (ONLY if current word is NOT in its base form)\n⚥ For gender\n📋 For number/form\n🎯 For case\n🕒 For tense/aspect\n👤 For person\n🎭 For mood\n🔄 For voice\n📐 For degree\n⚠️ For irregular forms\n\nHTML STRUCTURE:\n<div class="grammar-item">\n  <span class="icon-pos">📚</span> <strong>').concat(r.labels.partOfSpeech,':</strong> <span class="grammar-tag tag-pos">[').concat(r.name," term]</span>\n</div>\n\nEXAMPLE CORRECT OUTPUT (").concat(r.name,' interface):\n<div class="grammar-item">\n  <span class="icon-pos">📚</span> <strong>').concat(r.labels.partOfSpeech,':</strong> <span class="grammar-tag tag-pos">').concat(r.terms.split(",")[0].trim(),'</span>\n</div>\n<div class="grammar-item">\n  <span class="icon-root">🏠</span> <strong>').concat(r.labels.baseForm,':</strong> <span class="grammar-tag tag-root">[word in source language]</span>\n</div>\n<div class="grammar-item">\n  <span class="icon-gender">⚥</span> <strong>').concat(r.labels.gender,':</strong> <span class="grammar-tag tag-gender">').concat(r.gender.split(",")[0].trim(),"</span>\n</div>\n\nEXAMPLE WRONG OUTPUT (DO NOT DO THIS):\n❌ <strong>Part of speech:</strong> <span>Noun</span>\n❌ <strong>Gender:</strong> <span>Feminine</span>\n❌ <strong>Case:</strong> <span>Nominative</span>\n❌ <strong>Number/Form:</strong> <span>Singular</span>\n\nMANDATORY REQUIREMENTS:\n1. Maximum 4-6 grammar points\n2. Each tag content: maximum 3-4 words\n3. Include comprehensive grammatical information\n4. Use ONLY ").concat(r.name," language throughout\n5. Be thorough but concise\n6. Include base form ONLY if current word is NOT in its base form\n7. ALL labels and terms must be in ").concat(r.name," consistently\n\nCRITICAL: Your response must be 100% in ").concat(r.name," for all grammatical terms and labels. No mixing of languages allowed.");return o}(n,r,o),[4,e.createChatCompletion(t,[{role:"user",content:a}])];case 1:return(i=c.sent())&&i.content?((s=i.content).includes("<"),console.log("Generated linguistic info length:",(null==s?void 0:s.length)||0),[2,s]):[2,null];case 2:return l=c.sent(),console.error("Error creating linguistic info:",l),[2,null];case 3:return[2]}}))}))}function js(e,t,n,r,o,a){return void 0===a&&(a="ru"),bs(this,void 0,void 0,(function(){var i,s,l,c,u,d,f,p,g,h,m;return ws(this,(function(y){switch(y.label){case 0:return y.trys.push([0,2,,3]),console.log('Validating linguistic info for "'.concat(n,'" in ').concat(o)),i=function(e,t,n,r){return'You are an expert linguist specializing in grammar validation. Your task is to verify the grammatical accuracy of a linguistic reference.\n\nANALYSIS TARGET:\n- Word/Phrase: "'.concat(e,'"\n- Source Language: ').concat(n,"\n- Interface Language: ").concat(r,"\n\nLINGUISTIC REFERENCE TO VALIDATE:\n").concat(t,'\n\nVALIDATION INSTRUCTIONS:\n1. **Analyze the source word "').concat(e,'" in ').concat(n," language ONLY**\n2. **DO NOT analyze translations** - focus only on the original word\n3. **Check grammatical consistency** according to ").concat(n," language rules\n4. **Verify logical compatibility** of grammatical characteristics\n\nSPECIFIC CHECKS FOR ").concat(n.toUpperCase(),' LANGUAGE:\n• **Part of Speech**: Verify the word classification is correct\n• **Gender**: Check if gender is appropriate (singular forms only for most languages)\n• **Number**: Ensure number is correctly identified\n• **Case**: Validate case forms match the language\'s case system\n• **Tense/Aspect**: For verbs, check tense and aspect accuracy\n• **Degree**: Comparison degrees should only apply to adjectives/adverbs, NOT nouns\n• **Morphological Features**: Verify all features are linguistically valid\n\nCOMMON ERRORS TO DETECT:\n❌ Gender specified for plural forms (where not applicable)\n❌ Comparison degrees assigned to nouns\n❌ Incorrect case systems for the language\n❌ Wrong tense/aspect combinations\n❌ Analysis of translation instead of source word\n❌ Inconsistent grammatical categories\n\nRESPONSE FORMAT:\nVALIDATION: [VALID/INVALID]\n\nERRORS:\n[List specific errors found, or "None"]\n\nCORRECTIONS:\n[Suggest specific corrections, or "None"]\n\nBe thorough and precise. Focus on grammatical accuracy for ').concat(n," language rules.")}(n,r,o,a),[4,e.createChatCompletion(t,[{role:"user",content:i}])];case 1:return(s=y.sent())&&s.content?(l=s.content.trim(),console.log("Validation response:",l),c=l.includes("VALIDATION: VALID")||l.includes("✅ VALID"),u=l.match(/ERRORS?:([\s\S]*?)(?:CORRECTIONS?:|$)/),d=l.match(/CORRECTIONS?:([\s\S]*?)$/),f=[],p=[],u&&u[1]&&(g=u[1].trim())&&"None"!==g&&"Нет"!==g&&f.push.apply(f,g.split("\n").filter((function(e){return e.trim()})).map((function(e){return e.replace(/^[•\-*]\s*/,"").trim()}))),d&&d[1]&&(h=d[1].trim())&&"None"!==h&&"Нет"!==h&&p.push.apply(p,h.split("\n").filter((function(e){return e.trim()})).map((function(e){return e.replace(/^[•\-*]\s*/,"").trim()}))),[2,{isValid:c,errors:f,corrections:p.length>0?p:void 0}]):[2,{isValid:!1,errors:["Failed to validate linguistic information"]}];case 2:return m=y.sent(),console.error("Error validating linguistic info:",m),[2,{isValid:!1,errors:["Validation service unavailable"]}];case 3:return[2]}}))}))}function As(e,t,n,r,o,a,i,s){return void 0===s&&(s="ru"),bs(this,void 0,void 0,(function(){var l,c,u;return ws(this,(function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),console.log('Correcting linguistic info for "'.concat(n,'" based on validation errors')),l=function(e,t,n,r,o,a){var i=n.map((function(e){return"• ".concat(e)})).join("\n"),s=r.map((function(e){return"• ".concat(e)})).join("\n");return'Ты эксперт-лингвист. Исправь грамматическую справку на основе найденных ошибок.\n\nСЛОВО ДЛЯ АНАЛИЗА: "'.concat(e,'" (язык: ').concat(o,")\n\nИСХОДНАЯ СПРАВКА:\n").concat(t,"\n\nНАЙДЕННЫЕ ОШИБКИ:\n").concat(i,"\n\nРЕКОМЕНДАЦИИ ПО ИСПРАВЛЕНИЮ:\n").concat(s,'\n\nЗАДАЧА: Создай исправленную версию грамматической справки, устранив все указанные ошибки.\n\nТРЕБОВАНИЯ:\n1. Сохрани исходное HTML-форматирование\n2. Исправь только грамматические ошибки\n3. Убери неприменимые характеристики (например, род для мн.ч., степени сравнения для существительных)\n4. Все термины должны быть на языке "').concat(a,'"\n5. Анализируй только исходное слово "').concat(e,'", не его перевод\n\nВыведи ТОЛЬКО исправленную справку без дополнительных комментариев:')}(n,r,o,a,i,s),[4,e.createChatCompletion(t,[{role:"user",content:l}])];case 1:return(c=d.sent())&&c.content?[2,c.content.trim()]:[2,null];case 2:return u=d.sent(),console.error("Error correcting linguistic info:",u),[2,null];case 3:return[2]}}))}))}function Fs(e,t,n,r,o,a){return void 0===o&&(o="ru"),void 0===a&&(a=5),bs(this,void 0,void 0,(function(){var i,s,l,c,u;return ws(this,(function(d){switch(d.label){case 0:i=0,s=null,console.log('Starting iterative creation of linguistic info for "'.concat(n,'" (max ').concat(a," attempts)")),d.label=1;case 1:if(!(i<a))return[3,11];i++,console.log("Attempt ".concat(i,"/").concat(a)),d.label=2;case 2:return d.trys.push([2,9,,10]),s?[3,4]:[4,Is(e,t,n,r,o)];case 3:if(!(s=d.sent()))return console.log("Failed to generate linguistic info on attempt ".concat(i)),[3,1];d.label=4;case 4:return[4,js(e,t,n,s,r,o)];case 5:return(l=d.sent()).isValid?(console.log("Validation passed on attempt ".concat(i)),[2,{linguisticInfo:s,wasValidated:!0,attempts:i}]):l.errors.length>0?(console.log("Validation failed on attempt ".concat(i,":"),l.errors),l.corrections&&l.corrections.length>0&&i<a?(console.log("Attempting correction on attempt ".concat(i,"...")),[4,As(e,t,n,s,l.errors,l.corrections,r,o)]):[3,7]):[3,8];case 6:return(c=d.sent())?(s=c,console.log("Correction completed on attempt ".concat(i)),[3,1]):(console.log("Correction failed on attempt ".concat(i)),[3,8]);case 7:console.log("No corrections available or max attempts reached"),d.label=8;case 8:return i>=a?(console.log("Max attempts reached (".concat(a,"), returning current result")),[2,{linguisticInfo:s,wasValidated:!1,attempts:i}]):[3,10];case 9:return u=d.sent(),console.error("Error on attempt ".concat(i,":"),u),i>=a?[2,{linguisticInfo:null,wasValidated:!1,attempts:i}]:[3,10];case 10:return[3,1];case 11:return[2,{linguisticInfo:s,wasValidated:!1,attempts:i}]}}))}))}var Ts=function(){return Ts=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ts.apply(this,arguments)},Ps=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Os=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Rs=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const Bs=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],o=(m((function(e){return e.deck.deckId})),C()),i=(0,r.useCallback)((function(e){o({type:"SET_SOURCE_LANGUAGE",payload:e}),localStorage.setItem("source_language",e)}),[o]),s=m((function(e){return e.cards})),l=s.text,c=s.translation,u=s.examples,d=s.image,f=s.imageUrl,p=s.front,g=s.back,h=s.currentCardId,y=s.linguisticInfo,x=s.transcription,v=m((function(e){return e.settings.translateToLanguage})),b=m((function(e){return e.settings.aiInstructions})),w=m((function(e){return e.settings.imageInstructions})),S=(m((function(e){return e.deck.decks})),m((function(e){return e.settings.mode}))),k=(0,r.useState)(""),E=k[0],_=k[1],I=(m((function(e){return e.settings.useAnkiConnect})),m((function(e){return e.settings.ankiConnectUrl})),m((function(e){return e.settings.ankiConnectApiKey})),(0,r.useState)(!1)),F=I[0],T=I[1],P=(0,r.useState)(!1),O=P[0],R=P[1],B=(0,r.useState)(!1),N=B[0],z=B[1],L=(0,r.useState)(!1),D=L[0],M=L[1],U=(0,r.useState)(!1),$=U[0],W=U[1],V=(0,r.useState)(!0),q=V[0],H=V[1],G=(0,r.useState)(!1),K=G[0],Y=G[1],Q=m((function(e){return e.settings.openAiKey})),J=m((function(e){return e.settings.groqApiKey})),X=m((function(e){return e.settings.groqModelName})),Z=m((function(e){return e.settings.modelProvider})),ee=m((function(e){return e.settings.shouldGenerateImage})),te=m((function(e){return e.settings.imageGenerationMode})),ne=(0,r.useState)(!1),re=ne[0],pe=ne[1],ve=(0,r.useState)(!1),be=ve[0],we=ve[1],Ee=(0,r.useState)(b),_e=Ee[0],Ie=Ee[1],je=(0,r.useState)(w),Te=je[0],Pe=je[1],Oe=Ji(),Re=Oe.showError,Be=Oe.renderErrorNotification,ze=new Hi({apiKey:Q,dangerouslyAllowBrowser:!0}),Le=(0,r.useState)(""),Ue=Le[0],$e=Le[1],We=(0,r.useState)(!1),Ve=We[0],qe=We[1],He=(0,r.useState)(!1),Ge=He[0],Ke=He[1],Ye=(0,r.useState)([]),Qe=Ye[0],Je=Ye[1],Xe=(0,r.useState)(!1),et=Xe[0],tt=Xe[1],nt=(0,r.useState)(!1),rt=nt[0],it=nt[1],st=(0,r.useState)({}),ct=st[0],dt=st[1],pt=(0,r.useState)([]),xt=pt[0],vt=pt[1],bt=(0,r.useState)(0),wt=bt[0],St=bt[1],Et=(0,r.useState)(!1),Ct=Et[0],It=Et[1],jt=m((function(e){return e.cards.storedCards})),At=(0,r.useMemo)((function(){return Ss(Z)}),[Z]),Ft=(0,r.useMemo)((function(){return function(e,t,n){switch(void 0===n&&(n=""),e){case is.OpenAI:return t;case is.Groq:return n;default:return t}}(Z,Q,J)}),[Z,Q,J]),Pt=(0,r.useState)([]),Ot=Pt[0],Rt=Pt[1],Bt=(0,r.useCallback)((function(e){return!!e&&Ot.includes(e)}),[Ot]),Nt=(0,r.useMemo)((function(){if(console.log("Calculating isSaved:",{currentCardId:h,explicitlySaved:K,isMultipleCards:Ct,currentCardIndex:wt,createdCardsLength:xt.length,explicitlySavedIds:Ot}),Ct&&xt.length>0){var e=xt[wt];return!!e&&Bt(e.id)}return!(!h||!K)}),[h,K,Ct,wt,xt,Bt]);console.log("Card state details:",{isNewSubmission:q,explicitlySaved:K,isSaved:Nt,currentCardId:h,text:l.substring(0,20)+(l.length>20?"...":""),localStorage_explicitly_saved:localStorage.getItem("explicitly_saved")});(0,r.useEffect)((function(){Nt&&W(!0)}),[l,c,u,d,f,p,Nt]);var zt=(0,r.useCallback)((function(e){if(e&&""!==e.trim()){var t=rs().find((function(t){return t.text===e}));return!!t&&(console.log("Found existing card with matching text:",(null==t?void 0:t.text)||e,"ID:",t.id),console.log("Setting currentCardId but NOT setting explicitlySaved"),o(he(t.id)),!0)}}),[o]),Lt=function(e){o(le(e)),Nt&&W(!0)},Dt=function(e){o(se(e)),Nt&&W(!0)},Mt=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n,r,a;return Os(this,(function(i){switch(i.label){case 0:R(!0),i.label=1;case 1:return i.trys.push([1,6,7,8]),[4,At.getDescriptionImage(Ft,l,w)];case 2:return e=i.sent(),Z!==is.OpenAI?[3,4]:[4,Yi(0,ze,Q,e,w)];case 3:return t=i.sent(),n=t.imageUrl,r=t.imageBase64,n&&o(ue(n)),r&&o(ce(r)),[3,5];case 4:Re("Image generation is not supported with the selected provider."),i.label=5;case 5:return[3,8];case 6:return a=i.sent(),console.error("Error generating image:",a),Re(a instanceof Error?a.message:"Failed to generate image"),[3,8];case 7:return R(!1),[7];case 8:return Nt&&W(!0),[2]}}))}))},Ut=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n;return Os(this,(function(r){switch(r.label){case 0:z(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,Es(At,Ft,l,v,!0,b,(Pn?bn:yn)||void 0)];case 2:return(e=r.sent())&&e.length>0&&(t=e.map((function(e){return[e.original,e.translated]})),o(se(t))),[3,5];case 3:return n=r.sent(),console.error("Error getting examples:",n),Re(n instanceof Error?n.message:"Failed to generate examples"),[3,5];case 4:return z(!1),[7];case 5:return Nt&&W(!0),[2]}}))}))},$t=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n,r,a,i,s,c,u;return Os(this,(function(d){switch(d.label){case 0:if(!Ue.trim()||Ve)return[2];qe(!0),d.label=1;case 1:return d.trys.push([1,15,16,17]),Ue.toLowerCase().includes("image")||Ue.toLowerCase().includes("picture")||Ue.toLowerCase().includes("изображени")||Ue.toLowerCase().includes("картин")?[4,Ce(Q,l,Ue)]:[3,4];case 2:return a=d.sent(),[4,Yi(0,ze,Q,a,Ue)];case 3:return e=d.sent(),t=e.imageUrl,c=e.imageBase64,t&&o(ue(t)),c&&o(ce(c)),[3,14];case 4:return Ue.toLowerCase().includes("example")||Ue.toLowerCase().includes("sentence")||Ue.toLowerCase().includes("пример")||Ue.toLowerCase().includes("предложение")?[4,ke(Q,l,v,!0,Ue)]:[3,6];case 5:return r=d.sent(),o(se(r)),[3,14];case 6:return Ue.toLowerCase().includes("translat")||Ue.toLowerCase().includes("перевод")?[4,Se(Q,l,v,Ue)]:[3,8];case 7:return n=d.sent(),o(le(n)),[3,14];case 8:return[4,Se(Q,l,v,Ue)];case 9:return n=d.sent(),[4,ke(Q,l,v,!0,Ue)];case 10:return r=d.sent(),ee?[4,Ce(Q,l,Ue)]:[3,13];case 11:return a=d.sent(),[4,Yi(0,ze,Q,a,Ue)];case 12:i=d.sent(),s=i.imageUrl,c=i.imageBase64,s&&o(ue(s)),c&&o(ce(c)),d.label=13;case 13:o(le(n)),o(se(r)),d.label=14;case 14:return $e(""),[3,17];case 15:return u=d.sent(),console.error("Error applying custom instructions:",u),[3,17];case 16:return qe(!1),[7];case 17:return[2]}}))}))},Wt=function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),$t())},Vt=function(){return Z!==is.Groq},qt=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n,r,a,i,s,u,p;return Os(this,(function(g){console.log("*** HANDLE SAVE ALL CARDS: Starting ***"),console.log("Current Redux state at save all cards time:",{text:l,translation:c,image:d,imageUrl:f,hasImage:!!d,hasImageUrl:!!f,imageType:typeof d,imageUrlType:typeof f,shouldGenerateImage:ee,mode:S,createdCardsCount:xt.length}),Re(null);try{for(M(!0),tn(),e=0,t=0,n=0,r=0,a=Rs([],Ot,!0),console.log("Starting to save cards. Total cards:",xt.length,"Already saved:",Ot.length),i=function(i){var s=xt[i];if(Ot.includes(s.id))return console.log("Card #".concat(i," (").concat(s.id,") already explicitly saved, skipping")),e++,"continue";try{console.log("Saving card #".concat(i," (").concat(s.id,") from multi-card set")),-1===jt.findIndex((function(e){return e.id===s.id||e.text===s.text&&e.mode===s.mode}))?(o(oe(s)),n++,a.push(s.id),console.log("Card #".concat(i," (").concat(s.id,") saved as new")),e++):(console.log("Card #".concat(i," (").concat(s.id,") already in storage, updating")),o(ge(s)),r++,a.push(s.id),e++)}catch(e){console.error("Error saving card #".concat(i," (").concat(s.id,"):"),e),t++}},s=0;s<xt.length;s++)i(s);console.log("Save all complete. Saved:",n,"Updated:",r,"Errors:",t),Rt(a),Y(!0),localStorage.setItem("explicitly_saved","true"),(u=xt[wt])&&u.id&&(o(he(u.id)),localStorage.setItem("current_card_id",u.id)),0===t?(p=n>0&&r>0?"Saved ".concat(n," new cards and updated ").concat(r," existing cards."):n>0?"Saved ".concat(n," cards successfully!"):r>0?"Updated ".concat(r," cards successfully!"):"All ".concat(e," cards are now saved!"),Re(p,"success")):Re("Saved ".concat(e," cards, ").concat(t," failed."),"warning"),W(!1),H(!1),o(ae())}catch(e){console.error("Error in save all cards operation:",e),Re("Error saving cards. Please try again.")}finally{M(!1)}return[2]}))}))},Ht=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n,r,a,i,s;return Os(this,(function(g){console.log("*** HANDLE ACCEPT: Starting to save card ***"),console.log("Current Redux state at save time:",{text:l,translation:c,image:d,imageUrl:f,hasImage:!!d,hasImageUrl:!!f,imageType:typeof d,imageUrlType:typeof f,imageLength:null==d?void 0:d.length,imageUrlLength:null==f?void 0:f.length,shouldGenerateImage:ee,mode:S}),Re(null);try{if(M(!0),Ct&&xt.length>0)return tn(),(e=xt[wt])?(console.log("Saving current card from multi-card set:",e.id),-1===jt.findIndex((function(t){return t.id===e.id||t.text===e.text&&t.mode===e.mode}))?(o(oe(e)),console.log("Saved new card: ".concat(e.id))):(o(ge(e)),console.log("Updated existing card: ".concat(e.id))),Rt((function(t){if(t.includes(e.id))return t;var n=Rs(Rs([],t,!0),[e.id],!1);return console.log("Updated explicitly saved IDs:",n),n})),o(ae()),o(he(e.id)),localStorage.setItem("current_card_id",e.id),Y(!0),localStorage.setItem("explicitly_saved","true"),W(!1),Re("Card saved successfully!","success"),[2]):(Re("Card data not found"),[2]);if(t=h||Date.now().toString(),console.log("Saving card with data:",{originalSelectedText:E,text:l,translation:c,examples:u.length,mode:S,currentCardId:h,linguisticInfo:y?"present":"absent"}),S===j.LanguageLearning){if(!l&&!E)return console.error("Missing text data for card"),Re("Please enter or select some text for your card before saving."),[2];n={id:t,mode:S,text:E||l,translation:c,examples:u,linguisticInfo:y,transcription:x||"",image:d,imageUrl:f,createdAt:new Date,exportStatus:"not_exported"},console.log("*** CREATECARD: Preparing to save card to storage ***"),console.log("Card data being sent to Redux:",{id:n.id,text:n.text,mode:n.mode,hasImage:!!n.image,hasImageUrl:!!n.imageUrl,imageType:typeof n.image,imageUrlType:typeof n.imageUrl,imageLength:null===(r=n.image)||void 0===r?void 0:r.length,imageUrlLength:null===(a=n.imageUrl)||void 0===a?void 0:a.length,imageActualValue:n.image,imageUrlActualValue:n.imageUrl,imagePreview:null===(i=n.image)||void 0===i?void 0:i.substring(0,50),imageUrlPreview:null===(s=n.imageUrl)||void 0===s?void 0:s.substring(0,50)}),h?(console.log("Updating existing card by user action:",t),o(ge(n))):(console.log("Saving new card by user action:",t),o(oe(n)),o(he(t)))}else if(S===j.GeneralTopic){if(!p)return console.error("Missing front data for general topic card"),Re("Please generate card content before saving."),[2];n={id:t,mode:S,front:p,back:c||p,text:E||l||"",linguisticInfo:y,transcription:x||"",image:d,imageUrl:f,createdAt:new Date,exportStatus:"not_exported"},console.log("Saving general topic card to storage:",n),h?(console.log("Updating existing general topic card by user action:",t),o(ge(n))):(console.log("Saving new general topic card by user action:",t),o(oe(n)),o(he(t)))}Y(!0),localStorage.setItem("explicitly_saved","true"),Re($?"Card updated successfully!":"Card saved successfully!","success"),W(!1),H(!1)}catch(e){console.error("Error saving card:",e),Re("Error saving card. Please try again.")}finally{M(!1)}return[2]}))}))},Gt=function(){o(A("storedCards"))};(0,r.useEffect)((function(){var e=function(e){var t,n=document.getElementById("sidebar");if(!n||!n.contains(e.target)){if(e.target&&e.composedPath)for(var r=0,o=e.composedPath();r<o.length;r++){var a=o[r];if(a instanceof Element&&"sidebar"===a.id)return;if(a instanceof ShadowRoot&&a.host&&"sidebar"===a.host.id)return}var i=null===(t=window.getSelection())||void 0===t?void 0:t.toString().trim();i&&i.length>0&&(tt(!1),dt({}),Je([]),on(i))}};return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[o,Ft]),(0,r.useEffect)((function(){o(function(e){return{type:Ae,payload:e}}(j.LanguageLearning)),l&&c&&u.length>0?n(!0):n(!1),o(ae())}),[o]),(0,r.useEffect)((function(){Ps(void 0,void 0,void 0,(function(){return Os(this,(function(e){return console.log("Running saved cards check on mount"),o(ae()),setTimeout((function(){var e=rs();console.log("Loaded cards from storage:",e.length);var t=localStorage.getItem("current_card_id"),r=localStorage.getItem("explicitly_saved");if(console.log("localStorage values on mount:",{savedCardId:t,explicitlySavedFlag:r,cardCount:e.length}),t){console.log("Found current card ID in localStorage:",t);var a=e.find((function(e){return e.id===t}));a?(console.log("Restoring card from storage:",a),W(!1),H(!1),"true"===r?(console.log("Setting explicitlySaved to TRUE based on localStorage flag"),Y(!0)):(console.log("Setting explicitlySaved to FALSE based on localStorage flag"),Y(!1)),o(he(t)),o(ie(a.text)),a.translation&&o(le(a.translation)),a.examples&&o(se(a.examples)),a.image&&o(ce(a.image)),a.imageUrl&&o(ue(a.imageUrl)),a.front&&o(fe(a.front)),a.back&&o(de(a.back)),a.linguisticInfo&&o(me(a.linguisticInfo)),a.transcription&&o(ye(a.transcription)),_(a.text),n(!0)):(console.log("Card ID from localStorage not found in storage, resetting"),localStorage.removeItem("current_card_id"),localStorage.removeItem("explicitly_saved"),o(he(null)),H(!0),Y(!1))}else console.log("No current card ID in localStorage"),H(!0),Y(!1)}),200),[2]}))}))}),[]),(0,r.useEffect)((function(){l&&!q&&""!==l.trim()&&(!t||h?(h||(console.log("Actively typing new card text - ensuring not marked as saved"),Y(!1),localStorage.removeItem("explicitly_saved")),zt(l)):console.log("New card being created, skipping automatic saved detection"))}),[l,h,q,t,zt]);var Kt=function(){o({type:De,payload:_e}),pe(!1),Re("AI settings saved successfully","success")},Yt=function(){o({type:Me,payload:Te}),we(!1),Re("Image instructions saved successfully","success")},Qt=function(){console.log("Canceling current card, clearing all state"),n(!1),W(!1),o(he(null)),H(!0),Y(!1),localStorage.removeItem("explicitly_saved"),localStorage.removeItem("current_card_id"),o(xe(!1)),T(!1),vt([]),It(!1),St(0),o(ie("")),o(le("")),o(se([])),o(ce(null)),o(ue(null)),o(fe("")),o(de(null)),o(me("")),o(ye("")),_("")},Jt=function(){if(console.log("Modal close handler. Card saved status:",Nt,"isEdited:",$),Ct)return console.log("Closing modal for multiple cards without automatic saving"),void Ke(!1);!t||Nt||$||!c||Ct?Nt||(console.log("Card not saved, clearing all data"),o(ie("")),o(le("")),o(se([])),o(ce(null)),o(ue(null)),o(fe("")),o(de(null)),o(me("")),o(ye("")),n(!1)):window.confirm("Would you like to save this card to your collection?")?Ht():(console.log("User chose not to save, clearing all card data"),o(ie("")),o(le("")),o(se([])),o(ce(null)),o(ue(null)),o(fe("")),o(de(null)),o(me("")),o(ye("")),n(!1));Ke(!1)},Xt=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,r,a,i,s,l,c,u,d,f,p,g,h,m,y,x,k,E,C,I,j,A,F,P,O,R,B,N,z,L,D,M,U,$,W,V;return Os(this,(function(q){switch(q.label){case 0:if(0===(e=Object.keys(ct).filter((function(e){return ct[e]}))).length)return Re("Please select at least one text option","warning"),[2];console.log("*** MULTIPLE CARDS CREATION STARTED ***"),console.log("Image generation settings:",{imageGenerationMode:te,modelProvider:Z,isImageGenerationAvailable:Vt(),selectedOptionsCount:e.length}),tt(!1),T(!0),o(xe(!0)),q.label=1;case 1:q.trys.push([1,29,30,31]),t=[],r=0,a=e,q.label=2;case 2:if(!(r<a.length))return[3,28];i=a[r],o(ie("")),o(le("")),o(se([])),o(me("")),o(ie(i)),_(i),Y(!1),localStorage.removeItem("explicitly_saved"),q.label=3;case 3:return q.trys.push([3,26,,27]),[4,ks(At,Ft,i,v,b)];case 4:return(s=q.sent()).translated&&o(le(s.translated)),[4,Es(At,Ft,i,v,!0,b,(Pn?bn:yn)||void 0)];case 5:return(l=q.sent())&&l.length>0&&(c=l.map((function(e){return[e.original,e.translated]})),o(se(c))),[4,Cs(At,Ft,i)];case 6:return(u=q.sent()).front&&o(fe(u.front)),f="",(d=Pn?bn:yn)?[4,Fs(At,Ft,i,d,v,3)]:[3,8];case 7:(p=q.sent()).linguisticInfo?(f=p.linguisticInfo,o(me(p.linguisticInfo)),p.wasValidated&&p.attempts>1?console.log('Corrected linguistic info for "'.concat(i,'" after ').concat(p.attempts," attempts")):p.wasValidated||console.warn('Linguistic info for "'.concat(i,'" may contain inaccuracies'))):console.warn('Failed to generate linguistic info for "'.concat(i,'"')),q.label=8;case 8:g="",q.label=9;case 9:return q.trys.push([9,15,,16]),(h=Pn?bn:yn)?(console.log('Creating transcription for "'.concat(i,'" using source language: ').concat(h,", user language: ").concat(v)),[4,_s(At,Ft,i,h,v)]):[3,13];case 10:return(m=q.sent())?[4,qn(v)]:[3,12];case 11:y=q.sent(),(x=[m.userLanguageTranscription&&'<div class="transcription-item user-lang">\n                                            <span class="transcription-label">'.concat(y,':</span>\n                                            <span class="transcription-text">').concat(m.userLanguageTranscription,"</span>\n                                        </div>"),m.ipaTranscription&&'<div class="transcription-item ipa">\n                                            <span class="transcription-label">IPA:</span>\n                                            <span class="transcription-text">'.concat(m.ipaTranscription,"</span>\n                                        </div>")].filter(Boolean).join("\n"))&&(g=x,o(ye(x)),console.log('Transcription created successfully for "'.concat(i,'"'))),q.label=12;case 12:return[3,14];case 13:console.warn('No source language available for transcription of "'.concat(i,'"')),q.label=14;case 14:return[3,16];case 15:return k=q.sent(),console.error('Transcription generation failed for "'.concat(i,'":'),k),[3,16];case 16:if(E=null,C=null,"off"===te||!Vt())return[3,25];q.label=17;case 17:return q.trys.push([17,24,,25]),I="always"===te,j="","smart"!==te?[3,19]:[4,Hn(i)];case 18:A=q.sent(),I=A.shouldGenerate,j=A.reason,console.log('Smart image analysis for "'.concat(i,'": ').concat(I?"YES":"NO"," - ").concat(j)),q.label=19;case 19:return I?(console.log('Generating image for "'.concat(i,'"')),[4,At.getDescriptionImage(Ft,i,w)]):[3,22];case 20:return F=q.sent(),[4,Yi(0,ze,Q,F,w)];case 21:return P=q.sent(),O=P.imageUrl,R=P.imageBase64,O&&(E=O,console.log('Image URL generated for "'.concat(i,'": ').concat(O.substring(0,50),"..."))),R&&(C=R,console.log('Image base64 generated for "'.concat(i,'": ').concat(R.substring(0,50),"..."))),[3,23];case 22:"smart"===te&&console.log('No image needed for "'.concat(i,'": ').concat(j)),q.label=23;case 23:return[3,25];case 24:return B=q.sent(),console.error('Image generation failed for "'.concat(i,'":'),B),[3,25];case 25:return N=Date.now().toString()+"_"+t.length,z={id:N,mode:S,text:i,translation:s.translated||"",examples:l.map((function(e){return[e.original,e.translated]})),linguisticInfo:f,transcription:g,front:u.front||"",back:s.translated||"",image:C,imageUrl:E,createdAt:new Date,exportStatus:"not_exported"},console.log("Created card ".concat(z.id," but NOT saving to storage yet. Image info:"),{hasImage:!!z.image,hasImageUrl:!!z.imageUrl,imageLength:null===(U=z.image)||void 0===U?void 0:U.length,imageUrlLength:null===($=z.imageUrl)||void 0===$?void 0:$.length}),t.push(z),[3,27];case 26:return L=q.sent(),console.error('Error creating card for "'.concat(i,'":'),L),Re('Failed to create card for "'.concat(i.substring(0,20),'...": ').concat(L instanceof Error?L.message:"Unknown error"),"error"),[3,27];case 27:return r++,[3,2];case 28:return t.length>0?(vt(t),St(0),It(t.length>1),(D=t[0])&&(console.log("Loading first card into Redux state:",{cardId:D.id,hasImage:!!D.image,hasImageUrl:!!D.imageUrl,imageLength:null===(W=D.image)||void 0===W?void 0:W.length,imageUrlLength:null===(V=D.imageUrl)||void 0===V?void 0:V.length}),"string"==typeof D.text&&o(ie(D.text)),o(le(void 0===D.translation?null:D.translation)),o(se(Array.isArray(D.examples)?D.examples:[])),o(ce(void 0===D.image?null:D.image)),o(ue(void 0===D.imageUrl?null:D.imageUrl)),"string"==typeof D.front&&o(fe(D.front)),o(de(void 0===D.back?null:D.back)),o(me(D.linguisticInfo||"")),D.transcription?o(ye(D.transcription)):o(ye("")),console.log("First card loaded into Redux state successfully")),Y(!1),Rt([]),localStorage.removeItem("explicitly_saved"),console.log("Reset saved status for new multiple cards"),Rt([]),localStorage.removeItem("explicitly_saved"),Y(!1),n(!0),Ke(!0),Re("Created ".concat(t.length," cards!"),"success"),console.log("Created new cards, none saved yet. Card IDs:",t.map((function(e){return e.id})))):Re("Failed to create cards. Please try again.","error"),[3,31];case 29:return M=q.sent(),console.error("Error processing selected options:",M),Re(M instanceof Error?M.message:"Failed to create cards. Please try again."),[3,31];case 30:return T(!1),o(xe(!1)),dt({}),[7];case 31:return[2]}}))}))},Zt=function(e){!function(e){dt((function(t){var n;return Ts(Ts({},t),((n={})[e]=!t[e],n))}))}(e)},en=function(){if(!(xt.length<=1||wt>=xt.length-1)){tn();var e=wt+1;console.log("Moving from card ".concat(wt," to card ").concat(e));var t=xt[e];t&&(console.log("Loading next card data: ".concat(t.id,", text: ").concat(t.text,", linguistic info: ").concat(t.linguisticInfo?"yes":"no")),nn(t),St(e))}},tn=function(){if(xt[wt]){console.log("Saving current card state:",{index:wt,text:l,linguisticInfo:y?y.substring(0,30)+"...":"empty"});var e=Ts(Ts({},xt[wt]),{text:l,translation:c,examples:u,image:d,imageUrl:f,front:p,back:g||null,linguisticInfo:y||"",transcription:x||""}),t=Rs([],xt,!0);t[wt]=e,vt(t),console.log("Updated card saved:",e.id)}},nn=function(e){var t,n;console.log("Loading card data for card:",{id:e.id,text:e.text,hasLinguisticInfo:Boolean(e.linguisticInfo),hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length}),o(ie("")),o(le(null)),o(se([])),o(ce(null)),o(ue(null)),o(fe("")),o(de(null)),o(me("")),o(ye("")),"string"==typeof e.text&&o(ie(e.text)),o(le(void 0===e.translation?null:e.translation)),o(se(Array.isArray(e.examples)?e.examples:[])),o(ce(void 0===e.image?null:e.image)),o(ue(void 0===e.imageUrl?null:e.imageUrl)),"string"==typeof e.front&&o(fe(e.front)),o(de(void 0===e.back?null:e.back)),e.linguisticInfo?(console.log("Setting linguistic info:",e.linguisticInfo.substring(0,30)+"..."),o(me(e.linguisticInfo))):(console.log("No linguistic info found for this card"),o(me(""))),e.transcription?(console.log("Setting transcription:",e.transcription.substring(0,30)+"..."),o(ye(e.transcription))):(console.log("No transcription found for this card"),o(ye(""))),console.log("Card data loaded successfully, image status:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl})},rn=function(){if(!(xt.length<=1||wt<=0)){tn();var e=wt-1;console.log("Moving from card ".concat(wt," to card ").concat(e));var t=xt[e];t&&(console.log("Loading previous card data: ".concat(t.id,", text: ").concat(t.text,", linguistic info: ").concat(t.linguisticInfo?"yes":"no")),nn(t),St(e))}},on=function(e){return Ps(void 0,void 0,void 0,(function(){var t,n,r,a,i,s,l,c,u,d,f,p,g,h,m,y,x,v,b,w,S,k,E;return Os(this,(function(C){switch(C.label){case 0:if(console.log("=== ANALYZE SELECTED TEXT ==="),console.log("Selected text:",e),console.log("Text length:",e.length),!e||e.length<3)return o(ie(e)),[2];if(dt({}),Je([]),t=e.trim().split(/\s+/).length,console.log("Word count:",t),t<=3&&!e.includes(".")&&!e.includes("\n"))return console.log("Using short text directly (≤3 words)"),tt(!1),E=e.replace(/^[-–—•\s]+/,"").trim(),o(ie(E)),[2];console.log("Proceeding with text analysis..."),it(!0),C.label=1;case 1:if(C.trys.push([1,11,12,13]),n=e.split(/[\s\-–—•.,!?;:()\[\]{}""''«»„"\u2014\u2013\u2026]+/).filter((function(e){return e.length>1})).map((function(e){return e.trim()})).filter(Boolean),console.log("Extracted words from text:",n),r=Array.from(new Set(n)),console.log("Filtered words (universal):",r),a=[],i=!1,!(t>=4&&t<=10))return[3,6];if(console.log("Processing short-medium text (4-10 words)"),s=e.replace(/^[-–—•\s]+/,"").trim(),a.push(s),console.log("Added full phrase:",s),!Ft||!At)return[3,5];C.label=2;case 2:return C.trys.push([2,4,,5]),console.log("Using AI to extract key terms..."),[4,At.extractKeyTerms(Ft,e)];case 3:return(l=C.sent())&&l.length>0&&(l.forEach((function(e){var t=e.replace(/^[-–—•\s]+/,"").trim();!a.includes(t)&&t.length>1&&(a.push(t),console.log("Added AI-extracted term:",t))})),i=!0),[3,5];case 4:return c=C.sent(),console.log("AI extraction failed, falling back to word-based approach:",c),[3,5];case 5:if(i||(console.log("Adding individual words (fallback):",r),r.forEach((function(e){if(e.length>2){var t=e.replace(/^[-–—•\s]+/,"").trim();a.includes(t)||(a.push(t),console.log("Added individual word:",t))}}))),t>=6)for(console.log("Adding 2-word combinations..."),p=e.split(/\s+/),g=0;g<p.length-1;g++)p[g].length>1&&p[g+1].length>1&&(h=(h="".concat(p[g]," ").concat(p[g+1]).trim()).replace(/^[-–—•\s]+/,"").trim()).length>3&&!a.includes(h)&&(a.push(h),console.log("Added 2-word phrase:",h));i=!0,console.log("Short-medium processing complete. Options so far:",a),C.label=6;case 6:if(!(!i&&e.length>100&&Ft))return[3,10];C.label=7;case 7:return C.trys.push([7,9,,10]),it(!0),[4,At.extractKeyTerms(Ft,e)];case 8:return(u=C.sent())&&u.length>0&&(u.slice(0,7).forEach((function(e){var t=e.replace(/^[-–—•\s]+/,"").trim();a.includes(t)||a.push(t)})),i=!0),[3,10];case 9:return d=C.sent(),console.error("Failed to extract key terms with AI",d),[3,10];case 10:if(!i&&e.length>30&&e.length<=200&&(console.log("Processing medium-length text:",e.length,"chars, words:",t),t>=4&&t<=15&&r.forEach((function(e){if(e.length>2){var t=e.replace(/^[-–—•\s]+/,"").trim();a.includes(t)||(a.push(t),console.log("Added individual word:",t))}})),e.split(/[.!?]+/).filter((function(e){return e.trim().length>0})).forEach((function(e){var t=e.trim();if(t.length>10&&t.length<80&&t.split(/\s+/).length>=2&&t.split(/\s+/).length<=8){var n=t.replace(/^[-–—•\s]+/,"").trim();a.includes(n)||(a.push(n),console.log("Added medium phrase:",n))}})),i=!0),(a.length<5||t>=4&&t<=15&&!i)&&(console.log("Adding individual words, current options count:",a.length,"wordCount:",t,"phrasesExtracted:",i),f=r.filter((function(e){return e.length>2})).slice(0,7),console.log("Important words found:",f),f.forEach((function(e){var t=e.replace(/^[-–—•\s]+/,"").trim();a.includes(t)||(a.push(t),console.log("Added important word:",t))}))),a.length<7&&(p=e.split(/\s+/)).length>=2)for(g=0;g<p.length-1;g++)p[g].length>3&&p[g+1].length>3&&(h=(h="".concat(p[g]," ").concat(p[g+1]).trim()).replace(/^[-–—•\s]+/,"").trim()).length>7&&!a.includes(h)&&a.push(h),g<p.length-2&&p[g].length>2&&p[g+1].length>2&&p[g+2].length>2&&(m=(m="".concat(p[g]," ").concat(p[g+1]," ").concat(p[g+2]).trim()).replace(/^[-–—•\s]+/,"").trim()).length>10&&!a.includes(m)&&a.push(m);for(y=/(?:^|\n)[-–—•*]\s*(.*?)(?=\n[-–—•*]|\n\n|$)/g,x=void 0,v=e.toString();null!==(x=y.exec(v));)x[1]&&x[1].trim().length>3&&(b=x[1].trim(),a.includes(b)||a.push(b));return(a=Array.from(new Set(a)).filter((function(e){return e.length>2})).map((function(e){return e.replace(/^[-–—•\s]+/,"").trim()})).slice(0,8)).length>0?(Je(a),tt(!0)):e.length>500?(w=e.split(/[.!?]/)[0])&&w.length<100?(S=w.replace(/^[-–—•\s]+/,"").trim(),o(ie(S+"."))):(E=e.replace(/^[-–—•\s]+/,"").trim(),o(ie(E.substring(0,100).trim()+"..."))):(E=e.replace(/^[-–—•\s]+/,"").trim(),o(ie(E))),[3,13];case 11:return k=C.sent(),console.error("Error analyzing text",k),E=e.replace(/^[-–—•\s]+/,"").trim(),o(ie(E)),[3,13];case 12:return it(!1),[7];case 13:return[2]}}))}))},an=[{code:"ru",name:"Русский",flag:"🇷🇺",englishName:"Russian"},{code:"en",name:"English",flag:"🇬🇧",englishName:"English"},{code:"es",name:"Español",flag:"🇪🇸",englishName:"Spanish"},{code:"fr",name:"Français",flag:"🇫🇷",englishName:"French"},{code:"de",name:"Deutsch",flag:"🇩🇪",englishName:"German"},{code:"it",name:"Italiano",flag:"🇮🇹",englishName:"Italian"},{code:"pt",name:"Português",flag:"🇵🇹",englishName:"Portuguese"},{code:"ja",name:"日本語",flag:"🇯🇵",englishName:"Japanese"},{code:"ko",name:"한국어",flag:"🇰🇷",englishName:"Korean"},{code:"zh",name:"中文",flag:"🇨🇳",englishName:"Chinese"},{code:"ar",name:"العربية",flag:"🇦🇪",englishName:"Arabic"},{code:"hi",name:"हिंदी",flag:"🇮🇳",englishName:"Hindi"},{code:"bn",name:"বাংলা",flag:"🇧🇩",englishName:"Bengali"},{code:"tr",name:"Türkçe",flag:"🇹🇷",englishName:"Turkish"},{code:"pl",name:"Polski",flag:"🇵🇱",englishName:"Polish"},{code:"nl",name:"Nederlands",flag:"🇳🇱",englishName:"Dutch"},{code:"cs",name:"Čeština",flag:"🇨🇿",englishName:"Czech"},{code:"sv",name:"Svenska",flag:"🇸🇪",englishName:"Swedish"},{code:"vi",name:"Tiếng Việt",flag:"🇻🇳",englishName:"Vietnamese"},{code:"th",name:"ภาษาไทย",flag:"🇹🇭",englishName:"Thai"},{code:"he",name:"עִבְרִית",flag:"🇮🇱",englishName:"Hebrew"},{code:"id",name:"Bahasa Indonesia",flag:"🇮🇩",englishName:"Indonesian"},{code:"uk",name:"Українська",flag:"🇺🇦",englishName:"Ukrainian"},{code:"el",name:"Ελληνικά",flag:"🇬🇷",englishName:"Greek"},{code:"ro",name:"Română",flag:"🇷🇴",englishName:"Romanian"},{code:"hu",name:"Magyar",flag:"🇭🇺",englishName:"Hungarian"},{code:"fi",name:"Suomi",flag:"🇫🇮",englishName:"Finnish"},{code:"da",name:"Dansk",flag:"🇩🇰",englishName:"Danish"},{code:"no",name:"Norsk",flag:"🇳🇴",englishName:"Norwegian"},{code:"sk",name:"Slovenčina",flag:"🇸🇰",englishName:"Slovak"},{code:"lt",name:"Lietuvių",flag:"🇱🇹",englishName:"Lithuanian"},{code:"lv",name:"Latviešu",flag:"🇱🇻",englishName:"Latvian"},{code:"bg",name:"Български",flag:"🇧🇬",englishName:"Bulgarian"},{code:"hr",name:"Hrvatski",flag:"🇭🇷",englishName:"Croatian"},{code:"sr",name:"Српски",flag:"🇷🇸",englishName:"Serbian"},{code:"et",name:"Eesti",flag:"🇪🇪",englishName:"Estonian"},{code:"sl",name:"Slovenščina",flag:"🇸🇮",englishName:"Slovenian"}],sn=(0,r.useState)(!1),ln=sn[0],cn=sn[1],un=(0,r.useState)(""),dn=un[0],fn=un[1],pn=(0,r.useMemo)((function(){if(!dn)return an;var e=dn.toLowerCase();return an.filter((function(t){return t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e)}))}),[dn]),gn=(0,r.useMemo)((function(){return an.find((function(e){return e.code===v}))||an[0]}),[v]),hn=function(){return ln?(0,a.jsx)("div",Ts({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"16px"},onClick:function(){return cn(!1)}},{children:(0,a.jsxs)("div",Ts({style:{backgroundColor:"#FFFFFF",borderRadius:"12px",width:"90%",maxWidth:"360px",maxHeight:"80vh",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",Ts({style:{padding:"16px",borderBottom:"1px solid #E5E7EB",display:"flex",flexDirection:"column",gap:"12px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsx)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:"Select Your Language"})),(0,a.jsx)("button",Ts({onClick:function(){return cn(!1)},style:{background:"none",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px"}},{children:(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsxs)("div",Ts({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:dn,onChange:function(e){return fn(e.target.value)},placeholder:"Search languages...",style:{width:"100%",padding:"10px 12px 10px 36px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",fontSize:"14px",color:"#374151",outline:"none"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#9CA3AF",viewBox:"0 0 16 16",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}},{children:(0,a.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})),dn&&(0,a.jsx)("button",Ts({onClick:function(){return fn("")},style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",backgroundColor:"#E5E7EB"}},{children:(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsx)("p",Ts({style:{margin:0,fontSize:"12px",color:"#6B7280",lineHeight:1.5}},{children:"This will be used for both the interface language and translations. Your cards will be created in this language."}))]})),(0,a.jsx)("div",Ts({style:{overflowY:"auto",maxHeight:"calc(80vh - 135px)",padding:"8px 0"}},{children:0===pn.length?(0,a.jsxs)("div",Ts({style:{padding:"16px",textAlign:"center",color:"#6B7280",fontSize:"14px"}},{children:['No languages found matching "',dn,'"']})):pn.map((function(e){return(0,a.jsxs)("button",Ts({onClick:function(){o(function(e){return{type:Fe,payload:e}}(e.code)),cn(!1)},style:{display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",backgroundColor:e.code===v?"#EFF6FF":"transparent",border:"none",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(t){e.code!==v&&(t.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(t){e.code!==v&&(t.currentTarget.style.backgroundColor="transparent")}},{children:[(0,a.jsx)("span",Ts({style:{fontSize:"22px",marginRight:"12px",width:"28px",textAlign:"center"}},{children:e.flag})),(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},{children:[(0,a.jsx)("span",Ts({style:{color:e.code===v?"#2563EB":"#111827",fontWeight:e.code===v?"600":"normal",fontSize:"14px"}},{children:e.name})),e.englishName!==e.name&&(0,a.jsx)("span",Ts({style:{color:"#6B7280",fontSize:"12px"}},{children:e.englishName}))]})),e.code===v&&(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2563EB",viewBox:"0 0 16 16",style:{marginLeft:"auto"}},{children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})}))]}),e.code)}))}))]}))})):(0,a.jsxs)("div",Ts({style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",gap:"8px"}},{children:[(0,a.jsxs)("label",Ts({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0,display:"flex",alignItems:"center",gap:"6px"}},{children:["Your Language",(0,a.jsx)("span",Ts({style:{fontSize:"12px",color:"#6B7280",fontWeight:"normal",fontStyle:"italic"}},{children:"(translations)"}))]})),(0,a.jsxs)("button",Ts({onClick:function(){return cn(!0)},style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",color:"#374151",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#F9FAFB"}},{children:[(0,a.jsxs)("span",Ts({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)("span",Ts({style:{fontSize:"18px"}},{children:gn.flag})),(0,a.jsx)("span",{children:gn.name})]})),(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})}))]}))]}))},mn=(0,r.useState)((function(){return localStorage.getItem("source_language")||""})),yn=mn[0],xn=mn[1],vn=(0,r.useState)((function(){return localStorage.getItem("detected_language")||null})),bn=vn[0],wn=vn[1],Sn=(0,r.useState)(!1),kn=Sn[0],En=Sn[1],Cn=(0,r.useState)(!1),_n=Cn[0],In=Cn[1],jn=(0,r.useState)(""),An=jn[0],Fn=jn[1],Tn=(0,r.useState)((function(){return"false"!==localStorage.getItem("auto_detect_language")})),Pn=Tn[0],On=Tn[1],Rn=(0,r.useMemo)((function(){if(!An)return an;var e=An.toLowerCase();return an.filter((function(t){return t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e)}))}),[An]),Bn=(0,r.useMemo)((function(){return yn?an.find((function(e){return e.code===yn}))||null:bn&&an.find((function(e){return e.code===bn}))||null}),[yn,bn]),Nn=(0,r.useState)(!1),zn=Nn[0],Ln=Nn[1],Dn=(0,r.useCallback)((function(e){return Ps(void 0,void 0,void 0,(function(){var t,n,r,o,a,s,l,c,u,d,f,p,g,h,m,y,x,v,b,w,S,k,E,C;return Os(this,(function(_){switch(_.label){case 0:if(!e||e.trim().length<2)return[2];En(!0),_.label=1;case 1:return _.trys.push([1,11,12,13]),Z===is.OpenAI&&Q||Z===is.Groq&&J?Z!==is.OpenAI?[3,3]:[4,ze.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a language detection assistant. Respond only with the ISO 639-1 language code."},{role:"user",content:"Detect the language of this text and respond only with the ISO 639-1 language code (e.g. 'en', 'ru', 'fr', etc.): \"".concat(e,'"')}],temperature:.3,max_tokens:10})]:[3,9];case 2:return n=_.sent(),t=null===(w=n.choices[0].message.content)||void 0===w?void 0:w.trim().toLowerCase(),console.log("Language detected via OpenAI:",t),[3,8];case 3:return Z!==is.Groq?[3,8]:[4,fetch("https://api.groq.com/openai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(J)},body:JSON.stringify({model:X,messages:[{role:"system",content:"You are a language detection assistant. Respond only with the ISO 639-1 language code."},{role:"user",content:"Detect the language of this text and respond only with the ISO 639-1 language code (e.g. 'en', 'ru', 'fr', etc.): \"".concat(e,'"')}],temperature:.3,max_tokens:10})})];case 4:return(r=_.sent()).ok?[3,6]:[4,r.json()];case 5:throw o=_.sent(),new Error("Groq API error: ".concat(r.status," ").concat(r.statusText," - ").concat(JSON.stringify(o)));case 6:return[4,r.json()];case 7:a=_.sent(),t=null===(C=null===(E=null===(k=null===(S=a.choices)||void 0===S?void 0:S[0])||void 0===k?void 0:k.message)||void 0===E?void 0:E.content)||void 0===C?void 0:C.trim().toLowerCase(),console.log("Language detected via Groq:",t),_.label=8;case 8:return t&&an.some((function(e){return e.code===t}))&&(wn(t),localStorage.setItem("detected_language",t),Ln(!1),localStorage.setItem("language_already_detected","true"),i(t)),[3,10];case 9:s=e.trim().toLowerCase().slice(0,100),f=/[а-яё]/gi,p=/[a-z]/gi,g=/[\u4e00-\u9fff]/gi,h=/[\u3040-\u309f\u30a0-\u30ff]/gi,m=/[\uac00-\ud7af]/gi,y=/[\u0600-\u06ff]/gi,x=/[áéíóúüñ¿¡]/gi,v=["hasta","desde","como","pero","porque","adonde","quien","para","por"].some((function(e){return s===e||s.startsWith(e+" ")||s.includes(" "+e+" ")})),b="",f.test(s)?(console.log("Detected Cyrillic script - setting Russian"),b="ru"):g.test(s)?(console.log("Detected Chinese characters"),b="zh"):h.test(s)?(console.log("Detected Japanese characters"),b="ja"):m.test(s)?(console.log("Detected Korean characters"),b="ko"):y.test(s)?(console.log("Detected Arabic script"),b="ar"):x.test(s)||v?(console.log("Detected Spanish text or common Spanish word"),b="es"):p.test(s)&&(console.log("Detected Latin script, defaulting to English"),b="en"),b&&(wn(b),i(b),Ln(!1),localStorage.setItem("language_already_detected","true")),_.label=10;case 10:return[3,13];case 11:return l=_.sent(),console.error("Error detecting language:",l),c=l instanceof Error?l.message:String(l),(c.includes("401")||c.includes("Unauthorized")||c.includes("Authentication")||c.includes("Invalid API key")||c.includes("Incorrect API key")||c.includes("API key is missing"))&&(console.warn("API key error detected, disabling auto-detection to prevent infinite retries"),On(!1),localStorage.setItem("auto_detect_language","false"),u=Z===is.OpenAI?"OpenAI":Z===is.Groq?"Groq":"AI","function"==typeof Re&&Re("Language detection failed: Invalid ".concat(u," API key. Please check your API key in settings."),"error"),d=e.trim().toLowerCase().slice(0,100),f=/[а-яё]/gi,p=/[a-z]/gi,g=/[\u4e00-\u9fff]/gi,h=/[\u3040-\u309f\u30a0-\u30ff]/gi,m=/[\uac00-\ud7af]/gi,y=/[\u0600-\u06ff]/gi,x=/[áéíóúüñ¿¡]/gi,v=["hasta","desde","como","pero","porque","adonde","quien","para","por"].some((function(e){return d===e||d.startsWith(e+" ")||d.includes(" "+e+" ")})),b="",f.test(d)?b="ru":g.test(d)?b="zh":h.test(d)?b="ja":m.test(d)?b="ko":y.test(d)?b="ar":x.test(d)||v?b="es":p.test(d)&&(b="en"),b&&(wn(b),i(b),localStorage.setItem("detected_language",b),localStorage.setItem("language_already_detected","true"),console.log("Language detected using fallback method:",b))),[3,13];case 12:return En(!1),[7];case 13:return[2]}}))}))}),[ze,Q,Z,J,X,o,an,i]);(0,r.useEffect)((function(){var e="true"===localStorage.getItem("language_already_detected");if(l&&l.trim().length>2&&Pn&&(!e&&!bn||zn)){var t=setTimeout((function(){Dn(l)}),500);return function(){return clearTimeout(t)}}}),[l,Dn,Pn,bn,zn,i]);var Mn=function(){var e=!Pn;On(e),localStorage.setItem("auto_detect_language",e?"true":"false"),Pn?bn&&i(bn):(i(""),l&&Dn(l))},Un=function(){return _n?(0,a.jsx)("div",Ts({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"16px"},onClick:function(){return In(!1)}},{children:(0,a.jsxs)("div",Ts({style:{backgroundColor:"#FFFFFF",borderRadius:"12px",width:"90%",maxWidth:"360px",maxHeight:"80vh",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",Ts({style:{padding:"16px",borderBottom:"1px solid #E5E7EB",display:"flex",flexDirection:"column",gap:"12px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsxs)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(gt,{color:"#6366F1",size:18}),(0,a.jsx)("span",{children:"Select Source Language"})]})),(0,a.jsx)("button",Ts({onClick:function(){return In(!1)},style:{background:"none",border:"none",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px"}},{children:(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsxs)("div",Ts({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:An,onChange:function(e){return Fn(e.target.value)},placeholder:"Search languages...",style:{width:"100%",padding:"10px 12px 10px 36px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#F9FAFB",fontSize:"14px",color:"#374151",outline:"none"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#9CA3AF",viewBox:"0 0 16 16",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}},{children:(0,a.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})),An&&(0,a.jsx)("button",Ts({onClick:function(){return Fn("")},style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",backgroundColor:"#E5E7EB"}},{children:(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"#6B7280",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}))}))]})),(0,a.jsx)("p",Ts({style:{margin:0,fontSize:"12px",color:"#6B7280",lineHeight:1.5}},{children:"Select the language of your text. This helps generate more accurate translations and examples."}))]})),(0,a.jsx)("div",Ts({style:{overflowY:"auto",maxHeight:"calc(80vh - 135px)",padding:"8px 0"}},{children:0===Rn.length?(0,a.jsxs)("div",Ts({style:{padding:"16px",textAlign:"center",color:"#6B7280",fontSize:"14px"}},{children:['No languages found matching "',An,'"']})):Rn.map((function(e){return(0,a.jsxs)("button",Ts({onClick:function(){xn(e.code),In(!1),On(!1)},style:{display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",backgroundColor:e.code===yn?"#EFF6FF":"transparent",border:"none",textAlign:"left",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(t){e.code!==yn&&(t.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(t){e.code!==yn&&(t.currentTarget.style.backgroundColor="transparent")}},{children:[(0,a.jsx)("span",Ts({style:{fontSize:"22px",marginRight:"12px",width:"28px",textAlign:"center"}},{children:e.flag})),(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},{children:[(0,a.jsx)("span",Ts({style:{color:e.code===yn?"#2563EB":"#111827",fontWeight:e.code===yn?"600":"normal",fontSize:"14px"}},{children:e.name})),e.englishName!==e.name&&(0,a.jsx)("span",Ts({style:{color:"#6B7280",fontSize:"12px"}},{children:e.englishName}))]})),e.code===yn&&(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2563EB",viewBox:"0 0 16 16",style:{marginLeft:"auto"}},{children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})}))]}),e.code)}))}))]}))})):(0,a.jsxs)("div",Ts({style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",gap:"8px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"}},{children:[(0,a.jsxs)("label",Ts({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0,display:"flex",alignItems:"center",gap:"6px"}},{children:[(0,a.jsx)("span",{children:"Source Language"}),(0,a.jsx)("span",Ts({style:{fontSize:"12px",color:"#6B7280",fontWeight:"normal",fontStyle:"italic"}},{children:"(of your text)"}))]})),(0,a.jsxs)("div",Ts({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)("span",Ts({style:{fontSize:"12px",color:Pn?"#10B981":"#9CA3AF",transition:"color 0.2s ease"}},{children:"Auto"})),(0,a.jsx)("button",Ts({onClick:Mn,style:{width:"36px",height:"20px",backgroundColor:Pn?"#10B981":"#E5E7EB",border:"none",borderRadius:"10px",position:"relative",cursor:"pointer",transition:"background-color 0.2s ease"}},{children:(0,a.jsx)("span",{style:{position:"absolute",width:"16px",height:"16px",backgroundColor:"white",borderRadius:"50%",top:"2px",left:Pn?"18px":"2px",transition:"left 0.2s ease",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"}})}))]}))]})),(0,a.jsxs)("button",Ts({onClick:function(){return In(!0)},disabled:Pn,style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:Pn?"#F3F4F6":"#F9FAFB",color:"#374151",fontSize:"14px",cursor:Pn?"not-allowed":"pointer",opacity:Pn?.7:1,transition:"all 0.2s ease",textAlign:"left"},onMouseOver:function(e){return!Pn&&(e.currentTarget.style.backgroundColor="#F3F4F6")},onMouseOut:function(e){return!Pn&&(e.currentTarget.style.backgroundColor="#F9FAFB")}},{children:[(0,a.jsx)("span",Ts({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:kn?(0,a.jsx)(_t,{type:"pulse",size:"small",inline:!0,color:"#6B7280"}):Bn?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",Ts({style:{fontSize:"18px"}},{children:Bn.flag})),(0,a.jsx)("span",{children:Bn.name}),Pn&&(0,a.jsxs)("span",Ts({style:{fontSize:"12px",color:"#10B981",backgroundColor:"#ECFDF5",padding:"2px 6px",borderRadius:"4px",marginLeft:"4px",display:"flex",alignItems:"center",gap:"3px"}},{children:[(0,a.jsx)(Ze,{size:10}),(0,a.jsx)("span",{children:"Detected"})]}))]}):(0,a.jsx)("span",Ts({style:{color:"#9CA3AF"}},{children:Pn?"Detecting language...":"Select source language"}))})),!Pn&&(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})}))]})),(0,a.jsxs)("div",Ts({style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",backgroundColor:"#F3F4F6",borderRadius:"6px",marginTop:"4px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",alignItems:"center",gap:"4px"}},{children:[(0,a.jsx)("span",Ts({style:{fontSize:"14px"}},{children:Bn?Bn.flag:"🌐"})),(0,a.jsx)(lt,{size:12,color:"#6B7280"}),(0,a.jsx)("span",Ts({style:{fontSize:"14px"}},{children:gn.flag}))]})),(0,a.jsxs)("span",Ts({style:{fontSize:"12px",color:"#4B5563"}},{children:["Translating ",Bn?"from ".concat(Bn.englishName):""," to ",gn.englishName]})),Pn&&(0,a.jsx)("button",Ts({onClick:function(){localStorage.removeItem("language_already_detected"),l&&Dn(l)},title:"Reset language detection",style:{marginLeft:"auto",background:"none",border:"none",display:"flex",padding:"2px",cursor:"pointer",color:"#6B7280"}},{children:(0,a.jsxs)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16"},{children:[(0,a.jsx)("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),(0,a.jsx)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})]}))}))]}))]}))},$n=function(){return Ps(void 0,void 0,void 0,(function(){var e,t,n;return Os(this,(function(r){switch(r.label){case 0:if(!Ft)return Re("API key is required for testing","error"),[2];e="млекопитающими",console.log("Testing new iterative validation system..."),Re("Testing iterative validation system...","info"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Fs(At,Ft,e,"ru","ru",3)];case 2:return t=r.sent(),console.log("Test result:",t),t.linguisticInfo?(t.wasValidated?t.attempts>1?Re("✅ Test passed: Grammar reference created and validated after ".concat(t.attempts," attempts"),"success"):Re("✅ Test passed: Grammar reference validated on first attempt","success"):Re("⚠️ Test completed: Grammar reference created but validation failed after ".concat(t.attempts," attempts"),"warning"),console.log("Generated linguistic info:",t.linguisticInfo)):Re("❌ Test failed: Could not generate grammar reference after ".concat(t.attempts," attempts"),"error"),[3,4];case 3:return n=r.sent(),console.error("Test error:",n),Re("❌ Test failed: "+(n instanceof Error?n.message:"Unknown error"),"error"),[3,4];case 4:return[2]}}))}))},Wn=function(e){o(me(e)),Nt&&W(!0)};(0,r.useEffect)((function(){var e=localStorage.getItem("source_language"),t=localStorage.getItem("detected_language"),n=localStorage.getItem("auto_detect_language");console.log("Initializing language settings from localStorage:",{savedSourceLanguage:e,savedDetectedLanguage:t,savedAutoDetect:n}),e?i(e):t&&"false"!==n&&i(t),"false"===n&&On(!1)}),[i]);var Vn=(0,r.useCallback)((function(e){return Ps(void 0,void 0,void 0,(function(){var t,n,r,o;return Os(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),Ft?(t='Return only the native name of the language with ISO 639-1 code "'.concat(e,'".\nExamples: \n- "en" -> "English"\n- "ru" -> "Русский" \n- "es" -> "Español"\n- "fr" -> "Français"\n- "de" -> "Deutsch"\n- "zh" -> "中文"\n- "ja" -> "日本語"\n- "ar" -> "العربية"\n\nRespond with ONLY the native language name, no additional text.'),[4,At.createChatCompletion(Ft,[{role:"user",content:t}])]):[2,e.toUpperCase()];case 1:return(n=a.sent())&&n.content?(r=n.content.trim(),localStorage.setItem("language_name_".concat(e),r),[2,r]):[2,e.toUpperCase()];case 2:return o=a.sent(),console.error("Error getting language name from AI:",o),[2,e.toUpperCase()];case 3:return[2]}}))}))}),[Ft,At]),qn=(0,r.useCallback)((function(e){return Ps(void 0,void 0,void 0,(function(){var t;return Os(this,(function(n){switch(n.label){case 0:return(t=localStorage.getItem("language_name_".concat(e)))?[2,t]:[4,Vn(e)];case 1:return[2,n.sent()]}}))}))}),[Vn]),Hn=(0,r.useCallback)((function(e){return Ps(void 0,void 0,void 0,(function(){var t,n,r,o,a,i;return Os(this,(function(s){switch(s.label){case 0:if(!e||0===e.trim().length)return[2,{shouldGenerate:!1,reason:"No text provided"}];s.label=1;case 1:return s.trys.push([1,3,,4]),t='Analyze this word/phrase and determine if a visual image would be helpful for language learning: "'.concat(e,'"\n\nConsider these criteria:\n- Concrete objects, animals, places, foods, tools, vehicles = YES\n- Abstract concepts, emotions, actions, grammar terms = NO\n- People, professions, activities that can be visualized = YES\n- Numbers, prepositions, conjunctions, abstract ideas = NO\n\nRespond with ONLY "YES" or "NO" followed by a brief reason (max 10 words).\nFormat: "YES - concrete object that can be visualized" or "NO - abstract concept"'),[4,At.createChatCompletion(Ft,[{role:"user",content:t}])];case 2:return(n=s.sent())&&n.content?(r=n.content.trim(),o=r.toUpperCase().startsWith("YES"),a=r.includes(" - ")?r.split(" - ")[1]:"AI analysis",[2,{shouldGenerate:o,reason:a}]):[2,{shouldGenerate:!1,reason:"AI analysis failed"}];case 3:return i=s.sent(),console.error("Error analyzing text for image generation:",i),[2,{shouldGenerate:!1,reason:"Analysis error"}];case 4:return[2]}}))}))}),[At,Ft]),Gn=function(e){o(function(e){return{type:Ne,payload:e}}(e)),"always"===e&&l&&Vt()&&Mt(),"off"===e&&(o(ce(null)),o(ue(null)))},Kn=m((function(e){return e.cards.isGeneratingCard}));return(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",flex:1,width:"100%",height:"100%",position:"relative"}},{children:[F&&(0,a.jsxs)("div",Ts({style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"20px",padding:"0 20px"}},{children:[(0,a.jsx)(_t,{type:"spinner",size:"large",color:"#3B82F6",text:"Creating your Anki card..."}),(0,a.jsx)("div",Ts({style:{backgroundColor:"#F3F4F6",padding:"10px 16px",borderRadius:"8px",fontSize:"13px",color:"#4B5563",maxWidth:"90%",textAlign:"center",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:Ct?"We're creating multiple cards from your selected options...":"We're analyzing your text and generating learning materials"})),(0,a.jsxs)("button",Ts({onClick:Qt,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"10px"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"},title:"Cancel card generation"},{children:[(0,a.jsx)(kt,{}),"Cancel Generation"]}))]})),rt&&(0,a.jsxs)("div",Ts({style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:5,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"20px",padding:"0 20px"}},{children:[(0,a.jsx)(_t,{type:"pulse",size:"medium",color:"#3B82F6",text:"Analyzing selected text..."}),(0,a.jsxs)("button",Ts({onClick:function(){return it(!1)},style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",backgroundColor:"#F3F4F6",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"10px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"10px"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#E5E7EB",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#4B5563"},title:"Cancel text analysis"},{children:[(0,a.jsx)(kt,{}),"Cancel Analysis"]}))]})),(0,a.jsx)("div",Ts({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",gap:"12px",width:"100%",padding:"12px",paddingTop:"16px",height:"100%",overflowY:"auto",backgroundColor:"#ffffff",paddingBottom:"16px"}},{children:(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",width:"100%",maxWidth:"320px"}},{children:[S===j.LanguageLearning&&(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",gap:"8px"}},{children:[hn(),Un(),(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",width:"100%",gap:"8px",marginTop:"4px"}},{children:[(0,a.jsx)("label",Ts({style:{color:"#111827",fontWeight:"600",fontSize:"14px",margin:0}},{children:"Image Generation:"})),(0,a.jsxs)("div",Ts({style:{display:"flex",width:"100%",backgroundColor:"#F3F4F6",borderRadius:"8px",padding:"4px",gap:"2px",opacity:Vt()?1:.5}},{children:[(0,a.jsx)("button",Ts({type:"button",onClick:function(){return Gn("off")},disabled:!Vt(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"off"===te?"#FFFFFF":"transparent",color:"off"===te?"#111827":"#6B7280",fontSize:"12px",fontWeight:"off"===te?"600":"500",cursor:Vt()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"off"===te?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:"🚫 Off"})),(0,a.jsx)("button",Ts({type:"button",onClick:function(){return Gn("smart")},disabled:!Vt(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"smart"===te?"#FFFFFF":"transparent",color:"smart"===te?"#111827":"#6B7280",fontSize:"12px",fontWeight:"smart"===te?"600":"500",cursor:Vt()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"smart"===te?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:"🧠 Smart"})),(0,a.jsx)("button",Ts({type:"button",onClick:function(){return Gn("always")},disabled:!Vt(),style:{flex:1,whiteSpace:"nowrap",padding:"8px 12px",borderRadius:"6px",border:"none",backgroundColor:"always"===te?"#FFFFFF":"transparent",color:"always"===te?"#111827":"#6B7280",fontSize:"12px",fontWeight:"always"===te?"600":"500",cursor:Vt()?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"always"===te?"0 1px 2px rgba(0, 0, 0, 0.05)":"none"}},{children:"🎨 Always"}))]})),(0,a.jsx)("div",Ts({style:{position:"relative",height:"2.8em",marginTop:"2px"}},{children:(0,a.jsxs)("div",Ts({style:{position:"absolute",top:0,left:0,right:0,fontSize:"11px",color:"#6B7280",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"}},{children:["off"===te&&"No images will be generated","smart"===te&&"AI decides: Images only for concrete objects, places, and visual concepts. Saves API costs by skipping abstract terms.","always"===te&&"Images generated for all cards"]}))})),!Vt()&&(0,a.jsx)("div",Ts({style:{fontSize:"12px",color:"#EF4444",backgroundColor:"#FEF2F2",padding:"6px 8px",borderRadius:"6px",border:"1px solid #FECACA"}},{children:"Image generation not available with Groq provider"}))]})),"off"!==te&&Vt()&&(ee?be?(0,a.jsxs)("div",Ts({style:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px",padding:"16px",width:"100%",marginBottom:"12px",marginTop:"8px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(ft,{size:14,color:"#10B981"}),"Image Instructions"]})),(0,a.jsx)("button",Ts({onClick:function(){return we(!1)},style:{background:"transparent",border:"none",cursor:"pointer",color:"#6B7280",fontSize:"13px"}},{children:"Cancel"}))]})),(0,a.jsxs)("div",Ts({style:{marginBottom:"16px"}},{children:[(0,a.jsx)("label",Ts({style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:500,color:"#374151"}},{children:"Image generation style"})),(0,a.jsx)("textarea",{value:Te,onChange:function(e){return Pe(e.target.value)},placeholder:"E.g., use anime style, make it minimalist, use pastel colors, make it black and white",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",minHeight:"100px",resize:"vertical"}}),(0,a.jsxs)("div",Ts({style:{fontSize:"12px",color:"#6B7280",marginTop:"8px",lineHeight:"1.4"}},{children:[(0,a.jsx)("p",Ts({style:{margin:"0 0 6px 0",fontWeight:"500"}},{children:"How to use:"})),(0,a.jsxs)("ul",Ts({style:{margin:0,paddingLeft:"16px"}},{children:[(0,a.jsxs)("li",{children:["These are ",(0,a.jsx)("strong",{children:"style instructions"})," for image generation"]}),(0,a.jsx)("li",{children:"The image will still be related to the word you're learning"}),(0,a.jsx)("li",{children:"Focus on artistic style, mood, colors, composition, etc."}),(0,a.jsx)("li",{children:'Examples: "watercolor style", "dark background", "realistic rendering"'})]}))]}))]})),(0,a.jsxs)("button",Ts({onClick:Yt,style:{backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"}},{children:[(0,a.jsx)(ft,{size:14}),"Save Image Instructions"]}))]})):(0,a.jsxs)("button",Ts({onClick:function(){return we(!0)},style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",color:"#4B5563",cursor:"pointer",width:"100%",justifyContent:"center",marginTop:"8px"}},{children:[(0,a.jsx)(ft,{size:14}),"Customize image generation"]})):null)]})),re?(0,a.jsxs)("div",Ts({style:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px",padding:"16px",width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(ht,{size:14,color:"#2563EB"}),"AI Instructions"]})),(0,a.jsx)("button",Ts({onClick:function(){return pe(!1)},style:{background:"transparent",border:"none",cursor:"pointer",color:"#6B7280",fontSize:"13px"}},{children:"Cancel"}))]})),(0,a.jsxs)("div",Ts({style:{marginBottom:"16px"}},{children:[(0,a.jsx)("label",Ts({style:{display:"block",marginBottom:"4px",fontSize:"14px",fontWeight:500,color:"#374151"}},{children:"Additional instructions for AI"})),(0,a.jsx)("textarea",{value:_e,onChange:function(e){return Ie(e.target.value)},placeholder:"E.g., Keep specialized terms untranslated. Make examples more advanced. Use formal language.",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",fontSize:"14px",minHeight:"100px",resize:"vertical"}}),(0,a.jsxs)("div",Ts({style:{fontSize:"12px",color:"#6B7280",marginTop:"8px",lineHeight:"1.4"}},{children:[(0,a.jsx)("p",Ts({style:{margin:"0 0 6px 0",fontWeight:"500"}},{children:"How to use:"})),(0,a.jsxs)("ul",Ts({style:{margin:0,paddingLeft:"16px"}},{children:[(0,a.jsxs)("li",{children:["These are ",(0,a.jsx)("strong",{children:"additional"})," instructions that supplement the basic AI behavior"]}),(0,a.jsx)("li",{children:"The original word will always be used (no need to specify it)"}),(0,a.jsx)("li",{children:"Examples will always be generated for the word you're learning"}),(0,a.jsx)("li",{children:"Use this for style guidance, preferences, or special requirements"})]}))]}))]})),(0,a.jsxs)("button",Ts({onClick:Kt,style:{backgroundColor:"#2563EB",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"}},{children:[(0,a.jsx)(ot,{size:14}),"Save Instructions"]})),(0,a.jsx)("button",Ts({onClick:$n,style:{backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"}},{children:"🧪 Test Grammar Validation"}))]})):(0,a.jsxs)("button",Ts({onClick:function(){return pe(!0)},style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",color:"#4B5563",cursor:"pointer",width:"100%",justifyContent:"center"}},{children:[(0,a.jsx)(at,{size:14}),"Customize AI behavior"]})),(0,a.jsxs)("form",Ts({onSubmit:function(e){return Ps(void 0,void 0,void 0,(function(){var t,r,a,i,s,c,u,d,f,p,g,h,m,y,x,S,k,C,I,j,A,F,P,O,R,B;return Os(this,(function(N){switch(N.label){case 0:if(e.preventDefault(),!l.trim())return[2];Ln(!0),o(xe(!0)),Y(!1),localStorage.removeItem("explicitly_saved"),vt([]),It(!1),o(he(null)),ee?E!==l&&(console.log("Text has changed, clearing existing images for new generation"),o(ce(null)),o(ue(null))):(console.log("Image generation is disabled, clearing existing images"),o(ce(null)),o(ue(null))),o(me("")),o(ye("")),T(!0),_(l),Re(null),N.label=1;case 1:if(N.trys.push([1,36,37,38]),console.log("=== DEBUG INFO ==="),console.log("Model Provider:",Z),console.log("API Key available:",Boolean(Ft)),console.log("Model Name (if Groq):",Z===is.Groq?X:"N/A"),console.log("AI Service:",Object.keys(At)),console.log("Source Language:",Pn?bn:yn),!Ft)throw new Error("API key for ".concat(Z," is missing. Please go to settings and add your API key."));t=Pn?bn:yn,r={translation:!1,examples:!1,flashcard:!1,image:!1,linguisticInfo:!1},N.label=2;case 2:return N.trys.push([2,4,,5]),[4,ks(At,Ft,l,v,b)];case 3:return(a=N.sent()).translated&&(o(le(a.translated)),r.translation=!0),[3,5];case 4:throw i=N.sent(),console.error("Translation failed:",i),new Error("Translation failed: ".concat(i instanceof Error?i.message:"Unknown error"));case 5:return N.trys.push([5,7,,8]),[4,Es(At,Ft,l,v,!0,b,t||void 0)];case 6:return(s=N.sent())&&s.length>0&&(c=s.map((function(e){return[e.original,e.translated]})),o(se(c)),r.examples=!0),[3,8];case 7:if(u=N.sent(),console.error("Examples generation failed:",u),!r.translation)throw new Error("Examples generation failed: ".concat(u instanceof Error?u.message:"Unknown error"));return Re("Examples generation failed: ".concat(u instanceof Error?u.message:"Unknown error",". Continuing with translation only."),"warning"),[3,8];case 8:return N.trys.push([8,10,,11]),[4,Cs(At,Ft,l)];case 9:return(d=N.sent()).front&&(o(fe(d.front)),r.flashcard=!0),[3,11];case 10:if(f=N.sent(),console.error("Flashcard creation failed:",f),!r.translation)throw new Error("Flashcard creation failed: ".concat(f instanceof Error?f.message:"Unknown error"));return Re("Flashcard creation failed: ".concat(f instanceof Error?f.message:"Unknown error",". Continuing with available data."),"warning"),[3,11];case 11:return N.trys.push([11,16,,17]),p=Pn?bn:yn,console.log("Creating validated linguistic info using source language: ".concat(p||"unknown",' for text: "').concat(l.substring(0,20),'...", user language: ').concat(v)),p?[4,Fs(At,Ft,l,p,v,5)]:[3,13];case 12:return(g=N.sent()).linguisticInfo?(o(me(g.linguisticInfo)),r.linguisticInfo=!0):(console.warn("Failed to generate linguistic info after ".concat(g.attempts," attempts")),Re("Failed to generate grammar reference","warning")),[3,15];case 13:return console.warn("No source language detected. Using target language (".concat(v,") as fallback for source")),[4,Fs(At,Ft,l,v,v,3)];case 14:(g=N.sent()).linguisticInfo&&(o(me(g.linguisticInfo)),r.linguisticInfo=!0,g.wasValidated&&g.attempts>1?Re("✅ Grammar reference corrected (fallback mode)","success"):g.wasValidated||Re("⚠️ Grammar reference may contain inaccuracies (fallback mode)","warning")),N.label=15;case 15:return[3,17];case 16:return h=N.sent(),console.error("Linguistic info generation failed:",h),r.translation&&console.log("Linguistic info generation failed: ".concat(h instanceof Error?h.message:"Unknown error",". Continuing with available data.")),[3,17];case 17:return N.trys.push([17,23,,24]),(m=Pn?bn:yn)?(console.log("Creating transcription using source language: ".concat(m,", user language: ").concat(v)),[4,_s(At,Ft,l,m,v)]):[3,21];case 18:return(y=N.sent())?[4,qn(v)]:[3,20];case 19:x=N.sent(),(S=[y.userLanguageTranscription&&'<div class="transcription-item user-lang">\n                                    <span class="transcription-label">'.concat(x,':</span>\n                                    <span class="transcription-text">').concat(y.userLanguageTranscription,"</span>\n                                </div>"),y.ipaTranscription&&'<div class="transcription-item ipa">\n                                    <span class="transcription-label">IPA:</span>\n                                    <span class="transcription-text">'.concat(y.ipaTranscription,"</span>\n                                </div>")].filter(Boolean).join("\n"))&&(o(ye(S)),console.log("Transcription created successfully")),N.label=20;case 20:return[3,22];case 21:console.warn("No source language available for transcription"),N.label=22;case 22:return[3,24];case 23:return k=N.sent(),console.error("Transcription generation failed:",k),[3,24];case 24:if("off"===te||!Vt())return[3,35];N.label=25;case 25:return N.trys.push([25,34,,35]),C="always"===te,I="","smart"!==te?[3,27]:[4,Hn(l)];case 26:j=N.sent(),C=j.shouldGenerate,I=j.reason,console.log('Smart image analysis for "'.concat(l,'": ').concat(C?"YES":"NO"," - ").concat(I)),N.label=27;case 27:return C?[4,At.getDescriptionImage(Ft,l,w)]:[3,32];case 28:return A=N.sent(),Z!==is.OpenAI?[3,30]:[4,Yi(0,ze,Q,A,w)];case 29:return F=N.sent(),P=F.imageUrl,O=F.imageBase64,P&&(console.log("*** HANDLE SUBMIT: Setting imageUrl in Redux:",P.substring(0,50)),o(ue(P))),O&&(console.log("*** HANDLE SUBMIT: Setting image (base64) in Redux:",O.substring(0,50)),o(ce(O))),r.image=!0,"smart"===te&&Re("Image generated: ".concat(I),"info"),[3,31];case 30:console.log("Image generation not supported for this provider"),N.label=31;case 31:return[3,33];case 32:"smart"===te&&Re("No image needed: ".concat(I),"info"),N.label=33;case 33:return[3,35];case 34:return R=N.sent(),console.error("Image generation failed:",R),(r.translation||r.examples)&&Re("Image generation failed: ".concat(R instanceof Error?R.message:"Unknown error",". Continuing without image."),"warning"),[3,35];case 35:if(o(he(null)),Y(!1),Rt([]),localStorage.removeItem("explicitly_saved"),localStorage.removeItem("current_card_id"),console.log("Created new single card - reset all saved statuses"),!(r.translation||r.examples||r.flashcard))throw new Error("Failed to create card: No data was successfully generated. Please check your API key and try again.");return n(!0),Ke(!0),H(!0),[3,38];case 36:return B=N.sent(),console.error("Error processing text:",B),Re(B instanceof Error?"".concat(B.message):"Failed to create card. Please check your API key and try again."),n(!1),Ke(!1),[3,38];case 37:return T(!1),o(xe(!1)),[7];case 38:return[2]}}))}))},style:{width:"100%",display:"flex",flexDirection:"column",gap:"8px",marginTop:"4px",marginBottom:"0"}},{children:[(0,a.jsxs)("div",Ts({style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"}},{children:[(0,a.jsxs)("label",Ts({htmlFor:"text",style:{color:"#111827",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center"}},{children:["Text:",function(){switch(Z){case is.OpenAI:return(0,a.jsx)("span",Ts({style:{display:"inline-flex",alignItems:"center",marginLeft:"8px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#10a37f",color:"white",fontSize:"10px",fontWeight:"600"}},{children:"OpenAI"}));case is.Groq:return(0,a.jsx)("span",Ts({style:{display:"inline-flex",alignItems:"center",marginLeft:"8px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#7c3aed",color:"white",fontSize:"10px",fontWeight:"600"}},{children:"Groq"}));default:return null}}()]})),(0,a.jsx)("textarea",{id:"text",value:l,onChange:function(e){return t=e.target.value,o(ie(t)),void(Nt?W(!0):zt(t));var t},placeholder:"Enter text to translate or select text from a webpage",style:{width:"100%",minHeight:"80px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",resize:"vertical",outline:"none",transition:"all 0.2s ease"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})]})),(0,a.jsx)("button",Ts({type:"submit",disabled:F,style:{width:"100%",padding:"8px 10px",marginTop:"4px",borderRadius:"6px",backgroundColor:"#2563EB",color:"#ffffff",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",transition:"all 0.2s ease",opacity:F?.7:1},onMouseOver:function(e){return!F&&(e.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(e){return!F&&(e.currentTarget.style.backgroundColor="#2563EB")}},{children:F?(0,a.jsx)("div",Ts({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"dots",size:"small",inline:!0,color:"#ffffff",text:"Creating card"})})):"Create Card"}))]}))]}))})),function(){if(!et)return null;var e=Object.values(ct).filter(Boolean).length;return(0,a.jsx)("div",Ts({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:function(){dt({}),tt(!1)}},{children:(0,a.jsxs)("div",Ts({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"360px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",Ts({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsxs)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(ut,{size:14,color:"#2563EB"}),"Select Terms for Cards"]})),(0,a.jsx)("button",Ts({onClick:function(){dt({}),Je([]),tt(!1)},style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(kt,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"14px"}},{children:[(0,a.jsxs)("p",Ts({style:{fontSize:"14px",color:"#4B5563",margin:0,lineHeight:"1.4"}},{children:["Found ",Qe.length," key terms"]})),e>0&&(0,a.jsxs)("span",Ts({style:{fontSize:"13px",fontWeight:500,color:"#2563EB",padding:"3px 8px",backgroundColor:"#EFF6FF",borderRadius:"6px"}},{children:[e," selected"]}))]})),(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 4px",marginBottom:"12px"}},{children:[(0,a.jsx)("button",Ts({onClick:function(){var t=e<Qe.length,n={};Qe.forEach((function(e){n[e]=t})),dt(n)},style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",background:"none",border:"none",padding:"4px 8px",borderRadius:"4px",color:"#4B5563",cursor:"pointer"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"}},{children:e===Qe.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",Ts({style:{fontSize:"13px"}},{children:"✓"}))," Deselect all"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",Ts({style:{fontSize:"13px"}},{children:"☐"}))," Select all"]})})),(0,a.jsx)("span",Ts({style:{fontSize:"12px",color:"#6B7280",fontStyle:"italic"}},{children:"Tap to select"}))]})),(0,a.jsx)("div",Ts({style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"16px",maxHeight:"300px",overflowY:"auto",padding:"4px",listStyle:"none"}},{children:rt?(0,a.jsx)("div",Ts({style:{display:"flex",justifyContent:"center",padding:"20px"}},{children:(0,a.jsx)(_t,{type:"pulse",size:"small",color:"#4F46E5",text:"Analyzing selected text..."})})):Qe.map((function(e,t){return(0,a.jsxs)("div",Ts({style:{display:"flex",alignItems:"center",padding:"10px 12px",backgroundColor:ct[e]?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat(ct[e]?"#BFDBFE":"#E5E7EB"),borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",position:"relative",listStyleType:"none"},onClick:function(){return Zt(e)}},{children:[(0,a.jsx)("input",{type:"checkbox",checked:!!ct[e],onChange:function(){return Zt(e)},style:{marginRight:"12px",width:"16px",height:"16px",accentColor:"#2563EB",minWidth:"16px"},id:"option-".concat(t)}),(0,a.jsx)("span",Ts({style:{fontSize:"14px",color:"#374151",flex:1,cursor:"pointer",wordBreak:"break-word",textAlign:"left",paddingLeft:"0",marginLeft:"0",display:"inline-block"}},{children:e.replace(/^[-–—•\s]+/,"")})),(0,a.jsx)("span",Ts({style:{position:"absolute",right:"10px",top:"10px",fontSize:"10px",padding:"2px 6px",borderRadius:"10px",backgroundColor:e.split(/\s+/).length>1?"#DBEAFE":"#F3F4F6",color:e.split(/\s+/).length>1?"#1E40AF":"#6B7280",fontWeight:e.split(/\s+/).length>1?"500":"normal"}},{children:e.split(/\s+/).length>1?"phrase":"word"}))]}),t)}))})),(0,a.jsxs)("div",Ts({style:{display:"flex",gap:"8px",marginTop:"12px"}},{children:[(0,a.jsx)("button",Ts({onClick:function(){dt({}),tt(!1)},style:{flex:"1",padding:"10px 12px",backgroundColor:"#F9FAFB",color:"#4B5563",border:"1px solid #E5E7EB",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#F9FAFB"}},{children:"Cancel"})),(0,a.jsxs)("button",Ts({onClick:Xt,disabled:0===e,style:{flex:"2",padding:"10px 12px",backgroundColor:0===e?"#E5E7EB":"#2563EB",color:0===e?"#9CA3AF":"#FFFFFF",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:0===e?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseOver:function(t){e>0&&(t.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(t){e>0&&(t.currentTarget.style.backgroundColor="#2563EB")}},{children:[(0,a.jsx)(mt,{size:14}),"Create ",e>0?"".concat(e," Card").concat(e>1?"s":""):"Cards"]}))]}))]}))}))}(),Ge&&t?(0,a.jsx)("div",Ts({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:Jt},{children:(0,a.jsxs)("div",Ts({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"340px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",Ts({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsx)("h3",Ts({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:Ct?"Card ".concat(wt+1," of ").concat(xt.length):"Your Card"})),(0,a.jsx)("button",Ts({onClick:Jt,style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(kt,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",Ts({style:{width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",Ts({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:Ue,onChange:function(e){return $e(e.target.value)},onKeyDown:Wt,placeholder:"Enter custom instructions (e.g., 'more formal examples', 'change image style')",style:{width:"100%",padding:"10px 12px",paddingRight:"44px",borderRadius:"8px",border:"1px solid #E5E7EB",fontSize:"14px",color:"#374151",backgroundColor:Ve?"#F9FAFB":"#FFFFFF",transition:"all 0.2s ease",boxShadow:Ve?"inset 0 1px 2px rgba(0, 0, 0, 0.05)":"none"},disabled:Ve}),Ve?(0,a.jsx)("div",Ts({style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",color:"#4F46E5"}},{children:(0,a.jsx)(_t,{type:"pulse",size:"small",inline:!0,color:"#4F46E5"})})):(0,a.jsx)("button",Ts({onClick:$t,disabled:!Ue.trim()||Ve,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:Ue.trim()?"linear-gradient(to right, #4F46E5, #6366F1)":"none",border:"none",color:Ue.trim()?"#FFFFFF":"#9CA3AF",cursor:Ue.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",width:"28px",height:"28px",boxShadow:Ue.trim()?"0 1px 3px rgba(0, 0, 0, 0.1)":"none",transition:"all 0.2s ease"},title:"Apply instructions"},{children:(0,a.jsx)(yt,{size:14})}))]})),(0,a.jsxs)("div",Ts({style:{fontSize:"12px",color:Ve?"#4F46E5":"#6B7280",marginTop:"6px",display:"flex",alignItems:"center",gap:"6px",fontWeight:Ve?"500":"normal"}},{children:[Ve&&(0,a.jsx)("span",{style:{display:"inline-block",width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#4F46E5",animation:"pulse 1.5s infinite"}}),Ve?"Applying your instructions...":"Type instructions and press Enter or click the magic wand"]})),(0,a.jsx)("style",{children:"\n                            @keyframes pulse {\n                                0% { opacity: 1; }\n                                50% { opacity: 0.4; }\n                                100% { opacity: 1; }\n                            }\n                        "})]})),Ct&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",Ts({style:{marginBottom:"8px",display:"flex",justifyContent:"center",alignItems:"center"}},{children:(0,a.jsxs)("div",Ts({style:{fontSize:"13px",color:"#4B5563",backgroundColor:"#F9FAFB",padding:"4px 10px",borderRadius:"16px",display:"flex",alignItems:"center",gap:"4px"}},{children:["Card ",wt+1," of ",xt.length,xt[wt]&&Bt(xt[wt].id)&&(0,a.jsxs)("span",Ts({style:{display:"inline-flex",alignItems:"center",gap:"3px",backgroundColor:"#ECFDF5",color:"#10B981",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"bold"}},{children:[(0,a.jsx)(Ze,{size:8}),"SAVED"]}))]}))})),(0,a.jsxs)("div",Ts({style:{display:"flex",justifyContent:"space-between",gap:"8px",marginBottom:"12px"}},{children:[(0,a.jsxs)("button",Ts({onClick:rn,disabled:0===wt,style:{padding:"8px 16px",backgroundColor:0===wt?"#F3F4F6":"#EFF6FF",color:0===wt?"#9CA3AF":"#2563EB",border:"1px solid ".concat(0===wt?"#E5E7EB":"#BFDBFE"),borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:0===wt?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",flex:1}},{children:["← Prev",wt>0&&xt[wt-1]&&(Bt(xt[wt-1].id)?(0,a.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#10B981",marginLeft:"auto"}}):null)]})),(0,a.jsxs)("button",Ts({onClick:en,disabled:wt===xt.length-1,style:{padding:"8px 16px",backgroundColor:wt===xt.length-1?"#F3F4F6":"#EFF6FF",color:wt===xt.length-1?"#9CA3AF":"#2563EB",border:"1px solid ".concat(wt===xt.length-1?"#E5E7EB":"#BFDBFE"),borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:wt===xt.length-1?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",flex:1,justifyContent:"flex-end"}},{children:[wt<xt.length-1&&xt[wt+1]&&(Bt(xt[wt+1].id)?(0,a.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#10B981",marginRight:"auto"}}):null),"Next →"]}))]})),(0,a.jsx)("button",Ts({onClick:qt,style:{width:"100%",padding:"10px 12px",backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},disabled:D},{children:D?(0,a.jsx)(_t,{type:"dots",size:"small",inline:!0,color:"#ffffff",text:"Saving"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",Ts({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},{children:(0,a.jsx)("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})})),Ot.length>0?(0,a.jsxs)(a.Fragment,{children:["Save ",xt.length-Ot.length," Remaining Cards",(0,a.jsxs)("span",Ts({style:{fontSize:"12px",backgroundColor:"rgba(255,255,255,0.25)",borderRadius:"4px",padding:"1px 6px",marginLeft:"4px"}},{children:[Ot.length," saved"]}))]}):(0,a.jsxs)(a.Fragment,{children:["Save All Cards (",xt.length,")"]})]})}))]}),(0,a.jsx)(Tt,{mode:S,front:p,translation:c,examples:u,imageUrl:f,image:d,linguisticInfo:y,transcription:x,onNewImage:Mt,onNewExamples:Ut,onAccept:Ht,onViewSavedCards:Gt,onCancel:Qt,loadingNewImage:O,loadingNewExamples:N,loadingAccept:D,loadingGetResult:F,shouldGenerateImage:ee,isSaved:Nt,isEdited:$,isGeneratingCard:Kn,setTranslation:Lt,setExamples:Dt,setLinguisticInfo:Wn})]}))})):null,_n&&Un(),ln&&hn(),(0,a.jsx)("div",Ts({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,pointerEvents:"none"}},{children:(0,a.jsx)("div",Ts({style:{pointerEvents:"auto"}},{children:Be()}))}))]}))},Ns=n.p+"assets/img/chat-gpt39f424be38a6852eb2c5.png",zs=n.p+"assets/img/copy-iconb2b0ec637a2b0fd4ca40.svg";var Ls=function(){return Ls=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ls.apply(this,arguments)},Ds=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Ms=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};const Us=function(e){e.onBackClick,e.popup;var t=C(),n=(0,r.useState)(null),o=n[0],i=n[1],s=m((function(e){return e.settings.openAiKey})),l=(m((function(e){return e.settings.ankiConnectUrl})),m((function(e){return e.settings.ankiConnectApiKey}))),c=m((function(e){return e.settings.groqApiKey})),u=m((function(e){return e.settings.groqModelName})),d=m((function(e){return e.settings.modelProvider})),f=function(e){t(function(e){return{type:je,payload:e}}(e.target.value))},p=function(e){t(function(e){return{type:$e,payload:e}}(e.target.value))},g=function(e){var n;t((n=e.target.value,{type:We,payload:n}))},h=chrome.runtime.getURL(Ns),y=chrome.runtime.getURL(zs),x=function(e){return Ds(void 0,void 0,void 0,(function(){var t,n,r,o,a,l,d,f;return Ms(this,(function(p){switch(p.label){case 0:i(null),p.label=1;case 1:switch(p.trys.push([1,4,,5]),t="",n={},r={},o="",e){case is.OpenAI:t="https://api.openai.com/v1/chat/completions",n={"Content-Type":"application/json",Authorization:"Bearer ".concat(o=s)},r={model:"gpt-3.5-turbo",messages:[{role:"user",content:"Say hello"}],max_tokens:10};break;case is.Groq:t="https://api.groq.com/openai/v1/chat/completions",n={"Content-Type":"application/json",Authorization:"Bearer ".concat(o=c)},r={model:u,messages:[{role:"user",content:"Say hello"}],max_tokens:10}}return o.trim()?[4,fetch(t,{method:"POST",headers:n,body:JSON.stringify(r)})]:(i({success:!1,message:"API key is missing. Please enter your API key."}),[2]);case 2:return[4,(a=p.sent()).json()];case 3:return l=p.sent(),a.ok?(console.log("API test response:",l),i({success:!0,message:"Connection successful! API is working properly."})):(console.error("API test error:",l),i({success:!1,message:"Error: ".concat((null===(f=l.error)||void 0===f?void 0:f.message)||"Unknown error occurred")})),[3,5];case 4:return d=p.sent(),console.error("API connection test error:",d),i({success:!1,message:"Error: ".concat(d instanceof Error?d.message:"Unknown error occurred")}),[3,5];case 5:return[2]}}))}))},v=function(){return o?(0,a.jsx)("div",Ls({style:{padding:"10px",marginTop:"10px",borderRadius:"6px",backgroundColor:o.success?"#ECFDF5":"#FEF2F2",color:o.success?"#065F46":"#B91C1C",fontSize:"14px",borderLeft:"4px solid ".concat(o.success?"#10B981":"#EF4444")}},{children:o.message})):null};return(0,a.jsxs)("div",Ls({style:{padding:"12px",backgroundColor:"#ffffff",height:"100%",width:"100%",maxWidth:"320px",margin:"0 auto",overflowY:"auto",paddingBottom:"16px",marginTop:"20px"}},{children:[(0,a.jsxs)("div",Ls({style:{marginBottom:"20px",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"8px"}},{children:[(0,a.jsx)("label",Ls({htmlFor:"modelProvider",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"AI Provider"})),(0,a.jsx)("p",Ls({style:{fontSize:"12px",marginBottom:"8px",color:"#6B7280"}},{children:"Select which provider to use for generating flashcards"})),(0,a.jsxs)("select",Ls({id:"modelProvider",value:d,onChange:function(e){var n;t((n=e.target.value,{type:Ue,payload:n})),i(null)},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",cursor:"pointer"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)("option",Ls({value:is.OpenAI},{children:"OpenAI"})),(0,a.jsx)("option",Ls({value:is.Groq},{children:"Groq"}))]}))]})),(0,a.jsxs)("div",{children:[d!==is.OpenAI?null:(0,a.jsxs)("div",Ls({style:{marginBottom:"20px"}},{children:[(0,a.jsxs)("div",Ls({style:{display:"flex",alignItems:"center",marginBottom:"8px"}},{children:[(0,a.jsx)("label",Ls({htmlFor:"openAiKey",style:{display:"block",fontWeight:"600",marginBottom:"0",marginRight:"8px",color:"#111827",fontSize:"14px"}},{children:"OpenAI API Key"})),(0,a.jsx)("img",{src:h,alt:"ChatGPT Logo",style:{width:"16px",height:"16px",marginTop:"-2px"}})]})),(0,a.jsxs)("p",Ls({style:{fontSize:"12px",marginBottom:"6px",color:"#6B7280"}},{children:["You can get your OpenAI API key from ",(0,a.jsx)("a",Ls({href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#2563EB",textDecoration:"underline"}},{children:"here"})),"."]})),(0,a.jsx)("div",Ls({style:{position:"relative",marginBottom:"16px"}},{children:(0,a.jsx)("input",{type:"text",id:"openAiKey",value:s,onChange:f,style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})})),(0,a.jsx)("button",Ls({onClick:function(){return x(is.OpenAI)},style:{marginTop:"8px",padding:"6px 12px",backgroundColor:"#10a37f",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px"}},{children:"Test API Connection"})),v()]})),d!==is.Groq?null:(0,a.jsxs)("div",Ls({style:{marginBottom:"20px"}},{children:[(0,a.jsx)("label",Ls({htmlFor:"groqApiKey",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"Groq API Key"})),(0,a.jsxs)("p",Ls({style:{fontSize:"12px",marginBottom:"8px",color:"#6B7280"}},{children:["You can get your Groq API key from ",(0,a.jsx)("a",Ls({href:"https://console.groq.com/keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#2563EB",textDecoration:"underline"}},{children:"here"})),"."]})),(0,a.jsx)("input",{type:"text",id:"groqApiKey",value:c,onChange:p,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",marginBottom:"16px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}}),(0,a.jsx)("div",Ls({style:{padding:"8px",backgroundColor:"#DBEAFE",borderRadius:"6px",marginBottom:"16px"}},{children:(0,a.jsxs)("p",Ls({style:{fontSize:"12px",color:"#1E40AF",margin:0}},{children:[(0,a.jsx)("strong",{children:"Note:"})," Image generation is not available with Groq."]}))})),(0,a.jsx)("label",Ls({htmlFor:"groqModelName",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"Groq Model"})),(0,a.jsxs)("select",Ls({id:"groqModelName",value:u,onChange:g,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",cursor:"pointer",marginBottom:"16px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}},{children:[(0,a.jsx)("option",Ls({value:"llama3-8b-8192"},{children:"Llama-3 8B"})),(0,a.jsx)("option",Ls({value:"llama3-70b-8192"},{children:"Llama-3 70B"})),(0,a.jsx)("option",Ls({value:"mixtral-8x7b-32768"},{children:"Mixtral 8x7B"})),(0,a.jsx)("option",Ls({value:"gemma-7b-it"},{children:"Gemma 7B"}))]})),(0,a.jsx)("button",Ls({onClick:function(){return x(is.Groq)},style:{marginTop:"8px",padding:"6px 12px",backgroundColor:"#7c3aed",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px"}},{children:"Test API Connection"})),v()]})),(0,a.jsx)("div",{style:{marginBottom:"20px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",Ls({htmlFor:"ankiConnectApiKey",style:{display:"block",fontWeight:"600",marginBottom:"8px",color:"#111827",fontSize:"14px"}},{children:"AnkiConnect API Key (optional)"})),(0,a.jsx)("input",{type:"text",id:"ankiConnectApiKey",value:null!==l?l:"",onChange:function(e){var n;t((n=e.target.value,{type:Pe,payload:n}))},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"13px",outline:"none",transition:"all 0.2s ease",marginBottom:"20px"},onFocus:function(e){return e.target.style.borderColor="#2563EB"},onBlur:function(e){return e.target.style.borderColor="#E5E7EB"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",Ls({style:{fontSize:"13px",marginBottom:"8px",color:"#6B7280"}},{children:["Install the Anki plugin ",(0,a.jsx)("strong",{children:"AnkiConnect"})," and configure it as follows:"]})),(0,a.jsxs)("ul",Ls({style:{fontSize:"13px",listStyle:"disc",paddingLeft:"20px",marginBottom:"8px",color:"#6B7280"}},{children:[(0,a.jsxs)("li",Ls({style:{marginBottom:"4px"}},{children:["Go to ",(0,a.jsx)("strong",{children:"Tools"})," then ",(0,a.jsx)("strong",{children:"Add-ons"})," then ",(0,a.jsx)("strong",{children:"Get Add-ons..."})]})),(0,a.jsxs)("li",Ls({style:{marginBottom:"4px",display:"flex",alignItems:"center"}},{children:["Paste Code  ",(0,a.jsxs)("button",Ls({onClick:function(){return navigator.clipboard.writeText("2055492159")},style:{display:"flex",alignItems:"center",backgroundColor:"#F3F4F6",padding:"4px 6px",borderRadius:"4px",color:"#2563EB",transition:"all 0.2s ease",border:"none",cursor:"pointer"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#E5E7EB"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"}},{children:[(0,a.jsx)("img",{src:y,alt:"Copy Icon",style:{width:"16px",height:"16px",marginRight:"4px"}}),(0,a.jsx)("code",Ls({style:{backgroundColor:"transparent",fontSize:"12px"}},{children:"2055492159"}))]}))]})),(0,a.jsxs)("li",Ls({style:{marginBottom:"4px"}},{children:["Then click ",(0,a.jsx)("strong",{children:"OK"})]})),(0,a.jsx)("li",Ls({style:{marginBottom:"4px"}},{children:"Restart Anki"})),(0,a.jsxs)("li",Ls({style:{marginBottom:"4px"}},{children:["Navigate to ",(0,a.jsx)("strong",{children:"Tools"})," > ",(0,a.jsx)("strong",{children:"Add-ons"})," > ",(0,a.jsx)("strong",{children:"AnkiConnect"})," >",(0,a.jsx)("strong",{children:"Config"})]}))]})),(0,a.jsxs)("div",Ls({style:{position:"relative",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"6px",marginBottom:"20px"}},{children:[(0,a.jsxs)("p",Ls({style:{fontSize:"13px",marginBottom:"8px",color:"#6B7280"}},{children:["Copy paste the following config, you can change the ",(0,a.jsx)("code",{children:"apiKey"}),":"]})),(0,a.jsx)("pre",Ls({style:{display:"block",overflow:"auto",padding:"10px",backgroundColor:"#F3F4F6",borderRadius:"4px",whiteSpace:"pre-wrap",cursor:"pointer",fontSize:"12px",color:"#374151",margin:0},onClick:function(){return navigator.clipboard.writeText(JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2))},title:"Click to copy"},{children:JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2)})),(0,a.jsx)("button",Ls({onClick:function(){return navigator.clipboard.writeText(JSON.stringify({apiKey:l||"your_api_key",webCorsOriginList:["http://localhost","*"],webBindPort:8765},null,2))},style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",cursor:"pointer",padding:"4px"},title:"Copy to clipboard"},{children:(0,a.jsx)("img",{src:y,alt:"Copy Icon",style:{width:"16px",height:"16px"}})}))]}))]})]}))};var $s="FETCH_DECKS_SUCCESS",Ws="SET_DECK_ID",Vs=function(e){return{type:Ws,payload:e}},qs=function(){return qs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},qs.apply(this,arguments)},Hs=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},Gs=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ks=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const Ys=function(e){e.onBackClick;var t=C(),n=m((function(e){return e.cards})).storedCards,o=m((function(e){return e.deck.deckId})),i=m((function(e){return e.deck.decks})),s=m((function(e){return e.settings.useAnkiConnect})),l=m((function(e){return e.settings.ankiConnectUrl})),c=m((function(e){return e.settings.ankiConnectApiKey})),u=m((function(e){return e.settings.openAiKey})),d=m((function(e){return e.settings.imageInstructions})),f=m((function(e){return e.cards})),p=(0,r.useState)([]),g=p[0],h=p[1],y=(0,r.useState)(!1),x=y[0],v=y[1],b=(0,r.useState)(!1),w=b[0],S=b[1],k=(0,r.useState)("not_exported"),E=k[0],_=k[1],I=(0,r.useState)(!1),A=I[0],F=I[1],T=(0,r.useState)(null),P=T[0],O=T[1],R=(0,r.useState)(!1),B=R[0],z=R[1],L=(0,r.useState)(!1),D=(L[0],L[1]),M=(0,r.useState)(""),U=M[0],$=M[1],W=(0,r.useState)(!1),V=W[0],q=W[1],H=(0,r.useState)(!1),G=H[0],K=H[1],Q=(0,r.useState)(!1),J=Q[0],X=Q[1],Z=(0,r.useState)(!1),ee=Z[0],te=Z[1],ne=(0,r.useState)(1),oe=ne[0],he=ne[1],xe=(0,r.useState)(10),ve=xe[0],be=xe[1],we=(0,r.useState)(1),Se=we[0],ke=we[1],Ee=(0,r.useState)(!1),_e=Ee[0],Ie=Ee[1],je=(0,r.useState)("anki_cards"),Ae=je[0],Fe=je[1],Te=(0,r.useState)(!1),Pe=Te[0],Oe=Te[1],Re=Ji(),Be=Re.showError,Ne=Re.renderErrorNotification;new Hi({apiKey:u,dangerouslyAllowBrowser:!0});(0,r.useEffect)((function(){Hs(void 0,void 0,void 0,(function(){var e,r,o;return Gs(this,(function(a){console.log("StoredCards component mounted, forcing complete reload of cards...");try{if(e=localStorage.getItem("anki_stored_cards"))try{r=JSON.parse(e),console.log("Direct from localStorage, found cards:",r.length)}catch(e){console.error("Failed to parse localStorage data directly:",e)}else console.log("No cards found directly in localStorage")}catch(e){console.error("Error accessing localStorage directly:",e)}return t(ae()),o=setTimeout((function(){if(console.log("Current stored cards after initial load:",n.length),0===n.length){console.log("No cards loaded, trying to load directly from localStorage...");try{var e=localStorage.getItem("anki_stored_cards");if(e){var r=JSON.parse(e);Array.isArray(r)&&r.length>0&&(console.log("Found cards directly in localStorage, manually setting in Redux..."),t({type:"SET_STORED_CARDS",payload:r}))}}catch(e){console.error("Failed to manually load cards:",e)}}if(n.length>0){var o=n.filter((function(e){return"not_exported"===e.exportStatus})).length,a=n.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})).length;console.log("Card stats: total=",n.length,"not_exported=",o,"exported=",a),n.forEach((function(e,t){var n,r,o,a;(e.image||e.imageUrl)&&console.log("Card ".concat(t," (").concat(e.id,") has images:"),{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(n=e.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=e.imageUrl)||void 0===r?void 0:r.length,imageStart:null===(o=e.image)||void 0===o?void 0:o.substring(0,30),imageUrlStart:null===(a=e.imageUrl)||void 0===a?void 0:a.substring(0,30)})}))}}),500),[2,function(){return clearTimeout(o)}]}))}))}),[t,n.length]),(0,r.useEffect)((function(){console.log("Stored cards updated:",n)}),[n]);var ze=function(){return Hs(void 0,void 0,void 0,(function(){var e,n;return Gs(this,(function(r){switch(r.label){case 0:if(!s)return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),S(!0),[4,N(c)];case 2:return(e=r.sent()).result&&(t({type:"FETCH_DECKS_SUCCESS",payload:e.result}),!o&&e.result.length>0&&t(Vs(e.result[0].deckId))),[3,5];case 3:return n=r.sent(),console.error("Error loading decks:",n),s&&Be("Failed to load Anki decks. Make sure Anki is running with AnkiConnect plugin."),[3,5];case 4:return S(!1),[7];case 5:return[2]}}))}))};(0,r.useEffect)((function(){s&&0===i.length&&ze()}),[s]);var Le=function(){if(console.log("All cards in store:",n.length,"cards"),!Array.isArray(n)||0===n.length)return console.log("No cards to filter"),[];var e,t={not_exported:0,exported_to_anki:0,exported_to_file:0,unknown:0};switch(n.forEach((function(e){"not_exported"===e.exportStatus?t.not_exported++:"exported_to_anki"===e.exportStatus?t.exported_to_anki++:"exported_to_file"===e.exportStatus?t.exported_to_file++:t.unknown++})),console.log("Card status counts:",t),E){case"not_exported":e=n.filter((function(e){return"not_exported"===e.exportStatus})),console.log("Filtered to not_exported cards:",e.length);break;case"exported":e=n.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})),console.log("Filtered to exported cards:",e.length);break;default:e=Ks([],n,!0),console.log("Using all cards:",e.length)}var r=e.sort((function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}));return console.log("Final filtered and sorted cards:",r.length),r}(),De=function(){if(0===Le.length)return[];var e=(oe-1)*ve,t=e+ve;return e>=Le.length?(he(1),Le.slice(0,ve)):(console.log("Pagination debug:",{totalCards:n.length,filteredCards:Le.length,currentPage:oe,itemsPerPage:ve,startIndex:e,endIndex:t,cardsOnThisPage:Le.slice(e,t).length}),Le.slice(e,t))}();(0,r.useEffect)((function(){var e=Math.max(1,Math.ceil(Le.length/ve));ke(e),oe>e&&he(1)}),[Le.length,ve]);var Me={all:n.length,not_exported:n.filter((function(e){return"not_exported"===e.exportStatus})).length,exported:n.filter((function(e){return"exported_to_anki"===e.exportStatus||"exported_to_file"===e.exportStatus})).length},Ue=function(e){t(function(e){return{type:Y,payload:e}}(e))},$e=function(e){switch(e){case"exported_to_anki":return(0,a.jsx)("span",qs({style:{fontSize:"11px",color:"#10B981",marginLeft:"8px"}},{children:"✓ Anki"}));case"exported_to_file":return(0,a.jsx)("span",qs({style:{fontSize:"11px",color:"#2563EB",marginLeft:"8px"}},{children:"✓ File"}));default:return null}},We=function(e){return P===e?null:e.mode===j.LanguageLearning?(0,a.jsxs)("div",qs({style:{padding:"8px"}},{children:[(0,a.jsx)("p",qs({style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px"}},{children:e.text})),e.translation&&(0,a.jsx)("p",qs({style:{color:"#374151",fontSize:"13px",marginBottom:"8px"}},{children:e.translation})),e.examples&&e.examples.length>0&&(0,a.jsxs)("div",qs({style:{marginTop:"8px"}},{children:[(0,a.jsx)("p",qs({style:{fontSize:"12px",color:"#6B7280",marginBottom:"4px"}},{children:"Examples:"})),e.examples.slice(0,1).map((function(e,t){var n=e[0],r=e[1];return(0,a.jsxs)("div",qs({style:{fontSize:"12px",marginBottom:"2px"}},{children:[(0,a.jsx)("p",qs({style:{color:"#111827",marginBottom:"2px",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:n})),r&&(0,a.jsx)("p",qs({style:{color:"#6B7280",fontStyle:"italic",lineHeight:"1.4",wordWrap:"break-word",overflow:"visible",whiteSpace:"normal"}},{children:r}))]}),t)})),e.examples.length>1&&(0,a.jsxs)("p",qs({style:{fontSize:"11px",color:"#6B7280"}},{children:["+",e.examples.length-1," more examples"]}))]})),(e.imageUrl||e.image)&&(0,a.jsx)("div",qs({style:{marginTop:"8px",textAlign:"center"}},{children:(0,a.jsx)("img",{src:e.imageUrl||e.image||"",alt:"Card image",style:{maxWidth:"100%",maxHeight:"80px",borderRadius:"4px",border:"1px solid #E5E7EB",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},onError:function(t){var n,r,o,a,i;console.error("Image failed to load for card:",e.id,"image data:",{hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageLength:null===(n=e.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=e.imageUrl)||void 0===r?void 0:r.length,imagePreview:null===(o=e.image)||void 0===o?void 0:o.substring(0,50),imageUrlPreview:null===(a=e.imageUrl)||void 0===a?void 0:a.substring(0,50),imageSrc:(e.imageUrl||e.image||"").substring(0,100)});var s=t.target;s.style.display="none";var l=document.createElement("div");l.style.cssText="\n                                        width: 100%;\n                                        height: 60px;\n                                        background-color: #F3F4F6;\n                                        border: 1px dashed #D1D5DB;\n                                        border-radius: 4px;\n                                        display: flex;\n                                        align-items: center;\n                                        justify-content: center;\n                                        color: #6B7280;\n                                        font-size: 12px;\n                                    ",l.textContent="🖼️ Image unavailable",null===(i=s.parentNode)||void 0===i||i.insertBefore(l,s.nextSibling)},onLoad:function(){var t,n;console.log("✅ Image loaded successfully for card:",e.id,"Size:",{imageLength:null===(t=e.image)||void 0===t?void 0:t.length,imageUrlLength:null===(n=e.imageUrl)||void 0===n?void 0:n.length})}})}))]})):(0,a.jsxs)("div",qs({style:{padding:"8px"}},{children:[e.front&&(0,a.jsx)("p",qs({style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px"}},{children:e.front})),e.back&&(0,a.jsx)("p",qs({style:{color:"#374151",fontSize:"12px"}},{children:e.back.length>100?e.back.substring(0,100)+"...":e.back}))]}))},Ve=function(e){t(Vs(e.target.value))},qe=function(){F((function(e){return!e}))},He=function(e){console.log("Starting to edit card:",e.id),console.log("Card data:",e),console.log("Current Redux state before editing:",f),t(ie(e.text||"")),t(le(e.translation||"")),t(se(Array.isArray(e.examples)?e.examples:[])),t(fe(e.front||"")),t(de(e.back||"")),t(ce(e.image||null)),t(ue(e.imageUrl||null)),t(me(e.linguisticInfo||"")),t(ye(e.transcription||"")),console.log("Redux actions dispatched, setting modal state..."),O(e),z(!0),D(!0),$(""),q(!1),K(!1),X(!1),te(!1),console.log("Modal state set. showEditModal should be true now.")},Ge=function(){console.log("Canceling edit, resetting modal state..."),O(null),z(!1),D(!1),$(""),q(!1),K(!1),X(!1),te(!1),console.log("Edit canceled, modal should be hidden now.")},Ke=function(){return Hs(void 0,void 0,void 0,(function(){var e,n;return Gs(this,(function(r){if(!P)return[2];try{if(te(!0),(e=qs(qs({},P),{text:f.text||P.text||"",translation:f.translation||P.translation||"",examples:Array.isArray(f.examples)?f.examples:Array.isArray(P.examples)?P.examples:[],front:f.front||P.front||"",back:f.back||P.back||"",image:f.image||P.image||null,imageUrl:f.imageUrl||P.imageUrl||null,linguisticInfo:f.linguisticInfo||P.linguisticInfo||"",transcription:f.transcription||P.transcription||""})).mode===j.LanguageLearning){if(!e.text||!e.translation)return Be("Please provide both text and translation"),[2];e.text=e.text.trim(),e.translation=e.translation.trim()}else{if(!e.front||!e.back)return Be("Please provide both front and back content"),[2];e.front=e.front.trim(),e.back=(null===(n=e.back)||void 0===n?void 0:n.trim())||null}console.log("Final data being saved to Redux:",e),t(ge(e)),Ge(),Be("Card updated successfully!","success")}catch(e){console.error("Error saving card:",e),Be("Failed to update card. Please try again.")}finally{te(!1)}return[2]}))}))},Ye=function(){return Hs(void 0,void 0,void 0,(function(){var e,n,r,o,a,i,s;return Gs(this,(function(l){switch(l.label){case 0:if(!P)return[2];l.label=1;case 1:if(l.trys.push([1,6,7,8]),K(!0),!u)throw new Error("OpenAI API key is not configured. Please add it in the settings.");return e=f.text||P.text,console.log("Starting image generation for text:",e),[4,Ce(u,e,d)];case 2:if(n=l.sent(),console.log("Description generated:",n),!n)throw new Error("Failed to generate image description");return r=d?"".concat(n,". ").concat(d):n,[4,fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)},body:JSON.stringify({prompt:r,n:1,size:"512x512",response_format:"url"})})];case 3:return[4,l.sent().json()];case 4:if(o=l.sent(),console.log("OpenAI direct API response:",o),!o.data||!o.data[0]||!o.data[0].url)throw new Error("OpenAI did not return an image URL");return a=o.data[0].url,console.log("Image URL generated:",a),[4,new Promise((function(e,t){chrome.runtime.sendMessage(a,(function(n){if(chrome.runtime.lastError)return console.error("Error sending message:",chrome.runtime.lastError),void t(chrome.runtime.lastError);console.log("Response from background script:",n),n&&n.status&&n.data?e(n.data):t(new Error("Failed to get image data from background script"))}))}))];case 5:return i=l.sent(),console.log("Image data received from background"),t(ue(i)),t(ce(i)),Be("New image generated successfully!","success"),[3,8];case 6:return s=l.sent(),console.error("Error generating image:",s),Be("Image generation failed: ".concat((null==s?void 0:s.message)||"Unknown error")),[3,8];case 7:return K(!1),[7];case 8:return[2]}}))}))},Qe=function(){return Hs(void 0,void 0,void 0,(function(){return Gs(this,(function(e){if(!P)return[2];try{X(!0),f.text||P.text,Be("Examples generation would be implemented here","info")}catch(e){console.error("Error generating examples:",e),Be("Examples generation failed: ".concat((null==e?void 0:e.message)||"Unknown error"))}finally{X(!1)}return[2]}))}))},Je=function(){return Hs(void 0,void 0,void 0,(function(){return Gs(this,(function(e){if(!U.trim()||V||!P)return[2];q(!0);try{Be('Custom instruction "'.concat(U,'" would be applied here'),"info"),$("")}catch(e){console.error("Error applying custom instructions:",e),Be("Failed to apply custom instructions")}finally{q(!1)}return[2]}))}))},Xe=function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Je())},Ze=function(e){t(le(e))},et=function(e){t(se(e))},rt=function(e){t(me(e))},ot=function(e){e>=1&&e<=Se&&he(e)},at=function(e){be(Number(e.target.value)),he(1)};(0,r.useEffect)((function(){var e,t;console.log("Modal state changed:",{showEditModal:B,editingCard:null==P?void 0:P.id,currentCardData:{text:(null===(e=f.text)||void 0===e?void 0:e.substring(0,20))+"...",translation:(null===(t=f.translation)||void 0===t?void 0:t.substring(0,20))+"..."}})}),[B,P,f.text,f.translation]);var lt,ct=function(){return Hs(void 0,void 0,void 0,(function(){var e,r,o,a,i,s,l,c;return Gs(this,(function(u){if(0===g.length)return Be("Please select at least one card to export"),[2];try{Oe(!0),e=n.filter((function(e){return g.includes(e.id)})),r="#separator:tab\n#html:true\n",e.forEach((function(e,t){var n,o,a,i;if(console.log("Processing card ".concat(t," for file export:"),{id:e.id,mode:e.mode,hasImage:!!e.image,hasImageUrl:!!e.imageUrl,imageType:typeof e.image,imageUrlType:typeof e.imageUrl,imageLength:null===(n=e.image)||void 0===n?void 0:n.length,imageUrlLength:null===(o=e.imageUrl)||void 0===o?void 0:o.length,imagePreview:null===(a=e.image)||void 0===a?void 0:a.substring(0,50),imageUrlPreview:null===(i=e.imageUrl)||void 0===i?void 0:i.substring(0,50),hasLinguisticInfo:!!e.linguisticInfo}),e.mode===j.LanguageLearning){var s=e.text.trim(),l="";if(e.translation&&(l+="<b>".concat(e.translation,"</b>")),e.examples&&e.examples.length>0&&(l+="<br><br>",e.examples.forEach((function(e,t){var n=e[0],r=e[1];l+="".concat(t+1,". ").concat(n),r&&(l+="<br><span style='font-size: 0.8em;'><i>".concat(r,"</i></span>")),l+="<br><br>"}))),e.image){var c=e.image;if(c.startsWith("data:")){var u="base64,";if(-1!==(p=c.indexOf(u))){var d=c.substring(p+u.length);l+='<div><img src="data:image/jpeg;base64,'.concat(d,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="'.concat(c,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="data:image/jpeg;base64,'.concat(c,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else if(e.imageUrl){var f=e.imageUrl;if(f.startsWith("data:")){var p;u="base64,";if(-1!==(p=f.indexOf(u))){d=f.substring(p+u.length);l+='<div><img src="data:image/jpeg;base64,'.concat(d,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else l+='<div><img src="'.concat(f,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}else f.startsWith("http")?l+='<div><img src="'.concat(f,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>'):l+='<div><img src="data:image/jpeg;base64,'.concat(f,'" style="max-width: 350px; max-height: 350px; margin: 0 auto;"></div>')}if(e.linguisticInfo&&e.linguisticInfo.trim()){var g=e.linguisticInfo.trim().split("\n").filter((function(e){return e.trim()})),h="";g.forEach((function(e){var t=e.trim();if(t.match(/^[А-ЯЁA-Z][^:]*:$/))h+='<div style="color: #2563EB; font-weight: bold; margin-top: 12px; margin-bottom: 4px;">'.concat(t,"</div>");else if(t.startsWith("•")||t.startsWith("-")||t.startsWith("*")){var n=t.replace(/^[•\-*]\s*/,"");h+='<div style="margin-left: 16px; margin-bottom: 2px; color: #374151;">• '.concat(n,"</div>")}else if(t.includes(":")&&!t.endsWith(":")){var r=t.split(":"),o=r[0],a=r.slice(1).join(":").trim();h+='<div style="margin-bottom: 4px;"><span style="color: #6B7280; font-weight: 500;">'.concat(o.trim(),':</span> <span style="color: #111827;">').concat(a,"</span></div>")}else t&&(h+='<div style="margin-bottom: 6px; color: #374151; line-height: 1.4;">'.concat(t,"</div>"))})),h&&(l+='<div style="margin-top: 20px; padding: 12px; background-color: #F8FAFC; border-left: 4px solid #2563EB; border-radius: 0 6px 6px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="color: #1E40AF; font-weight: bold; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center;"><span style="margin-right: 6px;">📚</span>Grammar & Linguistics</div>'.concat(h,"</div>"))}var m=s.replace(/\t/g," ").replace(/\n/g," ").trim(),y=l.replace(/\t/g," ").replace(/\r?\n/g,"<br>").trim();r+="".concat(m,"\t").concat(y,"\n"),console.log("Exported card ".concat(t,":"),{front:m.substring(0,50),backLength:y.length,hasLinguisticInfo:y.includes("Grammar & Linguistics")})}else if(e.mode===j.GeneralTopic){s=(e.front||"").trim();var x=(e.back||"").trim();m=s.replace(/\t/g," ").replace(/\n/g," ").trim(),y=x.replace(/\t/g," ").replace(/\r?\n/g,"<br>").trim();r+="".concat(m,"\t").concat(y,"\n")}})),(o=Ae.trim())||(o="anki_cards"),(o=o.replace(/[<>:"/\\|?*]/g,"_")).toLowerCase().endsWith(".txt")||(o+=".txt"),a=new Blob([r],{type:"text/plain;charset=utf-8;"}),i=URL.createObjectURL(a),(s=document.createElement("a")).setAttribute("href",i),s.setAttribute("download",o),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),l=e.length,c=e.filter((function(e){return e.linguisticInfo&&e.linguisticInfo.trim()})).length,console.log("Export complete: ".concat(l," cards exported, ").concat(c," with grammar information")),Be("Successfully exported ".concat(l,' cards to "').concat(o,'"').concat(c>0?" (".concat(c," with grammar info)"):"","!"),"success"),g.forEach((function(e){t(pe(e,"exported_to_file")),console.log("Updated card ".concat(e," export status to 'exported_to_file'"))})),Ie(!1),setTimeout((function(){try{var e=localStorage.getItem("anki_stored_cards");if(e){var t=JSON.parse(e);console.log("Verified localStorage after file export:",t.filter((function(e){return e.id&&g.includes(e.id)})).map((function(e){return{id:e.id,status:e.exportStatus}})))}}catch(e){console.error("Error verifying localStorage after file export:",e)}}),500)}catch(e){console.error("Error during file export:",e),Be("Failed to export cards. Please try again.")}finally{Oe(!1)}return[2]}))}))};return(0,a.jsxs)("div",qs({style:{display:"flex",flexDirection:"column",height:"100%",padding:"12px",paddingBottom:"20px",overflowY:"auto",width:"100%",maxWidth:"320px",margin:"0 auto",position:"relative"}},{children:[(0,a.jsx)("div",qs({style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"16px",paddingBottom:"12px",borderBottom:"1px solid #E5E7EB",marginTop:"20px"}},{children:(0,a.jsxs)("div",qs({style:{fontWeight:"600",fontSize:"16px",color:"#111827",background:"linear-gradient(to right, #4F46E5, #2563EB)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",padding:"4px 12px",borderRadius:"16px",border:"1px solid #E5E7EB",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:["Saved Cards (",n.length,")"]}))})),n.length>0?(0,a.jsxs)(a.Fragment,{children:[(lt={base:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",borderRadius:"6px 6px 0 0",cursor:"pointer",textAlign:"center",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px"},active:{backgroundColor:"#ffffff",color:"#2563EB",borderBottom:"2px solid #2563EB"},inactive:{backgroundColor:"#F3F4F6",color:"#6B7280",borderBottom:"2px solid transparent"}},(0,a.jsxs)("div",qs({style:{display:"flex",width:"100%",borderBottom:"1px solid #E5E7EB",marginBottom:"16px",backgroundColor:"#F3F4F6"}},{children:[(0,a.jsxs)("div",qs({onClick:function(){return _("not_exported")},style:qs(qs(qs({},lt.base),"not_exported"===E?lt.active:lt.inactive),{flex:1})},{children:["New",(0,a.jsx)("span",qs({style:{backgroundColor:"not_exported"===E?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:Me.not_exported}))]})),(0,a.jsxs)("div",qs({onClick:function(){return _("all")},style:qs(qs(qs({},lt.base),"all"===E?lt.active:lt.inactive),{flex:1})},{children:["All",(0,a.jsx)("span",qs({style:{backgroundColor:"all"===E?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:Me.all}))]})),(0,a.jsxs)("div",qs({onClick:function(){return _("exported")},style:qs(qs(qs({},lt.base),"exported"===E?lt.active:lt.inactive),{flex:1})},{children:["Exported",(0,a.jsx)("span",qs({style:{backgroundColor:"exported"===E?"#2563EB":"#9CA3AF",color:"white",borderRadius:"9999px",fontSize:"12px",padding:"1px 6px",minWidth:"20px"}},{children:Me.exported}))]}))]}))),s&&function(){var e;if(!s)return null;var t={container:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"16px",backgroundColor:"#F9FAFB",padding:"12px",borderRadius:"8px",border:"1px solid #E5E7EB"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},title:{fontSize:"14px",fontWeight:"600",color:"#111827"},button:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6B7280",display:"flex",alignItems:"center",padding:"0",fontSize:"12px"},selectContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%"},select:{flex:1,padding:"8px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",cursor:"pointer"},refreshButton:{backgroundColor:"#F3F4F6",border:"1px solid #E5E7EB",borderRadius:"6px",cursor:"pointer",color:"#6B7280",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",minWidth:"36px",height:"38px"}};return A?(0,a.jsxs)("div",qs({style:t.container},{children:[(0,a.jsxs)("div",qs({style:t.header},{children:[(0,a.jsx)("span",qs({style:t.title},{children:"Select Anki Deck"})),(0,a.jsx)("button",qs({onClick:qe,style:t.button},{children:"Hide"}))]})),(0,a.jsxs)("div",qs({style:t.selectContainer},{children:[(0,a.jsxs)("select",qs({value:o,onChange:Ve,style:t.select,disabled:w},{children:[0===i.length&&(0,a.jsx)("option",qs({value:""},{children:"No decks available"})),i.map((function(e){return(0,a.jsx)("option",qs({value:e.deckId},{children:e.name}),e.deckId)}))]})),(0,a.jsx)("button",qs({onClick:ze,disabled:w,title:"Refresh decks list",style:t.refreshButton,"aria-label":"Refresh decks"},{children:w?(0,a.jsx)("span",qs({style:{marginLeft:"2px"}},{children:(0,a.jsx)(_t,{type:"spinner",size:"small",color:"#4B5563"})})):(0,a.jsx)(wt,{size:14})}))]})),(0,a.jsx)("style",{children:"\n                    @keyframes spin {\n                        0% { transform: rotate(0deg); }\n                        100% { transform: rotate(360deg); }\n                    }\n                    "})]})):(0,a.jsxs)("div",qs({style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:"12px",padding:"8px 12px",backgroundColor:"#F9FAFB",borderRadius:"6px",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",qs({style:{fontSize:"13px",color:"#6B7280"}},{children:"Anki Deck:"})),(0,a.jsx)("span",qs({style:{fontSize:"14px",fontWeight:"500",marginLeft:"8px",color:"#111827"}},{children:(null===(e=i.find((function(e){return e.deckId===o})))||void 0===e?void 0:e.name)||"None selected"}))]}),(0,a.jsx)("button",qs({onClick:qe,style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#2563EB",fontSize:"13px"}},{children:"Change"}))]}))}(),(0,a.jsxs)("div",qs({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",qs({style:{display:"flex",alignItems:"center"}},{children:[(0,a.jsx)("input",{type:"checkbox",id:"selectAll",checked:g.length===Le.length&&Le.length>0,onChange:function(){P||(g.length===Le.length?h([]):h(Le.map((function(e){return e.id}))))},style:{marginRight:"8px"},disabled:null!==P}),(0,a.jsx)("label",qs({htmlFor:"selectAll",style:{fontSize:"14px",cursor:null!==P?"default":"pointer",opacity:null!==P?.6:1}},{children:g.length===Le.length&&Le.length>0?"Deselect All":"Select All"}))]})),(0,a.jsxs)("div",qs({style:{display:"flex",gap:"8px",flexWrap:"wrap"}},{children:[(0,a.jsx)("button",qs({onClick:function(){return Hs(void 0,void 0,void 0,(function(){var e,r,a,i;return Gs(this,(function(s){switch(s.label){case 0:if(0===g.length)return Be("Please select at least one card to save"),[2];v(!0),s.label=1;case 1:return s.trys.push([1,6,7,8]),e="Basic",r=n.filter((function(e){return g.includes(e.id)})),a=[],i=[],r.forEach((function(e){if(e.mode===j.LanguageLearning&&e.translation){var t=null;if(e.image)if(e.image.startsWith("data:")){var n="base64,";t=-1!==(o=e.image.indexOf(n))?e.image.substring(o+n.length):e.image}else t=e.image;var r={text:e.text,translation:e.translation,examples:e.examples||[],image_base64:t,linguisticInfo:e.linguisticInfo};console.log("Adding language learning card to Anki export:",{cardId:e.id,text:e.text,hasImage:!!t,imageLength:null==t?void 0:t.length,imagePreview:null==t?void 0:t.substring(0,30)}),a.push(r)}else if(e.mode===j.GeneralTopic&&e.front&&e.back){t=null;if(e.image)if(e.image.startsWith("data:")){var o;n="base64,";t=-1!==(o=e.image.indexOf(n))?e.image.substring(o+n.length):e.image}else t=e.image;var s={front:e.front,back:e.back,text:e.text,image_base64:t};console.log("Adding general topic card to Anki export:",{cardId:e.id,text:e.text,hasImage:!!t,imageLength:null==t?void 0:t.length,imagePreview:null==t?void 0:t.substring(0,30)}),i.push(s)}})),a.length>0?[4,t(re(j.LanguageLearning,l,c,o,e,a))]:[3,3];case 2:s.sent(),s.label=3;case 3:return i.length>0?[4,t(re(j.GeneralTopic,l,c,o,e,i))]:[3,5];case 4:s.sent(),s.label=5;case 5:return g.forEach((function(e){t(pe(e,"exported_to_anki")),console.log("Updated card ".concat(e," export status to 'exported_to_anki'"))})),Be("Cards saved to Anki successfully!","success"),setTimeout((function(){try{var e=localStorage.getItem("anki_stored_cards");if(e){var t=JSON.parse(e);console.log("Verified localStorage after export:",t.filter((function(e){return e.id&&g.includes(e.id)})).map((function(e){return{id:e.id,status:e.exportStatus}})))}}catch(e){console.error("Error verifying localStorage after export:",e)}}),500),[3,8];case 6:return s.sent(),Be("Failed to save cards to Anki. Make sure Anki is running and AnkiConnect is properly configured."),[3,8];case 7:return v(!1),[7];case 8:return[2]}}))}))},disabled:x||0===g.length||!s||!o||null!==P,style:{padding:"6px 10px",borderRadius:"6px",backgroundColor:"#10B981",color:"#ffffff",fontSize:"13px",border:"none",cursor:"pointer",opacity:!x&&0!==g.length&&s&&o&&null===P?1:.6},title:null!==P?"Finish editing first":!o&&s?"Please select a deck first":""},{children:x?(0,a.jsx)("div",qs({style:{display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,a.jsx)(_t,{type:"spinner",size:"small",inline:!0,color:"#ffffff",text:"Saving to Anki"})})):"Save to Anki"})),(0,a.jsxs)("button",qs({onClick:function(){if(0!==g.length){var e=(new Date).toISOString().split("T")[0],t="anki_cards_".concat(e);Fe(t),Ie(!0)}else Be("Please select at least one card to export")},disabled:x||0===g.length||null!==P,style:{padding:"6px 10px",borderRadius:"6px",backgroundColor:"#2563EB",color:"#ffffff",fontSize:"13px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",opacity:x||0===g.length||null!==P?.6:1}},{children:[(0,a.jsx)(it,{size:12}),(0,a.jsx)("span",{children:"Export"})]}))]}))]})),(0,a.jsx)("div",qs({style:{flex:1,overflow:"auto",marginBottom:"16px"}},{children:0===Le.length?(0,a.jsx)("div",qs({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"200px",color:"#6B7280",textAlign:"center",padding:"20px"}},{children:(0,a.jsx)("p",qs({style:{fontSize:"14px"}},{children:"all"===E?"No cards yet":"not_exported"===E?"No new cards":"No exported cards"}))})):De.map((function(e){return(0,a.jsxs)("div",qs({style:{border:"1px solid #E5E7EB",borderRadius:"6px",marginBottom:"8px",backgroundColor:g.includes(e.id)?"#F3F4F6":"#ffffff"}},{children:[(0,a.jsxs)("div",qs({style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",borderBottom:P===e?"none":"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",qs({style:{display:"flex",alignItems:"center"}},{children:[(0,a.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:function(){return t=e.id,void(P||(g.includes(t)?h(g.filter((function(e){return e!==t}))):h(Ks(Ks([],g,!0),[t],!1))));var t},style:{marginRight:"8px"},disabled:null!==P}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",qs({style:{fontSize:"12px",color:"#6B7280"}},{children:e.mode===j.LanguageLearning?"Language":"Topic"})),(0,a.jsx)("span",qs({style:{fontSize:"11px",color:"#9CA3AF",marginLeft:"8px"}},{children:(t=e.createdAt,n=new Date(t),n.toLocaleDateString()+" "+n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))})),(e.image||e.imageUrl)&&(0,a.jsx)("span",qs({style:{fontSize:"11px",color:"#10B981",marginLeft:"8px",backgroundColor:"#ECFDF5",padding:"1px 4px",borderRadius:"3px",fontWeight:"bold"}},{children:"📸 IMG"})),$e(e.exportStatus)]})]})),(0,a.jsx)("div",qs({style:{display:"flex",gap:"8px",flexWrap:"wrap"}},{children:P!==e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",qs({onClick:function(){return He(e)},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#2563EB",display:"flex",alignItems:"center",padding:"4px",opacity:.8,transition:"opacity 0.2s"},title:"Edit card",onMouseOver:function(e){return e.currentTarget.style.opacity="1"},onMouseOut:function(e){return e.currentTarget.style.opacity="0.8"}},{children:(0,a.jsx)(st,{size:14})})),(0,a.jsx)("button",qs({onClick:function(){return Ue(e.id)},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#EF4444",display:"flex",alignItems:"center",padding:"4px",opacity:.8,transition:"opacity 0.2s"},title:"Delete card",onMouseOver:function(e){return e.currentTarget.style.opacity="1"},onMouseOut:function(e){return e.currentTarget.style.opacity="0.8"}},{children:(0,a.jsx)(Et,{size:14})}))]})}))]})),We(e)]}),e.id);var t,n}))})),(0,a.jsxs)("div",qs({style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px",marginBottom:"16px",padding:"12px",backgroundColor:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",qs({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},{children:[(0,a.jsx)("div",qs({style:{display:"flex",alignItems:"center",gap:"8px"}},{children:(0,a.jsxs)("select",qs({value:ve,onChange:at,style:{padding:"6px 8px",borderRadius:"6px",border:"1px solid #D1D5DB",fontSize:"13px",backgroundColor:"#FFFFFF",color:"#111827",fontWeight:"500",cursor:"pointer",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2212%22%20height%3D%2212%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20fill%3D%22%23424242%22%20d%3D%22M6%2C9L1.2%2C4.2%20c-0.4-0.4-0.4-1%2C0-1.4s1-0.4%2C1.4%2C0L6%2C6.2l3.4-3.4c0.4-0.4%2C1-0.4%2C1.4%2C0s0.4%2C1%2C0%2C1.4L6%2C9z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",paddingRight:"28px",minWidth:"90px"},"aria-label":"Cards per page"},{children:[(0,a.jsx)("option",qs({value:5},{children:"5 per page"})),(0,a.jsx)("option",qs({value:10},{children:"10 per page"})),(0,a.jsx)("option",qs({value:20},{children:"20 per page"})),(0,a.jsx)("option",qs({value:50},{children:"50 per page"}))]}))})),(0,a.jsx)("div",qs({style:{display:"flex",alignItems:"center",fontSize:"13px",fontWeight:"500",color:"#4B5563"}},{children:Le.length>0?"".concat(Math.min((oe-1)*ve+1,Le.length),"-").concat(Math.min(oe*ve,Le.length)," of ").concat(Le.length," cards"):"0 cards"}))]})),(0,a.jsx)("div",qs({style:{display:"flex",justifyContent:"center",alignItems:"center"}},{children:(0,a.jsxs)("div",qs({style:{display:"flex",alignItems:"center",border:"1px solid #D1D5DB",borderRadius:"8px",overflow:"hidden",backgroundColor:"#FFFFFF",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"}},{children:[(0,a.jsx)("button",qs({onClick:function(){return ot(1)},disabled:1===oe,style:{padding:"8px 10px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:1===oe?"default":"pointer",color:1===oe?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){1!==oe&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Go to first page",title:"First page"},{children:(0,a.jsx)("svg",qs({width:"14",height:"14",fill:"currentColor",viewBox:"0 0 20 20"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 010 1.414zm-6 0a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 1.414L5.414 10l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}))})),(0,a.jsx)("button",qs({onClick:function(){return ot(oe-1)},disabled:1===oe,style:{padding:"8px 12px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:1===oe?"default":"pointer",color:1===oe?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){1!==oe&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Previous page",title:"Previous page"},{children:(0,a.jsx)(tt,{size:14})})),(0,a.jsxs)("div",qs({style:{padding:"6px 16px",fontSize:"13px",fontWeight:"500",color:"#111827",display:"flex",alignItems:"center",backgroundColor:"transparent",borderRight:"1px solid #E5E7EB",minWidth:"60px",justifyContent:"center"}},{children:[oe," / ",Se||1]})),(0,a.jsx)("button",qs({onClick:function(){return ot(oe+1)},disabled:oe===Se||0===Se,style:{padding:"8px 12px",backgroundColor:"transparent",border:"none",borderRight:"1px solid #E5E7EB",cursor:oe===Se||0===Se?"default":"pointer",color:oe===Se||0===Se?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){oe!==Se&&0!==Se&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Next page",title:"Next page"},{children:(0,a.jsx)(nt,{size:14})})),(0,a.jsx)("button",qs({onClick:function(){return ot(Se)},disabled:oe===Se||0===Se,style:{padding:"8px 10px",backgroundColor:"transparent",border:"none",cursor:oe===Se||0===Se?"default":"pointer",color:oe===Se||0===Se?"#9CA3AF":"#111827",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s"},onMouseOver:function(e){oe!==Se&&0!==Se&&(e.currentTarget.style.backgroundColor="#F9FAFB")},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Go to last page",title:"Last page"},{children:(0,a.jsx)("svg",qs({width:"14",height:"14",fill:"currentColor",viewBox:"0 0 20 20"},{children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 15.707a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L8.586 10l-4.293 4.293a1 1 0 000 1.414zm6 0a1 1 0 001.414 0l5-5a1 1 0 000-1.414l-5-5a1 1 0 00-1.414 1.414L14.586 10l-4.293 4.293a1 1 0 000 1.414z",clipRule:"evenodd"})}))}))]}))}))]}))]}):(0,a.jsx)("div",qs({style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"300px",color:"#6B7280",textAlign:"center"}},{children:(0,a.jsx)("p",{children:"No saved cards yet."})})),_e&&(0,a.jsx)("div",qs({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"}},{children:(0,a.jsxs)("div",qs({style:{backgroundColor:"#ffffff",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",border:"1px solid #E5E7EB"}},{children:[(0,a.jsxs)("div",qs({style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"}},{children:[(0,a.jsxs)("h3",qs({style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#111827",display:"flex",alignItems:"center",gap:"8px"}},{children:[(0,a.jsx)(it,{size:16,style:{color:"#2563EB"}}),"Export Cards"]})),(0,a.jsx)("button",qs({onClick:function(){return Ie(!1)},disabled:Pe,style:{backgroundColor:"transparent",border:"none",cursor:Pe?"default":"pointer",padding:"4px",borderRadius:"4px",color:"#6B7280",opacity:Pe?.5:1}},{children:(0,a.jsx)(kt,{size:16})}))]})),(0,a.jsxs)("div",qs({style:{marginBottom:"20px"}},{children:[(0,a.jsxs)("p",qs({style:{margin:"0 0 16px 0",fontSize:"14px",color:"#6B7280",lineHeight:"1.5"}},{children:["Export ",g.length," selected cards to a file. Choose a filename or use the default."]})),(0,a.jsx)("label",qs({style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"}},{children:"Filename"})),(0,a.jsxs)("div",qs({style:{position:"relative"}},{children:[(0,a.jsx)("input",{type:"text",value:Ae,onChange:function(e){return Fe(e.target.value)},placeholder:"Enter filename (without extension)",disabled:Pe,style:{width:"100%",padding:"10px 12px",paddingRight:"48px",border:"1px solid #D1D5DB",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s ease",backgroundColor:Pe?"#F9FAFB":"#ffffff",opacity:Pe?.7:1,boxSizing:"border-box"},onFocus:function(e){Pe||(e.target.style.borderColor="#2563EB",e.target.style.boxShadow="0 0 0 3px rgba(37, 99, 235, 0.1)")},onBlur:function(e){e.target.style.borderColor="#D1D5DB",e.target.style.boxShadow="none"},onKeyDown:function(e){"Enter"!==e.key||Pe||ct(),"Escape"===e.key&&Ie(!1)}}),(0,a.jsx)("span",qs({style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",fontSize:"13px",color:"#9CA3AF",pointerEvents:"none"}},{children:".txt"}))]})),(0,a.jsx)("p",qs({style:{margin:"6px 0 0 0",fontSize:"12px",color:"#6B7280"}},{children:"The .txt extension will be added automatically"}))]})),(0,a.jsxs)("div",qs({style:{display:"flex",gap:"12px",justifyContent:"flex-end"}},{children:[(0,a.jsx)("button",qs({onClick:function(){return Ie(!1)},disabled:Pe,style:{padding:"10px 16px",border:"1px solid #D1D5DB",borderRadius:"8px",backgroundColor:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:Pe?"default":"pointer",transition:"all 0.2s ease",opacity:Pe?.5:1},onMouseOver:function(e){Pe||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#9CA3AF")},onMouseOut:function(e){Pe||(e.currentTarget.style.backgroundColor="#ffffff",e.currentTarget.style.borderColor="#D1D5DB")}},{children:"Cancel"})),(0,a.jsx)("button",qs({onClick:ct,disabled:Pe||!Ae.trim(),style:{padding:"10px 16px",border:"none",borderRadius:"8px",backgroundColor:!Ae.trim()||Pe?"#9CA3AF":"#2563EB",color:"#ffffff",fontSize:"14px",fontWeight:"500",cursor:!Ae.trim()||Pe?"default":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",minWidth:"100px",justifyContent:"center"},onMouseOver:function(e){!Pe&&Ae.trim()&&(e.currentTarget.style.backgroundColor="#1D4ED8")},onMouseOut:function(e){!Pe&&Ae.trim()&&(e.currentTarget.style.backgroundColor="#2563EB")}},{children:Pe?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_t,{type:"spinner",size:"small",inline:!0,color:"#ffffff"}),(0,a.jsx)("span",{children:"Exporting..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(it,{size:14}),(0,a.jsx)("span",{children:"Export"})]})}))]}))]}))})),function(){if(console.log("renderEditModal called. showEditModal:",B,"editingCard:",P),!B||!P)return console.log("Modal not showing because showEditModal:",B,"editingCard:",!!P),null;var e=f.text,t=f.translation,n=f.examples,r=f.front,o=(f.back,f.image),i=f.imageUrl,s=f.linguisticInfo,l=f.transcription;return console.log("Rendering edit modal with data:",{text:(null==e?void 0:e.substring(0,20))+"...",translation:(null==t?void 0:t.substring(0,20))+"...",examplesCount:null==n?void 0:n.length,hasImage:!!o,hasImageUrl:!!i}),(0,a.jsx)("div",qs({style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(2px)",padding:"16px"},onClick:Ge},{children:(0,a.jsxs)("div",qs({style:{backgroundColor:"#ffffff",borderRadius:"12px",maxWidth:"340px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",padding:"16px"},onClick:function(e){return e.stopPropagation()}},{children:[(0,a.jsxs)("div",qs({style:{position:"sticky",top:0,display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #E5E7EB",paddingBottom:"12px",marginBottom:"16px",backgroundColor:"#ffffff",zIndex:2}},{children:[(0,a.jsx)("h3",qs({style:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"}},{children:"Edit Card"})),(0,a.jsx)("button",qs({onClick:Ge,style:{background:"none",border:"none",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"50%",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:function(e){return e.currentTarget.style.backgroundColor="#F3F4F6"},onMouseOut:function(e){return e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Close"},{children:(0,a.jsx)(kt,{size:16,color:"#6B7280"})}))]})),(0,a.jsxs)("div",qs({style:{width:"100%",marginBottom:"12px"}},{children:[(0,a.jsxs)("div",qs({style:{position:"relative",width:"100%"}},{children:[(0,a.jsx)("input",{type:"text",value:U,onChange:function(e){return $(e.target.value)},onKeyDown:Xe,placeholder:"Enter custom instructions for this card (e.g., 'regenerate examples', 'change image style')",style:{width:"100%",padding:"10px 12px",paddingRight:"44px",borderRadius:"8px",border:"1px solid #E5E7EB",fontSize:"14px",color:"#374151",backgroundColor:V?"#F9FAFB":"#FFFFFF",transition:"all 0.2s ease",boxShadow:V?"inset 0 1px 2px rgba(0, 0, 0, 0.05)":"none"},disabled:V}),V?(0,a.jsx)("div",qs({style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",color:"#4F46E5"}},{children:(0,a.jsx)(_t,{type:"pulse",size:"small",inline:!0,color:"#4F46E5"})})):(0,a.jsx)("button",qs({onClick:Je,disabled:!U.trim()||V,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:U.trim()?"linear-gradient(to right, #4F46E5, #6366F1)":"none",border:"none",color:U.trim()?"#FFFFFF":"#9CA3AF",cursor:U.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"50%",width:"28px",height:"28px",boxShadow:U.trim()?"0 1px 3px rgba(0, 0, 0, 0.1)":"none",transition:"all 0.2s ease"},title:"Apply instructions"},{children:(0,a.jsx)(yt,{size:14})}))]})),(0,a.jsxs)("div",qs({style:{fontSize:"12px",color:V?"#4F46E5":"#6B7280",marginTop:"6px",display:"flex",alignItems:"center",gap:"6px",fontWeight:V?"500":"normal"}},{children:[V&&(0,a.jsx)("span",{style:{display:"inline-block",width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#4F46E5",animation:"pulse 1.5s infinite"}}),V?"Applying your instructions...":"Type instructions and press Enter or click the magic wand"]}))]})),(0,a.jsx)(Tt,{mode:P.mode,front:r,translation:t,examples:n,imageUrl:i,image:o,linguisticInfo:s,transcription:l,onNewImage:Ye,onNewExamples:Qe,onAccept:Ke,onViewSavedCards:function(){},onCancel:Ge,loadingNewImage:G,loadingNewExamples:J,loadingAccept:ee,shouldGenerateImage:!0,isSaved:!0,isEdited:!0,setTranslation:Ze,setExamples:et,setLinguisticInfo:rt})]}))}))}(),(0,a.jsx)("div",qs({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,pointerEvents:"none"}},{children:(0,a.jsx)("div",qs({style:{pointerEvents:"auto"}},{children:Ne()}))}))]}))};var Qs="SET_ANKI_AVAILABILITY",Js=function(e){return{type:Qs,payload:e}},Xs="TOGGLE_SIDEBAR",Zs="SHOW_NOTIFICATION",el="HIDE_NOTIFICATION",tl=function(e){return{type:el,payload:{id:e}}},nl=function(){return nl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},nl.apply(this,arguments)};const rl=function(){var e=m((function(e){return e.notifications.notifications})),t=C();(0,r.useEffect)((function(){e.forEach((function(e){var n=e.id,r=e.type,o=0;"success"===r||"info"===r?o=4e3:"warning"===r&&(o=6e3),o>0&&setTimeout((function(){t(tl(n))}),o)}))}),[e,t]);return 0===e.length?null:(0,a.jsx)("div",nl({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,maxWidth:"300px",width:"auto",display:"flex",flexDirection:"column",gap:"8px"}},{children:e.map((function(e){var n=function(e){switch(e){case"success":return{icon:(0,a.jsx)(Xe,{size:16}),color:"#059669",bgColor:"#ECFDF5",borderColor:"#10B981"};case"warning":return{icon:(0,a.jsx)(ct,{size:16}),color:"#D97706",bgColor:"#FFFBEB",borderColor:"#F59E0B"};case"info":return{icon:(0,a.jsx)(pt,{size:16}),color:"#2563EB",bgColor:"#EFF6FF",borderColor:"#3B82F6"};default:return{icon:(0,a.jsx)(St,{size:16}),color:"#DC2626",bgColor:"#FEF2F2",borderColor:"#EF4444"}}}(e.type),r=n.icon,o=n.color,i=n.bgColor,s=n.borderColor;return(0,a.jsxs)("div",nl({style:{transform:"translateX(0)",opacity:1,transition:"all 0.3s ease-out",backgroundColor:i,border:"1px solid ".concat(s),borderRadius:"12px",padding:"16px",minWidth:"280px",maxWidth:"320px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative",display:"flex",alignItems:"flex-start",gap:"12px"},role:"alert","aria-live":"polite"},{children:[(0,a.jsx)("div",nl({style:{color:o,marginTop:"2px",flexShrink:0}},{children:r})),(0,a.jsx)("div",nl({style:{flex:1,paddingRight:"8px"}},{children:(0,a.jsx)("p",nl({style:{color:"#374151",margin:0,fontSize:"14px",lineHeight:"1.5",fontWeight:500}},{children:e.message}))})),(0,a.jsx)("button",nl({onClick:function(){return n=e.id,void t(tl(n));var n},style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",color:"#9CA3AF",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:function(e){e.currentTarget.style.backgroundColor="rgba(0, 0, 0, 0.1)",e.currentTarget.style.color="#374151"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9CA3AF"},"aria-label":"Close notification"},{children:(0,a.jsx)(kt,{size:12})}))]}),e.id)}))}))};var ol=function(){return ol=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ol.apply(this,arguments)},al=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))},il=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};const sl=function(){var e=this,t=(m((function(e){return e.anki.isAnkiAvailable})),(0,r.useState)(!0)),n=t[0],o=t[1],i=m((function(e){return e.currentPage})),s=C(),l=m((function(e){return e.settings.ankiConnectApiKey})),c=m((function(e){return e.cards.storedCards})),u=m((function(e){return e.cards.isGeneratingCard}));(0,r.useEffect)((function(){n&&al(e,void 0,void 0,(function(){var e,t,n;return il(this,(function(r){switch(r.label){case 0:r.trys.push([0,5,6,7]),s(ae()),console.log("Initial card load from App component"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,N(l)];case 2:return(e=r.sent()).error?(console.error("Anki returned an error:",e.error),s(Js(!1))):(s(function(e){return{type:$s,payload:e}}(e.result)),s(Js(!0)),console.log("Anki is available",i)),[3,4];case 3:return t=r.sent(),console.error("Anki is unavailable:",t),s(Js(!1)),[3,4];case 4:return[3,7];case 5:return n=r.sent(),console.error("Error initializing app:",n),[3,7];case 6:return o(!1),[7];case 7:return[2]}}))}))}),[s,l,n]),(0,r.useEffect)((function(){console.log("App: Stored cards count:",c.length)}),[c]);var d,f=(0,r.useCallback)((function(e){s(A(e))}),[s]),p=(0,r.useCallback)((function(){s({type:Xs}),chrome.runtime.sendMessage({action:"toggleSidebar"},(function(e){chrome.runtime.lastError?console.error("Error sending message:",chrome.runtime.lastError.message):console.log("Extension closed:",e)}))}),[s]);return(0,a.jsx)("div",ol({className:"App",style:{backgroundColor:"#ffffff",height:"100vh",display:"flex",flexDirection:"column",position:"absolute",right:0,top:0,width:"350px",fontFamily:"Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.05), 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},{children:(0,a.jsxs)("div",ol({style:{flex:1,width:"100%",height:"100%",position:"relative",display:"flex",flexDirection:"column"}},{children:[(d=c.filter((function(e){return"not_exported"===e.exportStatus})).length,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",ol({onClick:p,className:"close-button",style:{position:"absolute",top:"6px",right:"12px",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"6px",color:"#6B7280",borderRadius:"5px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",zIndex:200},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.color="#EF4444"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#6B7280"},title:"Close extension"},{children:(0,a.jsx)(kt,{size:14})})),"createCard"!==i&&(0,a.jsx)("div",ol({style:{position:"absolute",top:"6px",left:"12px",right:"50px",zIndex:100}},{children:(0,a.jsxs)("button",ol({onClick:function(){return f("createCard")},className:"new-card-button",style:{backgroundColor:"#2563EB",border:"none",cursor:"pointer",padding:"6px 14px",color:"#FFFFFF",borderRadius:"7px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"32px",boxShadow:"0 1px 3px rgba(37, 99, 235, 0.2)",fontSize:"13px",fontWeight:600},onMouseOver:function(e){e.currentTarget.style.backgroundColor="#1D4ED8",e.currentTarget.style.transform="translateY(-0.5px)",e.currentTarget.style.boxShadow="0 2px 6px rgba(37, 99, 235, 0.25)"},onMouseOut:function(e){e.currentTarget.style.backgroundColor="#2563EB",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(37, 99, 235, 0.2)"},title:"Create a new card"},{children:[(0,a.jsx)(vt,{style:{marginRight:"5px"},size:13}),"New Card"]}))})),(0,a.jsxs)("div",ol({style:{position:"absolute",bottom:"8px",left:"12px",right:"12px",display:"flex",gap:"6px",zIndex:100}},{children:[(0,a.jsxs)("button",ol({onClick:function(){return f("storedCards")},disabled:u,className:"nav-button",style:{backgroundColor:"storedCards"===i?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat("storedCards"===i?"#BFDBFE":"#E5E7EB"),cursor:u?"not-allowed":"pointer",padding:"10px 14px",color:u?"#9CA3AF":"storedCards"===i?"#2563EB":"#6B7280",borderRadius:"10px",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,gap:"3px",fontSize:"11px",fontWeight:"storedCards"===i?600:500,boxShadow:"storedCards"===i?"0 2px 4px rgba(37, 99, 235, 0.1)":"0 1px 2px rgba(0, 0, 0, 0.05)",position:"relative",opacity:u?.6:1},onMouseOver:function(e){"storedCards"===i||u||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.borderColor="#D1D5DB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){"storedCards"===i||u||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.color="#6B7280")},title:u?"Please wait while card is being generated":"View your saved cards"},{children:[(0,a.jsxs)("div",ol({style:{position:"relative",display:"flex",alignItems:"center"}},{children:[(0,a.jsx)(mt,{size:16}),d>0&&(0,a.jsx)("span",ol({style:{position:"absolute",top:"-6px",right:"-8px",backgroundColor:"#EF4444",color:"white",borderRadius:"10px",fontSize:"10px",fontWeight:"bold",padding:"2px 6px",minWidth:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"}},{children:d>99?"99+":d}))]})),(0,a.jsx)("span",{children:"Cards"})]})),(0,a.jsxs)("button",ol({onClick:function(){return f("settings")},disabled:u,className:"nav-button",style:{backgroundColor:"settings"===i?"#EFF6FF":"#F9FAFB",border:"1px solid ".concat("settings"===i?"#BFDBFE":"#E5E7EB"),cursor:u?"not-allowed":"pointer",padding:"10px 14px",color:u?"#9CA3AF":"settings"===i?"#2563EB":"#6B7280",borderRadius:"10px",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,gap:"3px",fontSize:"11px",fontWeight:"settings"===i?600:500,boxShadow:"settings"===i?"0 2px 4px rgba(37, 99, 235, 0.1)":"0 1px 2px rgba(0, 0, 0, 0.05)",opacity:u?.6:1},onMouseOver:function(e){"settings"===i||u||(e.currentTarget.style.backgroundColor="#F3F4F6",e.currentTarget.style.borderColor="#D1D5DB",e.currentTarget.style.color="#374151")},onMouseOut:function(e){"settings"===i||u||(e.currentTarget.style.backgroundColor="#F9FAFB",e.currentTarget.style.borderColor="#E5E7EB",e.currentTarget.style.color="#6B7280")},title:u?"Please wait while card is being generated":"App settings and API configuration"},{children:[(0,a.jsx)(at,{size:16}),(0,a.jsx)("span",{children:"Settings"})]}))]}))]})),(0,a.jsxs)("header",ol({className:"App-header",style:{width:"100%",flex:1,display:"flex",flexDirection:"column",backgroundColor:"#ffffff",marginTop:"0px",height:"100%",overflow:"auto"}},{children:[function(){var e="createCard"!==i?"46px":"12px",t="58px",n={width:"100%",height:"100%",paddingTop:e,paddingBottom:t,overflow:"auto",opacity:1,transform:"translateX(0)",transition:"all 0.3s ease-in-out"};switch(i){case"settings":return(0,a.jsx)("div",ol({style:n},{children:(0,a.jsx)(Us,{onBackClick:function(){return f("createCard")},popup:!1})}));case"storedCards":return(0,a.jsx)("div",ol({style:n},{children:(0,a.jsx)(Ys,{onBackClick:function(){return f("createCard")}})}));default:return(0,a.jsx)("div",ol({style:{width:"100%",flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%",position:"relative",paddingTop:e,paddingBottom:t,opacity:1,transform:"translateX(0)",transition:"all 0.3s ease-in-out"}},{children:(0,a.jsx)(Bs,{})}))}}(),(0,a.jsx)("div",ol({style:{position:"absolute",top:"16px",right:"16px",zIndex:9999,maxWidth:"300px",width:"auto",pointerEvents:"none"}},{children:(0,a.jsxs)("div",ol({style:{pointerEvents:"auto"}},{children:[" ",(0,a.jsx)(rl,{})]}))}))]}))]}))}))};
/**
 * @license
 * ReduxedChromeStorage v3.0.10
 * https://github.com/hindmost/reduxed-chrome-storage
 * Copyright (c) Savr Goryaev aka hindmost
 *
 * This source code is licensed under the MIT license
 * https://github.com/hindmost/reduxed-chrome-storage/blob/master/LICENSE
 *
 * Dependencies:
 *
 * uuid v8.3.2
 */
var ll,cl=new Uint8Array(16);function ul(){if(!ll&&!(ll="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ll(cl)}var dl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var fl=[],pl=0;pl<256;++pl)fl.push((pl+256).toString(16).substr(1));function gl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(fl[e[t+0]]+fl[e[t+1]]+fl[e[t+2]]+fl[e[t+3]]+"-"+fl[e[t+4]]+fl[e[t+5]]+"-"+fl[e[t+6]]+fl[e[t+7]]+"-"+fl[e[t+8]]+fl[e[t+9]]+"-"+fl[e[t+10]]+fl[e[t+11]]+fl[e[t+12]]+fl[e[t+13]]+fl[e[t+14]]+fl[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&dl.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}function hl(e,t,n){var r=(e=e||{}).random||(e.rng||ul)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return gl(r)}function ml(e){return null==e||"object"!=typeof e?e:JSON.parse(JSON.stringify(e))}function yl(e,t){if(e===t)return!0;if(null==e||"object"!=typeof e||null==t||"object"!=typeof t||Array.isArray(e)!==Array.isArray(t))return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n)if(r.indexOf(o)<=-1||!yl(e[o],t[o]))return!1;return!0}function xl(e,t){if(e===t)return;if(null==e||"object"!=typeof e||null==t||"object"!=typeof t)return e;if(Array.isArray(e)||Array.isArray(t))return yl(e,t)?void 0:e;const n=Object.keys(e),r=Object.keys(t);let o=!0;const a=n.reduce(((n,a)=>{const i=r.indexOf(a)>-1?xl(e[a],t[a]):e[a];return void 0===i||(o=!1,n[a]=i),n}),{});return r.forEach((e=>{n.indexOf(e)>-1||(o=!1,a[e]=void 0)})),o?void 0:a}function vl(e,t,n){if(Array.isArray(t))return ml(t);if(null==e||"object"!=typeof e||Array.isArray(e)||null==t||"object"!=typeof t)return ml(void 0!==t?t:e);const r=Object.keys(e).concat(Object.keys(t).filter((t=>!(t in e)))).reduce(((r,o)=>(r[o]=vl(e[o],t[o],n),r)),{});if(!n)return r;const o=Object.keys(t);return Object.keys(e).forEach((e=>{o.indexOf(e)>-1||delete r[e]})),r}const bl=e=>{if(void 0===e||!Array.isArray(e)||3!==e.length)return[e,"",0];const[t,n,r]=e;return"string"==typeof t&&"number"==typeof n?[r,t,n]:[e,"",0]};class wl{constructor(e,t,n,r,o,a,i){this.container=e,this.storage=t,this.isolated=n,this.plain=r,this.timeout=o?Math.max(o,500):1e3,this.resetState=i,this.store=this._instantiateStore(),this.state=null,this.id=hl(),this.tmstamp=0,this.outdted=[],"function"==typeof a&&(this.lisner=a),this.lisners=[],this.getState=this.getState.bind(this),this.subscribe=this.subscribe.bind(this),this.dispatch=this.dispatch.bind(this),this.replaceReducer=this.replaceReducer.bind(this),this[Symbol.observable]=this[Symbol.observable].bind(this)}init(){this.tmstamp||this.isolated||this.storage.subscribe(((e,t)=>{const[n,r,o]=bl(e);if(r===this.id||yl(n,this.state))return;const a=o>=this.tmstamp,i=a?vl(this.state,n,!0):vl(n,this.state,!0);!a&&yl(i,this.state)||(this._setState(i,o),this._renewStore(),yl(i,n)||this._send2Storage(),this._callListeners())}));const e=this.store.getState();return new Promise((t=>{this.storage.load((n=>{const[r,,o]=bl(n);let a=r?vl(e,r):e;this.resetState&&(a=vl(a,this.resetState)),this._setState(a,o),this._renewStore(),yl(a,r)||this._send2Storage(),t(this)}))}))}initFrom(e){return this._setState(e,0),this._renewStore(),this}_setState(e,t){this.state=ml(e),(t=void 0!==t?t:Date.now())>this.tmstamp&&(this.tmstamp=t)}_renewStore(){this.plain?this.unsub&&this.unsub():this._clean();const e=this.store=this._instantiateStore(this.state),t=Date.now(),n=this.outdted.length;this.outdted=this.outdted.map((([e,r],o)=>e||o>=n-1?[e,r]:[t,r]));let r=ml(this.state);const o=this.store.subscribe((()=>{const t=e&&e.getState(),n=this.store===e;if(this._clean(),!yl(t,this.state)){if(n)this._setState(t);else{const e=xl(t,r);if(void 0===e)return;this._setState(vl(this.state,e)),this._renewStore()}this._send2Storage(),this._callListeners(!0,r),r=ml(t)}}));this.plain?this.unsub=o:this.outdted.push([0,o])}_clean(){if(this.plain)return;const e=Date.now(),t=this.outdted.length;this.outdted.forEach((([n,r],o)=>{o>=t-1||e-n<this.timeout||(r(),delete this.outdted[o])}))}_instantiateStore(e){const t=this.container(e);if("object"!=typeof t||"function"!=typeof t.getState)throw new Error("Invalid 'storeCreatorContainer' supplied");return t}_send2Storage(){var e,t,n;this.storage.save((e=this.state,t=this.id,n=this.tmstamp,[t,n,e]))}_callListeners(e,t){e&&this.lisner&&this.lisner(this,t);for(const e of this.lisners)e()}getState(){return this.state}subscribe(e){return"function"==typeof e&&this.lisners.push(e),()=>{"function"==typeof e&&(this.lisners=this.lisners.filter((t=>t!==e)))}}dispatch(e){return this.store.dispatch(e)}replaceReducer(e){return"function"==typeof e&&this.store.replaceReducer(e),this}[Symbol.observable](){const e=this.getState,t=this.subscribe;return{subscribe(n){if("object"!=typeof n||null===n)throw new TypeError("Expected the observer to be an object.");function r(){const t=n;t.next&&t.next(e())}r();return{unsubscribe:t(r)}},[Symbol.observable](){return this}}}}var Sl;!function(e){e.local="local",e.sync="sync"}(Sl||(Sl={}));const kl=e=>(new TextEncoder).encode(Object.entries(e).map((([e,t])=>e+JSON.stringify(t))).join("")).length;class El{constructor({namespace:e,area:t,key:n}){this.ns=e,this.areaName=t===Sl.sync?Sl.sync:Sl.local,this.key=n||"reduxed",this.listeners=[],this.errListeners=[]}regShared(){this.regListener(((e,t)=>{for(const n of this.listeners)n(e,t)}))}regListener(e){this.ns.storage.onChanged.addListener(((t,n)=>{if(n!==this.areaName||!(this.key in t))return;const{newValue:r,oldValue:o}=t[this.key];r&&e(r,o)}))}subscribe(e){"function"==typeof e&&this.listeners.push(e)}subscribeForError(e){"function"==typeof e&&this.errListeners.push(e)}fireErrorListeners(e,t){for(const n of this.errListeners)n(e,t)}callbackOnLoad(e,t,n){t(!this.ns.runtime.lastError&&(n?e:e&&e[this.key]))}callbackOnSave(e,t){if(!this.ns.runtime.lastError)return;const{message:n}=this.ns.runtime.lastError;if(!n||!e||!t)return void this.fireErrorListeners(n||"",!1);this.areaName===Sl.sync&&t.QUOTA_BYTES_PER_ITEM&&kl({[this.key]:e})>t.QUOTA_BYTES_PER_ITEM?this.fireErrorListeners(n,!0):this.load((r=>{const o="object"==typeof r&&t.QUOTA_BYTES>0&&kl(Object.assign(Object.assign({},r),{[this.key]:e}))>t.QUOTA_BYTES;this.fireErrorListeners(n,o)}),!0)}}class Cl extends El{constructor({namespace:e,area:t,key:n}){super({namespace:e,area:t,key:n}),this.areaApi=this.ns.storage[this.areaName]}load(e,t){"function"==typeof e&&this.areaApi.get(t?null:this.key,(n=>{this.callbackOnLoad(n,e,t)}))}save(e){this.areaApi.set({[this.key]:e},(()=>{this.callbackOnSave(e,this.areaApi)}))}}class _l extends El{constructor({namespace:e,area:t,key:n}){super({namespace:e,area:t,key:n}),this.areaApi=this.ns.storage[this.areaName]}load(e,t){"function"==typeof e&&this.areaApi.get(t?null:this.key).then((t=>{this.callbackOnLoad(t,e)}))}save(e){this.areaApi.set({[this.key]:e}).then((()=>{this.callbackOnSave(e,this.areaApi)}))}}var Il;function jl(e){return jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jl(e)}function Al(e){var t=function(e,t){if("object"!=jl(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=jl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jl(t)?t:t+""}function Fl(e,t,n){return(t=Al(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tl(Object(n),!0).forEach((function(t){Fl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ol(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}!function(e){e.chrome="chrome",e.browser="browser"}(Il||(Il={}));var Rl="function"==typeof Symbol&&Symbol.observable||"@@observable",Bl=function(){return Math.random().toString(36).substring(7).split("").join(".")},Nl={INIT:"@@redux/INIT"+Bl(),REPLACE:"@@redux/REPLACE"+Bl(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Bl()}};function zl(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Ll(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(Ol(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(Ol(1));return n(Ll)(e,t)}if("function"!=typeof e)throw new Error(Ol(2));var o=e,a=t,i=[],s=i,l=!1;function c(){s===i&&(s=i.slice())}function u(){if(l)throw new Error(Ol(3));return a}function d(e){if("function"!=typeof e)throw new Error(Ol(4));if(l)throw new Error(Ol(5));var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error(Ol(6));t=!1,c();var n=s.indexOf(e);s.splice(n,1),i=null}}}function f(e){if(!zl(e))throw new Error(Ol(7));if(void 0===e.type)throw new Error(Ol(8));if(l)throw new Error(Ol(9));try{l=!0,a=o(a,e)}finally{l=!1}for(var t=i=s,n=0;n<t.length;n++){(0,t[n])()}return e}return f({type:Nl.INIT}),(r={dispatch:f,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ol(10));o=e,f({type:Nl.REPLACE})}})[Rl]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(Ol(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[Rl]=function(){return this},e},r}function Dl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function Ml(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(Ol(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return r=Dl.apply(void 0,a)(n.dispatch),Pl(Pl({},n),{},{dispatch:r})}}}function Ul(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}var $l=Ul();$l.withExtraArgument=Ul;const Wl=$l;var Vl=function(){return Vl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Vl.apply(this,arguments)},ql={decks:[],deckId:""};var Hl=function(){return Hl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Hl.apply(this,arguments)},Gl=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Kl=Hl({savedCards:[],storedCards:[],text:"",translation:"",examples:[],image:null,imageUrl:null,error:void 0,back:null,front:"",currentCardId:null,linguisticInfo:"",transcription:"",isGeneratingCard:!1});const Yl=function(e,t){var n,r,o,a,i,s,l,c,u,d;void 0===e&&(e=Kl);var f=Hl({},e);switch(t.type){case D:f.savedCards=Gl(Gl([],e.savedCards,!0),t.payload,!0);break;case G:console.log("*** REDUCER: SAVE_CARD_TO_STORAGE action received ***"),console.log("Action payload raw:",t.payload),console.log("Action payload image data:",{hasImage:!!t.payload.image,hasImageUrl:!!t.payload.imageUrl,imageType:typeof t.payload.image,imageUrlType:typeof t.payload.imageUrl,imageValue:t.payload.image,imageUrlValue:t.payload.imageUrl,imageUndefinedCheck:void 0!==t.payload.image,imageUrlUndefinedCheck:void 0!==t.payload.imageUrl});var p=Hl(Hl({},t.payload.id?t.payload:Hl(Hl({},t.payload),{id:Date.now().toString()})),{image:void 0!==t.payload.image?t.payload.image:null,imageUrl:void 0!==t.payload.imageUrl?t.payload.imageUrl:null,exportStatus:t.payload.exportStatus||"not_exported",linguisticInfo:t.payload.linguisticInfo||"",transcription:t.payload.transcription||""});console.log("REDUCER: Final card object created:",{cardId:p.id,hasImage:!!p.image,hasImageUrl:!!p.imageUrl,imageType:typeof p.image,imageUrlType:typeof p.imageUrl,imageLength:null===(n=p.image)||void 0===n?void 0:n.length,imageUrlLength:null===(r=p.imageUrl)||void 0===r?void 0:r.length,imageActualValue:p.image,imageUrlActualValue:p.imageUrl,imagePreview:null===(o=p.image)||void 0===o?void 0:o.substring(0,50),imageUrlPreview:null===(a=p.imageUrl)||void 0===a?void 0:a.substring(0,50)});var g=e.storedCards.find((function(e){return e.text===p.text}));g?(f.storedCards=e.storedCards.map((function(e){return e.id===g.id?Hl(Hl({},p),{id:g.id}):e})),console.log("Updated existing card with text:",p.text)):(f.storedCards=Gl(Gl([],e.storedCards,!0),[p],!1),console.log("Added new card:",p.text));break;case J:f.storedCards=e.storedCards.map((function(e){return e.id===t.payload.cardId?Hl(Hl({},e),{exportStatus:t.payload.status}):e}));break;case X:if(console.log("*** REDUCER: UPDATE_STORED_CARD action received ***"),console.log("Update payload image info:",{cardId:t.payload.id,hasImage:!!t.payload.image,hasImageUrl:!!t.payload.imageUrl,imageType:typeof t.payload.image,imageUrlType:typeof t.payload.imageUrl,imageValue:t.payload.image,imageUrlValue:t.payload.imageUrl,imageLength:null===(i=t.payload.image)||void 0===i?void 0:i.length,imageUrlLength:null===(s=t.payload.imageUrl)||void 0===s?void 0:s.length}),!t.payload.id)return console.error("Cannot update card without ID"),e;if(e.storedCards.some((function(e){return e.id===t.payload.id})))f.storedCards=e.storedCards.map((function(e){return e.id===t.payload.id?Hl(Hl({},t.payload),{exportStatus:t.payload.exportStatus||e.exportStatus,linguisticInfo:t.payload.linguisticInfo||e.linguisticInfo,transcription:t.payload.transcription||e.transcription}):e})),console.log("UPDATE_STORED_CARD: Updated existing card with ID:",t.payload.id,"image:",!!t.payload.image);else{var h=Hl(Hl({},t.payload),{exportStatus:t.payload.exportStatus||"not_exported",linguisticInfo:t.payload.linguisticInfo||"",transcription:t.payload.transcription||""});f.storedCards=Gl(Gl([],e.storedCards,!0),[h],!1),console.log("UPDATE_STORED_CARD: Added new card with ID:",t.payload.id,"image:",!!h.image)}break;case K:break;case Q:f.storedCards=t.payload;break;case Y:f.storedCards=e.storedCards.filter((function(e){return e.id!==t.payload}));break;case M:f.text=t.payload,""!==t.payload&&""!==t.payload.trim()||(console.log("Text cleared completely, also clearing images"),f.image=null,f.imageUrl=null);break;case U:f.translation=t.payload;break;case $:f.examples=t.payload;break;case W:console.log("*** REDUCER: SET_IMAGE called with:",{hasPayload:!!t.payload,payloadType:typeof t.payload,payloadLength:null===(l=t.payload)||void 0===l?void 0:l.length,payloadPreview:null===(c=t.payload)||void 0===c?void 0:c.substring(0,50)}),f.image=t.payload;break;case V:return console.log("*** REDUCER: SET_IMAGE_URL called with:",{hasPayload:!!t.payload,payloadType:typeof t.payload,payloadLength:null===(u=t.payload)||void 0===u?void 0:u.length,payloadPreview:null===(d=t.payload)||void 0===d?void 0:d.substring(0,50)}),Hl(Hl({},e),{imageUrl:t.payload});case q:return Hl(Hl({},e),{back:t.payload});case H:return Hl(Hl({},e),{front:t.payload});case Z:return Hl(Hl({},e),{currentCardId:t.payload});case ee:return Hl(Hl({},e),{linguisticInfo:t.payload});case te:return Hl(Hl({},e),{transcription:t.payload});case ne:return Hl(Hl({},e),{isGeneratingCard:t.payload});default:return e}return f};var Ql=function(){return Ql=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ql.apply(this,arguments)},Jl={isAnkiAvailable:!1};var Xl=function(){return Xl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xl.apply(this,arguments)},Zl={isSidebarVisible:!1};var ec=function(){return ec=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ec.apply(this,arguments)},tc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},nc={notifications:[]};var rc,oc=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"==typeof e[o]&&(n[o]=e[o])}var a,i=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Nl.INIT}))throw new Error(Ol(12));if(void 0===n(void 0,{type:Nl.PROBE_UNKNOWN_ACTION()}))throw new Error(Ol(13))}))}(n)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,o={},s=0;s<i.length;s++){var l=i[s],c=n[l],u=e[l],d=c(u,t);if(void 0===d){t&&t.type;throw new Error(Ol(14))}o[l]=d,r=r||d!==u}return(r=r||i.length!==Object.keys(e).length)?o:e}}({deck:function(e,t){switch(void 0===e&&(e=ql),t.type){case $s:return Vl(Vl({},e),{decks:t.payload});case Ws:return Vl(Vl({},e),{deckId:t.payload});default:return e}},cards:Yl,settings:function(e,t){switch(void 0===e&&(e=cs),t.type){case je:return ss(ss({},e),{openAiKey:t.payload});case Ae:return ss(ss({},e),{mode:t.payload});case Fe:return ss(ss({},e),{translateToLanguage:t.payload});case Te:return ss(ss({},e),{ankiConnectUrl:t.payload});case Pe:return ss(ss({},e),{ankiConnectApiKey:t.payload});case Oe:return ss(ss({},e),{useAnkiConnect:t.payload});case Re:return ss(ss({},e),{visibleSideBar:t.visible});case $e:return ss(ss({},e),{groqApiKey:t.payload});case We:return ss(ss({},e),{groqModelName:t.payload});case Be:return ss(ss({},e),{shouldGenerateImage:t.payload});case ze:return ss(ss({},e),{translationPrompt:t.payload});case Le:return ss(ss({},e),{examplesPrompt:t.payload});case De:return ss(ss({},e),{aiInstructions:t.payload});case Me:return ss(ss({},e),{imageInstructions:t.payload});case Ne:return ss(ss({},e),{imageGenerationMode:t.payload});case Ue:return ss(ss({},e),{modelProvider:t.payload});case Ve:return ss(ss({},e),{sourceLanguage:t.payload});default:return e}},currentPage:function(e,t){return void 0===e&&(e="createCard"),"SET_CURRENT_PAGE"===t.type?t.currentPage:e},anki:function(e,t){return void 0===e&&(e=Jl),t.type===Qs?Ql(Ql({},e),{isAnkiAvailable:t.payload}):e},sidebar:function(e,t){return void 0===e&&(e=Zl),t.type===Xs?Xl(Xl({},e),{isSidebarVisible:!e.isSidebarVisible}):e},notifications:function(e,t){switch(void 0===e&&(e=nc),t.type){case Zs:return ec(ec({},e),{notifications:tc(tc([],e.notifications,!0),[t.payload],!1)});case el:return ec(ec({},e),{notifications:e.notifications.filter((function(e){return e.id!==t.payload.id}))});default:return e}}}),ac=function(e,t,n){const{namespace:r,chromeNs:o,browserNs:a,storageArea:i,storageKey:s,isolated:l,plainActions:c,outdatedTimeout:u}=t||{},{onGlobalChange:d,onLocalChange:f,onError:p}=n||{};if("function"!=typeof e)throw new Error("Missing argument for 'storeCreatorContainer'");const g=a||r===Il.browser?new _l({namespace:a||browser,area:i,key:s}):new Cl({namespace:o||chrome,area:i,key:s});return"function"==typeof d&&g.regListener(((t,n)=>{const r=new wl(e,g,!0,c),[o]=bl(t),[a]=bl(n);d(r.initFrom(o),a)})),l||g.regShared(),t=>{p&&g.subscribeForError(p);return new wl(e,g,l,c,u,f,t).init()}}((function(e){return Ll(oc,e,Ml(Wl,as))}));console.log("Content script works!"),console.log("Must reload extension for modifications to take effect."),rc="Using the 'printLine' function from the Print Module",console.log("===> FROM THE PRINT MODULE:",rc);const ic=document.createElement("div");ic.id="sidebar",ic.setAttribute("style","\n  all: initial;\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 350px;\n  height: 100%;\n  overflow: auto;\n  z-index: 9999;\n  background-color: #ffffff;\n  box-shadow: -2px 0 5px rgba(0, 0, 0, 0.15);\n  transform: translateX(100%); /* по умолчанию скрыто */\n  transition: transform 0.3s ease-in-out;\n");const sc=ic.attachShadow({mode:"open"}),lc=document.createElement("link");lc.setAttribute("rel","stylesheet");const cc=chrome.runtime.getURL("tailwind.css");lc.setAttribute("href",cc),sc.appendChild(lc),document.body.appendChild(ic);const uc=(0,o.H)(sc),dc=()=>r.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",fontFamily:"system-ui, -apple-system, sans-serif",color:"#ffffff"}},[r.createElement("div",{key:"logo",style:{width:"48px",height:"48px",background:"rgba(255,255,255,0.2)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px",animation:"pulse 2s ease-in-out infinite"}},"🧠"),r.createElement("div",{key:"spinner",style:{width:"32px",height:"32px",border:"2px solid rgba(255,255,255,0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"20px"}}),r.createElement("h2",{key:"title",style:{color:"#ffffff",fontSize:"20px",fontWeight:"700",marginBottom:"8px",textAlign:"center",letterSpacing:"-0.025em"}},"Anki Flash Cards"),r.createElement("p",{key:"subtitle",style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",textAlign:"center",fontWeight:"400"}},"Initializing your learning assistant..."),r.createElement("div",{key:"progress-bar",style:{width:"200px",height:"2px",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"1px",marginTop:"24px",overflow:"hidden"}},r.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"#ffffff",animation:"progressBar 2s ease-in-out infinite"}})),r.createElement("style",{key:"styles"},"\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n      @keyframes pulse {\n        0%, 100% { transform: scale(1); opacity: 1; }\n        50% { transform: scale(1.05); opacity: 0.8; }\n      }\n      @keyframes progressBar {\n        0% { transform: translateX(-100%); }\n        50% { transform: translateX(0%); }\n        100% { transform: translateX(100%); }\n      }\n    ")]),fc=()=>{const[e,t]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{ac().then((e=>{t(e),setTimeout((()=>o(!1)),100)})).catch((e=>{console.error("Error loading state from Chrome storage:",e),o(!1)}))}),[]),n||!e?r.createElement(dc):r.createElement(w,{store:e},r.createElement(sl,null))},pc=r.createElement(fc,{});uc.render(pc),chrome.runtime.onMessage.addListener(((e,t,n)=>{if("toggleSidebar"===e.action)return chrome.storage.local.get(["isSidebarVisible"],(e=>{let t=!e.isSidebarVisible;chrome.storage.local.set({isSidebarVisible:t},(()=>{t?(ic.style.transform="translateX(0)",document.body.style.marginRight="350px"):(ic.style.transform="translateX(100%)",document.body.style.marginRight="0"),n({status:"Sidebar toggled",visible:t}),console.log("Sidebar toggled:",t)}))})),!0})),chrome.storage.local.get(["isSidebarVisible"],(e=>{e.isSidebarVisible?(ic.style.transform="translateX(0)",document.body.style.marginRight="350px"):(ic.style.transform="translateX(100%)",document.body.style.marginRight="0")}))})();