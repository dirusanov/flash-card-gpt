# Исправление проблемы с языками примеров

## Проблема

Примеры всегда создавались на английском языке независимо от исходного языка (Source Language), а должны были создаваться на исходном языке.

## Решение

Внесены следующие изменения:

### 1. Обновлен интерфейс AIProviderInterface (`src/services/aiProviders.ts`)

- Добавлен параметр `sourceLanguage?: string` в метод `getExamples`

### 2. Модифицирован промпт для создания примеров

- Функция `getPrompts().examples()` теперь принимает `sourceLanguage`
- **Убран хардкод языков** - теперь AI модель сама определяет язык по коду
- Промпт использует либо код языка (`"ru"`, `"fr"`, `"es"` и т.д.), либо позволяет модели определить исходный язык автоматически
- Более гибкое решение без необходимости поддерживать список языков

### 3. Обновлены интерфейсы и адаптеры (`src/services/aiServiceFactory.ts`)

- Обновлен интерфейс `AIService` для принятия `sourceLanguage`
- Модифицирована функция `createExamples` для передачи исходного языка
- Обновлен адаптер для корректной передачи параметров

### 4. Исправлены вызовы в компоненте (`src/components/CreateCard.tsx`)

- Обновлены все вызовы `createExamples` для передачи исходного языка
- Исправлены конфликты имен переменных
- Исправлены импорты

## Преимущества нового подхода

### ✅ Убран хардкод

- Нет необходимости поддерживать огромный список языков
- AI модель сама понимает коды языков (`ru`, `fr`, `es`, `zh`, и т.д.)
- Автоматическая поддержка всех языков, которые понимает AI

### ✅ Умное определение языка

- Если исходный язык указан, используется код языка
- Если не указан, модель сама определяет язык по контексту слова
- Более надежное и гибкое решение

### ✅ Простота поддержки

- Нет дублирования списка языков
- Использует существующую структуру `allLanguages` из компонента
- Легко добавлять новые языки без изменения AI логики

## Как тестировать

1. Откройте Chrome extension
2. Установите исходный язык (Source Language)
3. Установите целевой язык (Your Language)
4. Введите слово на исходном языке
5. Нажмите "Create Card"
6. Проверьте, что примеры создаются на исходном языке
7. Проверьте, что переводы примеров на целевом языке

## Примеры ожидаемого поведения

### Русское слово → Английский перевод

- Слово: "книга"
- Source Language: Russian (код: `ru`)
- Your Language: English (код: `en`)
- AI получит: `'ru'` как sourceLanguage
- Ожидаемый результат: примеры на русском языке, переводы на английском

### Французское слово → Русский перевод

- Слово: "bonjour"
- Source Language: French (код: `fr`)
- Your Language: Russian (код: `ru`)
- AI получит: `'fr'` как sourceLanguage
- Ожидаемый результат: примеры на французском языке, переводы на русском

### Автоопределение языка

- Слово: "hola"
- Source Language: Auto-detect
- Your Language: Russian
- AI получит: `undefined` как sourceLanguage
- AI сама определит, что "hola" - испанское слово
- Ожидаемый результат: примеры на испанском языке, переводы на русском

## Техническая информация

- Все изменения обратно совместимы
- Если `sourceLanguage` не указан, AI определяет язык автоматически
- Промпты оптимизированы для работы с кодами языков
- Поддержка всех языков, которые понимает используемая AI модель
- Убрано более 70 строк хардкода с языками
